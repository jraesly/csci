/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

/*
	This is an optimized version of Dojo, built for deployment and not for
	development. To get sources and documentation, please visit:

		http://dojotoolkit.org
*/

//>>built
require({cache:{"esri/arcgis/OAuthInfo":function(){define(["../kernel","../lang","dojo/_base/declare","dojo/_base/lang","dojo/has"],function(h,b,k,a,c){k=k(null,{declaredClass:"esri.arcgis.OAuthInfo",constructor:function(b){a.mixin(this,{expiration:20160,minTimeUntilExpiration:30,portalUrl:"https://www.arcgis.com",authNamespace:"/",popup:!1,popupCallbackUrl:"oauth-callback.html",popupWindowFeatures:"height\x3d480,width\x3d800,location,resizable,scrollbars,status"},b)},_oAuthCred:null,toJson:function(){return b.fixJson({appId:this.appId,
expiration:this.expiration,locale:this.locale,minTimeUntilExpiration:this.minTimeUntilExpiration,portalUrl:this.portalUrl,authNamespace:this.authNamespace,popup:this.popup,popupCallbackUrl:this.popupCallbackUrl,popupWindowFeatures:this.popupWindowFeatures})}});c("extend-esri")&&a.setObject("arcgis.OAuthInfo",k,h);return k})},"dijit/form/TextBox":function(){define("dojo/_base/declare dojo/dom-construct dojo/dom-style dojo/_base/kernel dojo/_base/lang dojo/on dojo/sniff ./_FormValueWidget ./_TextBoxMixin dojo/text!./templates/TextBox.html ../main".split(" "),
function(h,b,k,a,c,d,e,f,g,l,m){f=h("dijit.form.TextBox"+(e("dojo-bidi")?"_NoBidi":""),[f,g],{templateString:l,_singleNodeTemplate:'\x3cinput class\x3d"dijit dijitReset dijitLeft dijitInputField" data-dojo-attach-point\x3d"textbox,focusNode" autocomplete\x3d"off" type\x3d"${type}" ${!nameAttrSetting} /\x3e',_buttonInputDisabled:e("ie")?"disabled":"",baseClass:"dijitTextBox",postMixInProperties:function(){var a=this.type.toLowerCase();if(this.templateString&&"input"==this.templateString.toLowerCase()||
("hidden"==a||"file"==a)&&this.templateString==this.constructor.prototype.templateString)this.templateString=this._singleNodeTemplate;this.inherited(arguments)},postCreate:function(){this.inherited(arguments);9>e("ie")&&this.defer(function(){try{var a=k.getComputedStyle(this.domNode);if(a){var b=a.fontFamily;if(b){var c=this.domNode.getElementsByTagName("INPUT");if(c)for(a=0;a<c.length;a++)c[a].style.fontFamily=b}}}catch(d){}})},_setPlaceHolderAttr:function(a){this._set("placeHolder",a);this._phspan||
(this._attachPoints.push("_phspan"),this._phspan=b.create("span",{className:"dijitPlaceHolder dijitInputField"},this.textbox,"after"),this.own(d(this._phspan,"mousedown",function(a){a.preventDefault()}),d(this._phspan,"touchend, pointerup, MSPointerUp",c.hitch(this,function(){this.focus()}))));this._phspan.innerHTML="";this._phspan.appendChild(this._phspan.ownerDocument.createTextNode(a));this._updatePlaceHolder()},_onInput:function(a){this.inherited(arguments);this._updatePlaceHolder()},_updatePlaceHolder:function(){this._phspan&&
(this._phspan.style.display=this.placeHolder&&!this.textbox.value?"":"none")},_setValueAttr:function(a,b,c){this.inherited(arguments);this._updatePlaceHolder()},getDisplayedValue:function(){a.deprecated(this.declaredClass+"::getDisplayedValue() is deprecated. Use get('displayedValue') instead.","","2.0");return this.get("displayedValue")},setDisplayedValue:function(b){a.deprecated(this.declaredClass+"::setDisplayedValue() is deprecated. Use set('displayedValue', ...) instead.","","2.0");this.set("displayedValue",
b)},_onBlur:function(a){this.disabled||(this.inherited(arguments),this._updatePlaceHolder(),e("mozilla")&&this.selectOnClick&&(this.textbox.selectionStart=this.textbox.selectionEnd=void 0))},_onFocus:function(a){!this.disabled&&!this.readOnly&&(this.inherited(arguments),this._updatePlaceHolder())}});9>e("ie")&&(f.prototype._isTextSelected=function(){var a=this.ownerDocument.selection.createRange();return a.parentElement()==this.textbox&&0<a.text.length},m._setSelectionRange=g._setSelectionRange=function(a,
b,c){a.createTextRange&&(a=a.createTextRange(),a.collapse(!0),a.moveStart("character",-99999),a.moveStart("character",b),a.moveEnd("character",c-b),a.select())});e("dojo-bidi")&&(f=h("dijit.form.TextBox",f,{_setPlaceHolderAttr:function(a){this.inherited(arguments);this.applyTextDir(this._phspan)}}));return f})},"esri/sniff":function(){define(["dojo/_base/sniff","./kernel"],function(h,b){var k=h("ff"),a=h("ie"),c=void 0===a&&7<=h("trident"),d=h("webkit"),e=h("opera"),f=h("chrome"),g=h("safari"),l=
navigator.userAgent,m;(m=l.match(/(iPhone|iPad|CPU)\s+OS\s+(\d+\_\d+)/i))&&h.add("esri-iphone",parseFloat(m[2].replace("_",".")));(m=l.match(/Android\s+(\d+\.\d+)/i))&&h.add("esri-android",parseFloat(m[1]));(m=l.match(/Fennec\/(\d+\.\d+)/i))&&h.add("esri-fennec",parseFloat(m[1]));0<=l.indexOf("BlackBerry")&&0<=l.indexOf("WebKit")&&h.add("esri-blackberry",1);h.add("esri-touch",h("esri-iphone")||h("esri-android")||h("esri-blackberry")||6<=h("esri-fennec")||(k||d)&&document.createTouch?!0:!1);h.add("esri-pointer",
navigator.pointerEnabled||navigator.msPointerEnabled);b._getDOMAccessor=function(b){var c="";k?c="Moz":d?c="Webkit":a?c="ms":e&&(c="O");return c+b.charAt(0).toUpperCase()+b.substr(1)};h.add("esri-phonegap",!!window.cordova);h.add("esri-cors",h("esri-phonegap")||"XMLHttpRequest"in window&&"withCredentials"in new XMLHttpRequest);h.add("esri-file-upload",window.FormData&&window.FileList?!0:!1);h.add("esri-workers",window.Worker?!0:!1);h.add("esri-transforms",c||9<=a||3.5<=k||4<=f||3.1<=g||10.5<=e||3.2<=
h("esri-iphone")||2.1<=h("esri-android"));h.add("esri-transitions",c||10<=a||4<=k||4<=f||3.1<=g||10.5<=e||3.2<=h("esri-iphone")||2.1<=h("esri-android"));h.add("esri-transforms3d",c||10<=k||12<=f||4<=g||3.2<=h("esri-iphone")||3<=h("esri-android"));h.add("esri-url-encodes-apostrophe",function(){var a=window.document.createElement("a");a.href="?'";return-1<a.href.indexOf("?%27")});3>h("esri-android")&&(h.add("esri-transforms",!1,!1,!0),h.add("esri-transitions",!1,!1,!0),h.add("esri-transforms3d",!1,
!1,!0));b._css=function(b){var c=h("esri-transforms3d");if(void 0!==b&&null!==b)c=b;else if(c&&(f||g&&!h("esri-iphone")))c=!1;var l=c?"translate3d(":"translate(",m=c?f?",-1px)":",0px)":")",t=c?"scale3d(":"scale(",u=c?",1)":")",x=c?"rotate3d(0,0,1,":"rotate(",w=c?"matrix3d(":"matrix(",v=c?",0,0,":",",y=c?",0,0,0,0,1,0,":",",A=c?",0,1)":")";return{names:{transition:d&&"-webkit-transition"||k&&"MozTransition"||e&&"OTransition"||a&&"msTransition"||"transition",transform:d&&"-webkit-transform"||k&&"MozTransform"||
e&&"OTransform"||a&&"msTransform"||"transform",transformName:d&&"-webkit-transform"||k&&"-moz-transform"||e&&"-o-transform"||a&&"-ms-transform"||"transform",origin:d&&"-webkit-transform-origin"||k&&"MozTransformOrigin"||e&&"OTransformOrigin"||a&&"msTransformOrigin"||"transformOrigin",endEvent:d&&"webkitTransitionEnd"||k&&"transitionend"||e&&"oTransitionEnd"||a&&"MSTransitionEnd"||"transitionend"},translate:function(a,b){return l+a+"px,"+b+"px"+m},scale:function(a){return t+a+","+a+u},rotate:function(a){return x+
a+"deg)"},matrix:function(a){return w+a.xx+","+a.xy+v+a.yx+","+a.yy+y+a.dx.toFixed(10)+(k?"px,":",")+a.dy.toFixed(10)+(k?"px":"")+A},getScaleFromMatrix:function(a){if(!a)return 1;a=a.toLowerCase();var b=-1<a.indexOf("matrix3d")?"matrix3d(":"matrix(";return Number(a.substring(b.length,a.indexOf(",")))}}};h("extend-esri")&&(b.isiPhone=h("esri-iphone"),b.isAndroid=h("esri-android"),b.isFennec=h("esri-fennec"),b.isBlackBerry=h("esri-blackberry"),b.isTouchEnabled=h("esri-touch"),b.isPointerEnabled=h("esri-pointer"),
b._hasCors=h("esri-cors"),b._hasFileUpload=h("esri-file-upload"),b._hasTransforms=h("esri-transforms"),b._hasTransitions=h("esri-transitions"),b._has3DTransforms=h("esri-transforms3d"));return h})},"dijit/_base/scroll":function(){define(["dojo/window","../main"],function(h,b){b.scrollIntoView=function(b,a){h.scrollIntoView(b,a)}})},"dijit/_TemplatedMixin":function(){define("dojo/cache dojo/_base/declare dojo/dom-construct dojo/_base/lang dojo/on dojo/sniff dojo/string ./_AttachMixin".split(" "),function(h,
b,k,a,c,d,e,f){var g=b("dijit._TemplatedMixin",f,{templateString:null,templatePath:null,_skipNodeCache:!1,searchContainerNode:!0,_stringRepl:function(b){var c=this.declaredClass,d=this;return e.substitute(b,this,function(b,e){"!"==e.charAt(0)&&(b=a.getObject(e.substr(1),!1,d));if("undefined"==typeof b)throw Error(c+" template:"+e);return null==b?"":"!"==e.charAt(0)?b:this._escapeValue(""+b)},this)},_escapeValue:function(a){return a.replace(/["'<>&]/g,function(a){return{"\x26":"\x26amp;","\x3c":"\x26lt;",
"\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#x27;"}[a]})},buildRendering:function(){if(!this._rendered){this.templateString||(this.templateString=h(this.templatePath,{sanitize:!0}));var b=g.getCachedTemplate(this.templateString,this._skipNodeCache,this.ownerDocument),c;if(a.isString(b)){if(c=k.toDom(this._stringRepl(b),this.ownerDocument),1!=c.nodeType)throw Error("Invalid template: "+b);}else c=b.cloneNode(!0);this.domNode=c}this.inherited(arguments);this._rendered||this._fillContent(this.srcNodeRef);
this._rendered=!0},_fillContent:function(a){var b=this.containerNode;if(a&&b)for(;a.hasChildNodes();)b.appendChild(a.firstChild)}});g._templateCache={};g.getCachedTemplate=function(a,b,c){var d=g._templateCache,f=a,s=d[f];if(s){try{if(!s.ownerDocument||s.ownerDocument==(c||document))return s}catch(t){}k.destroy(s)}a=e.trim(a);if(b||a.match(/\$\{([^\}]+)\}/g))return d[f]=a;b=k.toDom(a,c);if(1!=b.nodeType)throw Error("Invalid template: "+a);return d[f]=b};d("ie")&&c(window,"unload",function(){var a=
g._templateCache,b;for(b in a){var c=a[b];"object"==typeof c&&k.destroy(c);delete a[b]}});return g})},"dijit/_Templated":function(){define("./_WidgetBase ./_TemplatedMixin ./_WidgetsInTemplateMixin dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/_base/kernel".split(" "),function(h,b,k,a,c,d,e){d.extend(h,{waiRole:"",waiState:""});return c("dijit._Templated",[b,k],{widgetsInTemplate:!1,constructor:function(){e.deprecated(this.declaredClass+": dijit._Templated deprecated, use dijit._TemplatedMixin and if necessary dijit._WidgetsInTemplateMixin",
"","2.0")},_processNode:function(b,c){var d=this.inherited(arguments),e=c(b,"waiRole");e&&b.setAttribute("role",e);(e=c(b,"waiState"))&&a.forEach(e.split(/\s*,\s*/),function(a){-1!=a.indexOf("-")&&(a=a.split("-"),b.setAttribute("aria-"+a[0],a[1]))});return d}})})},"dijit/_CssStateMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-class dojo/has dojo/_base/lang dojo/on dojo/domReady dojo/touch dojo/_base/window ./a11yclick ./registry".split(" "),function(h,b,k,a,c,d,e,
f,g,l,m,n){b=b("dijit._CssStateMixin",[],{hovering:!1,active:!1,_applyAttributes:function(){this.inherited(arguments);h.forEach("disabled readOnly checked selected focused state hovering active _opened".split(" "),function(a){this.watch(a,d.hitch(this,"_setStateClass"))},this);for(var a in this.cssStateNodes||{})this._trackMouseState(this[a],this.cssStateNodes[a]);this._trackMouseState(this.domNode,this.baseClass);this._setStateClass()},_cssMouseEvent:function(a){if(!this.disabled)switch(a.type){case "mouseover":case "MSPointerOver":case "pointerover":this._set("hovering",
!0);this._set("active",this._mouseDown);break;case "mouseout":case "MSPointerOut":case "pointerout":this._set("hovering",!1);this._set("active",!1);break;case "mousedown":case "touchstart":case "MSPointerDown":case "pointerdown":case "keydown":this._set("active",!0);break;case "mouseup":case "dojotouchend":case "MSPointerUp":case "pointerup":case "keyup":this._set("active",!1)}},_setStateClass:function(){function a(c){b=b.concat(h.map(b,function(a){return a+c}),"dijit"+c)}var b=this.baseClass.split(" ");
this.isLeftToRight()||a("Rtl");var c="mixed"==this.checked?"Mixed":this.checked?"Checked":"";this.checked&&a(c);this.state&&a(this.state);this.selected&&a("Selected");this._opened&&a("Opened");this.disabled?a("Disabled"):this.readOnly?a("ReadOnly"):this.active?a("Active"):this.hovering&&a("Hover");this.focused&&a("Focused");var c=this.stateNode||this.domNode,d={};h.forEach(c.className.split(" "),function(a){d[a]=!0});"_stateClasses"in this&&h.forEach(this._stateClasses,function(a){delete d[a]});h.forEach(b,
function(a){d[a]=!0});var e=[],f;for(f in d)e.push(f);c.className=e.join(" ");this._stateClasses=b},_subnodeCssMouseEvent:function(b,c,d){function e(d){a.toggle(b,c+"Active",d)}if(!this.disabled&&!this.readOnly)switch(d.type){case "mouseover":case "MSPointerOver":case "pointerover":a.toggle(b,c+"Hover",!0);break;case "mouseout":case "MSPointerOut":case "pointerout":a.toggle(b,c+"Hover",!1);e(!1);break;case "mousedown":case "touchstart":case "MSPointerDown":case "pointerdown":case "keydown":e(!0);
break;case "mouseup":case "MSPointerUp":case "pointerup":case "dojotouchend":case "keyup":e(!1);break;case "focus":case "focusin":a.toggle(b,c+"Focused",!0);break;case "blur":case "focusout":a.toggle(b,c+"Focused",!1)}},_trackMouseState:function(a,b){a._cssState=b}});f(function(){function a(b,c,d){if(!d||!k.isDescendant(d,c))for(;c&&c!=d;c=c.parentNode)if(c._cssState){var e=n.getEnclosingWidget(c);e&&(c==e.domNode?e._cssMouseEvent(b):e._subnodeCssMouseEvent(c,c._cssState,b))}}var b=l.body(),c;e(b,
g.over,function(b){a(b,b.target,b.relatedTarget)});e(b,g.out,function(b){a(b,b.target,b.relatedTarget)});e(b,m.press,function(b){c=b.target;a(b,c)});e(b,m.release,function(b){a(b,c);c=null});e(b,"focusin, focusout",function(a){var b=a.target;if(b._cssState&&!b.getAttribute("widgetId")){var c=n.getEnclosingWidget(b);c&&c._subnodeCssMouseEvent(b,b._cssState,a)}})});return b})},"dijit/DialogUnderlay":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/dom-attr dojo/dom-style dojo/on dojo/window ./_Widget ./_TemplatedMixin ./BackgroundIframe ./Viewport ./main".split(" "),
function(h,b,k,a,c,d,e,f,g,l,m,n){var q=h("dijit.DialogUnderlay",[f,g],{templateString:"\x3cdiv class\x3d'dijitDialogUnderlayWrapper'\x3e\x3cdiv class\x3d'dijitDialogUnderlay' tabIndex\x3d'-1' data-dojo-attach-point\x3d'node'\x3e\x3c/div\x3e\x3c/div\x3e",dialogId:"","class":"",_modalConnects:[],_setDialogIdAttr:function(b){a.set(this.node,"id",b+"_underlay");this._set("dialogId",b)},_setClassAttr:function(a){this.node.className="dijitDialogUnderlay "+a;this._set("class",a)},postCreate:function(){this.ownerDocumentBody.appendChild(this.domNode);
this.own(d(this.domNode,"keydown",b.hitch(this,"_onKeyDown")));this.inherited(arguments)},layout:function(){var a=this.node.style,b=this.domNode.style;b.display="none";var c=e.getBox(this.ownerDocument);b.top=c.t+"px";b.left=c.l+"px";a.width=c.w+"px";a.height=c.h+"px";b.display="block"},show:function(){this.domNode.style.display="block";this.open=!0;this.layout();this.bgIframe=new l(this.domNode);var a=e.get(this.ownerDocument);this._modalConnects=[m.on("resize",b.hitch(this,"layout")),d(a,"scroll",
b.hitch(this,"layout"))]},hide:function(){this.bgIframe.destroy();delete this.bgIframe;for(this.domNode.style.display="none";this._modalConnects.length;)this._modalConnects.pop().remove();this.open=!1},destroy:function(){for(;this._modalConnects.length;)this._modalConnects.pop().remove();this.inherited(arguments)},_onKeyDown:function(){}});q.show=function(a,b){var d=q._singleton;!d||d._destroyed?d=n._underlay=q._singleton=new q(a):a&&d.set(a);c.set(d.domNode,"zIndex",b);d.open||d.show()};q.hide=function(){var a=
q._singleton;a&&!a._destroyed&&a.hide()};return q})},"arcgisonline/persist":function(){define(["dijit","dojo","dojox"],function(h,b,k){b.provide("arcgisonline.persist");arcgisonline.persist=function(){var a,b,d,e,f,g;g=function(){var a=["expires","path","domain"],b=escape,c=unescape,d=document,e,f=function(c,d){var e,f,g,n=[],p=2<arguments.length?arguments[2]:{};n.push(b(c)+"\x3d"+b(d));for(e=0;e<a.length;e++)f=a[e],(g=p[f])&&n.push(f+"\x3d"+g);p.secure&&n.push("secure");return n.join("; ")};e={set:function(a,
b){var c=2<arguments.length?arguments[2]:{},e=new Date;e.setTime(e.getTime());var g={};c.expires&&(c.expires*=864E5,g.expires=new Date(e.getTime()+c.expires),g.expires=g.expires.toGMTString());e=["path","domain","secure"];for(i=0;i<e.length;i++)c[e[i]]&&(g[e[i]]=c[e[i]]);c=f(a,b,g);d.cookie=c;return b},has:function(a){a=b(a);var c=d.cookie,e=c.indexOf(a+"\x3d"),c=c.substring(0,a.length);return!e&&a!=c||0>e?!1:!0},get:function(a){a=b(a);var e=d.cookie,f=e.indexOf(a+"\x3d"),g=f+a.length+1,l=e.substring(0,
a.length);if(!f&&a!=l||0>f)return null;a=e.indexOf(";",g);0>a&&(a=e.length);return c(e.substring(g,a))},remove:function(a){var b=e.get(a);d.cookie=f(a,"",{expires:"Thu, 01-Jan-1970 00:00:01 GMT"});return b},keys:function(){var a=d.cookie.split("; "),b,e,f=[];for(b=0;b<a.length;b++)e=a[b].split("\x3d"),f.push(c(e[0]));return f},all:function(){var a=d.cookie.split("; "),b,e,f=[];for(b=0;b<a.length;b++)e=a[b].split("\x3d"),f.push([c(e[0]),c(e[1])]);return f},version:"0.2.1",enabled:!1};e.enabled=function(){var a=
new Date,a=a.toGMTString();this.set("__EC_TEST__",a);return this.enabled=this.remove("__EC_TEST__")==a}.call(e);return e}();f=function(){};d=function(a){return"PS"+a.replace(/_/g,"__").replace(/ /g,"_s")};C={search_order:"localstorage whatwg_db globalstorage flash ie cookie".split(" "),name_re:/^[a-z][a-z0-9_ -]+$/i,methods:"init get set remove load save".split(" "),sql:{version:"1",create:"CREATE TABLE IF NOT EXISTS persist_data (k TEXT UNIQUE NOT NULL PRIMARY KEY, v TEXT NOT NULL)",get:"SELECT v FROM persist_data WHERE k \x3d ?",
set:"INSERT INTO persist_data(k, v) VALUES (?, ?)",remove:"DELETE FROM persist_data WHERE k \x3d ?"},flash:{div_id:"_persist_flash_wrap",id:"_persist_flash",path:"persist.swf",size:{w:1,h:1},args:{autostart:!0}}};b={gears:{size:-1,test:function(){return window.google&&window.google.gears?!0:!1},methods:{transaction:function(a){var b=this.db;b.execute("BEGIN").close();a.call(this,b);b.execute("COMMIT").close()},init:function(){var a;a=this.db=google.gears.factory.create("beta.database");a.open(d(this.name));
a.execute(C.sql.create).close()},get:function(a,b,c){var d,e=C.sql.get;b&&this.transaction(function(f){d=f.execute(e,[a]);d.isValidRow()?b.call(c||this,!0,d.field(0)):b.call(c||this,!1,null);d.close()})},set:function(a,b,c,d){var e=C.sql.remove,f=C.sql.set;this.transaction(function(g){g.execute(e,[a]).close();g.execute(f,[a,b]).close();c&&c.call(d||this,!0,b)})},remove:function(a,b,c){var d=C.sql.get;sql=C.sql.remove;r;val;this.transaction(function(e){b?(r=e.execute(d,[a]),r.isValidRow()?(val=r.field(0),
e.execute(sql,[a]).close(),b.call(c||this,!0,val)):b.call(c||this,!1,null),r.close()):e.execute(sql,[a]).close()})}}},whatwg_db:{size:204800,test:function(){return!window.openDatabase||!window.openDatabase("PersistJS Test",C.sql.version,"Persistent database test.",b.whatwg_db.size)?!1:!0},methods:{transaction:function(a){if(!this.db_created){var b=C.sql.create;this.db.transaction(function(a){a.executeSql(b,[],function(){this.db_created=!0})},f)}this.db.transaction(a)},init:function(){this.db=openDatabase(this.name,
C.sql.version,this.o.about||"Persistent storage for "+this.name,this.o.size||b.whatwg_db.size)},get:function(a,b,c){var d=C.sql.get;b&&(c=c||this,this.transaction(function(e){e.executeSql(d,[a],function(a,d){0<d.rows.length?b.call(c,!0,d.rows.item(0).v):b.call(c,!1,null)})}))},set:function(a,b,c,d){var e=C.sql.remove,f=C.sql.set;this.transaction(function(g){g.executeSql(e,[a],function(){g.executeSql(f,[a,b],function(a,e){c&&c.call(d||this,!0,b)})})});return b},remove:function(a,b,c){var d=C.sql.get;
sql=C.sql.remove;this.transaction(function(e){b?e.executeSql(d,[a],function(d,e){if(0<e.rows.length){var f=e.rows.item(0).v;d.executeSql(sql,[a],function(a,d){b.call(c||this,!0,f)})}else b.call(c||this,!1,null)}):e.executeSql(sql,[a])})}}},globalstorage:{size:5242880,test:function(){return window.globalStorage?!0:!1},methods:{key:function(a){return d(this.name)+d(a)},init:function(){this.store=globalStorage[this.o.domain]},get:function(a,b,c){a=this.key(a);b&&b.call(c||this,!0,this.store.getItem(a))},
set:function(a,b,c,d){a=this.key(a);this.store.setItem(a,b);c&&c.call(d||this,!0,b)},remove:function(a,b,c){var d;a=this.key(a);d=this.store[a];this.store.removeItem(a);b&&b.call(c||this,null!==d,d)}}},localstorage:{size:-1,test:function(){return window.localStorage?!0:!1},methods:{key:function(a){return d(this.name)+d(a)},init:function(){this.store=localStorage},get:function(a,b,c){a=this.key(a);b&&b.call(c||this,!0,this.store.getItem(a))},set:function(a,b,c,d){a=this.key(a);this.store.setItem(a,
b);c&&c.call(d||this,!0,b)},remove:function(a,b,c){var d;a=this.key(a);d=this.getItem(a);this.store.removeItem(a);b&&b.call(c||this,null!==d,d)}}},ie:{prefix:"_persist_data-",size:65536,test:function(){return window.ActiveXObject?!0:!1},make_userdata:function(a){var b=document.createElement("div");b.id=a;b.style.display="none";b.addBehavior("#default#userData");document.body.appendChild(b);return b},methods:{init:function(){var a=b.ie.prefix+d(this.name);this.el=b.ie.make_userdata(a);this.o.defer&&
this.load()},get:function(a,b,c){a=d(a);this.o.defer||this.load();a=this.el.getAttribute(a);b&&b.call(c||this,a?!0:!1,a)},set:function(a,b,c,e){a=d(a);this.el.setAttribute(a,b);this.o.defer||this.save();c&&c.call(e||this,!0,b)},load:function(){this.el.load(d(this.name))},save:function(){this.el.save(d(this.name))}}},cookie:{delim:":",size:4E3,test:function(){return a.Cookie.enabled?!0:!1},methods:{key:function(a){return this.name+b.cookie.delim+a},get:function(a,b,c,d){a=this.key(a);b=g.get(a);c&&
c.call(d||this,null!=b,b)},set:function(a,b,c,d){a=this.key(a);g.set(a,b,this.o);c&&c.call(d||this,!0,b)},remove:function(a,b,c,d){a=this.key(a);b=g.remove(a);c&&c.call(d||this,null!=b,b)}}},flash:{test:function(){return!window.SWFObject||!deconcept||!deconcept.SWFObjectUtil?!1:8<=deconcept.SWFObjectUtil.getPlayerVersion().major?!0:!1},methods:{init:function(){if(!b.flash.el){var a,d,e,f=C.flash;e=document.createElement("div");e.id=f.div_id;document.body.appendChild(e);a=new SWFObject(this.o.swf_path||
f.path,f.id,f.size.w,f.size.h,"8");for(d in f.args)a.addVariable(d,f.args[d]);a.write(e);b.flash.el=document.getElementById(f.id)}this.el=b.flash.el},get:function(a,b,c){a=d(a);a=this.el.get(this.name,a);b&&b.call(c||this,null!==a,a)},set:function(a,b,c,e){a=d(a);this.el.set(this.name,a,b);c&&c.call(e||this,!0,b)},remove:function(a,b,c){a=d(a);a=this.el.remove(this.name,a);b&&b.call(c||this,!0,a)}}}};e=function(){var d,e,g,q;g=C.methods;var p=C.search_order;d=0;for(e=g.length;d<e;d++)a.Store.prototype[g[d]]=
f;a.type=null;a.size=-1;d=0;for(e=p.length;!a.type&&d<e;d++)if(g=b[p[d]],g.test())for(q in a.type=p[d],a.size=g.size,g.methods)a.Store.prototype[q]=g.methods[q];a._init=!0};a={VERSION:"0.1.0",type:null,size:0,add:function(a){b[a.id]=a;C.search_order=[a.id].concat(C.search_order);e()},remove:function(a){Array.indexOf||(Array.prototype.indexOf=function(a){for(var b=0;b<this.length;b++)if(this[b]==a)return b;return-1});var d=C.search_order.indexOf(a);0>d||(C.search_order.splice(d,1),delete b[a],e())},
Cookie:g,Store:function(b,c){if(!C.name_re.exec(b))throw Error("Invalid name");if(!a.type)throw Error("No suitable storage found");c=c||{};this.name=b;c.domain=c.domain||location.hostname||"localhost.localdomain";this.o=c;c.expires=c.expires||730;c.path=c.path||"/";this.init()}};e();return a}()})},"esri/OAuthSignInHandler":function(){define("./Credential ./domUtils ./lang ./urlUtils dijit/Dialog dijit/registry dojo/_base/config dojo/_base/Deferred dojo/_base/kernel dojo/dom-attr dojo/i18n!esri/nls/jsapi dojo/io-query dojo/sniff dojo/json dijit/form/Button dojo/query".split(" "),
function(h,b,k,a,c,d,e,f,g,l,m,n,q,p){return{_oAuthDfd:null,_oAuthIntervalId:0,_oAuthDialogContent:"\x3cdiv class\x3d'dijitDialogPaneContentArea'\x3e\x3cdiv style\x3d'padding-bottom: 5px; word-wrap: break-word;'\x3e${info}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriErrorMsg' style\x3d'display: none; color: white; background-color: #D46464; text-align: center; padding-top: 3px; padding-bottom: 3px;'\x3e${invalidUser}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitDialogPaneActionBar'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdSubmit\"'\x3e${lblOk}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdCancel\"'\x3e${lblCancel}\x3c/button\x3e\x3c/div\x3e",
setOAuthRedirectionHandler:function(a){this._oAuthRedirectFunc=a},oAuthSignIn:function(a,c,d,e){var g=this._oAuthDfd=new f;g.resUrl_=a;g.sinfo_=c;g.oinfo_=d;var n=!e||!1!==e.oAuthPopupConfirmation;if(!d.popup||!n)return this._doOAuthSignIn(a,c,d),g;this._nls||(this._nls=m.identity);this.oAuthDialog||(this.oAuthDialog=this._createOAuthDialog());d=this.oAuthDialog;n=e&&e.error;e=e&&e.token;b.hide(d.errMsg_);n&&(403==n.code&&e)&&(l.set(d.errMsg_,"innerHTML",this._nls.forbidden),b.show(d.errMsg_));l.set(d.resLink_,
{title:a,innerHTML:"("+(this.getResourceName(a)||this._nls.lblItem)+")"});l.set(d.serverLink_,{title:c.server,innerHTML:(-1!==c.server.toLowerCase().indexOf("arcgis.com")?"ArcGIS Online":c.server)+" "});d.show();return g},setOAuthResponseHash:function(a){var b=this._oAuthDfd;this._oAuthDfd=null;if(b&&a)if(clearInterval(this._oAuthIntervalId),"#"===a.charAt(0)&&(a=a.substring(1)),a=n.queryToObject(a),a.error)a=Error("access_denied"===a.error?"ABORTED":"OAuth: "+a.error+" - "+a.error_description),a.code=
"IdentityManagerBase.2",a.log=e.isDebug,b.errback(a);else{var c=b.oinfo_._oAuthCred,d=new h({userId:a.username,server:b.sinfo_.server,token:a.access_token,expires:(new Date).getTime()+1E3*Number(a.expires_in),ssl:"true"===a.ssl,_oAuthCred:c});c.storage=a.persist?window.localStorage:window.sessionStorage;c.token=d.token;c.expires=d.expires;c.userId=d.userId;c.ssl=d.ssl;c.save();b.callback(d)}},_createOAuthDialog:function(){var a=this._nls,f=k.substitute(a,this._oAuthDialogContent),f=k.substitute({resource:"\x3cspan class\x3d'resLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e",
server:"\x3cspan class\x3d'serverLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e"},f),l=new c({title:a.title,content:f,"class":"esriOAuthSignInDialog",style:"width: 18em;",esriIdMgr_:this,execute_:function(){var a=l.esriIdMgr_._oAuthDfd;l.hide_();l.esriIdMgr_._doOAuthSignIn(a.resUrl_,a.sinfo_,a.oinfo_)},cancel_:function(){var a=l.esriIdMgr_._oAuthDfd;l.esriIdMgr_._oAuthDfd=null;l.hide_();var b=Error("ABORTED");b.code="IdentityManager.2";b.log=e.isDebug;a.errback(b)},hide_:function(){b.hide(l.errMsg_);
l.hide();c._DialogLevelManager.hide(l)}}),a=l.domNode;l.btnSubmit_=d.byNode(g.query(".esriIdSubmit",a)[0]);l.btnCancel_=d.byNode(g.query(".esriIdCancel",a)[0]);l.resLink_=g.query(".resLink",a)[0];l.serverLink_=g.query(".serverLink",a)[0];l.errMsg_=g.query(".esriErrorMsg",a)[0];l.connect(l.btnSubmit_,"onClick",l.execute_);l.connect(l.btnCancel_,"onClick",l.onCancel);l.connect(l,"onCancel",l.cancel_);return l},_doOAuthSignIn:function(b,c,d){var f=this,g={client_id:d.appId,response_type:"token",state:p.stringify({portalUrl:d.portalUrl}),
expiration:d.expiration,locale:d.locale,redirect_uri:d.popup?a.getAbsoluteUrl(d.popupCallbackUrl):window.location.href.replace(/#.*$/,"")},l=d.portalUrl.replace(/^http:/i,"https:")+"/sharing/oauth2/authorize",m=l+"?"+n.objectToQuery(g);if(d.popup){var k;7===q("ie")?(k=window.open(d.popupCallbackUrl,"esriJSAPIOAuth",d.popupWindowFeatures),k.location=m):k=window.open(m,"esriJSAPIOAuth",d.popupWindowFeatures);this._oAuthIntervalId=setInterval(function(){if(k.closed){clearInterval(f._oAuthIntervalId);
var a=f._oAuthDfd;if(a){var b=Error("ABORTED");b.code="IdentityManager.2";b.log=e.isDebug;a.errback(b)}}},500)}else this._oAuthRedirectFunc?this._oAuthRedirectFunc({authorizeParams:g,authorizeUrl:l,resourceUrl:b,serverInfo:c,oAuthInfo:d}):window.location=m}}})},"esri/Credential":function(){define(["dojo/_base/declare","dojo/has","./kernel","./IdentityManagerBase"],function(h,b,k,a){h=h(a.Credential,{});b("extend-esri")&&(k.Credential=h);return h})},"dijit/place":function(){define("dojo/_base/array dojo/dom-geometry dojo/dom-style dojo/_base/kernel dojo/_base/window ./Viewport ./main".split(" "),
function(h,b,k,a,c,d,e){function f(a,e,f,g){var p=d.getEffectiveBox(a.ownerDocument);(!a.parentNode||"body"!=String(a.parentNode.tagName).toLowerCase())&&c.body(a.ownerDocument).appendChild(a);var s=null;h.some(e,function(c){var d=c.corner,e=c.pos,m=0,t={w:{L:p.l+p.w-e.x,R:e.x-p.l,M:p.w}[d.charAt(1)],h:{T:p.t+p.h-e.y,B:e.y-p.t,M:p.h}[d.charAt(0)]},k=a.style;k.left=k.right="auto";f&&(m=f(a,c.aroundCorner,d,t,g),m="undefined"==typeof m?0:m);var u=a.style,h=u.display,B=u.visibility;"none"==u.display&&
(u.visibility="hidden",u.display="");k=b.position(a);u.display=h;u.visibility=B;h={L:e.x,R:e.x-k.w,M:Math.max(p.l,Math.min(p.l+p.w,e.x+(k.w>>1))-k.w)}[d.charAt(1)];B={T:e.y,B:e.y-k.h,M:Math.max(p.t,Math.min(p.t+p.h,e.y+(k.h>>1))-k.h)}[d.charAt(0)];e=Math.max(p.l,h);u=Math.max(p.t,B);h=Math.min(p.l+p.w,h+k.w);B=Math.min(p.t+p.h,B+k.h);h-=e;B-=u;m+=k.w-h+(k.h-B);if(null==s||m<s.overflow)s={corner:d,aroundCorner:c.aroundCorner,x:e,y:u,w:h,h:B,overflow:m,spaceAvailable:t};return!m});s.overflow&&f&&f(a,
s.aroundCorner,s.corner,s.spaceAvailable,g);e=s.y;var t=s.x,u=c.body(a.ownerDocument);/relative|absolute/.test(k.get(u,"position"))&&(e-=k.get(u,"marginTop"),t-=k.get(u,"marginLeft"));u=a.style;u.top=e+"px";u.left=t+"px";u.right="auto";return s}var g={TL:"BR",TR:"BL",BL:"TR",BR:"TL"};return e.place={at:function(a,b,c,d,e){c=h.map(c,function(a){var c={corner:a,aroundCorner:g[a],pos:{x:b.x,y:b.y}};d&&(c.pos.x+="L"==a.charAt(1)?d.x:-d.x,c.pos.y+="T"==a.charAt(0)?d.y:-d.y);return c});return f(a,c,e)},
around:function(c,d,e,g,p){function s(a,b){B.push({aroundCorner:a,corner:b,pos:{x:{L:A,R:A+G,M:A+(G>>1)}[a.charAt(1)],y:{T:z,B:z+F,M:z+(F>>1)}[a.charAt(0)]}})}var t;if("string"==typeof d||"offsetWidth"in d||"ownerSVGElement"in d){if(t=b.position(d,!0),/^(above|below)/.test(e[0])){var u=b.getBorderExtents(d),x=d.firstChild?b.getBorderExtents(d.firstChild):{t:0,l:0,b:0,r:0},w=b.getBorderExtents(c),v=c.firstChild?b.getBorderExtents(c.firstChild):{t:0,l:0,b:0,r:0};t.y+=Math.min(u.t+x.t,w.t+v.t);t.h-=
Math.min(u.t+x.t,w.t+v.t)+Math.min(u.b+x.b,w.b+v.b)}}else t=d;if(d.parentNode){u="absolute"==k.getComputedStyle(d).position;for(d=d.parentNode;d&&1==d.nodeType&&"BODY"!=d.nodeName;){x=b.position(d,!0);w=k.getComputedStyle(d);/relative|absolute/.test(w.position)&&(u=!1);if(!u&&/hidden|auto|scroll/.test(w.overflow)){var v=Math.min(t.y+t.h,x.y+x.h),y=Math.min(t.x+t.w,x.x+x.w);t.x=Math.max(t.x,x.x);t.y=Math.max(t.y,x.y);t.h=v-t.y;t.w=y-t.x}"absolute"==w.position&&(u=!0);d=d.parentNode}}var A=t.x,z=t.y,
G="w"in t?t.w:t.w=t.width,F="h"in t?t.h:(a.deprecated("place.around: dijit/place.__Rectangle: { x:"+A+", y:"+z+", height:"+t.height+", width:"+G+" } has been deprecated.  Please use { x:"+A+", y:"+z+", h:"+t.height+", w:"+G+" }","","2.0"),t.h=t.height),B=[];h.forEach(e,function(a){var b=g;switch(a){case "above-centered":s("TM","BM");break;case "below-centered":s("BM","TM");break;case "after-centered":b=!b;case "before-centered":s(b?"ML":"MR",b?"MR":"ML");break;case "after":b=!b;case "before":s(b?
"TL":"TR",b?"TR":"TL");s(b?"BL":"BR",b?"BR":"BL");break;case "below-alt":b=!b;case "below":s(b?"BL":"BR",b?"TL":"TR");s(b?"BR":"BL",b?"TR":"TL");break;case "above-alt":b=!b;case "above":s(b?"TL":"TR",b?"BL":"BR");s(b?"TR":"TL",b?"BR":"BL");break;default:s(a.aroundCorner,a.corner)}});c=f(c,B,p,{w:G,h:F});c.aroundNodePos=t;return c}}})},"dijit/_HasDropDown":function(){define("dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/has dojo/keys dojo/_base/lang dojo/on dojo/touch ./registry ./focus ./popup ./_FocusMixin".split(" "),
function(h,b,k,a,c,d,e,f,g,l,m,n,q,p,s,t){return h("dijit._HasDropDown",t,{_buttonNode:null,_arrowWrapperNode:null,_popupStateNode:null,_aroundNode:null,dropDown:null,autoWidth:!0,forceWidth:!1,maxHeight:-1,dropDownPosition:["below","above"],_stopClickEvents:!0,_onDropDownMouseDown:function(a){!this.disabled&&!this.readOnly&&("MSPointerDown"!=a.type&&"pointerdown"!=a.type&&a.preventDefault(),this.own(m.once(this.ownerDocument,n.release,l.hitch(this,"_onDropDownMouseUp"))),this.toggleDropDown())},
_onDropDownMouseUp:function(a){var b=this.dropDown,e=!1;if(a&&this._opened){var f=d.position(this._buttonNode,!0);if(!(a.pageX>=f.x&&a.pageX<=f.x+f.w)||!(a.pageY>=f.y&&a.pageY<=f.y+f.h)){for(f=a.target;f&&!e;)c.contains(f,"dijitPopup")?e=!0:f=f.parentNode;if(e){f=a.target;if(b.onItemClick){for(var g;f&&!(g=q.byNode(f));)f=f.parentNode;if(g&&g.onClick&&g.getParent)g.getParent().onItemClick(g,a)}return}}}if(this._opened){if(b.focus&&(!1!==b.autoFocus||"mouseup"==a.type&&!this.hovering))this._focusDropDownTimer=
this.defer(function(){b.focus();delete this._focusDropDownTimer})}else this.focus&&this.defer("focus")},_onDropDownClick:function(a){this._stopClickEvents&&(a.stopPropagation(),a.preventDefault())},buildRendering:function(){this.inherited(arguments);this._buttonNode=this._buttonNode||this.focusNode||this.domNode;this._popupStateNode=this._popupStateNode||this.focusNode||this._buttonNode;var a={after:this.isLeftToRight()?"Right":"Left",before:this.isLeftToRight()?"Left":"Right",above:"Up",below:"Down",
left:"Left",right:"Right"}[this.dropDownPosition[0]]||this.dropDownPosition[0]||"Down";c.add(this._arrowWrapperNode||this._buttonNode,"dijit"+a+"ArrowButton")},postCreate:function(){this.inherited(arguments);var a=this.focusNode||this.domNode;this.own(m(this._buttonNode,n.press,l.hitch(this,"_onDropDownMouseDown")),m(this._buttonNode,"click",l.hitch(this,"_onDropDownClick")),m(a,"keydown",l.hitch(this,"_onKey")),m(a,"keyup",l.hitch(this,"_onKeyUp")))},destroy:function(){this._opened&&this.closeDropDown(!0);
this.dropDown&&(this.dropDown._destroyed||this.dropDown.destroyRecursive(),delete this.dropDown);this.inherited(arguments)},_onKey:function(a){if(!this.disabled&&!this.readOnly){var b=this.dropDown,c=a.target;if(b&&(this._opened&&b.handleKey)&&!1===b.handleKey(a))a.stopPropagation(),a.preventDefault();else if(b&&this._opened&&a.keyCode==g.ESCAPE)this.closeDropDown(),a.stopPropagation(),a.preventDefault();else if(!this._opened&&(a.keyCode==g.DOWN_ARROW||(a.keyCode==g.ENTER||a.keyCode==g.SPACE&&(!this._searchTimer||
a.ctrlKey||a.altKey||a.metaKey))&&("input"!==(c.tagName||"").toLowerCase()||c.type&&"text"!==c.type.toLowerCase())))this._toggleOnKeyUp=!0,a.stopPropagation(),a.preventDefault()}},_onKeyUp:function(){if(this._toggleOnKeyUp){delete this._toggleOnKeyUp;this.toggleDropDown();var a=this.dropDown;a&&a.focus&&this.defer(l.hitch(a,"focus"),1)}},_onBlur:function(){this.closeDropDown(!1);this.inherited(arguments)},isLoaded:function(){return!0},loadDropDown:function(a){a()},loadAndOpenDropDown:function(){var a=
new b,c=l.hitch(this,function(){this.openDropDown();a.resolve(this.dropDown)});this.isLoaded()?c():this.loadDropDown(c);return a},toggleDropDown:function(){!this.disabled&&!this.readOnly&&(this._opened?this.closeDropDown(!0):this.loadAndOpenDropDown())},openDropDown:function(){var b=this.dropDown,e=b.domNode,f=this._aroundNode||this.domNode,g=this,m=s.open({parent:this,popup:b,around:f,orient:this.dropDownPosition,maxHeight:this.maxHeight,onExecute:function(){g.closeDropDown(!0)},onCancel:function(){g.closeDropDown(!0)},
onClose:function(){a.set(g._popupStateNode,"popupActive",!1);c.remove(g._popupStateNode,"dijitHasDropDownOpen");g._set("_opened",!1)}});if(this.forceWidth||this.autoWidth&&f.offsetWidth>b._popupWrapper.offsetWidth){var f=f.offsetWidth-b._popupWrapper.offsetWidth,n={w:b.domNode.offsetWidth+f};l.isFunction(b.resize)?b.resize(n):d.setMarginBox(e,n);"R"==m.corner[1]&&(b._popupWrapper.style.left=b._popupWrapper.style.left.replace("px","")-f+"px")}a.set(this._popupStateNode,"popupActive","true");c.add(this._popupStateNode,
"dijitHasDropDownOpen");this._set("_opened",!0);this._popupStateNode.setAttribute("aria-expanded","true");this._popupStateNode.setAttribute("aria-owns",b.id);"presentation"!==e.getAttribute("role")&&!e.getAttribute("aria-labelledby")&&e.setAttribute("aria-labelledby",this.id);return m},closeDropDown:function(a){this._focusDropDownTimer&&(this._focusDropDownTimer.remove(),delete this._focusDropDownTimer);this._opened&&(this._popupStateNode.setAttribute("aria-expanded","false"),a&&this.focus&&this.focus(),
s.close(this.dropDown),this._opened=!1)}})})},"dojo/dnd/Selector":function(){define("../_base/array ../_base/declare ../_base/kernel ../_base/lang ../dom ../dom-construct ../mouse ../_base/NodeList ../on ../touch ./common ./Container".split(" "),function(h,b,k,a,c,d,e,f,g,l,m,n){var q=b("dojo.dnd.Selector",n,{constructor:function(b,c){c||(c={});this.singular=c.singular;this.autoSync=c.autoSync;this.selection={};this.anchor=null;this.simpleSelection=!1;this.events.push(g(this.node,l.press,a.hitch(this,
"onMouseDown")),g(this.node,l.release,a.hitch(this,"onMouseUp")))},singular:!1,getSelectedNodes:function(){var a=new f,b=m._empty,d;for(d in this.selection)d in b||a.push(c.byId(d));return a},selectNone:function(){return this._removeSelection()._removeAnchor()},selectAll:function(){this.forInItems(function(a,b){this._addItemClass(c.byId(b),"Selected");this.selection[b]=1},this);return this._removeAnchor()},deleteSelectedNodes:function(){var a=m._empty,b;for(b in this.selection)if(!(b in a)){var e=
c.byId(b);this.delItem(b);d.destroy(e)}this.anchor=null;this.selection={};return this},forInSelectedItems:function(a,b){b=b||k.global;var c=this.selection,d=m._empty,e;for(e in c)e in d||a.call(b,this.getItem(e),e,this)},sync:function(){q.superclass.sync.call(this);this.anchor&&!this.getItem(this.anchor.id)&&(this.anchor=null);var a=[],b=m._empty,c;for(c in this.selection)c in b||this.getItem(c)||a.push(c);h.forEach(a,function(a){delete this.selection[a]},this);return this},insertNodes:function(a,
b,c,d){var e=this._normalizedCreator;this._normalizedCreator=function(b,c){var d=e.call(this,b,c);a?(this.anchor?this.anchor!=d.node&&(this._removeItemClass(d.node,"Anchor"),this._addItemClass(d.node,"Selected")):(this.anchor=d.node,this._removeItemClass(d.node,"Selected"),this._addItemClass(this.anchor,"Anchor")),this.selection[d.node.id]=1):(this._removeItemClass(d.node,"Selected"),this._removeItemClass(d.node,"Anchor"));return d};q.superclass.insertNodes.call(this,b,c,d);this._normalizedCreator=
e;return this},destroy:function(){q.superclass.destroy.call(this);this.selection=this.anchor=null},onMouseDown:function(a){this.autoSync&&this.sync();if(this.current)if(!this.singular&&!m.getCopyKeyState(a)&&!a.shiftKey&&this.current.id in this.selection)this.simpleSelection=!0,e.isLeft(a)&&(a.stopPropagation(),a.preventDefault());else{if(!this.singular&&a.shiftKey){m.getCopyKeyState(a)||this._removeSelection();var b=this.getAllNodes();if(b.length&&(this.anchor||(this.anchor=b[0],this._addItemClass(this.anchor,
"Anchor")),this.selection[this.anchor.id]=1,this.anchor!=this.current)){for(var c=0,d;c<b.length&&!(d=b[c],d==this.anchor||d==this.current);++c);for(++c;c<b.length;++c){d=b[c];if(d==this.anchor||d==this.current)break;this._addItemClass(d,"Selected");this.selection[d.id]=1}this._addItemClass(this.current,"Selected");this.selection[this.current.id]=1}}else this.singular?this.anchor==this.current?m.getCopyKeyState(a)&&this.selectNone():(this.selectNone(),this.anchor=this.current,this._addItemClass(this.anchor,
"Anchor"),this.selection[this.current.id]=1):m.getCopyKeyState(a)?this.anchor==this.current?(delete this.selection[this.anchor.id],this._removeAnchor()):this.current.id in this.selection?(this._removeItemClass(this.current,"Selected"),delete this.selection[this.current.id]):(this.anchor&&(this._removeItemClass(this.anchor,"Anchor"),this._addItemClass(this.anchor,"Selected")),this.anchor=this.current,this._addItemClass(this.current,"Anchor"),this.selection[this.current.id]=1):this.current.id in this.selection||
(this.selectNone(),this.anchor=this.current,this._addItemClass(this.current,"Anchor"),this.selection[this.current.id]=1);a.stopPropagation();a.preventDefault()}},onMouseUp:function(){this.simpleSelection&&(this.simpleSelection=!1,this.selectNone(),this.current&&(this.anchor=this.current,this._addItemClass(this.anchor,"Anchor"),this.selection[this.current.id]=1))},onMouseMove:function(){this.simpleSelection=!1},onOverEvent:function(){this.onmousemoveEvent=g(this.node,l.move,a.hitch(this,"onMouseMove"))},
onOutEvent:function(){this.onmousemoveEvent&&(this.onmousemoveEvent.remove(),delete this.onmousemoveEvent)},_removeSelection:function(){var a=m._empty,b;for(b in this.selection)if(!(b in a)){var d=c.byId(b);d&&this._removeItemClass(d,"Selected")}this.selection={};return this},_removeAnchor:function(){this.anchor&&(this._removeItemClass(this.anchor,"Anchor"),this.anchor=null);return this}});return q})},"dijit/_MenuBase":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/lang dojo/mouse dojo/on dojo/window ./a11yclick ./registry ./_Widget ./_CssStateMixin ./_KeyNavContainer ./_TemplatedMixin".split(" "),
function(h,b,k,a,c,d,e,f,g,l,m,n,q,p,s){return b("dijit._MenuBase",[n,s,p,q],{selected:null,_setSelectedAttr:function(a){this.selected!=a&&(this.selected&&(this.selected._setSelected(!1),this._onChildDeselect(this.selected)),a&&a._setSelected(!0),this._set("selected",a))},activated:!1,_setActivatedAttr:function(a){c.toggle(this.domNode,"dijitMenuActive",a);c.toggle(this.domNode,"dijitMenuPassive",!a);this._set("activated",a)},parentMenu:null,popupDelay:500,passivePopupDelay:Infinity,autoFocus:!1,
childSelector:function(a){var b=m.byNode(a);return a.parentNode==this.containerNode&&b&&b.focus},postCreate:function(){var a=this,b="string"==typeof this.childSelector?this.childSelector:d.hitch(this,"childSelector");this.own(f(this.containerNode,f.selector(b,e.enter),function(){a.onItemHover(m.byNode(this))}),f(this.containerNode,f.selector(b,e.leave),function(){a.onItemUnhover(m.byNode(this))}),f(this.containerNode,f.selector(b,l),function(b){a.onItemClick(m.byNode(this),b);b.stopPropagation()}),
f(this.containerNode,f.selector(b,"focusin"),function(){a._onItemFocus(m.byNode(this))}));this.inherited(arguments)},onKeyboardSearch:function(a,b,c,d){this.inherited(arguments);if(a&&(-1==d||a.popup&&1==d))this.onItemClick(a,b)},_keyboardSearchCompare:function(a,b){return a.shortcutKey?b==a.shortcutKey.toLowerCase()?-1:0:this.inherited(arguments)?1:0},onExecute:function(){},onCancel:function(){},_moveToPopup:function(a){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled)this.onItemClick(this.focusedChild,
a);else(a=this._getTopMenu())&&a._isMenuBar&&a.focusNext()},_onPopupHover:function(){this.set("selected",this.currentPopupItem);this._stopPendingCloseTimer()},onItemHover:function(a){this.activated?(this.set("selected",a),a.popup&&(!a.disabled&&!this.hover_timer)&&(this.hover_timer=this.defer(function(){this._openItemPopup(a)},this.popupDelay))):Infinity>this.passivePopupDelay&&(this.passive_hover_timer&&this.passive_hover_timer.remove(),this.passive_hover_timer=this.defer(function(){this.onItemClick(a,
{type:"click"})},this.passivePopupDelay));this._hoveredChild=a;a._set("hovering",!0)},_onChildDeselect:function(a){this._stopPopupTimer();this.currentPopupItem==a&&(this._stopPendingCloseTimer(),this._pendingClose_timer=this.defer(function(){this.currentPopupItem=this._pendingClose_timer=null;a._closePopup()},this.popupDelay))},onItemUnhover:function(a){this._hoveredChild==a&&(this._hoveredChild=null);this.passive_hover_timer&&(this.passive_hover_timer.remove(),this.passive_hover_timer=null);a._set("hovering",
!1)},_stopPopupTimer:function(){this.hover_timer&&(this.hover_timer=this.hover_timer.remove())},_stopPendingCloseTimer:function(){this._pendingClose_timer&&(this._pendingClose_timer=this._pendingClose_timer.remove())},_getTopMenu:function(){for(var a=this;a.parentMenu;a=a.parentMenu);return a},onItemClick:function(a,b){this.passive_hover_timer&&this.passive_hover_timer.remove();this.focusChild(a);if(a.disabled)return!1;if(a.popup){this.set("selected",a);this.set("activated",!0);var c=/^key/.test(b._origType||
b.type)||0==b.clientX&&0==b.clientY;this._openItemPopup(a,c)}else this.onExecute(),a._onClick?a._onClick(b):a.onClick(b)},_openItemPopup:function(a,b){if(a!=this.currentPopupItem){this.currentPopupItem&&(this._stopPendingCloseTimer(),this.currentPopupItem._closePopup());this._stopPopupTimer();var c=a.popup;c.parentMenu=this;this.own(this._mouseoverHandle=f.once(c.domNode,"mouseover",d.hitch(this,"_onPopupHover")));var e=this;a._openPopup({parent:this,orient:this._orient||["after","before"],onCancel:function(){b&&
e.focusChild(a);e._cleanUp()},onExecute:d.hitch(this,"_cleanUp",!0),onClose:function(){e._mouseoverHandle&&(e._mouseoverHandle.remove(),delete e._mouseoverHandle)}},b);this.currentPopupItem=a}},onOpen:function(){this.isShowingNow=!0;this.set("activated",!0)},onClose:function(){this.set("activated",!1);this.set("selected",null);this.isShowingNow=!1;this.parentMenu=null},_closeChild:function(){this._stopPopupTimer();this.currentPopupItem&&(this.focused&&(a.set(this.selected.focusNode,"tabIndex",this.tabIndex),
this.selected.focusNode.focus()),this.currentPopupItem._closePopup(),this.currentPopupItem=null)},_onItemFocus:function(a){if(this._hoveredChild&&this._hoveredChild!=a)this.onItemUnhover(this._hoveredChild);this.set("selected",a)},_onBlur:function(){this._cleanUp(!0);this.inherited(arguments)},_cleanUp:function(a){this._closeChild();"undefined"==typeof this.isShowingNow&&this.set("activated",!1);a&&this.set("selected",null)}})})},"esri/layerUtils":function(){define(["dojo/_base/lang","dojo/_base/array",
"dojo/_base/json","dojo/has","./kernel"],function(h,b,k,a,c){var d={_serializeLayerDefinitions:function(a){var c=[],d=!1,l=/[:;]/;if(a&&(b.forEach(a,function(a,b){a&&(c.push([b,a]),!d&&l.test(a)&&(d=!0))}),0<c.length)){var m;d?(m={},b.forEach(c,function(a){m[a[0]]=a[1]}),m=k.toJson(m)):(m=[],b.forEach(c,function(a){m.push(a[0]+":"+a[1])}),m=m.join(";"));return m}return null},_serializeTimeOptions:function(a,c){if(a){var d=[];b.forEach(a,function(a,e){if(a){var n=a.toJson();c&&-1!==b.indexOf(c,e)&&
(n.useTime=!1);d.push('"'+e+'":'+k.toJson(n))}});if(d.length)return"{"+d.join(",")+"}"}},_getVisibleLayers:function(a,c){var d=[],l,m,n;if(!a)return d;if(c){d=c.concat();for(n=0;n<a.length;n++)l=a[n],m=b.indexOf(a,l.id),l.subLayerIds&&-1<m&&(d.splice(m,1),d=d.concat(l.subLayerIds))}else d=this._getDefaultVisibleLayers(a);return d},_getDefaultVisibleLayers:function(a){var c=[],d;if(!a)return c;for(d=0;d<a.length;d++)0<=a[d].parentLayerId&&-1===b.indexOf(c,a[d].parentLayerId)&&b.some(a,function(b){return b.id===
a[d].parentLayerId})||a[d].defaultVisibility&&c.push(a[d].id);return c},_getLayersForScale:function(a,c){var d=[];if(0<a&&c){var l;for(l=0;l<c.length;l++)if(!(0<=c[l].parentLayerId&&-1===b.indexOf(d,c[l].parentLayerId)&&b.some(c,function(a){return a.id===c[l].parentLayerId}))&&0<=c[l].id){var m=!0,n=c[l].maxScale,q=c[l].minScale;if(0<n||0<q)0<n&&0<q?m=n<=a&&a<=q:0<n?m=n<=a:0<q&&(m=a<=q);m&&d.push(c[l].id)}}return d}};a("extend-esri")&&h.mixin(c,d);return d})},"arcgisonline/sharing/dijit/SignInInternal":function(){define(["dijit",
"dojo","dojox","dojo/require!dijit/_Widget,dijit/_Templated,dijit/form/Form,dijit/form/Button,dijit/form/ValidationTextBox,arcgisonline/sharing/util,arcgisonline/sharing/geow/Account,arcgisonline/sharing/geow/Geow"],function(h,b,k){b.provide("arcgisonline.sharing.dijit.SignInInternal");b.require("dijit._Widget");b.require("dijit._Templated");b.require("dijit.form.Form");b.require("dijit.form.Button");b.require("dijit.form.ValidationTextBox");b.require("arcgisonline.sharing.util");b.require("arcgisonline.sharing.geow.Account");
b.require("arcgisonline.sharing.geow.Geow");b.declare("arcgisonline.sharing.dijit.SignInInternal",[h._Widget,h._Templated],{widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContent"\x3e\r\n  \x3cdiv id\x3d"login-form" class\x3d"grid_16 esriFloatLeading" style\x3d"display:block;clear:both;"\x3e\r\n    \x3cdiv dojotype\x3d"dijit.form.Form" id\x3d"sign-in-form" method\x3d"POST" action\x3d""\x3e\r\n      \x3cdiv id\x3d"organizationTitle" style\x3d"display:none; margin:10px 0 40px 0; text-align:center;"\x3e\x3c/div\x3e\r\n      \x3cdiv id\x3d"left" class\x3d"grid_7 esriFloatLeading"\x3e\r\n        \x3ch1 id\x3d"leftPanelTitle"\x3e${i18n.firstTimeSignIn}\x3c/h1\x3e\r\n        \x3cbr/\x3e\r\n        \x3cdiv id\x3d"not_a_member_msg"\x3e\r\n        \x3c/div\x3e\r\n        \x3cbr/\x3e\r\n        \x3cbr/\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"right" class\x3d"grid_7 esriFloatTrailing"\x3e\r\n        \x3ch1 id\x3d"rightPanelTitle"\x3e${i18n.signIn}\x3c/h1\x3e\r\n        \x3cbr/\x3e\r\n        \x3cdiv id\x3d"sign-in-error"\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv id\x3d"rightPanelDesc" style\x3d"font-weight:bold;"\x3e\x3c/div\x3e\x3cbr/\x3e\r\n        \x3ciframe dojoattachpoint\x3d"_iFrame" id\x3d"oAuthFrame" scrolling\x3d"no" style\x3d"display:none; border:0" marginheight\x3d"0" marginwidth\x3d"0" frameborder\x3d"0" width\x3d"400" height\x3d"400"\x3e\r\n           Your browser does not support iframes.\r\n        \x3c/iframe\x3e\r\n        \x3ctable id\x3d"authTable" style\x3d"width:100%;display:none"\x3e\r\n          \x3ctbody\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd class\x3d"grid_2 alpha"\x3e\r\n                \x3clabel for\x3d"user_username" style\x3d"padding:0;margin:0;"\x3e\r\n                  ${i18n.userLabel}\r\n                \x3c/label\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv id\x3d"user_username" name\x3d"user_username" class\x3d"grid_5 omega" style\x3d"padding:2px;margin:0;" dojotype\x3d"dijit.form.TextBox" trim\x3d"true" dojoAttachEvent\x3d"keyDown: onKeyDown"\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr height\x3d"5"\x3e\r\n              \x3ctd colspan\x3d"2" height\x3d"5"\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd class\x3d"grid_2 alpha"\x3e\r\n                \x3clabel for\x3d"user_password" style\x3d"padding:0;margin:0;"\x3e\r\n                  ${i18n.passwordLabel}\r\n                \x3c/label\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv id\x3d"user_password" name\x3d"user_password" class\x3d"grid_5 omega" style\x3d"padding:2px;margin:0;" type\x3d"password" dojotype\x3d"dijit.form.TextBox" trim\x3d"true" dojoAttachEvent\x3d"keyDown: onKeyDown"\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv id\x3d"signInHelp"\x3e\r\n                  \x3ca id\x3d"signInHelpLink"\x3e${i18n.needHelpSign}\x3c/a\x3e\r\n                  \x3cbr/\x3e\r\n                  \x3cbr/\x3e\r\n                \x3c/div\x3e\r\n                \x3cinput id\x3d"remember-me" style\x3d"height:24px;margin:auto;" value\x3d"off" dojotype\x3d"dijit.form.CheckBox" /\x3e\r\n                \x3clabel id\x3d"remember-me-label" for\x3d"remember-me"\x3e${i18n.rememberMe}\x3c/label\x3e\r\n                \x3cbr/\x3e\r\n                \x3cbr/\x3e\r\n                \x3cbutton id\x3d"button_sign_in" class\x3d"calcite small btn primary" style\x3d"margin:0;padding:0;" type\x3d"submit" dojotype\x3d"dijit.form.Button"\x3e\r\n                  ${i18n.signIn}\r\n                \x3c/button\x3e\r\n                \x3cbr/\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n          \x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv style\x3d"width:100%; clear:both;"\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
util:arcgisonline.sharing.util,geow:arcgisonline.sharing.geow.Geow,account:arcgisonline.sharing.geow.Account,redirectUrl:esriGeowConfig.baseUrl.replace("https:","http:")+"index.html",orgRedirectUrl:esriGeowConfig.baseUrl.replace("https:","http:")+"organization.html",defaultOrgTitleText:null,invitationId:null,orgName:null,usr:null,pwd:null,exp:null,i18n:null,postMixInProperties:function(){this.inherited(arguments);this.i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(this.i18n,
b.i18n.getLocalization("arcgisonline","arcgisonline").signInInternalWidget);this.i18n.error.signInSoftAuth=b.i18n.getLocalization("arcgisonline","arcgisonline").errorWidget.signInSoftAuth;this.defaultOrgTitleText=this.i18n.myAccount;this._oAuthInfo={url:esriGeowConfig.restBaseUrl+"oauth2/authorize",clientId:"arcgisonline",redirectUri:esriGeowConfig.baseUrl+"postsignin.html",parent:window.location.protocol+"//"+window.location.host,expiration:20160,locale:b.locale}},postCreate:function(){!1===esriGeowConfig.showSignUp&&
(b.style(b.byId("left"),"display","none"),b.style(b.byId("right"),"float","left"));this.account.getSelf(b.hitch(this,function(a){a&&a.isPortal&&(!esriGeowConfig.self||!esriGeowConfig.self.supportsOAuth?(esri.show(b.byId("authTable")),esri.hide(b.byId("oAuthFrame"))):(window.onOAuthSignIn=b.hitch(this,"onOAuthSignIn"),window.checkOAuthResponse=b.hitch(this,"checkOAuthResponse"),window.onOAuthSignInError=b.hitch(this,"onOAuthSignInError"),this._authorizeUrl=esri.substitute(this._oAuthInfo,"${url}?client_id\x3d${clientId}\x26redirect_uri\x3d${redirectUri}\x26response_type\x3dtoken\x26display\x3diframe\x26parent\x3d${parent}\x26expiration\x3d${expiration}\x26locale\x3d${locale}"),
b.attr(this._iFrame,"src",this._authorizeUrl),esri.hide(b.byId("authTable")),esri.show(b.byId("oAuthFrame"))),a=esriGeowConfig.baseUrl.substring(0,esriGeowConfig.baseUrl.indexOf("/home"))+"/portaladmin",b.xhrGet({url:a,handleAs:"json",content:{f:"json",ts:(new Date).getTime()}}).then(b.hitch(this,function(a){var b=arcgisonline.sharing.util.getUser();if(a.status&&"error"===a.status&&a.code&&503===a.code)arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorTitle,
message:this.i18n.error.siteUnavailable});else if(a&&(!a.error&&!b||!b&&a.error&&a.error.code&&499!==a.error.code))window.location=esriGeowConfig.baseUrl+"createadmin.html"})))}))},startup:function(){this.inherited(arguments);if(b.byId("not_a_member_msg")){var a="\x3cbutton id\x3d'registerButton' class\x3d'calcite blue' type\x3d'button' dojotype\x3d'dijit.form.Button'\x3e"+this.i18n.createAccount+"\x3c/button\x3e";b.byId("not_a_member_msg").innerHTML=a;b.parser.parse(b.byId("not_a_member_msg"));b.connect(b.byId("registerButton"),
"onclick",function(){var a=esriGeowConfig.signup,c=b.queryToObject(window.location.search.slice(1)).invitation;if(c)a+="?invitation\x3d"+c;else if(c=b.queryToObject(window.location.search.slice(1)).returnUrl,null!=c){var d=arcgisonline.sharing.util.parseUrl(window.location.href);if(-1<c.indexOf(d.host)||-1<c.indexOf("arcgis.com")||-1<c.indexOf("esri.com"))a+="?returnUrl\x3d"+c}document.location=a});esriGeowConfig.signInHelp?b.byId("signInHelpLink").href=esriGeowConfig.signInHelp:b.byId("signInHelpLink").href=
"troubleshoot.html"}this.loadConnections();a=b.queryToObject(window.location.search.slice(1)).error;null!=a&&this.showError(this.getErrorMsg(a));a=b.queryToObject(window.location.search.slice(1)).returnUrl;if(null!=a){var c=arcgisonline.sharing.util.parseUrl(window.location.href);if(-1<a.indexOf(c.host)||-1<a.indexOf("arcgis.com")||-1<a.indexOf("esri.com"))this.redirectUrl=a}esriGeowConfig.esriGlobalAccount?(a=b.string.substitute(this.i18n.signInAccountDesc,{account:esriGeowConfig.esriGlobalAccount}),
b.attr(b.byId("rightPanelDesc"),"innerHTML",a)):b.style(b.byId("rightPanelDesc"),"display","none");(a=b.queryToObject(window.location.search.slice(1)).invitation)?(this.invitationId=a,this.util.getJson(esriGeowConfig.restBaseUrl+"community/invitations/"+this.invitationId,b.hitch(this,function(a){a.account&&a.account.name&&(this.orgName=a.account.name,esriGeowConfig.useDefaultIdentityStore?(b.byId("organizationTitle").innerHTML="\x3ch1\x3e"+b.string.substitute(this.i18n.joinOptions,{account:this.orgName})+
"\x3c/h1\x3e",b.style(b.byId("organizationTitle"),"display","block"),b.addClass(b.byId("left"),"invitation"),b.byId("leftPanelTitle").innerHTML=b.string.substitute(this.i18n.joinFirstTime,{account:this.orgName}),b.addClass(b.byId("leftPanelTitle"),"subtitle"),b.style(b.byId("left"),"width","47%"),b.addClass(b.byId("right"),"invitation"),b.byId("rightPanelTitle").innerHTML=b.string.substitute(this.i18n.joinAlreadyUsing,{account:this.orgName}),b.addClass(b.byId("rightPanelTitle"),"subtitle")):(b.style(b.byId("left"),
"display","none"),b.removeClass(b.byId("right"),"esriFloatTrailing"),esriGeowConfig.isRightToLeft?b.style(b.byId("right"),"padding-right","30%"):b.style(b.byId("right"),"padding-left","30%"),b.removeClass(b.byId("login-form"),"esriFloatLeading")))}))):esriGeowConfig.useDefaultIdentityStore?b.style(b.byId("left"),"width","300px"):(b.style(b.byId("left"),"display","none"),b.removeClass(b.byId("right"),"esriFloatTrailing"),esriGeowConfig.isRightToLeft?b.style(b.byId("right"),"padding-right","30%"):b.style(b.byId("right"),
"padding-left","30%"),b.removeClass(b.byId("login-form"),"esriFloatLeading"));this.account.getSelf(b.hitch(this,function(a){esriGeowConfig.self.disableSignup&&(b.style(b.byId("left"),"display","none"),b.removeClass(b.byId("right"),"esriFloatTrailing"),esriGeowConfig.isRightToLeft?b.style(b.byId("right"),"padding-right","30%"):b.style(b.byId("right"),"padding-left","30%"),b.removeClass(b.byId("login-form"),"esriFloatLeading"))}));this.checkCookieSupport();try{setTimeout("dojo.byId('user_username').focus()",
350)}catch(d){}},checkCookieSupport:function(){if(10>=b.isIE){b.cookie("test","enabled",{path:"/"});var a=b.cookie("test");b.cookie("test",null,{expires:-1});"enabled"!==a&&arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorTitle,message:this.i18n.error.cookiesRequired})}else b.cookie.isSupported()||arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorTitle,message:this.i18n.error.cookiesRequired})},
loadConnections:function(){b.connect(h.byId("sign-in-form"),"onSubmit",this,"signIn")},signIn:function(a){a.preventDefault();-1!=b.byId("sign-in-error").className.indexOf("error")&&(b.byId("sign-in-error").innerHTML="\x26nbsp;",b.removeClass("sign-in-error","error"));if(!1==this.validateForm())return!1;h.byId("button_sign_in").set("disabled",!0);h.byId("button_sign_in").set("label",this.i18n.signingIn);a=b.byId("user_username").value;var c=b.byId("user_password").value,d=esriGeowConfig.tokenExpiration;
b.byId("remember-me").checked&&(d=esriGeowConfig.longTokenExpiration);this.invitationId&&(this.usr=a,this.pwd=c,this.exp=d);this.geow.signin({username:a,password:c,expiration:d},b.hitch(this,this.onSignIn),b.hitch(this,"signInError"))},onOAuthSignIn:function(){-1!==b.byId("sign-in-error").className.indexOf("error")&&(b.byId("sign-in-error").innerHTML="\x26nbsp;",b.removeClass("sign-in-error","error"))},checkOAuthResponse:function(a){a=new b._Url(a);a=a.fragment?b.queryToObject(a.fragment):null;a.error?
(b.addClass("sign-in-error","error"),b.attr(b.byId("sign-in-error"),"innerHTML",(a.error_description||a.error)+"\x3cbr/\x3e\x3cbr/\x3e"),b.attr(this._iFrame,"src",this._authorizeUrl)):(this._user=b.mixin(this._user,b.mixin(a,{token:a.access_token})),this.geow.signInHandler2(this._user).then(b.hitch(this,"onSignIn")))},onOAuthSignInError:function(a){a&&a.length&&-1!==a[0].toLowerCase().indexOf("not a member")?(b.addClass("sign-in-error","error"),b.attr(b.byId("sign-in-error"),"innerHTML",this.i18n.error.notOrgMember+
"\x3cbr/\x3e\x3cbr/\x3e")):a&&a.length&&-1<a[0].toLowerCase().indexOf("software authorization error")?(b.addClass("sign-in-error","error"),b.attr(b.byId("sign-in-error"),"innerHTML",this.i18n.error.signInSoftAuth+"\x3cbr/\x3e\x3cbr/\x3e")):a&&a.length&&(-1<a[0].toLowerCase().indexOf("too many invalid logins")||-1!==a[0].toLowerCase().indexOf("too many invalid attempts"))?(b.addClass("sign-in-error","error"),b.attr(b.byId("sign-in-error"),"innerHTML",this.i18n.error.tooManyAttempts+"\x3cbr/\x3e\x3cbr/\x3e")):
this.signInError({code:400})},onKeyDown:function(a){a.keyCode===b.keys.ENTER&&this.signIn(a)},onSignIn:function(a,c){this.invitationId?arcgisonline.sharing.geow.Account.getInvitation(this.invitationId,b.hitch(this,this.onInvitationInfo),b.hitch(this,this.onInvitationInfo)):this.routeUser()},onInvitationInfo:function(a,c){var d;if(a&&a.code&&a.message&&403===a.code){var e="\x3cp\x3e"+this.i18n.emailInvitation+"\x3c/p\x3e";d=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();
d.onOkClick=b.hitch(this,function(a,b){a.hide();this.routeUser()},d);d.show({title:this.i18n.noticeLabel,message:e})}else if(a&&a.code&&a.message&&400===a.code)e="\x3cp\x3e"+this.i18n.invitationUsedMsg+"\x3c/p\x3e",d=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),d.onOkClick=b.hitch(this,function(a,b){a.hide();window.location=arcgisonline.sharing.util.getSecureUrl()+esriGeowConfig.signin},d),d.show({title:this.i18n.noticeLabel,message:e});else if(a&&a.id&&a.id===this.invitationId){var f=
"\x3cp\x3e"+b.string.substitute(this.i18n.membershipPending,{account:"\x3cstrong\x3e"+a.account.name+"\x3c/strong\x3e"})+"\x3c/p\x3e";d="\x3cp\x3e\x3cstrong\x3e"+b.string.substitute(this.i18n.byAcceptingInvite,{account:a.account.name})+"\x3c/strong\x3e\x3c/p\x3e\x3cp\x3e\x3cul\x3e\x3cli\x3e"+b.string.substitute(this.i18n.itemsMsg,{beginStrong:"\x3cstrong\x3e",endStrong:"\x3c/strong\x3e"})+"\x3c/li\x3e\x3cli\x3e"+this.i18n.leaveMsg+"\x3c/li\x3e\x3c/ul\x3e\x3c/p\x3e";e={title:this.i18n.noticeLabel,
message:d,choiceOneTitle:this.i18n.yesLabel,choiceTwoTitle:this.i18n.noLabel};e.choiceOneHandler=b.hitch(this,function(c){a.mustApprove&&!0===a.mustApprove?(c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),c.onOkClick=b.hitch(this,function(a){a.hide();arcgisonline.sharing.geow.Account.acceptInvitation(this.invitationId,b.hitch(this,this.onInvitationAccepted),b.hitch(this,this.onInvitationAccepted))},c),c.show({title:this.i18n.noticeLabel,message:f})):arcgisonline.sharing.geow.Account.acceptInvitation(this.invitationId,
b.hitch(this,this.onInvitationAccepted),b.hitch(this,this.onInvitationAccepted))});e.choiceTwoHandler=b.hitch(this,function(a){this.routeUser()});d=arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance();d.show(e)}else this.routeUser()},onInvitationAccepted:function(a,c){var d;if(a&&a.success&&!0===a.success)this.geow.signin({username:this.usr,password:this.pwd,expiration:this.exp},b.hitch(this,this.routeUser),b.hitch(this,"signInError"));else if(a&&a.code&&a.message&&500===a.code&&
"Invitation has already been accepted."===b.trim(a.message)){var e="\x3cp\x3e"+this.i18n.acceptedInvite+"\x3c/p\x3e\x3cp\x3e"+this.i18n.clickOk+"\x3c/p\x3e";d=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();d.onOkClick=b.hitch(this,function(a,b){a.hide();window.location=arcgisonline.sharing.util.getSecureUrl()+esriGeowConfig.signin},d);d.show({title:this.i18n.noticeLabel,message:e})}else console.log(a),d=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),
d.onOkClick=b.hitch(this,function(a,b){a.hide();window.location=arcgisonline.sharing.util.getSecureUrl()+esriGeowConfig.signin+"?invitation\x3d"+this.invitationId},d),a.code&&a.message?("User already member of an account."===a.message&&(a.message=this.i18n.userAnotherOrg),d.show({title:this.i18n.unableJoin,message:a.message})):d.show({title:this.i18n.unableJoin,message:this.i18n.problemJoining})},routeUser:function(){this.exp=this.pwd=this.usr=null;esriGeowConfig.self=null;arcgisonline.sharing.geow.Account.getSelf(b.hitch(this,
this.routeOrg))},routeOrg:function(a,c){var d=this.util.getUser(),e=b.queryToObject(window.location.search.slice(1)).returnUrl,f=esriGeowConfig.baseUrl+esriGeowConfig.signin;e&&-1<e.indexOf(f)&&(e=null);e&&(f=arcgisonline.sharing.util.parseUrl(window.location.href),-1===e.indexOf(f.host)&&(-1===e.indexOf("arcgis.com")&&-1===e.indexOf("esri.com"))&&(e=null));if(a&&!a.code&&!a.message){var f=a.allSSL,g=arcgisonline.sharing.util.usePortalSSL();this.redirectUrl=arcgisonline.sharing.util.getHttpUrl()+
"index.html";this.orgRedirectUrl=arcgisonline.sharing.util.getHttpUrl()+"organization.html";e?(g=!!(-1<e.indexOf("https:")),window.location=f||g?arcgisonline.sharing.util.getSecureUrl(e):e):window.location="account_admin"===d.role?f||g?arcgisonline.sharing.util.getSecureUrl()+"organization.html":this.orgRedirectUrl:f||g?arcgisonline.sharing.util.getSecureUrl()+"index.html":this.redirectUrl}else window.location=e?e:arcgisonline.sharing.util.getHttpUrl(this.redirectUrl)},getErrorMsg:function(a){if("498"==
a)return this.i18n.error.sessionExpired;if("403"==a||"400"==a)return(a=b.queryToObject(window.location.search.slice(1)).returnUrl)&&-1<a.indexOf("viewer.html")?"":this.i18n.error.requireSignIn},validateForm:function(){var a=h.byId("user_username").getValue(),b=h.byId("user_password").getValue(),d=null;if((null==a||""==a)&&(null==b||""==b))d=this.i18n.error.userNamePassRqd;else if(null==a||""==a)d=this.i18n.error.usernameRqd;else if(null==b||""==b)d=this.i18n.error.passReqd;if(null==d)return!0;this.showError(d);
return!1},signInError:function(a,c){h.byId("button_sign_in").set("disabled",!1);h.byId("button_sign_in").set("label",this.i18n.SignIn);if(null!=a&&""!=a)switch(b.addClass("sign-in-error","error"),a.code=500===a.code?400:a.code,a.code){case 400:var d="\x3cb style\x3d'font-size:1.2em;line-height:30px;'\x3e"+b.string.substitute(this.i18n.unableSignIn,{portalName:esriGeowConfig.portalName?esriGeowConfig.portalName:this.i18n.arcgisOnline})+"\x3c/b\x3e\x3cbr/\x3e",d=d+'\x3cspan style\x3d"color:#000000;"\x3e'+
this.i18n.usernamePassCorrect,d=d+"\x3c/span\x3e";if(!(!1===esriGeowConfig.isMultiTenant&&!1===esriGeowConfig.showSignUp)){var d=d+'\x3cdiv style\x3d"color:#000000; padding-top:15px;"\x3e',e=esriGeowConfig.signup;document.referrer&&-1<document.referrer.indexOf("https://")&&(e+="?returnUrl\x3d"+arcgisonline.sharing.util.getSecureUrl()+"user.html?newUser\x3dtrue");this.invitation&&(e+=(-1<e.indexOf("?")?"\x26":"?")+"invitation\x3d"+this.invitation);d+=this.i18n.ifFirstTime+"\x3cbr/\x3e\x3ca href\x3d'"+
e+"'\"\x3e"+this.i18n.createAccount+"\x3c/a\x3e.";d+="\x3c/div\x3e"}this.showError(d);try{b.byId("user_username").focus()}catch(f){}break;default:this.showError(this.i18n.error.signInError)}},showError:function(a){b.addClass("sign-in-error","error");b.byId("sign-in-error").innerHTML=a+"\x3cbr/\x3e\x3cbr/\x3e"}})})},"dijit/focus":function(){define("dojo/aspect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/Evented dojo/_base/lang dojo/on dojo/domReady dojo/sniff dojo/Stateful dojo/_base/window dojo/window ./a11y ./registry ./main".split(" "),
function(h,b,k,a,c,d,e,f,g,l,m,n,q,p,s,t,u){var x,w,v=new (b([n,e],{curNode:null,activeStack:[],constructor:function(){var a=f.hitch(this,function(a){k.isDescendant(this.curNode,a)&&this.set("curNode",null);k.isDescendant(this.prevNode,a)&&this.set("prevNode",null)});h.before(d,"empty",a);h.before(d,"destroy",a)},registerIframe:function(a){return this.registerWin(a.contentWindow,a)},registerWin:function(a,b){var c=this,d=a.document&&a.document.body;if(d){var e=m("pointer-events")?"pointerdown":m("MSPointer")?
"MSPointerDown":m("touch-events")?"mousedown, touchstart":"mousedown",f=g(a.document,e,function(a){if(!a||!(a.target&&null==a.target.parentNode))c._onTouchNode(b||a.target,"mouse")}),l=g(d,"focusin",function(a){if(a.target.tagName){var d=a.target.tagName.toLowerCase();"#document"==d||"body"==d||(s.isFocusable(a.target)?c._onFocusNode(b||a.target):c._onTouchNode(b||a.target))}}),n=g(d,"focusout",function(a){c._onBlurNode(b||a.target)});return{remove:function(){f.remove();l.remove();n.remove();d=f=
l=n=null}}}},_onBlurNode:function(a){a=(new Date).getTime();a<x+100||(this._clearFocusTimer&&clearTimeout(this._clearFocusTimer),this._clearFocusTimer=setTimeout(f.hitch(this,function(){this.set("prevNode",this.curNode);this.set("curNode",null)}),0),this._clearActiveWidgetsTimer&&clearTimeout(this._clearActiveWidgetsTimer),a<w+100||(this._clearActiveWidgetsTimer=setTimeout(f.hitch(this,function(){delete this._clearActiveWidgetsTimer;this._setStack([])}),0)))},_onTouchNode:function(b,d){w=(new Date).getTime();
this._clearActiveWidgetsTimer&&(clearTimeout(this._clearActiveWidgetsTimer),delete this._clearActiveWidgetsTimer);c.contains(b,"dijitPopup")&&(b=b.firstChild);var e=[];try{for(;b;){var f=a.get(b,"dijitPopupParent");if(f)b=t.byId(f).domNode;else if(b.tagName&&"body"==b.tagName.toLowerCase()){if(b===q.body())break;b=p.get(b.ownerDocument).frameElement}else{var g=b.getAttribute&&b.getAttribute("widgetId"),l=g&&t.byId(g);l&&!("mouse"==d&&l.get("disabled"))&&e.unshift(g);b=b.parentNode}}}catch(m){}this._setStack(e,
d)},_onFocusNode:function(a){a&&9!=a.nodeType&&(x=(new Date).getTime(),this._clearFocusTimer&&(clearTimeout(this._clearFocusTimer),delete this._clearFocusTimer),this._onTouchNode(a),a!=this.curNode&&(this.set("prevNode",this.curNode),this.set("curNode",a)))},_setStack:function(a,b){var c=this.activeStack,d=c.length-1,e=a.length-1;if(a[e]!=c[d]){this.set("activeStack",a);var f;for(f=d;0<=f&&c[f]!=a[f];f--)if(d=t.byId(c[f]))d._hasBeenBlurred=!0,d.set("focused",!1),d._focusManager==this&&d._onBlur(b),
this.emit("widget-blur",d,b);for(f++;f<=e;f++)if(d=t.byId(a[f]))d.set("focused",!0),d._focusManager==this&&d._onFocus(b),this.emit("widget-focus",d,b)}},focus:function(a){if(a)try{a.focus()}catch(b){}}}));l(function(){var a=v.registerWin(p.get(document));m("ie")&&g(window,"unload",function(){a&&(a.remove(),a=null)})});u.focus=function(a){v.focus(a)};for(var y in v)/^_/.test(y)||(u.focus[y]="function"==typeof v[y]?f.hitch(v,y):v[y]);v.watch(function(a,b,c){u.focus[a]=c});return v})},"dijit/hccss":function(){define(["dojo/dom-class",
"dojo/hccss","dojo/domReady","dojo/_base/window"],function(h,b,k,a){k(function(){b("highcontrast")&&h.add(a.body(),"dijit_a11y")});return b})},"dojo/AdapterRegistry":function(){define(["./_base/kernel","./_base/lang"],function(h,b){var k=h.AdapterRegistry=function(a){this.pairs=[];this.returnWrappers=a||!1};b.extend(k,{register:function(a,b,d,e,f){this.pairs[f?"unshift":"push"]([a,b,d,e])},match:function(){for(var a=0;a<this.pairs.length;a++){var b=this.pairs[a];if(b[1].apply(this,arguments))return b[3]||
this.returnWrappers?b[2]:b[2].apply(this,arguments)}throw Error("No match found");},unregister:function(a){for(var b=0;b<this.pairs.length;b++)if(this.pairs[b][0]==a)return this.pairs.splice(b,1),!0;return!1}});return k})},"dojox/widget/rotator/Controller":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/event dojo/_base/array dojo/_base/connect dojo/query".split(" "),function(h,b,k,a,c,d,e){return h("dojox.widget.rotator.Controller",null,{rotator:null,commands:"prev,play/pause,info,next",
constructor:function(f,g){b.mixin(this,f);var l=this.rotator;if(l){for(;g.firstChild;)g.removeChild(g.firstChild);var m=this._domNode=k.create("ul",null,g),n=function(b,c,d){k.create("li",{className:c,innerHTML:'\x3ca href\x3d"#"\x3e\x3cspan\x3e'+b+"\x3c/span\x3e\x3c/a\x3e",onclick:function(b){a.stop(b);l&&l.control.apply(l,d)}},m)};c.forEach(this.commands.split(","),function(a,b){switch(a){case "prev":n("Prev","dojoxRotatorPrev dojoxRotatorIcon",["prev"]);break;case "play/pause":n("Play","dojoxRotatorPlay dojoxRotatorIcon",
["play"]);n("Pause","dojoxRotatorPause dojoxRotatorIcon",["pause"]);break;case "info":this._info=k.create("li",{className:"dojoxRotatorInfo",innerHTML:this._buildInfo(l)},m);break;case "next":n("Next","dojoxRotatorNext dojoxRotatorIcon",["next"]);break;case "#":case "titles":for(var c=0;c<l.panes.length;c++)n("#"==a?c+1:l.panes[c].title||"Tab "+(c+1),("#"==a?"dojoxRotatorNumber":"dojoxRotatorTab")+" "+(c==l.idx?"dojoxRotatorSelected":"")+" dojoxRotatorPane"+c,["go",c])}},this);e("li:first-child",
m).addClass("dojoxRotatorFirst");e("li:last-child",m).addClass("dojoxRotatorLast");this._togglePlay();this._con=d.connect(l,"onUpdate",this,"_onUpdate")}},destroy:function(){d.disconnect(this._con);k.destroy(this._domNode)},_togglePlay:function(a){a=this.rotator.playing;e(".dojoxRotatorPlay",this._domNode).style("display",a?"none":"");e(".dojoxRotatorPause",this._domNode).style("display",a?"":"none")},_buildInfo:function(a){return"\x3cspan\x3e"+(a.idx+1)+" / "+a.panes.length+"\x3c/span\x3e"},_onUpdate:function(a){var b=
this.rotator;switch(a){case "play":case "pause":this._togglePlay();break;case "onAfterTransition":this._info&&(this._info.innerHTML=this._buildInfo(b)),a=function(a){b.idx<a.length&&k.addClass(a[b.idx],"dojoxRotatorSelected")},a(e(".dojoxRotatorNumber",this._domNode).removeClass("dojoxRotatorSelected")),a(e(".dojoxRotatorTab",this._domNode).removeClass("dojoxRotatorSelected"))}}})})},"dijit/form/_ComboBoxMenuMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/has dojo/i18n dojo/i18n!./nls/ComboBox".split(" "),
function(h,b,k,a,c){var d=b("dijit.form._ComboBoxMenuMixin"+(a("dojo-bidi")?"_NoBidi":""),null,{_messages:null,postMixInProperties:function(){this.inherited(arguments);this._messages=c.getLocalization("dijit.form","ComboBox",this.lang)},buildRendering:function(){this.inherited(arguments);this.previousButton.innerHTML=this._messages.previousMessage;this.nextButton.innerHTML=this._messages.nextMessage},_setValueAttr:function(a){this._set("value",a);this.onChange(a)},onClick:function(a){if(a==this.previousButton)this._setSelectedAttr(null),
this.onPage(-1);else if(a==this.nextButton)this._setSelectedAttr(null),this.onPage(1);else this.onChange(a)},onChange:function(){},onPage:function(){},onClose:function(){this._setSelectedAttr(null)},_createOption:function(a,b){var c=this._createMenuItem(),d=b(a);d.html?c.innerHTML=d.label:c.appendChild(c.ownerDocument.createTextNode(d.label));""==c.innerHTML&&(c.innerHTML="\x26#160;");return c},createOptions:function(a,b,c){this.items=a;this.previousButton.style.display=0==b.start?"none":"";k.set(this.previousButton,
"id",this.id+"_prev");h.forEach(a,function(a,b){var d=this._createOption(a,c);d.setAttribute("item",b);k.set(d,"id",this.id+b);this.nextButton.parentNode.insertBefore(d,this.nextButton)},this);var d=!1;a.total&&!a.total.then&&-1!=a.total?b.start+b.count<a.total?d=!0:b.start+b.count>a.total&&b.count==a.length&&(d=!0):b.count==a.length&&(d=!0);this.nextButton.style.display=d?"":"none";k.set(this.nextButton,"id",this.id+"_next")},clearResultList:function(){for(var a=this.containerNode;2<a.childNodes.length;)a.removeChild(a.childNodes[a.childNodes.length-
2]);this._setSelectedAttr(null)},highlightFirstOption:function(){this.selectFirstNode()},highlightLastOption:function(){this.selectLastNode()},selectFirstNode:function(){this.inherited(arguments);this.getHighlightedOption()==this.previousButton&&this.selectNextNode()},selectLastNode:function(){this.inherited(arguments);this.getHighlightedOption()==this.nextButton&&this.selectPreviousNode()},getHighlightedOption:function(){return this.selected}});a("dojo-bidi")&&(d=b("dijit.form._ComboBoxMenuMixin",
d,{_createOption:function(){var a=this.inherited(arguments);this.applyTextDir(a);return a}}));return d})},"dijit/form/_SearchMixin":function(){define("dojo/_base/declare dojo/keys dojo/_base/lang dojo/query dojo/string dojo/when ../registry".split(" "),function(h,b,k,a,c,d,e){return h("dijit.form._SearchMixin",null,{pageSize:Infinity,store:null,fetchProperties:{},query:{},list:"",_setListAttr:function(a){this._set("list",a)},searchDelay:200,searchAttr:"name",queryExpr:"${0}*",ignoreCase:!0,_patternToRegExp:function(a){return RegExp("^"+
a.replace(/(\\.)|(\*)|(\?)|\W/g,function(a,b,c,d){return c?".*":d?".":b?b:"\\"+a})+"$",this.ignoreCase?"mi":"m")},_abortQuery:function(){this.searchTimer&&(this.searchTimer=this.searchTimer.remove());this._queryDeferHandle&&(this._queryDeferHandle=this._queryDeferHandle.remove());this._fetchHandle&&(this._fetchHandle.abort&&(this._cancelingQuery=!0,this._fetchHandle.abort(),this._cancelingQuery=!1),this._fetchHandle.cancel&&(this._cancelingQuery=!0,this._fetchHandle.cancel(),this._cancelingQuery=
!1),this._fetchHandle=null)},_processInput:function(a){if(!this.disabled&&!this.readOnly){var c=a.charOrCode;if(!("type"in a&&"key"==a.type.substring(0,3)&&(a.altKey||(a.ctrlKey||a.metaKey)&&"x"!=c&&"v"!=c||c==b.SHIFT))){this._prev_key_backspace=a=!1;switch(c){case b.DELETE:case b.BACKSPACE:a=this._maskValidSubsetError=this._prev_key_backspace=!0;break;default:a="string"==typeof c||229==c}if(a)if(this.store)this.searchTimer=this.defer("_startSearchFromInput",1);else this.onSearch()}}},onSearch:function(){},
_startSearchFromInput:function(){this._startSearch(this.focusNode.value)},_startSearch:function(a){this._abortQuery();var b=this,e=k.clone(this.query),m={start:0,count:this.pageSize,queryOptions:{ignoreCase:this.ignoreCase,deep:!0}},n=c.substitute(this.queryExpr,[a.replace(/([\\\*\?])/g,"\\$1")]),q,p=function(){var a=b._fetchHandle=b.store.query(e,m);!b.disabled&&!(b.readOnly||q!==b._lastQuery)&&d(a,function(c){b._fetchHandle=null;!b.disabled&&(!b.readOnly&&q===b._lastQuery)&&d(a.total,function(a){c.total=
a;var d=b.pageSize;if(isNaN(d)||d>c.total)d=c.total;c.nextPage=function(a){m.direction=a=!1!==a;m.count=d;a?(m.start+=c.length,m.start>=c.total&&(m.count=0)):(m.start-=d,0>m.start&&(m.count=Math.max(d+m.start,0),m.start=0));0>=m.count?(c.length=0,b.onSearch(c,e,m)):p()};b.onSearch(c,e,m)})},function(a){b._fetchHandle=null;b._cancelingQuery||console.error(b.declaredClass+" "+a.toString())})};k.mixin(m,this.fetchProperties);this.store._oldAPI?q=n:(q=this._patternToRegExp(n),q.toString=function(){return n});
this._lastQuery=e[this.searchAttr]=q;this._queryDeferHandle=this.defer(p,this.searchDelay)},constructor:function(){this.query={};this.fetchProperties={}},postMixInProperties:function(){if(!this.store){var a=this.list;a&&(this.store=e.byId(a))}this.inherited(arguments)}})})},"dojo/parser":function(){define("require ./_base/kernel ./_base/lang ./_base/array ./_base/config ./dom ./_base/window ./_base/url ./aspect ./promise/all ./date/stamp ./Deferred ./has ./query ./on ./ready".split(" "),function(h,
b,k,a,c,d,e,f,g,l,m,n,q,p,s,t){function u(a){return eval("("+a+")")}function x(a){var b=a._nameCaseMap,c=a.prototype;if(!b||b._extendCnt<v){var b=a._nameCaseMap={},d;for(d in c)"_"!==d.charAt(0)&&(b[d.toLowerCase()]=d);b._extendCnt=v}return b}function w(a,b){var c=a.join();if(!y[c]){for(var d=[],e=0,f=a.length;e<f;e++){var g=a[e];d[d.length]=y[g]=y[g]||k.getObject(g)||~g.indexOf("/")&&(b?b(g):h(g))}e=d.shift();y[c]=d.length?e.createSubclass?e.createSubclass(d):e.extend.apply(e,d):e}return y[c]}new Date("X");
var v=0;g.after(k,"extend",function(){v++},!0);var y={},A={_clearCache:function(){v++;y={}},_functionFromScript:function(b,c){var d="",e="",f=b.getAttribute(c+"args")||b.getAttribute("args"),g=b.getAttribute("with"),f=(f||"").split(/\s*,\s*/);g&&g.length&&a.forEach(g.split(/\s*,\s*/),function(a){d+="with("+a+"){";e+="}"});return new Function(f,d+b.innerHTML+e)},instantiate:function(c,d,e){d=d||{};e=e||{};var f=(e.scope||b._scopeName)+"Type",g="data-"+(e.scope||b._scopeName)+"-",l=g+"type",m=g+"mixins",
n=[];a.forEach(c,function(a){var b=f in d?d[f]:a.getAttribute(l)||a.getAttribute(f);if(b){var c=a.getAttribute(m),b=c?[b].concat(c.split(/\s*,\s*/)):[b];n.push({node:a,types:b})}});return this._instantiate(n,d,e)},_instantiate:function(b,c,d,e){function f(b){!c._started&&!d.noStart&&a.forEach(b,function(a){"function"===typeof a.startup&&!a._started&&a.startup()});return b}b=a.map(b,function(a){var b=a.ctor||w(a.types,d.contextRequire);if(!b)throw Error("Unable to resolve constructor for: '"+a.types.join()+
"'");return this.construct(b,a.node,c,d,a.scripts,a.inherited)},this);return e?l(b).then(f):f(b)},construct:function(c,d,e,l,n,t){function h(a){X&&k.setObject(X,a);for(J=0;J<R.length;J++)g[R[J].advice||"after"](a,R[J].method,k.hitch(a,R[J].func),!0);for(J=0;J<Y.length;J++)Y[J].call(a);for(J=0;J<U.length;J++)a.watch(U[J].prop,U[J].func);for(J=0;J<V.length;J++)s(a,V[J].event,V[J].func);return a}var w=c&&c.prototype;l=l||{};var v={};l.defaults&&k.mixin(v,l.defaults);t&&k.mixin(v,t);var y;q("dom-attributes-explicit")?
y=d.attributes:q("dom-attributes-specified-flag")?y=a.filter(d.attributes,function(a){return a.specified}):(t=(/^input$|^img$/i.test(d.nodeName)?d:d.cloneNode(!1)).outerHTML.replace(/=[^\s"']+|="[^"]*"|='[^']*'/g,"").replace(/^\s*<[a-zA-Z0-9]*\s*/,"").replace(/\s*>.*$/,""),y=a.map(t.split(/\s+/),function(a){var b=a.toLowerCase();return{name:a,value:"LI"==d.nodeName&&"value"==a||"enctype"==b?d.getAttribute(b):d.getAttributeNode(b).value}}));var A=l.scope||b._scopeName;t="data-"+A+"-";var D={};"dojo"!==
A&&(D[t+"props"]="data-dojo-props",D[t+"type"]="data-dojo-type",D[t+"mixins"]="data-dojo-mixins",D[A+"type"]="dojoType",D[t+"id"]="data-dojo-id");for(var J=0,L,A=[],X,N;L=y[J++];){var I=L.name,M=I.toLowerCase();L=L.value;switch(D[M]||M){case "data-dojo-type":case "dojotype":case "data-dojo-mixins":break;case "data-dojo-props":N=L;break;case "data-dojo-id":case "jsid":X=L;break;case "data-dojo-attach-point":case "dojoattachpoint":v.dojoAttachPoint=L;break;case "data-dojo-attach-event":case "dojoattachevent":v.dojoAttachEvent=
L;break;case "class":v["class"]=d.className;break;case "style":v.style=d.style&&d.style.cssText;break;default:if(I in w||(I=x(c)[M]||I),I in w)switch(typeof w[I]){case "string":v[I]=L;break;case "number":v[I]=L.length?Number(L):NaN;break;case "boolean":v[I]="false"!=L.toLowerCase();break;case "function":""===L||-1!=L.search(/[^\w\.]+/i)?v[I]=new Function(L):v[I]=k.getObject(L,!1)||new Function(L);A.push(I);break;default:M=w[I],v[I]=M&&"length"in M?L?L.split(/\s*,\s*/):[]:M instanceof Date?""==L?new Date(""):
"now"==L?new Date:m.fromISOString(L):M instanceof f?b.baseUrl+L:u(L)}else v[I]=L}}for(y=0;y<A.length;y++)D=A[y].toLowerCase(),d.removeAttribute(D),d[D]=null;if(N)try{N=u.call(l.propsThis,"{"+N+"}"),k.mixin(v,N)}catch(T){throw Error(T.toString()+" in data-dojo-props\x3d'"+N+"'");}k.mixin(v,e);n||(n=c&&(c._noScript||w._noScript)?[]:p("\x3e script[type^\x3d'dojo/']",d));var R=[],Y=[],U=[],V=[];if(n)for(J=0;J<n.length;J++)D=n[J],d.removeChild(D),e=D.getAttribute(t+"event")||D.getAttribute("event"),l=
D.getAttribute(t+"prop"),N=D.getAttribute(t+"method"),A=D.getAttribute(t+"advice"),y=D.getAttribute("type"),D=this._functionFromScript(D,t),e?"dojo/connect"==y?R.push({method:e,func:D}):"dojo/on"==y?V.push({event:e,func:D}):v[e]=D:"dojo/aspect"==y?R.push({method:N,advice:A,func:D}):"dojo/watch"==y?U.push({prop:l,func:D}):Y.push(D);c=(n=c.markupFactory||w.markupFactory)?n(v,d,c):new c(v,d);return c.then?c.then(h):h(c)},scan:function(c,d){function e(a){if(!a.inherited){a.inherited={};var b=a.node,c=
e(a.parent),b={dir:b.getAttribute("dir")||c.dir,lang:b.getAttribute("lang")||c.lang,textDir:b.getAttribute(k)||c.textDir},d;for(d in b)b[d]&&(a.inherited[d]=b[d])}return a.inherited}var f=[],g=[],l={},m=(d.scope||b._scopeName)+"Type",p="data-"+(d.scope||b._scopeName)+"-",s=p+"type",k=p+"textdir",p=p+"mixins",t=c.firstChild,u=d.inherited;if(!u){var x=function(a,b){return a.getAttribute&&a.getAttribute(b)||a.parentNode&&x(a.parentNode,b)},u={dir:x(c,"dir"),lang:x(c,"lang"),textDir:x(c,k)},v;for(v in u)u[v]||
delete u[v]}for(var u={inherited:u},y,A;;)if(t)if(1!=t.nodeType)t=t.nextSibling;else if(y&&"script"==t.nodeName.toLowerCase())(I=t.getAttribute("type"))&&/^dojo\/\w/i.test(I)&&y.push(t),t=t.nextSibling;else if(A)t=t.nextSibling;else{var I=t.getAttribute(s)||t.getAttribute(m);v=t.firstChild;if(!I&&(!v||3==v.nodeType&&!v.nextSibling))t=t.nextSibling;else{A=null;if(I){var M=t.getAttribute(p);y=M?[I].concat(M.split(/\s*,\s*/)):[I];try{A=w(y,d.contextRequire)}catch(T){}A||a.forEach(y,function(a){~a.indexOf("/")&&
!l[a]&&(l[a]=!0,g[g.length]=a)});M=A&&!A.prototype._noScript?[]:null;u={types:y,ctor:A,parent:u,node:t,scripts:M};u.inherited=e(u);f.push(u)}else u={node:t,scripts:y,parent:u};y=M;A=t.stopParser||A&&A.prototype.stopParser&&!d.template;t=v}}else{if(!u||!u.node)break;t=u.node.nextSibling;A=!1;u=u.parent;y=u.scripts}var R=new n;g.length?(q("dojo-debug-messages")&&console.warn("WARNING: Modules being Auto-Required: "+g.join(", ")),(d.contextRequire||h)(g,function(){R.resolve(a.filter(f,function(a){if(!a.ctor)try{a.ctor=
w(a.types,d.contextRequire)}catch(b){}for(var c=a.parent;c&&!c.types;)c=c.parent;var e=a.ctor&&a.ctor.prototype;a.instantiateChildren=!(e&&e.stopParser&&!d.template);a.instantiate=!c||c.instantiate&&c.instantiateChildren;return a.instantiate}))})):R.resolve(f);return R.promise},_require:function(a,b){var c=u("{"+a.innerHTML+"}"),d=[],e=[],f=new n,g=b&&b.contextRequire||h,l;for(l in c)d.push(l),e.push(c[l]);g(e,function(){for(var a=0;a<d.length;a++)k.setObject(d[a],arguments[a]);f.resolve(arguments)});
return f.promise},_scanAmd:function(a,b){var c=new n,d=c.promise;c.resolve(!0);var e=this;p("script[type\x3d'dojo/require']",a).forEach(function(a){d=d.then(function(){return e._require(a,b)});a.parentNode.removeChild(a)});return d},parse:function(a,b){var c;!b&&a&&a.rootNode?(b=a,c=b.rootNode):a&&k.isObject(a)&&!("nodeType"in a)?b=a:c=a;c=c?d.byId(c):e.body();b=b||{};var f=b.template?{template:!0}:{},g=[],l=this,m=this._scanAmd(c,b).then(function(){return l.scan(c,b)}).then(function(a){return l._instantiate(a,
f,b,!0)}).then(function(a){return g=g.concat(a)}).otherwise(function(a){console.error("dojo/parser::parse() error",a);throw a;});k.mixin(g,m);return g}};b.parser=A;c.parseOnLoad&&t(100,A,"parse");return A})},"dojo/dnd/Manager":function(){define("../_base/array ../_base/declare ../_base/lang ../_base/window ../dom-class ../Evented ../has ../keys ../on ../topic ../touch ./common ./autoscroll ./Avatar".split(" "),function(h,b,k,a,c,d,e,f,g,l,m,n,q,p){var s=b("dojo.dnd.Manager",[d],{constructor:function(){this.source=
this.avatar=null;this.nodes=[];this.copy=!0;this.target=null;this.canDropFlag=!1;this.events=[]},OFFSET_X:e("touch")?0:16,OFFSET_Y:e("touch")?-64:16,overSource:function(a){this.avatar&&(this.target=a&&"Disabled"!=a.targetState?a:null,this.canDropFlag=Boolean(this.target),this.avatar.update());l.publish("/dnd/source/over",a)},outSource:function(a){this.avatar?this.target==a&&(this.target=null,this.canDropFlag=!1,this.avatar.update(),l.publish("/dnd/source/over",null)):l.publish("/dnd/source/over",
null)},startDrag:function(b,d,e){function f(a){a.preventDefault();a.stopPropagation()}q.autoScrollStart(a.doc);this.source=b;this.nodes=d;this.copy=Boolean(e);this.avatar=this.makeAvatar();a.body().appendChild(this.avatar.node);l.publish("/dnd/start",b,d,this.copy);this.events=[g(a.doc,m.move,k.hitch(this,"onMouseMove")),g(a.doc,m.release,k.hitch(this,"onMouseUp")),g(a.doc,"keydown",k.hitch(this,"onKeyDown")),g(a.doc,"keyup",k.hitch(this,"onKeyUp")),g(a.doc,"dragstart",f),g(a.body(),"selectstart",
f)];c.add(a.body(),"dojoDnd"+(e?"Copy":"Move"))},canDrop:function(a){a=Boolean(this.target&&a);this.canDropFlag!=a&&(this.canDropFlag=a,this.avatar.update())},stopDrag:function(){c.remove(a.body(),["dojoDndCopy","dojoDndMove"]);h.forEach(this.events,function(a){a.remove()});this.events=[];this.avatar.destroy();this.source=this.target=this.avatar=null;this.nodes=[]},makeAvatar:function(){return new p(this)},updateAvatar:function(){this.avatar.update()},onMouseMove:function(a){var b=this.avatar;b&&
(q.autoScrollNodes(a),b=b.node.style,b.left=a.pageX+this.OFFSET_X+"px",b.top=a.pageY+this.OFFSET_Y+"px",b=Boolean(this.source.copyState(n.getCopyKeyState(a))),this.copy!=b&&this._setCopyStatus(b));e("touch")&&a.preventDefault()},onMouseUp:function(a){if(this.avatar){if(this.target&&this.canDropFlag){var b=Boolean(this.source.copyState(n.getCopyKeyState(a)));l.publish("/dnd/drop/before",this.source,this.nodes,b,this.target,a);l.publish("/dnd/drop",this.source,this.nodes,b,this.target,a)}else l.publish("/dnd/cancel");
this.stopDrag()}},onKeyDown:function(a){if(this.avatar)switch(a.keyCode){case f.CTRL:a=Boolean(this.source.copyState(!0));this.copy!=a&&this._setCopyStatus(a);break;case f.ESCAPE:l.publish("/dnd/cancel"),this.stopDrag()}},onKeyUp:function(a){this.avatar&&a.keyCode==f.CTRL&&(a=Boolean(this.source.copyState(!1)),this.copy!=a&&this._setCopyStatus(a))},_setCopyStatus:function(b){this.copy=b;this.source._markDndStatus(this.copy);this.updateAvatar();c.replace(a.body(),"dojoDnd"+(this.copy?"Copy":"Move"),
"dojoDnd"+(this.copy?"Move":"Copy"))}});n._manager=null;s.manager=n.manager=function(){n._manager||(n._manager=new s);return n._manager};return s})},"dijit/form/ToggleButton":function(){define(["dojo/_base/declare","dojo/_base/kernel","./Button","./_ToggleButtonMixin"],function(h,b,k,a){return h("dijit.form.ToggleButton",[k,a],{baseClass:"dijitToggleButton",setChecked:function(a){b.deprecated("setChecked("+a+") is deprecated. Use set('checked',"+a+") instead.","","2.0");this.set("checked",a)}})})},
"esri/SpatialReference":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ./kernel ./lang".split(" "),function(h,b,k,a,c,d){var e=[-2.0037508342788905E7,2.0037508342788905E7],f=[-2.0037508342787E7,2.0037508342787E7];h=h(null,{declaredClass:"esri.SpatialReference",constructor:function(a){a&&(k.isObject(a)?k.mixin(this,a):k.isString(a)?this.wkt=a:this.wkid=a)},wkid:null,wkt:null,_info:{102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',
valid:e,origin:f,dx:1E-5},102100:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',valid:e,origin:f,
dx:1E-5},3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:e,origin:f,dx:1E-5},3857:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',
valid:e,origin:f,dx:1E-5},4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",${Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],UNIT["Degrees",111319.491]]',
valid:[-180,180],origin:[-180,180],dx:1E-5}},_isWebMercator:function(){return-1!==b.indexOf([102113,102100,3857,3785],this.wkid)},_isWrappable:function(){return-1!==b.indexOf([102113,102100,3857,3785,4326],this.wkid)},_getInfo:function(){return this.wkid?this._info[this.wkid]:null},_canProject:function(a){var b=!1;a&&(b=this.isWebMercator()&&4326===a.wkid||a.isWebMercator()&&4326===this.wkid);return b},isWebMercator:function(){return this._isWebMercator()},equals:function(a){var b=!1;a&&(this===a&&
(b=!0),this.wkid||a.wkid?b=this.wkid===a.wkid||this.isWebMercator()&&a.isWebMercator()||this.wkid===a.latestWkid||a.wkid===this.latestWkid:this.wkt&&a.wkt&&(b=this.wkt.toUpperCase()===a.wkt.toUpperCase()));return b},toJson:function(){var a=null,b=d.isDefined;b(this.wkid)?a={wkid:this.wkid}:b(this.wkt)&&(a={wkt:this.wkt});a&&b(this.latestWkid)&&(a.latestWkid=this.latestWkid);return a}});a("extend-esri")&&(c.SpatialReference=h);return h})},"dojo/date/stamp":function(){define(["../_base/lang","../_base/array"],
function(h,b){var k={};h.setObject("dojo.date.stamp",k);k.fromISOString=function(a,c){k._isoRegExp||(k._isoRegExp=/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):(\d{2}))|Z)?)?$/);var d=k._isoRegExp.exec(a),e=null;if(d){d.shift();d[1]&&d[1]--;d[6]&&(d[6]*=1E3);c&&(c=new Date(c),b.forEach(b.map("FullYear Month Date Hours Minutes Seconds Milliseconds".split(" "),function(a){return c["get"+a]()}),function(a,b){d[b]=d[b]||a}));e=new Date(d[0]||1970,d[1]||
0,d[2]||1,d[3]||0,d[4]||0,d[5]||0,d[6]||0);100>d[0]&&e.setFullYear(d[0]||1970);var f=0,g=d[7]&&d[7].charAt(0);"Z"!=g&&(f=60*(d[8]||0)+(Number(d[9])||0),"-"!=g&&(f*=-1));g&&(f-=e.getTimezoneOffset());f&&e.setTime(e.getTime()+6E4*f)}return e};k.toISOString=function(a,b){var d=function(a){return 10>a?"0"+a:a};b=b||{};var e=[],f=b.zulu?"getUTC":"get",g="";"time"!=b.selector&&(g=a[f+"FullYear"](),g=["0000".substr((g+"").length)+g,d(a[f+"Month"]()+1),d(a[f+"Date"]())].join("-"));e.push(g);if("date"!=b.selector){g=
[d(a[f+"Hours"]()),d(a[f+"Minutes"]()),d(a[f+"Seconds"]())].join(":");f=a[f+"Milliseconds"]();b.milliseconds&&(g+="."+(100>f?"0":"")+d(f));if(b.zulu)g+="Z";else if("time"!=b.selector)var f=a.getTimezoneOffset(),l=Math.abs(f),g=g+((0<f?"-":"+")+d(Math.floor(l/60))+":"+d(l%60));e.push(g)}return e.join("T")};return k})},"arcgisonline/sharing/dijit/ProfilePopup":function(){define(["dijit","dojo","dojox","dojo/require!arcgisonline/sharing/dijit/views,arcgisonline/sharing/geow/Community,dijit/layout/ContentPane"],
function(h,b,k){b.provide("arcgisonline.sharing.dijit.ProfilePopup");b.require("arcgisonline.sharing.dijit.views");b.require("arcgisonline.sharing.geow.Community");b.require("dijit.layout.ContentPane");b.declare("arcgisonline.sharing.dijit.ProfilePopup",h.layout.ContentPane,{"class":"profilePopup",_lastTrigger:null,_resizeConnect:null,_blurConnect:null,_profileContentPane:null,animateShowHide:!0,fadeDuration:300,statics:{cache:[],_instance:null,getInstance:function(){null===this._instance&&(this._instance=
new arcgisonline.sharing.dijit.ProfilePopup,this._instance.startup());return this._instance},showProfilePopup:function(a){var c=arcgisonline.sharing.dijit.ProfilePopup.prototype.statics.getInstance();null!==c&&c.showProfile(b.attr(a.currentTarget,"owner"),a.currentTarget)}},postCreate:function(){this.inherited(arguments);b.style(this.domNode,{position:"absolute",top:"-1000px",left:"-1000px",opacity:0});this.fadeIn=b.fadeIn({node:this.domNode,duration:this.fadeDuration,onEnd:function(){h.focus(this.node)}});
this.fadeOut=b.fadeOut({node:this.domNode,duration:this.fadeDuration,onEnd:b.hitch(this,"_afterFade")})},startup:function(){this.inherited(arguments);var a=b.create("div",{style:{position:"relative",top:0,left:0}},this.domNode);this._profileContentPane=new h.layout.ContentPane;this._profileContentPane.placeAt(a);a=b.create("div",{"class":"dijitDialogCloseIcon",style:{position:"absolute",top:"-5px"}},a);b.style(a,esriGeowConfig.isRightToLeft?{left:"-5px"}:{right:"-5px"});b.connect(a,"onclick",this,
this.hide)},showProfile:function(a,c){this._lastTrigger=c;var d=arcgisonline.sharing.dijit.ProfilePopup.prototype.statics.cache[a];d&&null!==d?(this._profileContentPane.set("content",d),d=arcgisonline.sharing.dijit.views.profile.medium(d,{showThumb:!0,showProfilePopup:!0,align:"left"}),this._placeNextTo(d,c)):(arcgisonline.sharing.geow.Community.getProfile(a,b.hitch(this,this._handleGetProfile),b.hitch(this,this._handleGetProfile)),this._profileContentPane.set("content",b.create("span",{innerHTML:"loading..."})))},
showProfileFromPopup:function(a,c){b.style(this.domNode,{zIndex:1E3,opacity:1});this.showProfile(a,c)},_handleGetProfile:function(a,b){if(a){var d=arcgisonline.sharing.dijit.views.profile.medium(a,{showThumb:!0,showProfilePopup:!0,align:"left"});arcgisonline.sharing.dijit.ProfilePopup.prototype.statics.cache[a.username]=a;this._placeNextTo(d,this._lastTrigger)}},_placeNextTo:function(a,b){h.placeOnScreenAroundNode(this.domNode,b,esriGeowConfig.isRightToLeft?{BR:"TR",BL:"TL",TR:"BR",TL:"BL"}:{BL:"TL",
BR:"TR",TL:"BL",TR:"BR"});this._profileContentPane.set("content",a);this.show()},_afterFade:function(){b.style(this.domNode,{top:"-1000px",left:"-1000px"})},show:function(a){this.isShowing=!0;this.animateShowHide?(this.fadeOut.stop(),this.fadeIn.play()):(b.style(this.domNode,"display","block"),h.focus(this.domNode));this._clearConnects();this._resizeConnect=b.connect(window,"onresize",this,this.hide)},hide:function(){this._clearConnects();this.animateShowHide?(this.fadeIn.stop(),this.fadeOut.play()):
b.style(this.domNode,"display","none")},_clearConnects:function(){null!==this._resizeConnect&&(b.disconnect(this._resizeConnect),this._resizeConnect=null);null!==this._blurConnect&&(b.disconnect(this._blurConnect),this._blurConnect=null)}})})},"esri/IdentityManagerBase":function(){define("dojo/_base/declare dojo/_base/config dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/_base/url dojo/sniff dojo/cookie dojo/io-query dojo/regexp ./kernel ./config ./lang ./ServerInfo ./urlUtils ./deferredUtils ./request ./Evented ./OAuthCredential ./arcgis/OAuthInfo".split(" "),
function(h,b,k,a,c,d,e,f,g,l,m,n,q,p,s,t,u,x,w,v,y){var A={},z=function(a){var b=(new e(a.owningSystemUrl)).host;a=(new e(a.server)).host;var c=/.+\.arcgis\.com$/i;return c.test(b)&&c.test(a)},G=function(b,c){return!(!z(b)||!c||!a.some(c,function(a){return a.test(b.server)}))},F,B=h(w,{declaredClass:"esri.IdentityManagerBase",constructor:function(){this._portalConfig=k.getObject("esriGeowConfig");this.serverInfos=[];this.oAuthInfos=[];this.credentials=[];this._soReqs=[];this._xoReqs=[];this._portals=
[];this._getOAuthHash()},defaultTokenValidity:60,tokenValidity:null,signInPage:null,useSignInPage:!0,normalizeWebTierAuth:!1,_busy:null,_oAuthHash:null,_gwTokenUrl:"/sharing/generateToken",_agsRest:"/rest/services",_agsPortal:/\/sharing(\/|$)/i,_agsAdmin:/https?:\/\/[^\/]+\/[^\/]+\/admin\/?(\/.*)?$/i,_adminSvcs:/\/admin\/services(\/|$)/i,_agolSuffix:".arcgis.com",_gwDomains:[{regex:/https?:\/\/www\.arcgis\.com/i,tokenServiceUrl:"https://www.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/dev\.arcgis\.com/i,
tokenServiceUrl:"https://dev.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*dev[^.]*\.arcgis\.com/i,tokenServiceUrl:"https://devext.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*qa[^.]*\.arcgis\.com/i,tokenServiceUrl:"https://qaext.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*.arcgis\.com/i,tokenServiceUrl:"https://www.arcgis.com/sharing/generateToken"}],_legacyFed:[],_regexSDirUrl:/http.+\/rest\/services\/?/ig,_regexServerType:/(\/(MapServer|GeocodeServer|GPServer|GeometryServer|ImageServer|NAServer|FeatureServer|GeoDataServer|GlobeServer|MobileServer|GeoenrichmentServer)).*/ig,
_gwUser:/http.+\/users\/([^\/]+)\/?.*/i,_gwItem:/http.+\/items\/([^\/]+)\/?.*/i,_gwGroup:/http.+\/groups\/([^\/]+)\/?.*/i,_errorCodes:[499,498,403,401],_rePortalTokenSvc:/\/sharing(\/rest)?\/generatetoken/i,_publicUrls:[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],registerServers:function(b){var c=this.serverInfos;c?(b=a.filter(b,function(a){return!this.findServerInfo(a.server)},this),this.serverInfos=c.concat(b)):this.serverInfos=b;a.forEach(b,function(a){a.owningSystemUrl&&
this._portals.push(a.owningSystemUrl);if(a.hasPortal){this._portals.push(a.server);var b=q.defaults.io.corsEnabledServers,c=this._getOrigin(a.tokenServiceUrl);t.canUseXhr(a.server)||b.push(a.server.replace(/^https?:\/\//i,""));t.canUseXhr(c)||b.push(c.replace(/^https?:\/\//i,""))}},this)},registerOAuthInfos:function(b){var c=this.oAuthInfos;c?(b=a.filter(b,function(a){return!this.findOAuthInfo(a.portalUrl)},this),this.oAuthInfos=c.concat(b)):this.oAuthInfos=b},registerToken:function(a){var b=this._sanitizeUrl(a.server),
c=this.findServerInfo(b),d=!0,e;c||(c=new s,c.server=this._getOrigin(b),c.tokenServiceUrl=this._getTokenSvcUrl(b),c.hasPortal=!0,this.registerServers([c]));(e=this.findCredential(b,a.userId))?(k.mixin(e,a),d=!1):(e=new F({userId:a.userId,server:c.server,token:a.token,expires:a.expires,ssl:a.ssl,scope:this._isServerRsrc(b)?"server":"portal"}),e.resources=[b],this.credentials.push(e));e.onTokenChange(!1);d||e.refreshServerTokens()},toJson:function(){return p.fixJson({serverInfos:a.map(this.serverInfos,
function(a){return a.toJson()}),oAuthInfos:a.map(this.oAuthInfos,function(a){return a.toJson()}),credentials:a.map(this.credentials,function(a){return a.toJson()})})},initialize:function(b){if(b){k.isString(b)&&(b=d.fromJson(b));var c=b.serverInfos,e=b.oAuthInfos;b=b.credentials;if(c){var f=[];a.forEach(c,function(a){a.server&&a.tokenServiceUrl&&f.push(a.declaredClass?a:new s(a))});f.length&&this.registerServers(f)}if(e){var g=[];a.forEach(e,function(a){a.appId&&g.push(a.declaredClass?a:new y(a))});
g.length&&this.registerOAuthInfos(g)}b&&a.forEach(b,function(a){a.userId&&(a.server&&a.token&&a.expires&&a.expires>(new Date).getTime())&&(a=a.declaredClass?a:new F(a),a.onTokenChange(),this.credentials.push(a))},this)}},findServerInfo:function(b){var c;b=this._sanitizeUrl(b);a.some(this.serverInfos,function(a){t.hasSameOrigin(a.server,b,!0)&&(c=a);return!!c});return c},findOAuthInfo:function(b){var c;b=this._sanitizeUrl(b);a.some(this.oAuthInfos,function(a){t.hasSameOrigin(a.portalUrl,b,!0)&&(c=
a);return!!c});return c},findCredential:function(b,c){var d,e;b=this._sanitizeUrl(b);e=this._isServerRsrc(b)?"server":"portal";c?a.some(this.credentials,function(a){t.hasSameOrigin(b,a.server,!0)&&(c===a.userId&&a.scope===e)&&(d=a);return!!d},this):a.some(this.credentials,function(a){t.hasSameOrigin(b,a.server,!0)&&(-1!==this._getIdenticalSvcIdx(b,a)&&a.scope===e)&&(d=a);return!!d},this);return d},getCredential:function(a,d){var e,f,g=!0;p.isDefined(d)&&(k.isObject(d)?(e=!!d.token,f=d.error,g=!1!==
d.prompt):e=d);a=this._sanitizeUrl(a);var l=new c(u._dfdCanceller),m=this._isAdminResource(a),n=e&&this._doPortalSignIn(a)?this._getEsriAuthCookie():null;e=e?this.findCredential(a):null;if(n||e)return g=Error("You are currently signed in as: '"+(n&&n.email||e&&e.userId)+"'. You do not have access to this resource: "+a),g.code="IdentityManagerBase.1",g.httpCode=f&&f.httpCode,g.messageCode=f?f.messageCode:null,g.subcode=f?f.subcode:null,g.details=f?f.details:null,g.log=b.isDebug,l.errback(g),l;if(f=
this._findCredential(a,d))return l.callback(f),l;if(f=this.findServerInfo(a))!f.hasServer&&this._isServerRsrc(a)&&(f._restInfoDfd=this._getTokenSvcUrl(a,!0),f.hasServer=!0);else{n=this._getTokenSvcUrl(a);if(!n)return g=Error("Unknown resource - could not find token service endpoint."),g.code="IdentityManagerBase.2",g.log=b.isDebug,l.errback(g),l;f=new s;f.server=this._getOrigin(a);k.isString(n)?(f.tokenServiceUrl=n,g&&!this._findOAuthInfo(a)&&(f._selfDfd=this._getPortalSelf(n.replace(this._rePortalTokenSvc,
"/sharing/rest/portals/self"),a)),f.hasPortal=!0):(f._restInfoDfd=n,f.hasServer=!0);this.registerServers([f])}return this._enqueue(a,f,d,l,m)},getResourceName:function(a){return this._isRESTService(a)?a.replace(this._regexSDirUrl,"").replace(this._regexServerType,"")||"":this._gwUser.test(a)&&a.replace(this._gwUser,"$1")||this._gwItem.test(a)&&a.replace(this._gwItem,"$1")||this._gwGroup.test(a)&&a.replace(this._gwGroup,"$1")||""},generateToken:function(a,c,d){var f,g,l,m,p,s,q=new e(window.location.href.toLowerCase()),
u=this._getEsriAuthCookie(),h,z=!c;m=a.shortLivedTokenValidity;var w;c&&(w=n.id.tokenValidity||m||n.id.defaultTokenValidity,w>m&&(w=m));d&&(f=d.isAdmin,g=d.serverUrl,l=d.token,s=d.ssl,a.customParameters=d.customParameters);if(f)m=a.adminTokenServiceUrl;else{m=a.tokenServiceUrl;p=new e(m.toLowerCase());u&&(h=(h=u.auth_tier)&&h.toLowerCase());if(("web"===h||a.webTierAuth)&&d&&d.serverUrl&&!s&&"http"===q.scheme&&(t.hasSameOrigin(q.uri,m,!0)||"https"===p.scheme&&q.host===p.host&&"7080"===q.port&&"7443"===
p.port))m=m.replace(/^https:/i,"http:").replace(/:7443/i,":7080");z&&this._rePortalTokenSvc.test(a.tokenServiceUrl)&&(m=m.replace(/\/rest/i,""))}d=x(k.mixin({url:m,content:k.mixin({request:"getToken",username:c&&c.username,password:c&&c.password,serverUrl:g,token:l,expiration:w,referer:f||this._rePortalTokenSvc.test(a.tokenServiceUrl)?window.location.host:null,client:f?"referer":null,f:"json"},a.customParameters),handleAs:"json",callbackParamName:z?"callback":void 0},d&&d.ioArgs),{usePost:!z,disableIdentityLookup:!0,
useProxy:this._useProxy(a,d)});d.addCallback(function(d){if(!d||!d.token)return d=Error("Unable to generate token"),d.code="IdentityManagerBase.3",d.log=b.isDebug,d;var e=a.server;A[e]||(A[e]={});c&&(A[e][c.username]=c.password);d.validity=w;return d});d.addErrback(function(a){});return d},isBusy:function(){return!!this._busy},checkSignInStatus:function(a){return this.getCredential(a,{prompt:!1})},setRedirectionHandler:function(a){this._redirectFunc=a},setProtocolErrorHandler:function(a){this._protocolFunc=
a},signIn:function(){},oAuthSignIn:function(){},onCredentialCreate:function(){},onCredentialsDestroy:function(){},destroyCredentials:function(){if(this.credentials){var b=this.credentials.slice();a.forEach(b,function(a){a.destroy()})}this.onCredentialsDestroy()},_getOAuthHash:function(){var a=window.location.hash;if(a){"#"===a.charAt(0)&&(a=a.substring(1));var a=l.queryToObject(a),b=!1;a.access_token&&a.expires_in&&a.state&&a.hasOwnProperty("username")?(a.state=d.fromJson(a.state),this._oAuthHash=
a,b=!0):a.error&&a.error_description&&(console.log("IdentityManager OAuth Error: ",a.error," - ",a.error_description),"access_denied"===a.error&&(b=!0));if(b&&(!f("ie")||8<f("ie")))window.location.hash=""}},_findCredential:function(b,c){var d=-1,e,f,g,l,m=c&&c.token;e=c&&c.resource;var n=this._isServerRsrc(b)?"server":"portal",p=a.filter(this.credentials,function(a){return t.hasSameOrigin(a.server,b,!0)&&a.scope===n});b=e||b;if(p.length)if(1===p.length)if(e=p[0],g=(f=(l=this.findServerInfo(e.server))&&
l.owningSystemUrl)&&this.findCredential(f,e.userId),d=this._getIdenticalSvcIdx(b,e),m)-1!==d&&(e.resources.splice(d,1),this._removeResource(b,g));else return-1===d&&e.resources.push(b),this._addResource(b,g),e;else{var s,q;a.some(p,function(a){q=this._getIdenticalSvcIdx(b,a);return-1!==q?(s=a,g=(f=(l=this.findServerInfo(s.server))&&l.owningSystemUrl)&&this.findCredential(f,s.userId),d=q,!0):!1},this);if(m)s&&(s.resources.splice(d,1),this._removeResource(b,g));else if(s)return this._addResource(b,
g),s}},_findOAuthInfo:function(b){var c=this.findOAuthInfo(b);c||a.some(this.oAuthInfos,function(a){this._isIdProvider(a.portalUrl,b)&&(c=a);return!!c},this);return c},_addResource:function(a,b){b&&-1===this._getIdenticalSvcIdx(a,b)&&b.resources.push(a)},_removeResource:function(a,b){var c=-1;b&&(c=this._getIdenticalSvcIdx(a,b),-1<c&&b.resources.splice(c,1))},_useProxy:function(a,b){return b&&b.isAdmin&&!t.hasSameOrigin(a.adminTokenServiceUrl,window.location.href)||!this._isPortalDomain(a.tokenServiceUrl)&&
10.1==a.currentVersion&&!t.hasSameOrigin(a.tokenServiceUrl,window.location.href)},_getOrigin:function(a){a=new e(a);return a.scheme+"://"+a.host+(p.isDefined(a.port)?":"+a.port:"")},_sanitizeUrl:function(a){a=t.fixUrl(k.trim(a));var b=(q.defaults.io.proxyUrl||"").toLowerCase(),c=b?a.toLowerCase().indexOf(b+"?"):-1;-1!==c&&(a=a.substring(c+b.length+1));return t.urlToObject(a).path},_isRESTService:function(a){return-1<a.indexOf(this._agsRest)},_isAdminResource:function(a){return this._agsAdmin.test(a)||
this._adminSvcs.test(a)},_isServerRsrc:function(a){return this._isRESTService(a)||this._isAdminResource(a)},_isIdenticalService:function(a,b){var c;if(this._isRESTService(a)&&this._isRESTService(b)){var d=this._getSuffix(a).toLowerCase(),e=this._getSuffix(b).toLowerCase();c=d===e;c||(c=/(.*)\/(MapServer|FeatureServer).*/ig,c=d.replace(c,"$1")===e.replace(c,"$1"))}else this._isAdminResource(a)&&this._isAdminResource(b)?c=!0:!this._isServerRsrc(a)&&(!this._isServerRsrc(b)&&this._isPortalDomain(a))&&
(c=!0);return c},_isPortalDomain:function(b){b=b.toLowerCase();var c=(new e(b)).authority,d=this._portalConfig,f=-1!==c.indexOf(this._agolSuffix);!f&&d&&(f=t.hasSameOrigin(d.restBaseUrl,b,!0));if(!f){if(!this._arcgisUrl&&(d=k.getObject("esri.arcgis.utils.arcgisUrl")))this._arcgisUrl=(new e(d)).authority;this._arcgisUrl&&(f=this._arcgisUrl.toLowerCase()===c)}f||(f=a.some(this._portals,function(a){return t.hasSameOrigin(a,b,!0)}));return f=f||this._agsPortal.test(b)},_isIdProvider:function(b,c){var d=
-1,e=-1;a.forEach(this._gwDomains,function(a,f){-1===d&&a.regex.test(b)&&(d=f);-1===e&&a.regex.test(c)&&(e=f)});var f=!1;if(-1<d&&-1<e)if(0===d||4===d){if(0===e||4===e)f=!0}else if(1===d){if(1===e||2===e)f=!0}else 2===d?2===e&&(f=!0):3===d&&3===e&&(f=!0);if(!f){var g=this.findServerInfo(c),l=g&&g.owningSystemUrl;l&&(z(g)&&this._isPortalDomain(l)&&this._isIdProvider(b,l))&&(f=!0)}return f},_isPublic:function(b){b=this._sanitizeUrl(b);return a.some(this._publicUrls,function(a){return a.test(b)})},_getIdenticalSvcIdx:function(b,
c){var d=-1;a.some(c.resources,function(a,c){return this._isIdenticalService(b,a)?(d=c,!0):!1},this);return d},_getSuffix:function(a){return a.replace(this._regexSDirUrl,"").replace(this._regexServerType,"$1")},_getTokenSvcUrl:function(b){var c,d;if((c=this._isRESTService(b))||this._isAdminResource(b))return d=b.toLowerCase().indexOf(c?this._agsRest:"/admin/"),c=b.substring(0,d)+"/admin/generateToken",b=b.substring(0,d)+"/rest/info",d=x({url:b,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}),
d.adminUrl_=c,d;if(this._isPortalDomain(b)){var f="";a.some(this._gwDomains,function(a){a.regex.test(b)&&(f=a.tokenServiceUrl);return!!f});f||a.some(this._portals,function(a){t.hasSameOrigin(a,b,!0)&&(f=a+this._gwTokenUrl);return!!f},this);f||(d=b.toLowerCase().indexOf("/sharing"),-1!==d&&(f=b.substring(0,d)+this._gwTokenUrl));f||(f=this._getOrigin(b)+this._gwTokenUrl);f&&(c=(new e(b)).port,/^http:\/\//i.test(b)&&"7080"===c&&(f=f.replace(/:7080/i,":7443")),f=f.replace(/http:/i,"https:"));return f}if(-1!==
b.toLowerCase().indexOf("premium.arcgisonline.com"))return"https://premium.arcgisonline.com/server/tokens"},_getPortalSelf:function(a,b){"https:"===window.location.protocol?a=a.replace(/^http:/i,"https:").replace(/:7080/i,":7443"):/^http:/i.test(b)&&(a=a.replace(/^https:/i,"http:").replace(/:7443/i,":7080"));return x({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"},{crossOrigin:!1,disableIdentityLookup:!0})},_hasPortalSession:function(){return!!this._getEsriAuthCookie()},_getEsriAuthCookie:function(){var a;
if(g.isSupported()){var b=this._getAllCookies("esri_auth"),c;for(c=0;c<b.length;c++){var e=d.fromJson(b[c]);if(e.portalApp){a=e;break}}}return a},_getAllCookies:function(a){var b=[],c=document.cookie.match(RegExp("(?:^|; )"+m.escapeString(a)+"\x3d([^;]*)","g"));if(c)for(a=0;a<c.length;a++){var d=c[a],e=d.indexOf("\x3d");-1<e&&(d=d.substring(e+1),b.push(decodeURIComponent(d)))}return b},_doPortalSignIn:function(a){if(g.isSupported()){var b=this._getEsriAuthCookie(),c=this._portalConfig,d=window.location.href,
e=this.findServerInfo(a);if(this.useSignInPage&&(c||this._isPortalDomain(d)||b)&&(e?e.hasPortal||e.owningSystemUrl&&this._isPortalDomain(e.owningSystemUrl):this._isPortalDomain(a))&&(this._isIdProvider(d,a)||c&&(t.hasSameOrigin(c.restBaseUrl,a,!0)||this._isIdProvider(c.restBaseUrl,a))||t.hasSameOrigin(d,a,!0)))return!0}return!1},_checkProtocol:function(a,c,d,e){var f=!0;e=e?c.adminTokenServiceUrl:c.tokenServiceUrl;if(0===k.trim(e).toLowerCase().indexOf("https:")&&0!==window.location.href.toLowerCase().indexOf("https:")&&
(!q.defaults.io.useCors||!t.canUseXhr(e)&&!t.canUseXhr(t.getProxyUrl(!0).path)))f=this._protocolFunc?!!this._protocolFunc({resourceUrl:a,serverInfo:c}):!1,f||(a=Error("Aborted the Sign-In process to avoid sending password over insecure connection."),a.code="IdentityManagerBase.4",a.log=b.isDebug,console.log(a.message),d(a));return f},_enqueue:function(a,b,d,e,f,g){e||(e=new c(u._dfdCanceller));e.resUrl_=a;e.sinfo_=b;e.options_=d;e.admin_=f;e.refresh_=g;this._busy?t.hasSameOrigin(a,this._busy.resUrl_,
!0)?this._soReqs.push(e):this._xoReqs.push(e):this._doSignIn(e);return e},_doSignIn:function(c){this._busy=c;var d=this,e=function(b){var e=c.options_&&c.options_.resource,f=c.resUrl_,g=c.refresh_,l=!1;-1===a.indexOf(d.credentials,b)&&(g&&-1!==a.indexOf(d.credentials,g)?(g.userId=b.userId,g.token=b.token,g.expires=b.expires,g.validity=b.validity,g.ssl=b.ssl,g.creationTime=b.creationTime,l=!0,b=g):d.credentials.push(b));b.resources||(b.resources=[]);b.resources.push(e||f);b.scope=d._isServerRsrc(f)?
"server":"portal";b.onTokenChange();var e=d._soReqs,m={};d._soReqs=[];a.forEach(e,function(a){if(!this._isIdenticalService(f,a.resUrl_)){var c=this._getSuffix(a.resUrl_);m[c]||(m[c]=!0,b.resources.push(a.resUrl_))}},d);c.callback(b);a.forEach(e,function(a){a.callback(b)});d._busy=c.resUrl_=c.sinfo_=c.refresh_=null;if(!l)d.onCredentialCreate({credential:b});d._soReqs.length&&d._doSignIn(d._soReqs.shift());d._xoReqs.length&&d._doSignIn(d._xoReqs.shift())},f=function(a){c.errback(a);d._busy=c.resUrl_=
c.sinfo_=c.refresh_=null;d._soReqs.length&&d._doSignIn(d._soReqs.shift());d._xoReqs.length&&d._doSignIn(d._xoReqs.shift())},g=function(a,g,l,m){var n=c.sinfo_,s=!c.options_||!1!==c.options_.prompt;d._doPortalSignIn(c.resUrl_)?(g=d._getEsriAuthCookie(),a=d._portalConfig,g?e(new F({userId:g.email,server:n.server,token:g.token,expires:null})):s?(s="",g=window.location.href,s=d.signInPage?d.signInPage:a?a.baseUrl+a.signin:d._isIdProvider(g,c.resUrl_)?d._getOrigin(g)+"/home/signin.html":n.tokenServiceUrl.replace(d._rePortalTokenSvc,
"")+"/home/signin.html",s=s.replace(/http:/i,"https:"),a&&!1===a.useSSL&&(s=s.replace(/https:/i,"http:")),0===g.toLowerCase().replace("https","http").indexOf(s.toLowerCase().replace("https","http"))?(n=Error("Cannot redirect to Sign-In page from within Sign-In page. URL of the resource that triggered this workflow: "+c.resUrl_),n.code="IdentityManagerBase.5",n.log=b.isDebug,f(n)):d._redirectFunc?d._redirectFunc({signInPage:s,returnUrlParamName:"returnUrl",returnUrl:g,resourceUrl:c.resUrl_,serverInfo:n}):
window.location=s+"?returnUrl\x3d"+window.escape(g)):(n=Error("User is not signed in."),n.code="IdentityManagerBase.6",n.log=b.isDebug,f(n))):a?e(new F({userId:a,server:n.server,token:l,expires:p.isDefined(m)?Number(m):null,ssl:!!g})):q?(a=q._oAuthCred,a||(g=new v(q,window.localStorage),l=new v(q,window.sessionStorage),g.isValid()&&l.isValid()?g.expires>l.expires?(a=g,l.destroy()):(a=l,g.destroy()):a=g.isValid()?g:l,q._oAuthCred=a),a.isValid()?e(new F({userId:a.userId,server:n.server,token:a.token,
expires:a.expires,ssl:a.ssl,_oAuthCred:a})):d._oAuthHash&&d._oAuthHash.state.portalUrl===q.portalUrl?(s=d._oAuthHash,n=new F({userId:s.username,server:n.server,token:s.access_token,expires:(new Date).getTime()+1E3*Number(s.expires_in),ssl:"true"===s.ssl,oAuthState:s.state,_oAuthCred:a}),a.storage=s.persist?window.localStorage:window.sessionStorage,a.token=n.token,a.expires=n.expires,a.userId=n.userId,a.ssl=n.ssl,a.save(),d._oAuthHash=null,e(n)):s?c._pendingDfd=d.oAuthSignIn(c.resUrl_,n,q,c.options_).addCallbacks(e,
f):(n=Error("User is not signed in."),n.code="IdentityManagerBase.6",n.log=b.isDebug,f(n))):s?d._checkProtocol(c.resUrl_,n,f,c.admin_)&&(s=c.options_,c.admin_&&(s=s||{},s.isAdmin=!0),c._pendingDfd=d.signIn(c.resUrl_,n,s).addCallbacks(e,f)):(n=Error("User is not signed in."),n.code="IdentityManagerBase.6",n.log=b.isDebug,f(n))},l=function(){var b=c.sinfo_,g=b.owningSystemUrl,l=c.options_,m,n,s;l&&(m=l.token,n=l.error);s=d._findCredential(g,{token:m,resource:c.resUrl_});!s&&z(b)&&a.some(d.credentials,
function(a){this._isIdProvider(g,a.server)&&(s=a);return!!s},d);s?(l=d.findCredential(c.resUrl_,s.userId))?e(l):G(b,d._legacyFed)?(l=s.toJson(),l.server=b.server,l.resources=null,e(new F(l))):(c._pendingDfd=d.generateToken(d.findServerInfo(s.server),null,{serverUrl:c.resUrl_,token:s.token,ssl:s.ssl})).addCallbacks(function(a){e(new F({userId:s.userId,server:b.server,token:a.token,expires:p.isDefined(a.expires)?Number(a.expires):null,ssl:!!a.ssl,isAdmin:c.admin_,validity:a.validity}))},f):(d._busy=
null,m&&(c.options_.token=null),(c._pendingDfd=d.getCredential(g.replace(/\/?$/,"/sharing"),{resource:c.resUrl_,token:m,error:n})).addCallbacks(function(a){d._enqueue(c.resUrl_,c.sinfo_,c.options_,c,c.admin_)},function(a){f(a)}))},m=c.sinfo_.owningSystemUrl,n=this._isServerRsrc(c.resUrl_),s=c.sinfo_._restInfoDfd,q=this._findOAuthInfo(c.resUrl_);s?s.addCallbacks(function(a){var b=c.sinfo_;b.adminTokenServiceUrl=b._restInfoDfd.adminUrl_;b._restInfoDfd=null;b.tokenServiceUrl=k.getObject("authInfo.tokenServicesUrl",
!1,a)||k.getObject("authInfo.tokenServiceUrl",!1,a)||k.getObject("tokenServiceUrl",!1,a);b.shortLivedTokenValidity=k.getObject("authInfo.shortLivedTokenValidity",!1,a);b.currentVersion=a.currentVersion;b.owningTenant=a.owningTenant;if(a=b.owningSystemUrl=a.owningSystemUrl)d._portals.push(a),!b.hasPortal&&t.hasSameOrigin(a,c.resUrl_,!0)&&(q||(b._selfDfd=d._getPortalSelf(a.replace(/\/?$/,"/sharing/rest/portals/self"),c.resUrl_)),b.hasPortal=!0);n&&a?l():g()},function(){c.sinfo_._restInfoDfd=null;var a=
Error("Unknown resource - could not find token service endpoint.");a.code="IdentityManagerBase.2";a.log=b.isDebug;f(a)}):n&&m?l():c.sinfo_._selfDfd?(m=function(a){c.sinfo_._selfDfd=null;var b=a&&a.user&&a.user.username,e=a&&a.allSSL;c.sinfo_.webTierAuth=!!b;b&&d.normalizeWebTierAuth?(c.sinfo_._tokenDfd=d.generateToken(c.sinfo_,null,{ssl:e}),a=function(a){c.sinfo_._tokenDfd=null;g(b,e,a&&a.token,a&&a.expires)},c.sinfo_._tokenDfd.then(a,a)):g(b,e)},c.sinfo_._selfDfd.then(m,m)):g()}});F=h(w,{declaredClass:"esri.Credential",
tokenRefreshBuffer:2,constructor:function(a){k.mixin(this,a);this.resources=this.resources||[];p.isDefined(this.creationTime)||(this.creationTime=(new Date).getTime())},_oAuthCred:null,refreshToken:function(){var b=this,c=this.resources&&this.resources[0],d=n.id.findServerInfo(this.server),e=d&&d.owningSystemUrl,f=!!e&&"server"===this.scope,g=f&&G(d,n.id._legacyFed),l=f&&n.id.findServerInfo(e),m,s=(m=d.webTierAuth)&&n.id.normalizeWebTierAuth,q=A[this.server],q=q&&q[this.userId],k={username:this.userId,
password:q},t;if(!m||s)if(f&&!l&&a.some(n.id.serverInfos,function(a){n.id._isIdProvider(e,a.server)&&(l=a);return!!l}),m=l&&n.id.findCredential(l.server,this.userId),!f||m)if(g)m.refreshToken();else{if(f)t={serverUrl:c,token:m&&m.token,ssl:m&&m.ssl};else if(s)k=null,t={ssl:this.ssl};else if(q)this.isAdmin&&(t={isAdmin:!0});else{var u;c&&(c=n.id._sanitizeUrl(c),this._enqueued=1,u=n.id._enqueue(c,d,null,null,this.isAdmin,this),u.addCallback(function(){b._enqueued=0;b.refreshServerTokens()}).addErrback(function(){b._enqueued=
0}));return u}return n.id.generateToken(f?l:d,f?null:k,t).addCallback(function(a){b.token=a.token;b.expires=p.isDefined(a.expires)?Number(a.expires):null;b.creationTime=(new Date).getTime();b.validity=a.validity;b.onTokenChange();b.refreshServerTokens()}).addErrback(function(){})}},refreshServerTokens:function(){"portal"===this.scope&&a.forEach(n.id.credentials,function(a){var b=n.id.findServerInfo(a.server),c=b&&b.owningSystemUrl;if(a!==this&&a.userId===this.userId&&c&&"server"===a.scope&&(t.hasSameOrigin(this.server,
c,!0)||n.id._isIdProvider(c,this.server)))G(b,n.id._legacyFed)?(a.token=this.token,a.expires=this.expires,a.creationTime=this.creationTime,a.validity=this.validity,a.onTokenChange()):a.refreshToken()},this)},onTokenChange:function(a){clearTimeout(this._refreshTimer);var b=this.server&&n.id.findServerInfo(this.server),c=(b=b&&b.owningSystemUrl)&&n.id.findServerInfo(b);!1!==a&&((!b||"portal"===this.scope||c&&c.webTierAuth&&!n.id.normalizeWebTierAuth)&&(p.isDefined(this.expires)||p.isDefined(this.validity)))&&
this._startRefreshTimer()},onDestroy:function(){},destroy:function(){this.userId=this.server=this.token=this.expires=this.validity=this.resources=this.creationTime=null;this._oAuthCred&&(this._oAuthCred.destroy(),this._oAuthCred=null);var b=a.indexOf(n.id.credentials,this);-1<b&&n.id.credentials.splice(b,1);this.onTokenChange();this.onDestroy()},toJson:function(){return this._toJson()},_toJson:function(){var a=p.fixJson({userId:this.userId,server:this.server,token:this.token,expires:this.expires,
validity:this.validity,ssl:this.ssl,isAdmin:this.isAdmin,creationTime:this.creationTime,scope:this.scope}),b=this.resources;b&&0<b.length&&(a.resources=b);return a},_startRefreshTimer:function(){clearTimeout(this._refreshTimer);var a=6E4*this.tokenRefreshBuffer,b=(this.validity?this.creationTime+6E4*this.validity:this.expires)-(new Date).getTime();0>b&&(b=0);this._refreshTimer=setTimeout(k.hitch(this,this.refreshToken),b>a?b-a:b)}});B.Credential=F;f("extend-esri")&&(n.IdentityManagerBase=B);return B})},
"dojo/Stateful":function(){define(["./_base/declare","./_base/lang","./_base/array","./when"],function(h,b,k,a){return h("dojo.Stateful",null,{_attrPairNames:{},_getAttrNames:function(a){var b=this._attrPairNames;return b[a]?b[a]:b[a]={s:"_"+a+"Setter",g:"_"+a+"Getter"}},postscript:function(a){a&&this.set(a)},_get:function(a,b){return"function"===typeof this[b.g]?this[b.g]():this[a]},get:function(a){return this._get(a,this._getAttrNames(a))},set:function(b,d){if("object"===typeof b){for(var e in b)b.hasOwnProperty(e)&&
"_watchCallbacks"!=e&&this.set(e,b[e]);return this}e=this._getAttrNames(b);var f=this._get(b,e);e=this[e.s];var g;"function"===typeof e?g=e.apply(this,Array.prototype.slice.call(arguments,1)):this[b]=d;if(this._watchCallbacks){var l=this;a(g,function(){l._watchCallbacks(b,f,d)})}return this},_changeAttrValue:function(a,b){var e=this.get(a);this[a]=b;this._watchCallbacks&&this._watchCallbacks(a,e,b);return this},watch:function(a,b){var e=this._watchCallbacks;if(!e)var f=this,e=this._watchCallbacks=
function(a,b,c,d){var g=function(d){if(d){d=d.slice();for(var e=0,g=d.length;e<g;e++)d[e].call(f,a,b,c)}};g(e["_"+a]);d||g(e["*"])};!b&&"function"===typeof a?(b=a,a="*"):a="_"+a;var g=e[a];"object"!==typeof g&&(g=e[a]=[]);g.push(b);var l={};l.unwatch=l.remove=function(){var a=k.indexOf(g,b);-1<a&&g.splice(a,1)};return l}})})},"arcgisonline/init":function(){define(["dijit","dojo","dojox","dojo/require!dojo/DeferredList"],function(h,b,k){b.provide("arcgisonline.init");b.require("dojo.DeferredList");
b.mixin(arcgisonline.init,{labels:null,feeds:[],currentFeed:null,allSSL:!1,isOrg:!1,isSingleTenant:!1,settings:null,loadLabels:function(){var a=arcgisonline.init;a.labels=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(a.labels,b.i18n.getLocalization("arcgisonline","arcgisonline").homePage);b.attr("viewerLink","innerHTML",a.labels.viewerLink);b.attr("viewerDescription","innerHTML",a.labels.viewerDescription);b.attr("signUpLink","innerHTML",a.labels.signUpLink);b.attr("signUpDescription",
"innerHTML",a.labels.signUpDescription);b.attr("featuredVideosLink","innerHTML",a.labels.featuredVideosLink);b.attr("featuredVideosDescription","innerHTML",a.labels.featuredVideosDescription);b.attr("lnkExplore","innerHTML",esri.isiPhone||esri.isAndroid?a.labels.appLink:a.labels.explorerLink);b.attr("pExplore","innerHTML",esri.isiPhone||esri.isAndroid?a.labels.appDescription:a.labels.explorerDescription);b.attr("signUpImg","alt",a.labels.signUpLink);b.attr("signUpImg","title",a.labels.signUpLink);
b.attr("mapImg","alt",a.labels.viewerLink);b.attr("mapImg","title",a.labels.viewerLink);b.attr("developersImg","alt",a.labels.explorerLink);b.attr("developersImg","title",a.labels.explorerLink);b.attr("videosImg","alt",a.labels.featuredVideosLink);b.attr("videosImg","title",a.labels.featuredVideosLink)},initialize:function(){var a=arcgisonline.init;esri.i18nBundle=b.i18n.getLocalization("arcgisonline","arcgisonline");a.loadLabels();b.byId("logoImg")&&b.attr("logoImg","src",arcgisonline.sharing.util.relativeToExplicitUrl("images/logo-pod.jpg"));
var c=arcgisonline.sharing.dijit.HelpManager.prototype.statics.getInstance();b.connect(c,"onLoad",b.hitch(this,function(){b.byId("featuredVideosLink").href=c.getHelpUrl("120000461")}));a.isSingleTenant=void 0!==esriGeowConfig.isMultiTenant&&null!==esriGeowConfig.isMultiTenant&&!1===esriGeowConfig.isMultiTenant;var d=arcgisonline.sharing.util.getUser();if(a.isSingleTenant||d&&d.accountId)a.isOrg=!0,(d=b.byId("headerTitle"))&&d.parentNode.removeChild(d);arcgisonline.sharing.geow.Account.getSelf(b.hitch(a,
arcgisonline.init.initPage),b.hitch(arcgisonline.init,arcgisonline.init.initPage))},overrideSettings:function(a){var c=arcgisonline.init;c.settings=a;c.isPortal=arcgisonline.sharing.util.isPortal();if(c.settings.id&&0<c.settings.id.length){c.isOrg=!0;var d=b.byId("headerTitle");d&&d.parentNode.removeChild(d)}c.isPortal&&c.getFederatedServers();a.allSSL&&(c.allSSL=a.allSSL);a.portalName&&(esriGeowConfig.portalName=a.portalName);a.portalHostname&&(esriGeowConfig.portalHostname=a.portalHostname);a.portalHeaderImage&&
(esriGeowConfig.portalHeaderImage=a.portalHeaderImage);a.homePageFeaturedContent?esriGeowConfig.homePageFeaturedContent=a.homePageFeaturedContent:c.isOrg&&(esriGeowConfig.homePageFeaturedContent=null);esri.isDefined(a.homePageFeaturedContentCount)&&(esriGeowConfig.homePageFeaturedContentCount=a.homePageFeaturedContentCount);if(a.rotatorPanels)if(c.isOrg){esriGeowConfig.rotatorPanels=a.rotatorPanels;for(var d=esriGeowConfig.rotatorPanels,e,f,g,l=0;l<d.length;l++)e=d[l],c.isPortal&&("7443"===location.port&&
-1===esriGeowConfig.self.portalHostname.indexOf(":7443"))&&(f=RegExp(esriGeowConfig.self.portalHostname,"gi"),f.test(e.innerHTML)&&(g=esriGeowConfig.self.portalHostname.split("/"),g[0]+=":7443",g[1]="arcgis",e.innerHTML=e.innerHTML.replace(f,g.join("/")))),d[l].innerHTML=e.innerHTML.replace(/CDN_SERVER/gi,esriGeowConfig.cdnServerUrl)}else b.create("div",{id:"homeCalciteBanner"},b.byId("matrixLayout")),b.addClass(b.byId("details"),"calcite_home calcite_home_details"),b.addClass(b.byId("matrixLayout"),
"calcite_home calcite_home_matrixLayout"),b.addClass(b.byId("homeCalciteBanner"),"calcite_home calcite_home_banner"),b.addClass(b.byId("featuredMaps"),"calcite_home calcite_home_featuredMaps"),b.addClass(b.byId("bottomContent"),"calcite_home calcite_home_bottomContent");else c.isOrg&&(esriGeowConfig.rotatorPanels=null);c=a.showHomePageDescription;esriGeowConfig.showHomePageDescription=void 0!==c&&null!==c?a.showHomePageDescription:!1},getFederatedServers:function(){var a=arcgisonline.sharing.util.getUser();
!esriGeowConfig.federatedServers&&a&&arcgisonline.sharing.util.request({url:esriGeowConfig.restBaseUrl+"portals/"+esriGeowConfig.self.id+"/servers"}).then(b.hitch(this,function(a){esriGeowConfig.federatedServers=a.servers}))},initOrganization:function(){var a=arcgisonline.init;esri.hide(b.byId("bottomSection"));if(esriGeowConfig.explorerOnline){var c="http://developers.arcgis.com",d=a.labels.explorerLink,e=a.labels.explorerDescription;a.isSingleTenant&&(c=esriGeowConfig.explorerOnline,d=a.labels.explorerLinkPortal,
e=a.labels.explorerDescriptionPortal);b.create("div",{id:"appOrgDiv",innerHTML:'\x3ch2 id\x3d"h2Explore"\x3e\x3ca id\x3d"lnkExplore" class\x3d"explorerLink" href\x3d"'+c+'" target\x3d"_blank" \x3e'+d+'\x3c/a\x3e\x3c/h2\x3e\x3cp id\x3d"pExplore"\x3e'+e+"\x3c/p\x3e"},b.byId("topRow2"))}var c=a.settings.name,d=a.settings.description,e=esriGeowConfig.showHomePageDescription,e=void 0!==e&&null!==e&&!1===e?!1:!0,f=esri.isDefined(d)&&"\x3cbr/\x3e"!==d&&"\x3cbr /\x3e"!==d&&""!==d;if(f&&e)b.attr(b.byId("orgDetails"),
"innerHTML",d),esri.show(b.byId("organizationSection"));else if(arcgisonline.sharing.util.isPortal()&&!f&&!e){var g=esriGeowConfig.self.helpBase.replace("/website/","/admin/"),g=a.settings.allSSL?arcgisonline.sharing.util.getSecureUrl(g):arcgisonline.sharing.util.getHttpUrl(g);esri.request({url:g+"cxhelp.js"}).then(b.hitch(this,function(c){c='\x3cspan class\x3d"esriItemLinks"\x3e\x3ca href\x3d"'+(g+c.m["120000837"])+'" target\x3d"_blank"\x3e';b.attr(b.byId("orgDetails"),"innerHTML",esri.substitute({linkStart:c,
linkEnd:"\x3c/a\x3e\x3c/span\x3e"},a.labels.portalDefaultDesc));esri.show(b.byId("organizationSection"))}))}d=(d=arcgisonline.sharing.util.getToken())?"?token\x3d"+d:"";e=a.settings.backgroundImage;esri.isDefined(e)?"none"!==e?0===e.indexOf("images/")?b.query("body").addClass("defaultBackground"):(e=esriGeowConfig.restBaseUrl+"portals/self/resources/"+e+d,f=b.query("body.esri")[0],b.style(f,"backgroundImage","url('"+e+"')"),b.style(f,"backgroundPosition","top center"),b.style(f,"backgroundRepeat",
"repeat-x")):b.query("body").addClass("calciteBackground"):b.query("body").addClass("calciteBackground");if(esriGeowConfig.rotatorPanels){b.addClass(b.byId("matrixLayout"),"matrixLayoutShort");b.addClass(b.byId("details"),"detailsShort");c=arcgisonline.sharing.util.getToken();e=esriGeowConfig.rotatorPanels;for(f=0;f<e.length;f++)d=e[f],d.id&&(d.innerHTML=a.allSSL||a.isPortal&&"https:"===location.protocol?d.innerHTML.replace("http:","https:"):d.innerHTML.replace("https:","http:")),e[f].innerHTML=d.innerHTML.replace(/CDN_SERVER/gi,
esriGeowConfig.cdnServerUrl),e[f].innerHTML=d.innerHTML.replace("SECURITY_TOKEN",c?c:"");a.createRotator(e)}else e=esriGeowConfig.portalHeaderImage?esriGeowConfig.portalHeaderImage:arcgisonline.sharing.util.relativeToExplicitUrl("images/organizationSplash.jpg"),b.create("img",{id:"headerImage",src:e},b.byId("matrixLayout")),b.addClass(b.byId("headerImage"),"portalImage"),b.create("div",{id:"logoDisplay"},b.byId("matrixLayout")),e="",a.settings&&a.settings.thumbnail&&(e=esriGeowConfig.restBaseUrl+
"portals/self/resources/"+a.settings.thumbnail+d,b.create("img",{src:e,alt:c},b.byId("logoDisplay"))),b.create("span",{innerHTML:c},b.byId("logoDisplay")),b.addClass(b.byId("matrixLayout"),"matrixLayoutShort"),b.addClass(b.byId("details"),"detailsShort")},initPage:function(a,c){var d=arcgisonline.init;a&&(!a.code&&!a.message)&&d.overrideSettings(a);if(d.isOrg)document.title=d.settings.name;else if(document.title=esriGeowConfig.portalName||d.labels.arcgis,b.query("body").addClass("defaultBackground"),
esriGeowConfig.portalHeaderImage){var e=b.byId("headerTitle");e&&e.parentNode.removeChild(e);b.create("img",{id:"headerImage",src:esriGeowConfig.portalHeaderImage},b.byId("matrixLayout"));b.addClass(b.byId("headerImage"),"portalImage")}else d.createRotator(esriGeowConfig.rotatorPanels);e="";-1===esriGeowConfig.signin.indexOf("http")?(e=esriGeowConfig.baseUrl+esriGeowConfig.signin,!1!==esriGeowConfig.useSSL&&(e=e.replace("http:","https:"))):e=esriGeowConfig.signin;b.query(".signUpLink").attr("href",
e);esriGeowConfig.explorerOnline?b.query(".explorerLink").attr("href","http://developers.arcgis.com"):(b.style(b.byId("bottom3Grid"),"display","none"),b.removeClass(b.byId("bottomRow2"),"middle"),b.addClass(b.byId("bottomRow2"),"last"),b.addClass(b.byId("bottom2Grid"),"grid_6"),b.addClass(b.byId("bottom1Grid"),"grid_6"));b.style("page-border","visibility","visible");esriGeowConfig.homePageFeaturedContent?d.getGroup(esriGeowConfig.homePageFeaturedContent):esri.hide(b.byId("featuredMaps"));d.isOrg?
d.initOrganization():d.initGoogleAPI();var f,e=-1!==navigator.userAgent.indexOf("Kindle Fire")||-1!==navigator.userAgent.indexOf("Silk-Accelerated")||-1!==navigator.userAgent.indexOf("Kindle/");if(esri.isiPhone||esri.isAndroid||e)f=b.create("a",{"class":"divAppLink"},d.isOrg?"appOrgDiv":"appDiv","last"),b.attr("lnkExplore","innerHTML",esri.isiPhone||esri.isAndroid||e?d.labels.appLink:d.labels.explorerLink),b.attr("pExplore","innerHTML",esri.isiPhone||esri.isAndroid||e?d.labels.appDescription:d.labels.explorerDescription);
esri.isiPhone?(b.attr("lnkExplore","href","http://itunes.apple.com/us/app/arcgis/id379687930"),b.attr(f,"href","http://itunes.apple.com/us/app/arcgis/id379687930"),b.create("div",{"class":"iosAppIcon esriAlignLeading"},f)):e?(b.attr("lnkExplore","href","http://www.amazon.com/gp/product/B007OWF3BI/ref\x3dmas_pm_ArcGIS"),b.attr(f,"href","http://www.amazon.com/gp/product/B007OWF3BI/ref\x3dmas_pm_ArcGIS"),b.create("div",{"class":"amazonAppIcon esriAlignLeading"},f)):esri.isAndroid&&(b.attr("lnkExplore",
"href","https://play.google.com/store/apps/details?id\x3dcom.esri.android.client"),b.attr(f,"href","https://play.google.com/store/apps/details?id\x3dcom.esri.android.client"),b.create("div",{"class":"androidAppIcon esriAlignLeading"},f))},createRotator:function(a){var c=new k.widget.AutoRotator({transition:"dojox.widget.rotator.crossFade",duration:1E4,panes:a,autoStart:!0,pauseOnManualChange:!0,cycles:12,suspendOnHover:!0},b.byId("imgRotator"));new k.widget.rotator.Controller({rotator:c,commands:"#"},
b.byId("categories"));a&&1===a.length&&b.style("categories","display","none")},initGoogleAPI:function(){var a=document.createElement("script");a.src=location.protocol+"//www.google.com/jsapi?key\x3dABQIAAAAmO-VQth3Y6KB46-ZxGr_nBSQ8kgDO2SNhVovJIFNetyD-K9YDhTGHU-P9PYC3aMlIhJ1u_jDcPv_Jw\x26callback\x3darcgisonline.init.initFeed";a.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(a)},initFeed:function(){google.load("feeds","1",{callback:arcgisonline.init.LoadDynamicFeed})},
LoadDynamicFeed:function(){var a=arcgisonline.init;if(!a.isOrg){var b=new google.feeds.Feed("http://feeds.feedburner.com/arcgiscomnewsfeed");b.setNumEntries(50);b.load(a.formatFeedCallback)}},formatFeedCallback:function(a){var c=arcgisonline.init;a.error||(b.forEach(a.feed.entries,function(a){var e=b.date.locale.format(new Date(a.publishedDate),{selector:"date",formatLength:"medium"});c.feeds.push("\x3cdiv\x3e\x3ch2 class\x3d'ellipsis'\x3e\x3ca href\x3d'"+a.link+"'\x3e"+a.title+"\x3c/a\x3e\x3c/h2\x3e\x3c/div\x3e\x3cdiv style\x3d'padding-bottom:4px;' id\x3d'date'\x3e"+
e+"\x3c/div\x3e\x3cdiv class\x3d'feedSnippet'\x3e"+a.contentSnippet+"\x3c/div\x3e")}),c.currentFeed=0)},getNextFeed:function(){var a=arcgisonline.init;-1<=a.currentFeed&&a.currentFeed<a.feeds.length-1?(a.currentFeed+=1,b.byId("feeds").innerHTML=a.feeds[a.currentFeed]):(a.currentFeed=-1,a.getNextFeed())},getPreviousFeed:function(){var a=arcgisonline.init;a.currentFeed<=a.feeds.length&&0<a.currentFeed?(a.currentFeed-=1,b.byId("feeds").innerHTML=a.feeds[a.currentFeed]):(a.currentFeed=a.feeds.length,
a.getPreviousFeed())},getNextElementSibling:function(a){if(a.nextElementSibling)return a.nextElementSibling;for(;a.nextSibling;){if(1===a.nextSibling.nodeType)return a.nextSibling;a=a.nextSibling}},getGroup:function(a){a={q:a,f:"json",ts:(new Date).getTime()};arcgisonline.sharing.util.request({url:esriGeowConfig.restBaseUrl+"community/groups",content:a}).then(b.hitch(arcgisonline.init,arcgisonline.init.getGroupContent),b.hitch(arcgisonline.init,arcgisonline.init.getGroupContent))},getGroupContent:function(a){if(!a||
!a.results||!a.results[0])console.log("unable to fetch group",arguments),esri.hide(b.byId("featuredMaps"));else{for(var c=0,d=a.results[c];a.results.length>c+1&&!(-1<a.query.indexOf('"'+d.title+'"'));)c++,d=a.results[c];b.byId("galleryTitle").innerHTML=d.title;0===esriGeowConfig.homePageFeaturedContentCount?this.showAllGroupItems(d):(c={q:"group:"+d.id+' -(type:"Code Attachment" OR type:"Windows Viewer Add In" OR type:"Windows Viewer Configuration")',f:"json",num:esriGeowConfig.homePageFeaturedContentCount,
sortField:d.sortField?d.sortField:"modified",sortOrder:d.sortOrder?d.sortOrder:"desc",ts:(new Date).getTime()},arcgisonline.sharing.util.request({url:esriGeowConfig.restBaseUrl+"search",content:c}).then(b.hitch(arcgisonline.init,arcgisonline.init.createGallery),function(a){console.log("unable to fetch group content",arguments)}))}},showAllGroupItems:function(a){var c={q:"group:"+a.id+' -(type:"Code Attachment" OR type:"Windows Viewer Add In" OR type:"Windows Viewer Configuration")',f:"json",num:100,
sortField:a.sortField?a.sortField:"modified",sortOrder:a.sortOrder?a.sortOrder:"desc",ts:(new Date).getTime()};arcgisonline.sharing.util.request({url:esriGeowConfig.restBaseUrl+"search",content:c}).then(b.hitch(this,function(a){var e={results:a.results},f=0,f=0;if(0<a.nextStart){var f=a.total-a.results.length,f=Math.ceil(f/100),g=[];a=a.nextStart;for(var l=0;l<f;l++)c.start=a+100*l,g.push(arcgisonline.sharing.util.request({url:esriGeowConfig.restBaseUrl+"search",content:c}));(new b.DeferredList(g)).then(b.hitch(this,
function(a){b.forEach(a,b.hitch(this,function(a){a[1]&&a[1].results&&(e.results=e.results.concat(a[1].results))}));this.createGallery(e)}),b.hitch(this,function(a){console.log("error fetching further group content",a);this.createGallery(e)}))}else this.createGallery(e)}),function(a){console.log("unable to fetch group content",arguments)})},createGallery:function(a,c){var d,e=a.results;d=new arcgisonline.sharing.dijit.Gallery({nodesPerPage:4,showThumbnailInDetails:!1,showToolTip:!1,showPageControls:!1,
fadeOutOtherNodes:!0,noResultsMessage:"\x3cp class\x3d'esriItemLinks'\x3e\x3cspan\x3e"+arcgisonline.init.labels.noGalleryItems+"\x3c/span\x3e\x3c/p\x3e"},"gallery");b.connect(d,"onContentChange",function(){e.length<=d.nodesPerPage&&(esriGeowConfig.isRightToLeft?(b.removeClass("next","prevButtonEnabled"),b.addClass("next","prevButtonDisabled")):(b.removeClass("next","nextButtonEnabled"),b.addClass("next","nextButtonDisabled")))});d.set("items",e);esriGeowConfig.isRightToLeft?(b.connect(b.byId("prev"),
"onclick",d,d.nextPage),b.connect(b.byId("next"),"onclick",d,d.prevPage),b.removeClass("next","nextButtonEnabled"),b.addClass("next","nextButtonDisabled")):(b.connect(b.byId("prev"),"onclick",d,d.prevPage),b.connect(b.byId("next"),"onclick",d,d.nextPage),b.removeClass("prev","prevButtonEnabled"),b.addClass("prev","prevButtonDisabled"));b.connect(d,"onPageChange",function(a){esriGeowConfig.isRightToLeft?(1===a?(b.removeClass("next","nextButtonEnabled"),b.addClass("next","nextButtonDisabled")):(b.removeClass("next",
"nextButtonDisabled"),b.addClass("next","nextButtonEnabled")),a===d.pageCount?(b.removeClass("prev","prevButtonEnabled"),b.addClass("prev","prevuttonDisabled")):(b.removeClass("prev","prevButtonDisabled"),b.addClass("prev","prevButtonEnabled"))):(1===a?(b.removeClass("prev","prevButtonEnabled"),b.addClass("prev","prevButtonDisabled")):(b.removeClass("prev","prevButtonDisabled"),b.addClass("prev","prevButtonEnabled")),a===d.pageCount?(b.removeClass("next","nextButtonEnabled"),b.addClass("next","nextButtonDisabled")):
(b.removeClass("next","nextButtonDisabled"),b.addClass("next","nextButtonEnabled")))});b.connect(d,"onNodeMouseEnter",function(a,c){var d=arcgisonline.sharing.util.getHomePageGalleryLinkInfo(c),e=!1;if(d.href&&(-1<d.href.toLowerCase().indexOf("javascript")&&c.url)&&("Web Mapping Application"===c.type||"Mobile Application"===c.type||"Document Link"===c.type))d.href=c.url,e=!0;"CityEngine Web Scene"===c.type&&(e=!0);b.query("a",a.currentTarget).forEach(function(a){b.attr(a,"href",d.href);b.attr(a,"target",
e?"_blank":"")})})}})})},"dijit/form/ComboButton":function(){define("dojo/_base/declare dojo/keys ../focus ./DropDownButton dojo/text!./templates/ComboButton.html ../a11yclick".split(" "),function(h,b,k,a,c){return h("dijit.form.ComboButton",a,{templateString:c,_setIdAttr:"",_setTabIndexAttr:["focusNode","titleNode"],_setTitleAttr:"titleNode",optionsTitle:"",baseClass:"dijitComboButton",cssStateNodes:{buttonNode:"dijitButtonNode",titleNode:"dijitButtonContents",_popupStateNode:"dijitDownArrowButton"},
_focusedNode:null,_onButtonKeyDown:function(a){if(a.keyCode==b[this.isLeftToRight()?"RIGHT_ARROW":"LEFT_ARROW"])k.focus(this._popupStateNode),a.stopPropagation(),a.preventDefault()},_onArrowKeyDown:function(a){if(a.keyCode==b[this.isLeftToRight()?"LEFT_ARROW":"RIGHT_ARROW"])k.focus(this.titleNode),a.stopPropagation(),a.preventDefault()},focus:function(a){this.disabled||k.focus("start"==a?this.titleNode:this._popupStateNode)}})})},"arcgisonline/sharing/dijit/dialog/TermsOfUseDlg":function(){define(["dijit",
"dojo","dojox","dojo/require!dijit/_Widget,dijit/_Templated,arcgisonline/sharing/util,dijit/Dialog"],function(h,b,k){b.provide("arcgisonline.sharing.dijit.dialog.TermsOfUseDlg");b.require("dijit._Widget");b.require("dijit._Templated");b.require("arcgisonline.sharing.util");b.require("dijit.Dialog");b.declare("arcgisonline.sharing.dijit.dialog.TermsOfUseDlg",[h._Widget,h._Templated],{util:arcgisonline.sharing.util,widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContainer"\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit.Dialog" id\x3d"terms-of-use-dialog" title\x3d"${i18n.title}" execute\x3d"" style\x3d"overflow-y:auto;"\x3e\r\n    \x3cform id\x3d"terms-of-use-form" method\x3d"POST" action\x3d"" style\x3d"height:100%;overflow-y:auto;padding-left:10px;"\x3e\r\n      \x3cdiv style\x3d"height:30px; text-align:center;"\x3e\r\n        \x3cspan style\x3d"font-size:1.1em; font-weight:bold"\x3e${i18n.termsOfUseTitle}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-type\x3d"dijit.layout.ContentPane" id\x3d"tos" style\x3d"background:#FFF;border:solid 1px #000;overflow-x:hidden;overflow-y:hidden;width:400px;height:250px;"\x3e\r\n        \x3ca href\x3d\'\'\x3e\x3c/a\x3e\r\n        \x3ciframe id\x3d"termsFrame" src\x3d"termsofuse.html" style\x3d"width:100%;height:250px;max-width:100%;max-height:250px;"\x3e\x3c/iframe\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv style\x3d"padding-top:10px;"\x3e\r\n        \x3cspan class\x3d"esriItemLinks"\x3e\x3ca href\x3d"http://www.esri.com/legal/software-license" target\x3d"_blank"\x3e${i18n.otherLanguages}\x3c/a\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv style\x3d"height:40px; padding-top:10px;"\x3e\r\n        \x3cbutton id\x3d"button_accept" type\x3d"submit" class\x3d"primary" data-dojo-type\x3d"dijit.form.Button"\x3e\r\n            ${i18n.accept}\r\n        \x3c/button\x3e\r\n        \x3cbutton id\x3d"button_decline" class\x3d"jevent cancel" type\x3d"cancel" data-dojo-type\x3d"dijit.form.Button"\x3e\r\n            ${i18n.noaccept}\r\n        \x3c/button\x3e\r\n      \x3c/div\x3e\r\n    \x3c/form\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
_firstLoad:!0,statics:{_instance:null,getInstance:function(){null==this._instance&&(this._instance=new arcgisonline.sharing.dijit.dialog.TermsOfUseDlg);return this._instance}},postMixInProperties:function(){this.inherited(arguments);this.i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").termsOfUseDlg)},postCreate:function(){this.loadConnections()},show:function(a){h.byId("terms-of-use-dialog").show();esri.isTouchEnabled?
(b.style(b.byId("terms-of-use-dialog"),"width","500px"),b.style(b.byId("tos"),"width","455px"),b.style(b.byId("tos"),"overflow-y","scroll")):this._firstLoad&&(b.style(b.byId("terms-of-use-dialog"),"width","455px"),b.isFF||10>b.isIE?(b.isFF&&b.style(b.byId("tos"),"height",parseInt(b.style(b.byId("terms-of-use-dialog"),"height"))-169+"px"),9>b.isIE&&b.style(b.byId("tos"),"height",parseInt(b.style(b.byId("terms-of-use-dialog"),"height"))-208+"px"),8>b.isIE&&b.style(b.byId("tos"),"height",parseInt(b.style(b.byId("terms-of-use-dialog"),
"height"))-133+"px")):b.style(b.byId("tos"),"height",parseInt(b.style(b.byId("terms-of-use-dialog"),"height"))-169+"px"),b.style(b.byId("terms-of-use-form"),"overflow-y","hidden"),this._firstLoad=!1)},loadConnections:function(){b.query(".jevent").connect("onclick",function(a){a.preventDefault()});b.connect(b.byId("button_decline"),"onclick",this,"declineTerms");b.connect(b.byId("terms-of-use-form"),"onsubmit",this,"registerUser")},hide:function(){h.byId("terms-of-use-dialog").hide()},registerUser:function(a){a.preventDefault();
this.hide();b.publish("registerUser",["true"])},declineTerms:function(a){a.preventDefault();this.hide();b.publish("declineTermsOfUse",["true"])}})})},"dijit/form/_AutoCompleterMixin":function(){define("dojo/aspect dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/query dojo/regexp dojo/sniff ./DataList ./_TextBoxMixin ./_SearchMixin".split(" "),function(h,b,k,a,c,d,e,f,g,l,m){b=b("dijit.form._AutoCompleterMixin",m,{item:null,autoComplete:!0,highlightMatch:"first",labelAttr:"",labelType:"text",
maxHeight:-1,_stopClickEvents:!1,_getCaretPos:function(a){var b=0;if("number"==typeof a.selectionStart)b=a.selectionStart;else if(f("ie")){var c=a.ownerDocument.selection.createRange().duplicate();a=a.createTextRange();c.move("character",0);a.move("character",0);try{a.setEndPoint("EndToEnd",c),b=String(a.text).replace(/\r/g,"").length}catch(d){}}return b},_setCaretPos:function(a,b){b=parseInt(b);l.selectInputText(a,b,b)},_setDisabledAttr:function(a){this.inherited(arguments);this.domNode.setAttribute("aria-disabled",
a?"true":"false")},_onKey:function(b){if(!(32<=b.charCode)){var c=b.charCode||b.keyCode;if(!(c==a.ALT||c==a.CTRL||c==a.META||c==a.SHIFT)){var d=this.dropDown,e=null;this._abortQuery();this.inherited(arguments);if(!b.altKey&&!b.ctrlKey&&!b.metaKey)switch(this._opened&&(e=d.getHighlightedOption()),c){case a.PAGE_DOWN:case a.DOWN_ARROW:case a.PAGE_UP:case a.UP_ARROW:this._opened&&this._announceOption(e);b.stopPropagation();b.preventDefault();break;case a.ENTER:if(e){if(e==d.nextButton){this._nextSearch(1);
b.stopPropagation();b.preventDefault();break}else if(e==d.previousButton){this._nextSearch(-1);b.stopPropagation();b.preventDefault();break}b.stopPropagation();b.preventDefault()}else this._setBlurValue(),this._setCaretPos(this.focusNode,this.focusNode.value.length);case a.TAB:c=this.get("displayedValue");if(d&&(c==d._messages.previousMessage||c==d._messages.nextMessage))break;e&&this._selectOption(e);case a.ESCAPE:this._opened&&(this._lastQuery=null,this.closeDropDown())}}}},_autoCompleteText:function(a){var b=
this.focusNode;l.selectInputText(b,b.value.length);var c=this.ignoreCase?"toLowerCase":"substr";0==a[c](0).indexOf(this.focusNode.value[c](0))?(c=this.autoComplete?this._getCaretPos(b):b.value.length,c+1>b.value.length&&(b.value=a,l.selectInputText(b,c))):(b.value=a,l.selectInputText(b))},_openResultList:function(a,b,d){var e=this.dropDown.getHighlightedOption();this.dropDown.clearResultList();!a.length&&0==d.start?this.closeDropDown():(this._nextSearch=this.dropDown.onPage=c.hitch(this,function(b){a.nextPage(-1!==
b);this.focus()}),this.dropDown.createOptions(a,d,c.hitch(this,"_getMenuLabelFromItem")),this._showResultList(),"direction"in d?(d.direction?this.dropDown.highlightFirstOption():d.direction||this.dropDown.highlightLastOption(),e&&this._announceOption(this.dropDown.getHighlightedOption())):this.autoComplete&&(!this._prev_key_backspace&&!/^[*]+$/.test(b[this.searchAttr].toString()))&&this._announceOption(this.dropDown.containerNode.firstChild.nextSibling))},_showResultList:function(){this.closeDropDown(!0);
this.openDropDown();this.domNode.setAttribute("aria-expanded","true")},loadDropDown:function(){this._startSearchAll()},isLoaded:function(){return!1},closeDropDown:function(){this._abortQuery();this._opened&&(this.inherited(arguments),this.domNode.setAttribute("aria-expanded","false"))},_setBlurValue:function(){var a=this.get("displayedValue"),b=this.dropDown;b&&(a==b._messages.previousMessage||a==b._messages.nextMessage)?this._setValueAttr(this._lastValueReported,!0):"undefined"==typeof this.item?
(this.item=null,this.set("displayedValue",a)):(this.value!=this._lastValueReported&&this._handleOnChange(this.value,!0),this._refreshState());this.focusNode.removeAttribute("aria-activedescendant")},_setItemAttr:function(a,b,c){var d="";a&&(c||(c=this.store._oldAPI?this.store.getValue(a,this.searchAttr):a[this.searchAttr]),d=this._getValueField()!=this.searchAttr?this.store.getIdentity(a):c);this.set("value",d,b,c,a)},_announceOption:function(a){if(a){var b;if(a==this.dropDown.nextButton||a==this.dropDown.previousButton)b=
a.innerHTML,this.item=void 0,this.value="";else{var c=this.dropDown.items[a.getAttribute("item")];b=(this.store._oldAPI?this.store.getValue(c,this.searchAttr):c[this.searchAttr]).toString();this.set("item",c,!1,b)}this.focusNode.value=this.focusNode.value.substring(0,this._lastInput.length);this.focusNode.setAttribute("aria-activedescendant",k.get(a,"id"));this._autoCompleteText(b)}},_selectOption:function(a){this.closeDropDown();a&&this._announceOption(a);this._setCaretPos(this.focusNode,this.focusNode.value.length);
this._handleOnChange(this.value,!0);this.focusNode.removeAttribute("aria-activedescendant")},_startSearchAll:function(){this._startSearch("")},_startSearchFromInput:function(){this.item=void 0;this.inherited(arguments)},_startSearch:function(a){if(!this.dropDown){var b=this.id+"_popup";this.dropDown=new (c.isString(this.dropDownClass)?c.getObject(this.dropDownClass,!1):this.dropDownClass)({onChange:c.hitch(this,this._selectOption),id:b,dir:this.dir,textDir:this.textDir})}this._lastInput=a;this.inherited(arguments)},
_getValueField:function(){return this.searchAttr},postMixInProperties:function(){this.inherited(arguments);if(!this.store&&this.srcNodeRef&&(this.store=new g({},this.srcNodeRef),!("value"in this.params))){var a=this.item=this.store.fetchSelectedItem();if(a){var b=this._getValueField();this.value=this.store._oldAPI?this.store.getValue(a,b):a[b]}}},postCreate:function(){var a=d('label[for\x3d"'+this.id+'"]');a.length&&(a[0].id||(a[0].id=this.id+"_label"),this.domNode.setAttribute("aria-labelledby",
a[0].id));this.inherited(arguments);h.after(this,"onSearch",c.hitch(this,"_openResultList"),!0)},_getMenuLabelFromItem:function(a){a=this.labelFunc(a,this.store);var b=this.labelType;"none"!=this.highlightMatch&&("text"==this.labelType&&this._lastInput)&&(a=this.doHighlight(a,this._lastInput),b="html");return{html:"html"==b,label:a}},doHighlight:function(a,b){var c=(this.ignoreCase?"i":"")+("all"==this.highlightMatch?"g":""),d=this.queryExpr.indexOf("${0}");b=e.escapeString(b);return this._escapeHtml(a.replace(RegExp((0==
d?"^":"")+"("+b+")"+(d==this.queryExpr.length-4?"$":""),c),"\uffff$1\uffff")).replace(/\uFFFF([^\uFFFF]+)\uFFFF/g,'\x3cspan class\x3d"dijitComboBoxHighlightMatch"\x3e$1\x3c/span\x3e')},_escapeHtml:function(a){return a=String(a).replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;")},reset:function(){this.item=null;this.inherited(arguments)},labelFunc:function(a,b){return(b._oldAPI?b.getValue(a,this.labelAttr||this.searchAttr):a[this.labelAttr||this.searchAttr]).toString()},
_setValueAttr:function(a,b,c,d){this._set("item",d||null);null==a&&(a="");this.inherited(arguments)}});f("dojo-bidi")&&b.extend({_setTextDirAttr:function(a){this.inherited(arguments);this.dropDown&&this.dropDown._set("textDir",a)}});return b})},"esri/arcgis/Portal":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/kernel dojo/_base/Deferred dojo/_base/array dojo/_base/sniff require ../kernel ../lang ../request ../Evented ../IdentityManager".split(" "),function(h,b,k,a,c,d,e,f,g,l,m){var n=
{options:{disableIdentityLookup:!0},requestParams:{f:"json"}},q=function(d){function e(b){d[b]||(d[b]=function(){var e=arguments;return a.when(d,function(a){Array.prototype.unshift.call(e,a.results||a);return q(c[b].apply(c,e))})})}if(!d)return d;d.then&&(d=b.delegate(d));d.total||(d.total=a.when(d,function(a){return g.isDefined(a.total)?a.total:a.length||0}));e("forEach");e("filter");e("map");e("some");e("every");return d},p={useSSL:function(a,b){var c=n&&n.self||{};if(c&&!c.isPortal)return-1!==
a.indexOf("https:")||c.allSSL?b.replace("http:","https:"):b;var d=p.getLocation(b);if(-1<c.portalHostname.toLowerCase().indexOf(d.hostname.toLowerCase())&&d.port&&"80"!==d.port&&"443"!==d.port){var e=d.pathname,e=0===e.indexOf("/")?e:"/"+e;return c.allSSL||-1<a.indexOf("https:")?"https://"+d.hostname+(c.httpsPort&&"443"!==c.httpsPort?":"+c.httpsPort:"")+e+d.search:"http://"+d.hostname+(c.httpPort&&"80"!==c.httpPort?":"+c.httpPort:"")+e+d.search}return-1!==a.indexOf("https:")||c.allSSL?b.replace("http:",
"https:"):b},formatUrl:function(a){var b=n.currentToken;return-1!==a.indexOf("null")?null:p.useSSL(window.location.protocol,b?a+(-1!==a.indexOf("?")?"\x26":"?")+("token\x3d"+b):a)},getLocation:function(a){var b=document.createElement("a");b.href=a;return{protocol:b.protocol,hostname:b.hostname,port:b.port,pathname:b.pathname,search:b.search,hash:b.hash,host:b.host}},resultsToTypedArray:function(a,d,e){e=e?e.listings||e.notifications||e.userInvitations||e.tags||e.items||e.groups||e.comments||e.results||
e:[];return c.map(e,function(c){c=b.mixin(c,d||{});return a?new a(c):c})},clearFieldsFromObject:function(a,c){var d,e=a.length;if(b.isArray(a))for(d=0;d<e;d++)delete c[a[d]];else for(d in a)delete c[d];return c},requestToTypedArray:function(a,c,d,e,f){return q(p.request(a,c,d).then(b.partial(p.resultsToTypedArray,e,f)))},request:function(a,c,d){var e;c&&c.portal&&delete c.portal;c&&c.form&&(e=c.form,delete c.form);c=b.mixin(b.mixin({},c||{}),n.requestParams);d=b.mixin(d||{},n.options);return l({url:p.useSSL(window.location.protocol,
a.url||a),content:c,callbackParamName:"callback",timeout:d&&d.timeout||0,form:e},d)},formatQueryParams:function(a,c,d){a=b.mixin(b.mixin({},a),b.isString(c)?{q:c}:c||{});a.q=!d&&n.extraQuery?"("+a.q+")"+n.extraQuery:a.q;return a}},s=h([],{declaredClass:"esri.arcgis.PortalComment",constructor:function(a){b.mixin(this,a);this.url=this.item.itemUrl+"/comments/"+this.id;this.created=this.created?new Date(this.created):null}}),t=h([],{declaredClass:"esri.arcgis.PortalRating",constructor:function(a){b.mixin(this,
a);this.url=this.item.itemUrl+"/rating";this.created=this.created?new Date(this.created):null}}),u=h([],{declaredClass:"esri.arcgis.PortalItem",constructor:function(a){b.mixin(this,a);this.folderId=this.ownerFolder||this.folderId;this.itemUrl=(this.portal&&this.portal.portalUrl)+"content/items/"+this.id;this.userItemUrl=this.hasOwnProperty("ownerFolder")?this.itemUrl.replace("content","content/users/"+this.owner+(this.folderId?"/"+this.folderId:"")):null;this.itemDataUrl=p.formatUrl(this.itemUrl+
"/data");this.thumbnailUrl=p.formatUrl(this.itemUrl+"/info/"+this.thumbnail);this.displayName=this._getDisplayName();this.iconUrl=this._getIconUrl();this.isPremiumContent=this._getIsPremiumContent();this.created=this.created?new Date(this.created):null;this.uploaded=this.uploaded?new Date(this.uploaded):null;this.modified=this.modified?new Date(this.modified):null},getTypeInfo:function(){var a=this.type;return{source:-1<c.indexOf(this.typeKeywords||[],"ArcGIS Server")||"Feature Collection"===a?a:
null,displayName:this.displayName,iconUrl:this.iconUrl,isPremiumContent:this.isPremiumContent,premiumIconUrl:this._getPremiumIconUrl()}},addComment:function(a){var c=b.isString(a)?{comment:a}:a;return p.request(this.itemUrl+"/addComment",c,{usePost:!0}).then(b.hitch(this,function(a){return new s(b.mixin(c,{id:a.commentId,item:this}))}))},updateComment:function(a){if(a&&a.url&&a.comment)return p.request(a.url+"/update",{comment:a.comment},{usePost:!0}).then(function(b){a.id=b.commentId;return a});
throw Error();},getComments:function(){return p.requestToTypedArray(this.itemUrl+"/comments",null,null,s,{item:this})},deleteComment:function(a){if(a&&a.url)return p.request(a.url+"/delete",null,{usePost:!0});throw Error();},addRating:function(a){var c=b.isObject(a)?a:{rating:parseFloat(a)};return p.request(this.itemUrl+"/addRating",c,{usePost:!0}).then(b.hitch(this,function(a){return new t(b.mixin(c,{id:a.ratingId,item:this}))}))},getRating:function(){return p.request(this.itemUrl+"/rating").then(b.hitch(this,
function(a){return new t(b.mixin(a,{item:this}))}))},deleteRating:function(){return p.request(this.itemUrl+"/deleteRating",null,{usePost:!0})},_getDisplayName:function(){var a=this.type,b=this.typeKeywords||[],d=a;"Feature Service"===a||"Feature Collection"===a?d=-1<c.indexOf(b,"Table")?"Table":"Feature Layer":"Image Service"===a?d=-1<c.indexOf(b,"Elevation 3D Layer")?"Elevation Layer":"Imagery Layer":"Scene Service"===a?d="Scene Layer":"Stream Service"===a?d="Feature Layer":"Microsoft Powerpoint"===
a?d="Microsoft PowerPoint":"GeoJson"===a?this.type=d="GeoJSON":"Globe Service"===a?d="Globe Layer":"Map Service"===a&&(d=-1<c.indexOf(b,"Hosted Service")||-1<c.indexOf(b,"Tiled")?"Tile Layer":"Map Image Layer");return d},_getIconUrl:function(){var a=this.type&&this.type.toLowerCase()||"",b=this.typeKeywords||[],d=!1,f=!1;0<a.indexOf("service")||"feature collection"===a||"kml"===a||"wms"===a||"wmts"===a?(d=-1<c.indexOf(b,"Hosted Service"),a="feature service"===a||"feature collection"===a||"kml"===
a?(f=-1<c.indexOf(b,"Table"))?"table":d?"featureshosted":"features":"map service"===a||"wms"===a||"wmts"===a?d||-1<c.indexOf(b,"Tiled")?"maptiles":"mapimages":"scene service"===a?"sceneweblayer":"image service"===a?-1<c.indexOf(b,"Elevation 3D Layer")?"elevationlayer":"imagery":"stream service"===a?"streamlayer":"layers"):a="web map"===a||"cityengine web scene"===a?"maps":"web scene"===a?"webscene":"web mapping application"===a||"mobile application"===a||"application"===a||"operation view"===a||"desktop application"===
a?"apps":"map document"===a||"map package"===a||"published map"===a||"scene document"===a||"globe document"===a||"basemap package"===a||"mobile basemap package"===a||"mobile map package"===a||"project package"===a||"project template"===a||"pro map"===a||"layout"===a||"layer"===a&&-1<c.indexOf(b,"ArcGIS Pro")||"explorer map"===a&&c.indexOf(b,"Explorer Document")?"mapsgray":"service definition"===a||"csv"===a||"shapefile"===a||"cad drawing"===a||"geojson"===a?"datafiles":"explorer add in"===a||"desktop add in"===
a||"windows viewer add in"===a||"windows viewer configuration"===a?"appsgray":"rule package"===a||"file geodatabase"===a||"csv collection"===a||"kml collection"===a||"windows mobile package"===a||"map template"===a||"desktop application template"===a||"arcpad package"===a||"code sample"===a||"document link"===a||"tile package"===a||"scene package"===a||"operations dashboard add in"===a||"rules package"===a||"image"===a||"workflow manager package"===a||"desktop style"===a||"explorer map"===a&&-1<c.indexOf(b,
"Explorer Mapping Application")||-1<c.indexOf(b,"Document")?"datafilesgray":"geocoding service"===a||"network analysis service"===a||"geoprocessing service"===a||"geodata service"===a||"geometry service"===a||"geoprocessing package"===a||"locator package"===a||"geoprocessing sample"===a||"workflow manager service"===a||"raster function template"===a?"toolsgray":"layer"===a||"layer package"===a||"explorer layer"===a?"layersgray":"task file"===a?"taskfile":"maps";return a?e.toUrl("../css/images/item_type_icons/"+
a+"16.png"):null},_getIsPremiumContent:function(){var a=this.typeKeywords,b=!1;if(-1<c.indexOf(a,"Service")&&(-1<c.indexOf(a,"Requires Subscription")||-1<c.indexOf(this.typeKeywords,"Requires Credits")))b=!0;return b},_getPremiumIconUrl:function(){var a=this.typeKeywords,b;this.isPremiumContent&&(b=-1<c.indexOf(a,"Requires Credits")?"premiumcredits":"premiumitem");return b?e.toUrl("../css/images/item_type_icons/"+b+"16.png"):null}}),x=h([],{declaredClass:"esri.arcgis.PortalListing",constructor:function(a){b.mixin(this,
a);this.id=this.itemId;this.url=(this.portal&&this.portal.portalUrl)+"content/"+(this.userItemUrl?"items/":"listings/")+this.itemId;this.commentsUrl=this.url+"/comments";this.created=this.created?new Date(this.created):null;this.banner=this.banner?p.formatUrl(this.url+"/info/"+this.banner):"";this.thumbnail=this.thumbnail?p.formatUrl(this.url+"/info/"+this.thumbnail):"";this.largeThumbnail=this.largeThumbnail?p.formatUrl(this.url+"/info/"+this.largeThumbnail):"";this.avgRating=this.avgRating||0;this.numRatings=
this.numRatings||0;this.numComments=this.numComments||0;this.listingProperties=this.listingProperties||{priceDesc:"",creditsPerTransaction:0,licenseType:"free",trialSupported:!1,trialDuration:0,listingAccess:"private"};for(var d in this.listingProperties)this[d]&&(this.listingProperties[d]=this[d]);this.properties=this.properties||{systemRequirements:"",termsAndConditions:"",version:"1.0"};this.screenshots=c.map(this.screenshots,b.hitch(this,function(a){return p.formatUrl(this.url+"/info/"+a)}));
this.vendorName=this.vendor.name;this.vendor.thumbnail=this.vendor.thumbnail?this.userItemUrl?p.formatUrl(this.portal.portalUrl+"/accounts/self/resources/"+this.vendor.thumbnail):p.formatUrl(this.url+"/vendorinfo/"+this.vendor.thumbnail):""},getComments:function(){return p.requestToTypedArray(this.commentsUrl,null,null,s,{item:this})},getVendor:function(){return this.vendor}}),w=h([],{declaredClass:"esri.arcgis.PortalProvision",constructor:function(a){b.mixin(this,a);this.created=this.created?new Date(this.created):
null;this.startDate=this.startDate?new Date(this.startDate):null;this.endDate=this.endDate&&-1!==this.endDate?new Date(this.endDate):null;this.listing=a.listing?new x(b.mixin(a.listing,{portal:this.portal})):null}}),v=h([],{declaredClass:"esri.arcgis.PortalGroup",constructor:function(a){b.mixin(this,a);this.url=(this.portal&&this.portal.portalUrl)+"community/groups/"+this.id;this.thumbnailUrl=p.formatUrl(this.url+"/info/"+this.thumbnail);this.modified=this.modified?new Date(this.modified):null;this.created=
this.created?new Date(this.created):null},getMembers:function(){return p.request(this.url+"/users")},queryItems:function(a,b){a=p.formatQueryParams({},a,b);a.q="group:"+this.id+(a.q?" "+a.q:"");return this.portal.queryItems(a)}}),y=h([],{declaredClass:"esri.arcgis.PortalFolder",constructor:function(a){b.mixin(this,a);this.url=(this.portal&&this.portal.portalUrl)+"content/users/"+this.username+"/"+this.id;this.created=this.created?new Date(this.created):null},getItems:function(){return p.requestToTypedArray(this.url,
null,null,u,{portal:this.portal,folderId:this.id})}}),A=h([],{declaredClass:"esri.arcgis.PortalUser",constructor:function(a){b.mixin(this,a);this.url=(this.portal&&this.portal.portalUrl)+"community/users/"+this.username;this.userContentUrl=(this.portal&&this.portal.portalUrl)+"content/users/"+this.username;this.thumbnailUrl=p.formatUrl(this.url+"/info/"+this.thumbnail);this.modified=this.modified?new Date(this.modified):null;this.created=this.created?new Date(this.created):null},getGroups:function(){return q(p.request(this.url).then(b.hitch(this,
function(a){return p.resultsToTypedArray(v,{portal:this.portal},a.groups)})))},getNotifications:function(){return p.requestToTypedArray(this.url+"/notifications",null,null,null,{portal:this.portal})},getGroupInvitations:function(){return p.requestToTypedArray(this.url+"/invitations",null,null,null,{portal:this.portal})},getTags:function(){return p.requestToTypedArray(this.url+"/tags",null,null,null,{portal:this.portal})},getFolders:function(){return q(this.getContent().then(function(a){return a.folders}))},
getItems:function(a){return q(this.getContent(a).then(function(a){return a.items}))},getItem:function(a){return p.request(this.portal.portalUrl+"content/items/"+a).then(b.hitch(this,function(a){return new u(b.mixin(a,{portal:this.portal}))}))},getContent:function(a){var c=this.url.replace("community","content")+(a?"/"+a:"");return p.request(c).then(b.hitch(this,function(b){b.folders=p.resultsToTypedArray(y,{portal:this.portal},b.folders);b.items=p.resultsToTypedArray(u,{portal:this.portal,folderId:a},
b.items);return b}))}});h={Portal:h([m],{declaredClass:"esri.arcgis.Portal",onLoad:function(){},onError:function(){},constructor:function(a){a=b.isObject(a)?a:{url:a};this.registerConnectEvents();n={options:{disableIdentityLookup:!0},requestParams:{f:"json"}};a.self?(n.self=a.self,b.mixin(this,{url:a.url||window.location.protocol+"//"+(a.self.urlKey?a.self.urlKey+"."+a.self.customBaseUrl:a.self.portalHostname)}),this.portalUrl=-1!==this.url.indexOf("/sharing")?this.url+"/":this.url+"/sharing/rest/",
a=a.self.user?this.signIn():this.init(this.url)):(a.url&&b.mixin(this,{url:a.url}),a=this.init(this.url));a.then(b.hitch(this,function(){this.emit("ready",this);this.onLoad(this)}))},init:function(a,c){a=(a||this.portalUrl).replace(/\/+$/,"");this.portalUrl=-1!==a.indexOf("/sharing")?a+"/":a+"/sharing/rest/";return this._getSelf(this.portalUrl).then(b.hitch(this,function(a){n.self=b.mixin({},a);if((a=a.user)&&c)n.currentToken=c&&c.token,n.loggedInUser=new A(b.mixin(a,{portal:this,credential:c}));
n.self.id&&!1===n.self.canSearchPublic&&(n.extraQuery=" AND orgid:"+n.self.id);b.mixin(this,n.self);this.thumbnailUrl=p.formatUrl(this.portalUrl+"accounts/self/resources/"+this.thumbnail);this.isOrganization=this.access&&this.access.length||!1;this.created=this.created?new Date(this.created):null;this.modified=this.modified?new Date(this.modified):null;return this}),b.hitch(this,function(a){this.onError(a);throw a;}))},signIn:function(){var c=new a,d=b.hitch(this,function(){this._onSignIn().then(b.hitch(this,
function(){c.resolve(n.loggedInUser)}),b.hitch(this,function(a){c.reject(a)}))});if(!n||!n.self)this.on("load",b.hitch(this,function(){d()}));else n&&n.loggedInUser?setTimeout(function(){c.resolve(n.loggedInUser)},0):d();return c},signOut:function(){n.loggedInUser.credential&&n.loggedInUser.credential.destroy();n.loggedInUser=null;n.options.disableIdentityLookup=!0;p.clearFieldsFromObject(n.self,this);n.self=null;return this.init(this.url)},getPortalUser:function(){return n.loggedInUser},addResource:function(a,
b){return p.request(this.portalUrl+"portals/self/addResource",{key:a,text:b},{usePost:!0})},update:function(a){return p.request(this.portalUrl+"portals/self/update",a,{usePost:!0})},queryGroups:function(a,b){return this._queryPortal(this.portalUrl+"community/groups",p.formatQueryParams({},a,b),v)},queryItems:function(a,b){return this._queryPortal(this.portalUrl+"search",p.formatQueryParams({},a,b),u)},queryListings:function(a){a=p.formatQueryParams({},a,!0);var b="";a.q&&-1<a.q.toLowerCase().indexOf("mylistings:true")?
(a.q=a.q.toLowerCase().replace("mylistings:true",""),b="?mylistings\x3dtrue"):a.q||(a.q='""');return this._queryPortal(this.portalUrl+"content/listings"+b,a,x)},getProvisions:function(){return this.getCustomers().then(b.hitch(this,function(a){return a.purchases}))},getInterests:function(){return this.getCustomers().then(b.hitch(this,function(a){return a.interests}))},getTrials:function(){return this.getCustomers().then(b.hitch(this,function(a){return a.trials}))},getCustomers:function(a){return p.request(this.portalUrl+
"portals/self/customers",{status:a||"all"})},getMyPurchases:function(){return this.getPurchases().then(function(a){return a.purchases})},getMyInterests:function(){return this.getPurchases().then(function(a){return a.interests})},getPurchases:function(){return p.request(this.portalUrl+"portals/self/purchases").then(b.hitch(this,function(a){a.interests=c.map(a.interests,function(a){return b.mixin(a.provision,{listing:a.listing})});a.purchases=c.map(a.purchases,function(a){return b.mixin(a.provision,
{listing:a.listing})});a.trials=c.map(a.trials,function(a){return b.mixin(a.provision,{listing:a.listing})});a.interests=p.resultsToTypedArray(w,{portal:this},a.interests);a.trials=p.resultsToTypedArray(w,{portal:this},a.trials);a.purchases=p.resultsToTypedArray(w,{portal:this},a.purchases);return a}))},queryUsers:function(a,b){return this._queryPortal(this.portalUrl+"community/users",p.formatQueryParams({sortField:"username"},a,b),A)},_onSignIn:function(){n.options.disableIdentityLookup=!1;if(!n.self||
!n.self.user)n.self=null;return f.id.getCredential(this.portalUrl).then(b.hitch(this,"init",this.url)).then(function(){return n.loggedInUser},b.hitch(this,function(a){n.options.disableIdentityLookup=!0;this.onError(a);throw a;}))},_getSelf:function(b){var c;b=b+"accounts/self?culture\x3d"+k.locale;n.self?(c=new a,setTimeout(function(){c.resolve(n.self)},0)):c=p.request(b);return c},_queryPortal:function(c,d,e){var f=b.mixin({num:10,start:0,sortField:"title",sortOrder:"asc"},d),g=["start","query",
"num","nextStart"];c=p.request(c,f).then(b.hitch(this,function(a){a.results=p.resultsToTypedArray(e,{portal:this},a);a.queryParams=b.mixin({},f);a.nextQueryParams=b.mixin(f,{start:a.nextStart});return p.clearFieldsFromObject(g,a)}));c=b.delegate(c);c.queryParams=b.mixin({},f);c.nextQueryParams=a.when(c,function(a){return a.nextQueryParams});return q(c)}}),PortalFolder:y,PortalGroup:v,PortalItem:u,PortalComment:s,PortalRating:t,PortalUtil:p,PortalResult:q,PortalListing:x};d("extend-esri")&&b.mixin(b.getObject("arcgis",
!0,f),h);return h})},"dojox/widget/AutoRotator":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/on dojo/mouse dojox/widget/Rotator".split(" "),function(h,b,k,a,c,d){return h("dojox.widget.AutoRotator",d,{suspendOnHover:!1,duration:4E3,autoStart:!0,pauseOnManualChange:!1,cycles:-1,random:!1,reverse:!1,constructor:function(){var b=this;b.cycles-0==b.cycles&&0<b.cycles?b.cycles++:b.cycles=b.cycles?-1:0;b._signals=[a(b._domNode,c.enter,function(){if(b.suspendOnHover&&!b.anim&&
!b.wfe){var a=b._endTime,c=b._now();b._suspended=!0;b._resetTimer();b._resumeDuration=a>c?a-c:0.01}}),a(b._domNode,c.leave,function(){b.suspendOnHover&&!b.anim&&(b._suspended=!1,b.playing&&!b.wfe&&b.play(!0))})];b.autoStart&&1<b.panes.length?b.play():b.pause()},destroy:function(){b.forEach(this._signals,function(a){a.remove()});delete this._signals;dojo.forEach(this._connects,dojo.disconnect);this.inherited(arguments)},play:function(a,b){this.playing=!0;this._resetTimer();!0!==a&&0<this.cycles&&this.cycles--;
if(0==this.cycles)this.pause();else if(!this._suspended)if(this.onUpdate("play"),b)this._cycle();else{var c=(this._resumeDuration||0)-0,c=(0<c?c:this.panes[this.idx].duration||this.duration)-0;this._resumeDuration=0;this._endTime=this._now()+c;this._timer=setTimeout(k.hitch(this,"_cycle",!1),c)}},pause:function(){this.playing=this._suspended=!1;this.cycles=-1;this._resetTimer();this.onUpdate("pause")},_now:function(){return(new Date).getTime()},_resetTimer:function(){clearTimeout(this._timer)},_cycle:function(a){var b=
this;a=b.idx;var c;if(b.random){do c=Math.floor(Math.random()*b.panes.length+1);while(c==a)}else c=a+(b.reverse?-1:1);(a=b.go(c))&&a.addCallback(function(a){b.onUpdate("cycle");b.playing&&b.play(!1,a)})},onManualChange:function(a){this.cycles=-1;"play"!=a&&(this._resetTimer(),this.pauseOnManualChange&&this.pause());this.playing&&this.play()}})})},"esri/geometry/normalizeUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/_base/Deferred dojo/has ../kernel ../config ../deferredUtils ./Polyline ./Polygon ./webMercatorUtils ./jsonUtils".split(" "),
function(h,b,k,a,c,d,e,f,g,l,m){function n(a,b){return Math.ceil((a-b)/(2*b))}function q(a,b){var c=a.paths||a.rings,d,e,f=c.length,g;for(d=0;d<f;d++){g=c[d].length;for(e=0;e<g;e++){var l=a.getPoint(d,e);a.setPoint(d,e,l.offset(b,0))}}return a}function p(a,b){if(!(a instanceof f||a instanceof g))throw console.error("_straightLineDensify: the input geometry is neither polyline nor polygon"),Error("_straightLineDensify: the input geometry is neither polyline nor polygon");var c=a instanceof f,d=[],
e;h.forEach(c?a.paths:a.rings,function(a){d.push(e=[]);e.push([a[0][0],a[0][1]]);var c,f,g,l,m,n,p,s,k,q,t,u;for(m=0;m<a.length-1;m++){c=a[m][0];f=a[m][1];g=a[m+1][0];l=a[m+1][1];p=Math.sqrt((g-c)*(g-c)+(l-f)*(l-f));s=(l-f)/p;k=(g-c)/p;q=p/b;if(1<q){for(n=1;n<=q-1;n++)u=n*b,t=k*u+c,u=s*u+f,e.push([t,u]);n=(p+Math.floor(q-1)*b)/2;t=k*n+c;u=s*n+f;e.push([t,u])}e.push([g,l])}});return c?new f({paths:d,spatialReference:a.spatialReference}):new g({rings:d,spatialReference:a.spatialReference})}function s(a,
b,c){b&&(a=p(a,1E6),a=l.webMercatorToGeographic(a,!0));c&&(a=q(a,c));return a}function t(a,b,c){var d=a.x||a[0],e;d>b?(e=n(d,b),a.x?a=a.offset(e*-2*b,0):a[0]=d+e*-2*b):d<c&&(e=n(d,c),a.x?a=a.offset(e*-2*c,0):a[0]=d+e*-2*c);return a}function u(a,b){var c=-1;h.forEach(b.cutIndexes,function(d,e){var f=b.geometries[e];h.forEach(f.rings||f.paths,function(a,b){h.some(a,function(c){if(!(180>c[0])){c=0;var d,e=a.length,g;for(d=0;d<e;d++)g=a[d][0],c=g>c?g:c;c=Number(c.toFixed(9));c=-360*n(c,180);e=a.length;
for(d=0;d<e;d++)g=f.getPoint(b,d),f.setPoint(b,d,g.offset(c,0))}return!0})});d===c?f.rings?h.forEach(f.rings,function(b){a[d]=a[d].addRing(b)}):h.forEach(f.paths,function(b){a[d]=a[d].addPath(b)}):(c=d,a[d]=f)});return a}function x(a,b,c,e){var p=new k;p.addCallbacks(c,e);b=b||d.defaults.geometryService;var x=[],w=[],v,y,A,H,D,J,L,X,N=0;h.forEach(a,function(a){if(a)if(v||(v=a.spatialReference,y=v._getInfo(),H=(A=v._isWebMercator())?2.0037508342788905E7:180,D=A?-2.0037508342788905E7:-180,J=A?102100:
4326,L=new f({paths:[[[H,D],[H,H]]],spatialReference:{wkid:J}}),X=new f({paths:[[[D,D],[D,H]]],spatialReference:{wkid:J}})),y){var b=m.fromJson(a.toJson()),c=a.getExtent();"point"===a.type?x.push(t(b,H,D)):"multipoint"===a.type?(b.points=h.map(b.points,function(a){return t(a,H,D)}),x.push(b)):"extent"===a.type?(b=c._normalize(null,null,y),x.push(b.rings?new g(b):b)):c?(a=n(c.xmin,D)*2*H,b=0===a?b:q(b,a),c=c.offset(a,0),c.intersects(L)&&c.xmax!==H?(N=c.xmax>N?c.xmax:N,b=s(b,A),w.push(b),x.push("cut")):
c.intersects(X)&&c.xmin!==D?(N=c.xmax*2*H>N?c.xmax*2*H:N,b=s(b,A,360),w.push(b),x.push("cut")):x.push(b)):x.push(b)}else x.push(a);else x.push(a)});c=new f;e=n(N,H);for(var I=-90,M=e;0<e;){var T=-180+360*e;c.addPath([[T,I],[T,-1*I]]);I*=-1;e--}0<w.length&&0<M?b?b.cut(w,c,function(c){w=u(w,c);var d=[];h.forEach(x,function(b,c){if("cut"===b){var e=w.shift();a[c].rings&&1<a[c].rings.length&&e.rings.length>=a[c].rings.length?(x[c]="simplify",d.push(e)):x[c]=!0===A?l.geographicToWebMercator(e):e}});0<
d.length?b.simplify(d,function(a){h.forEach(x,function(b,c){"simplify"===b&&(x[c]=!0===A?l.geographicToWebMercator(a.shift()):a.shift())});p.callback(x)},function(a){p.errback(a)}):p.callback(x)},function(a){p.errback(a)}):p.errback(Error("esri.geometry.normalizeCentralMeridian: 'geometryService' argument is missing.")):(h.forEach(x,function(a,b){if("cut"===a){var c=w.shift();x[b]=!0===A?l.geographicToWebMercator(c):c}}),p.callback(x));return p}function w(a,c,d,e){var f=!1,g;b.isObject(a)&&a&&(b.isArray(a)?
a.length&&((g=a[0]&&a[0].declaredClass)&&-1!==g.indexOf("Graphic")?(a=h.map(a,function(a){return a.geometry}),f=a.length?!0:!1):g&&-1!==g.indexOf("esri.geometry.")&&(f=!0)):(g=a.declaredClass)&&-1!==g.indexOf("FeatureSet")?(a=h.map(a.features||[],function(a){return a.geometry}),f=a.length?!0:!1):g&&-1!==g.indexOf("esri.geometry.")&&(f=!0));f&&c.push({index:d,property:e,value:a})}function v(a,c){var d=[];h.forEach(c,function(c){var e=c.i,f=a[e];c=c.p;var g;if(b.isObject(f)&&f)if(c)if("*"===c[0])for(g in f)f.hasOwnProperty(g)&&
w(f[g],d,e,g);else h.forEach(c,function(a){w(b.getObject(a,!1,f),d,e,a)});else w(f,d,e)});return d}function y(a,c){var d=0,e={};h.forEach(c,function(c){var f=c.index,g=c.property,l=c.value,m=l.length||1,n=a.slice(d,d+m);b.isArray(l)||(n=n[0]);d+=m;delete c.value;g?(e[f]=e[f]||{},e[f][g]=n):e[f]=n});return e}var A={normalizeCentralMeridian:x,_foldCutResults:u,_prepareGeometryForCut:s,_offsetMagnitude:n,_pointNormalization:t,_updatePolyGeometry:q,_straightLineDensify:p,_createWrappers:function(a){var c=
b.isObject(a)?a.prototype:b.getObject(a+".prototype");h.forEach(c.__msigns,function(a){var b=c[a.n];c[a.n]=function(){var c=this,d=[],f,g=new k(e._dfdCanceller);a.f&&e._fixDfd(g);for(f=0;f<a.c;f++)d[f]=arguments[f];var l={dfd:g};d.push(l);var m,n=[],p;c.normalization&&!c._isTable&&(m=v(d,a.a),h.forEach(m,function(a){n=n.concat(a.value)}),n.length&&(p=x(n)));p?(g._pendingDfd=p,p.addCallbacks(function(a){g.canceled||(l.assembly=y(a,m),g._pendingDfd=b.apply(c,d))},function(b){var e=c.declaredClass;e&&
-1!==e.indexOf("FeatureLayer")?c._resolve([b],null,d[a.e],g,!0):c._errorHandler(b,d[a.e],g)})):g._pendingDfd=b.apply(c,d);return g}})},_disassemble:v,_addToBucket:w,_reassemble:y};a("extend-esri")&&b.mixin(b.getObject("geometry",!0,c),A);return A})},"dojo/rpc/JsonService":function(){define("../_base/declare ../_base/Deferred ../_base/json ../_base/lang ../_base/xhr ./RpcService".split(" "),function(h,b,k,a,c,d){return h("dojo.rpc.JsonService",d,{bustCache:!1,contentType:"application/json-rpc",lastSubmissionId:0,
callRemote:function(a,c){var d=new b;this.bind(a,c,d);return d},bind:function(a,b,d,l){c.post({url:l||this.serviceUrl,postData:this.createRequest(a,b),contentType:this.contentType,timeout:this.timeout,handleAs:"json-comment-optional"}).addCallbacks(this.resultCallback(d),this.errorCallback(d))},createRequest:function(a,b){var c={params:b,method:a,id:++this.lastSubmissionId};return k.toJson(c)},parseResults:function(b){if(a.isObject(b)){if("result"in b)return b.result;if("Result"in b)return b.Result;
if("ResultSet"in b)return b.ResultSet}return b}})})},"dijit/form/ComboBoxMixin":function(){define("dojo/_base/declare dojo/Deferred dojo/_base/kernel dojo/_base/lang dojo/store/util/QueryResults ./_AutoCompleterMixin ./_ComboBoxMenu ../_HasDropDown dojo/text!./templates/DropDownBox.html".split(" "),function(h,b,k,a,c,d,e,f,g){return h("dijit.form.ComboBoxMixin",[f,d],{dropDownClass:e,hasDownArrow:!0,templateString:g,baseClass:"dijitTextBox dijitComboBox",cssStateNodes:{_buttonNode:"dijitDownArrowButton"},
_setHasDownArrowAttr:function(a){this._set("hasDownArrow",a);this._buttonNode.style.display=a?"":"none"},_showResultList:function(){this.displayMessage("");this.inherited(arguments)},_setStoreAttr:function(d){d.get||a.mixin(d,{_oldAPI:!0,get:function(a){var c=new b;this.fetchItemByIdentity({identity:a,onItem:function(a){c.resolve(a)},onError:function(a){c.reject(a)}});return c.promise},query:function(d,e){var f=new b(function(){g.abort&&g.abort()});f.total=new b;var g=this.fetch(a.mixin({query:d,
onBegin:function(a){f.total.resolve(a)},onComplete:function(a){f.resolve(a)},onError:function(a){f.reject(a)}},e));return c(f)}});this._set("store",d)},postMixInProperties:function(){var b=this.params.store||this.store;b&&this._setStoreAttr(b);this.inherited(arguments);if(!this.params.store&&this.store&&!this.store._oldAPI){var c=this.declaredClass;a.mixin(this.store,{getValue:function(a,b){k.deprecated(c+".store.getValue(item, attr) is deprecated for builtin store.  Use item.attr directly","","2.0");
return a[b]},getLabel:function(a){k.deprecated(c+".store.getLabel(item) is deprecated for builtin store.  Use item.label directly","","2.0");return a.name},fetch:function(b){k.deprecated(c+".store.fetch() is deprecated for builtin store.","Use store.query()","2.0");require(["dojo/data/ObjectStore"],a.hitch(this,function(a){(new a({objectStore:this})).fetch(b)}))}})}},buildRendering:function(){this.inherited(arguments);this.focusNode.setAttribute("aria-autocomplete",this.autoComplete?"both":"list")}})})},
"esri/geometry/Extent":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./webMercatorUtils ./mathUtils".split(" "),function(h,b,k,a,c,d,e,f,g,l,m){var n={type:"extent",xmin:0,ymin:0,xmax:0,ymax:0},q=h(f,{declaredClass:"esri.geometry.Extent",constructor:function(a,b,c,d,f){k.mixin(this,n);k.isObject(a)?(k.mixin(this,a),this.spatialReference&&(this.spatialReference=new e(this.spatialReference))):this.update(a,b,
c,d,f);this.verifySR()},getWidth:function(){return Math.abs(this.xmax-this.xmin)},getHeight:function(){return Math.abs(this.ymax-this.ymin)},getCenter:function(){return new g((this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2,this.spatialReference)},centerAt:function(a){var b=this.getCenter(),c=a.x-b.x;a=a.y-b.y;return new q(this.xmin+c,this.ymin+a,this.xmax+c,this.ymax+a,this.spatialReference)},update:function(a,b,c,d,e){this.xmin=a;this.ymin=b;this.xmax=c;this.ymax=d;this.spatialReference=e;this.clearCache();
return this},offset:function(a,b){return new q(this.xmin+a,this.ymin+b,this.xmax+a,this.ymax+b,this.spatialReference)},expand:function(a){var b=(1-a)/2;a=this.getWidth()*b;b*=this.getHeight();return new q(this.xmin+a,this.ymin+b,this.xmax-a,this.ymax-b,this.spatialReference)},intersects:function(a){if(!a)return!1;var b=a.type,c=this.spatialReference,d=a.spatialReference;c&&(d&&!c.equals(d)&&c._canProject(d))&&(a=c.isWebMercator()?l.geographicToWebMercator(a):l.webMercatorToGeographic(a,!0));switch(b){case "point":return this.contains(a);
case "multipoint":return this._intersectsMultipoint(a);case "extent":return this._intersectsExtent(a);case "polygon":return this._intersectsPolygon(a);case "polyline":return this._intersectsPolyline(a)}},normalize:function(){var a=this._normalize(!1,!0);k.isArray(a)||(a=[a]);return a},shiftCentralMeridian:function(){return this._normalize(!0)},_intersectsMultipoint:function(a){var b=a.points.length,c;for(c=0;c<b;c++)if(this.contains(a.getPoint(c)))return!0;return!1},_intersectsExtent:function(a){var b,
c,d,e,f=!1;this.xmin<=a.xmin?(b=a.xmin,this.xmax<b?f=!0:d=Math.min(this.xmax,a.xmax)-b):(b=this.xmin,a.xmax<b?f=!0:d=Math.min(this.xmax,a.xmax)-b);this.ymin<=a.ymin?(c=a.ymin,this.ymax<c?f=!0:e=Math.min(this.ymax,a.ymax)-c):(c=this.ymin,a.ymax<c?f=!0:e=Math.min(this.ymax,a.ymax)-c);return f?null:new q(b,c,b+d,c+e,this.spatialReference)},_intersectsPolygon:function(a){var b=[this.xmin,this.ymax],c=[this.xmax,this.ymax],d=[this.xmin,this.ymin],e=[this.xmax,this.ymin],f=[b,c,d,e],b=[[d,b],[b,c],[c,e],
[e,d]],d=a.rings,e=d.length,l,m=new g(0,0,this.spatialReference);l=f.length;for(c=0;c<l;c++)if(m.update(f[c][0],f[c][1]),a.contains(m))return!0;m.setSpatialReference(a.spatialReference);for(var n,k,c=0;c<e;c++)if(f=d[c],l=f.length){n=f[0];m.update(n[0],n[1]);if(this.contains(m))return!0;for(a=1;a<l;a++){k=f[a];m.update(k[0],k[1]);if(this.contains(m)||this._intersectsLine([n,k],b))return!0;n=k}}return!1},_intersectsPolyline:function(a){var b=[[[this.xmin,this.ymin],[this.xmin,this.ymax]],[[this.xmin,
this.ymax],[this.xmax,this.ymax]],[[this.xmax,this.ymax],[this.xmax,this.ymin]],[[this.xmax,this.ymin],[this.xmin,this.ymin]]],c,d=a.paths,e=d.length,f,l,m,n,k=new g(0,0,a.spatialReference);for(a=0;a<e;a++)if(f=d[a],l=f.length){m=f[0];k.update(m[0],m[1]);if(this.contains(k))return!0;for(c=1;c<l;c++){n=f[c];k.update(n[0],n[1]);if(this.contains(k)||this._intersectsLine([m,n],b))return!0;m=n}}return!1},_intersectsLine:function(a,b){var c=m._getLineIntersection2,d,e=b.length;for(d=0;d<e;d++)if(c(a,b[d]))return!0;
return!1},contains:function(a){if(!a)return!1;var b=a.type;if("point"===b){var c=this.spatialReference,d=a.spatialReference,b=a.x;a=a.y;c&&(d&&!c.equals(d)&&c._canProject(d))&&(a=c.isWebMercator()?g.lngLatToXY(b,a):g.xyToLngLat(b,a,!0),b=a[0],a=a[1]);return b>=this.xmin&&b<=this.xmax&&a>=this.ymin&&a<=this.ymax}return"extent"===b?this._containsExtent(a):!1},_containsExtent:function(a){var b=a.xmin,c=a.ymin,d=a.xmax,e=a.ymax,f=a.spatialReference;a=new g(b,c,f);b=new g(b,e,f);e=new g(d,e,f);c=new g(d,
c,f);return this.contains(a)&&this.contains(b)&&this.contains(e)&&this.contains(c)?!0:!1},union:function(a){return new q(Math.min(this.xmin,a.xmin),Math.min(this.ymin,a.ymin),Math.max(this.xmax,a.xmax),Math.max(this.ymax,a.ymax),this.spatialReference)},getExtent:function(){var a=this.spatialReference;return new q(this.xmin,this.ymin,this.xmax,this.ymax,a&&new e(a.toJson()))},_shiftCM:function(a){var b=this.getCacheValue("_shifted");if(!b){var b=new q(this.toJson()),c=b.spatialReference;if(a=a||c._getInfo()){var f=
this._getCM(a);if(f){var g=c._isWebMercator()?l.webMercatorToGeographic(f):f;b.xmin-=f.x;b.xmax-=f.x;c._isWebMercator()||(g.x=this._normalizeX(g.x,a).x);b.setSpatialReference(new e(d.substitute({Central_Meridian:g.x},4326===c.wkid?a.altTemplate:a.wkTemplate)))}}this.setCacheValue("_shifted",b)}return b},_getCM:function(a){var b,c=a.valid[0];a=a.valid[1];var d=this.xmin,e=this.xmax;if(!(d>=c&&d<=a)||!(e>=c&&e<=a))b=this.getCenter();return b},_normalize:function(a,c,d){var e=new q(this.toJson()),f=
e.spatialReference;if(f&&(d=d||f._getInfo())){var g=b.map(this._getParts(d),function(a){return a.extent});return 2<g.length?a?this._shiftCM(d):e.update(d.valid[0],e.ymin,d.valid[1],e.ymax,f):2===g.length?a?this._shiftCM(d):c?g:{rings:b.map(g,function(a){return[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]}),spatialReference:f}:g[0]||e}return e},_getParts:function(a){var b=this.getCacheValue("_parts");if(!b){var b=[],c=this.xmin,d=this.xmax,e=this.ymin,f=this.ymax,
g=this.spatialReference,l=this.getWidth(),m=c,n=d,k=0,h=0,B,E;a=a||g._getInfo();B=a.valid[0];E=a.valid[1];h=this._normalizeX(c,a);c=h.x;k=h.frameId;h=this._normalizeX(d,a);d=h.x;h=h.frameId;a=c===d&&0<l;if(l>2*E){l=new q(m<n?c:d,e,E,f,g);c=new q(B,e,m<n?d:c,f,g);E=new q(0,e,E,f,g);e=new q(B,e,0,f,g);g=[];B=[];l.contains(E)&&g.push(k);l.contains(e)&&B.push(k);c.contains(E)&&g.push(h);c.contains(e)&&B.push(h);for(f=k+1;f<h;f++)g.push(f),B.push(f);b.push({extent:l,frameIds:[k]},{extent:c,frameIds:[h]},
{extent:E,frameIds:g},{extent:e,frameIds:B})}else c>d||a?b.push({extent:new q(c,e,E,f,g),frameIds:[k]},{extent:new q(B,e,d,f,g),frameIds:[h]}):b.push({extent:new q(c,e,d,f,g),frameIds:[k]});this.setCacheValue("_parts",b)}return b},_normalizeX:function(a,b){var c=0,d=b.valid[0],e=b.valid[1],f=2*e;a>e?(c=Math.ceil(Math.abs(a-e)/f),a-=c*f):a<d&&(c=Math.ceil(Math.abs(a-d)/f),a+=c*f,c=-c);return{x:a,frameId:c}},toJson:function(){var a={xmin:this.xmin,ymin:this.ymin,xmax:this.xmax,ymax:this.ymax},b=this.spatialReference;
b&&(a.spatialReference=b.toJson());return a}});q.defaultProps=n;a("extend-esri")&&(k.setObject("geometry.Extent",q,c),c.geometry.defaultExtent=n);return q})},"dijit/form/_TextBoxMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/has dojo/keys dojo/_base/lang dojo/on ../main".split(" "),function(h,b,k,a,c,d,e,f){var g=b("dijit.form._TextBoxMixin"+(a("dojo-bidi")?"_NoBidi":""),null,{trim:!1,uppercase:!1,lowercase:!1,propercase:!1,maxLength:"",selectOnClick:!1,placeHolder:"",
_getValueAttr:function(){return this.parse(this.get("displayedValue"),this.constraints)},_setValueAttr:function(a,b,c){var d;void 0!==a&&(d=this.filter(a),"string"!=typeof c&&(c=null!==d&&("number"!=typeof d||!isNaN(d))?this.filter(this.format(d,this.constraints)):"",0!=this.compare(d,this.filter(this.parse(c,this.constraints)))&&(c=null)));if(null!=c&&("number"!=typeof c||!isNaN(c))&&this.textbox.value!=c)this.textbox.value=c,this._set("displayedValue",this.get("displayedValue"));this.inherited(arguments,
[d,b])},displayedValue:"",_getDisplayedValueAttr:function(){return this.filter(this.textbox.value)},_setDisplayedValueAttr:function(a){null==a?a="":"string"!=typeof a&&(a=String(a));this.textbox.value=a;this._setValueAttr(this.get("value"),void 0);this._set("displayedValue",this.get("displayedValue"))},format:function(a){return null==a?"":a.toString?a.toString():a},parse:function(a){return a},_refreshState:function(){},onInput:function(){},__skipInputEvent:!1,_onInput:function(a){this._processInput(a);
this.intermediateChanges&&this.defer(function(){this._handleOnChange(this.get("value"),!1)})},_processInput:function(a){this._refreshState();this._set("displayedValue",this.get("displayedValue"))},postCreate:function(){this.textbox.setAttribute("value",this.textbox.value);this.inherited(arguments);this.own(e(this.textbox,"keydown, keypress, paste, cut, input, compositionend",d.hitch(this,function(a){var b;if("keydown"==a.type){b=a.keyCode;switch(b){case c.SHIFT:case c.ALT:case c.CTRL:case c.META:case c.CAPS_LOCK:case c.NUM_LOCK:case c.SCROLL_LOCK:return}if(!a.ctrlKey&&
!a.metaKey&&!a.altKey){switch(b){case c.NUMPAD_0:case c.NUMPAD_1:case c.NUMPAD_2:case c.NUMPAD_3:case c.NUMPAD_4:case c.NUMPAD_5:case c.NUMPAD_6:case c.NUMPAD_7:case c.NUMPAD_8:case c.NUMPAD_9:case c.NUMPAD_MULTIPLY:case c.NUMPAD_PLUS:case c.NUMPAD_ENTER:case c.NUMPAD_MINUS:case c.NUMPAD_PERIOD:case c.NUMPAD_DIVIDE:return}if(65<=b&&90>=b||48<=b&&57>=b||b==c.SPACE)return;b=!1;for(var e in c)if(c[e]===a.keyCode){b=!0;break}if(!b)return}}(b=32<=a.charCode?String.fromCharCode(a.charCode):a.charCode)||
(b=65<=a.keyCode&&90>=a.keyCode||48<=a.keyCode&&57>=a.keyCode||a.keyCode==c.SPACE?String.fromCharCode(a.keyCode):a.keyCode);b||(b=229);if("keypress"==a.type){if("string"!=typeof b)return;if("a"<=b&&"z">=b||"A"<=b&&"Z">=b||"0"<=b&&"9">=b||" "===b)if(a.ctrlKey||a.metaKey||a.altKey)return}if("input"==a.type){if(this.__skipInputEvent){this.__skipInputEvent=!1;return}}else this.__skipInputEvent=!0;var f={faux:!0},g;for(g in a)/^(layer[XY]|returnValue|keyLocation)$/.test(g)||(e=a[g],"function"!=typeof e&&
"undefined"!=typeof e&&(f[g]=e));d.mixin(f,{charOrCode:b,_wasConsumed:!1,preventDefault:function(){f._wasConsumed=!0;a.preventDefault()},stopPropagation:function(){a.stopPropagation()}});!1===this.onInput(f)&&(f.preventDefault(),f.stopPropagation());f._wasConsumed||this.defer(function(){this._onInput(f)})})),e(this.domNode,"keypress",function(a){a.stopPropagation()}))},_blankValue:"",filter:function(a){if(null===a)return this._blankValue;if("string"!=typeof a)return a;this.trim&&(a=d.trim(a));this.uppercase&&
(a=a.toUpperCase());this.lowercase&&(a=a.toLowerCase());this.propercase&&(a=a.replace(/[^\s]+/g,function(a){return a.substring(0,1).toUpperCase()+a.substring(1)}));return a},_setBlurValue:function(){this._setValueAttr(this.get("value"),!0)},_onBlur:function(a){this.disabled||(this._setBlurValue(),this.inherited(arguments))},_isTextSelected:function(){return this.textbox.selectionStart!=this.textbox.selectionEnd},_onFocus:function(a){!this.disabled&&!this.readOnly&&(this.selectOnClick&&"mouse"==a&&
(this._selectOnClickHandle=e.once(this.domNode,"mouseup, touchend",d.hitch(this,function(a){this._isTextSelected()||g.selectInputText(this.textbox)})),this.own(this._selectOnClickHandle),this.defer(function(){this._selectOnClickHandle&&(this._selectOnClickHandle.remove(),this._selectOnClickHandle=null)},500)),this.inherited(arguments),this._refreshState())},reset:function(){this.textbox.value="";this.inherited(arguments)}});a("dojo-bidi")&&(g=b("dijit.form._TextBoxMixin",g,{_setValueAttr:function(){this.inherited(arguments);
this.applyTextDir(this.focusNode)},_setDisplayedValueAttr:function(){this.inherited(arguments);this.applyTextDir(this.focusNode)},_onInput:function(){this.applyTextDir(this.focusNode);this.inherited(arguments)}}));g._setSelectionRange=f._setSelectionRange=function(a,b,c){a.setSelectionRange&&a.setSelectionRange(b,c)};g.selectInputText=f.selectInputText=function(a,b,c){a=k.byId(a);isNaN(b)&&(b=0);isNaN(c)&&(c=a.value?a.value.length:0);try{a.focus(),g._setSelectionRange(a,b,c)}catch(d){}};return g})},
"arcgisonline/sharing/dijit/dialog/GeneralDlg":function(){define(["dijit","dojo","dojox","dojo/require!dijit/Dialog,dijit/_Widget,dijit/_Templated"],function(h,b,k){b.provide("arcgisonline.sharing.dijit.dialog.GeneralDlg");b.require("dijit.Dialog");b.require("dijit._Widget");b.require("dijit._Templated");b.declare("arcgisonline.sharing.dijit.dialog.GeneralDlg",[h._Widget,h._Templated],{widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContent" \x3e\r\n    \x3cdiv dojotype\x3d"dijit.Dialog" id\x3d"general-dialog" title\x3d"${i18n.notificationDlgTitle}"\r\n    execute\x3d""\x3e\r\n  \x3cdiv id\x3d"general-dialog-content"\x3e\x3c/div\x3e\r\n  \x3cbr /\x3e  \r\n  \x3cbutton id\x3d"button_general-close" dojoAttachEvent\x3d"onClick:onOkClick" class\x3d"jevent primary" dojoType\x3d"dijit.form.Button"\x3e${i18n.ok}\x3c/button\x3e\r\n\x3c/div\x3e\r\n\x3c/div\x3e',
statics:{_instance:null,getInstance:function(){null==this._instance&&(this._instance=new arcgisonline.sharing.dijit.dialog.GeneralDlg);return this._instance}},postMixInProperties:function(){this.inherited(arguments);this.i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").generalDlg)},postCreate:function(){this.loadConnections()},show:function(a){this.clear();this.setTitle(a.title);this.setMessage(a.message);a.error&&
b.addClass("general-dialog-content","error");h.byId("general-dialog").show()},showWide:function(a){b.style(b.byId("general-dialog"),"width","700px");this.show(a)},clear:function(){b.byId("general-dialog_title").innerHTML="";b.byId("general-dialog-content").innerHTML="";b.removeClass("general-dialog-content","error")},loadConnections:function(){b.query(".jevent").connect("onclick",function(a){a.preventDefault()});b.query("#general-dialog .dijitDialogTitleBar .dijitDialogCloseIcon").forEach(b.hitch(this,
function(a){b.attr(a,"title","Close")}));var a=h.byId("general-dialog");b.connect(a,"onCancel",b.hitch(this,function(a){this.onCancel(a)}));b.connect(a,"hide",b.hitch(this,function(a){this.onHide(a)}))},setTitle:function(a){a&&(b.byId("general-dialog_title").innerHTML=a)},setMessage:function(a){a&&(b.byId("general-dialog-content").innerHTML="\x3cp style\x3d'word-wrap:break-word;'\x3e"+a+"\x3c/p\x3e")},hide:function(){h.byId("general-dialog").hide()},onOkClick:function(a){h.byId("general-dialog").hide()},
onCancel:function(){},onHide:function(){}})})},"esri/geometry/Geometry":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../SpatialReference"],function(h,b,k,a,c){h=h(null,{declaredClass:"esri.geometry.Geometry",spatialReference:null,type:null,cache:void 0,setSpatialReference:function(a){this.spatialReference=a;return this},verifySR:function(){this.spatialReference||this.setSpatialReference(new c(4326))},getExtent:function(){return null},clearCache:function(){this.cache=
void 0},getCacheValue:function(a){return this.cache&&this.cache[a]},setCacheValue:function(a,b){this.cache||(this.cache={});this.cache[a]=b}});k("extend-esri")&&b.setObject("geometry.Geometry",h,a);return h})},"dijit/_base/window":function(){define(["dojo/window","../main"],function(h,b){b.getDocumentWindow=function(b){return h.get(b)}})},"dijit/PopupMenuItem":function(){define("dojo/_base/declare dojo/dom-style dojo/_base/lang dojo/query ./popup ./registry ./MenuItem ./hccss".split(" "),function(h,
b,k,a,c,d,e){return h("dijit.PopupMenuItem",e,{baseClass:"dijitMenuItem dijitPopupMenuItem",_fillContent:function(){if(this.srcNodeRef){var b=a("*",this.srcNodeRef);this.inherited(arguments,[b[0]]);this.dropDownContainer=this.srcNodeRef}},_openPopup:function(a,b){var d=this.popup;c.open(k.delegate(a,{popup:this.popup,around:this.domNode}));b&&d.focus&&d.focus()},_closePopup:function(){c.close(this.popup);this.popup.parentMenu=null},startup:function(){if(!this._started){this.inherited(arguments);if(!this.popup){var c=
a("[widgetId]",this.dropDownContainer)[0];this.popup=d.byNode(c)}this.ownerDocumentBody.appendChild(this.popup.domNode);this.popup.domNode.setAttribute("aria-labelledby",this.containerNode.id);this.popup.startup();this.popup.domNode.style.display="none";this.arrowWrapper&&b.set(this.arrowWrapper,"visibility","");this.focusNode.setAttribute("aria-haspopup","true")}},destroyDescendants:function(a){this.popup&&(this.popup._destroyed||this.popup.destroyRecursive(a),delete this.popup);this.inherited(arguments)}})})},
"arcgisonline/sharing/geow/QueryReadStore":function(){define(["dijit","dojo","dojox","dojo/require!dojox/data/QueryReadStore,arcgisonline/sharing/geow/Content"],function(h,b,k){b.provide("arcgisonline.sharing.geow.QueryReadStore");b.require("dojox.data.QueryReadStore");b.require("arcgisonline.sharing.geow.Content");b.declare("arcgisonline.sharing.geow.QueryReadStore",k.data.QueryReadStore,{_fetchItems:function(a,c,d){var e=a.serverQuery||a.query||{};e.start=a.start||0;e.start++;a.count&&(e.num=a.count);
arcgisonline.sharing.geow.Content.search(this.url,e,b.hitch(this,function(d){var g=d.total||-1;b.publish("gridCount",[d.total]);this.onResultCount(d.total);this._total=d.total;this._items=[];b.forEach(d.results,function(a,b){var c=a.tags||a.keywords||[],d=void 0==a.imageUrl?arcgisonline.sharing.geow.Content._getItemImageUrl(a):a.imageUrl,e=a.uploaded||a.created,f=void 0==a.extent?arcgisonline.sharing.geow.Community._getGroupTitleLink(a):a.title,g=a.item||"",l="";a.snippet&&0<a.snippet.length&&"null"!=
a.snippet?l=150<a.snippet.length?a.snippet.substring(0,150)+"...":a.snippet:a.description&&(0<a.description.length&&"null"!=a.description)&&(l=150<a.description.length?a.description.substring(0,150)+"...":a.description);c={id:a.id||"",owner:a.owner,title:f,description:a.description,snippet:l,snippetFull:a.snippet,tags:c.join?c.join(","):c,imageUrl:d,thumbnail:a.thumbnail,isInvitationOnly:a.isInvitationOnly,created:e,modified:a.modified,itemType:a.itemType||"",typeKeywords:a.typeKeywords||"",type:a.type||
"",extent:a.extent||"",item:g,numComments:a.numComments,numRatings:a.numRatings,avgRating:a.avgRating,numViews:a.numViews};this._items.push({i:c,r:this})},this);this._itemsByIdentity={};this._identifier="id";for(i=0;i<this._items.length;++i){d=this._items[i].i;var l=d.id;this._itemsByIdentity[l]||(this._itemsByIdentity[l]=d)}g=-1===g?this._items.length:g;c(this._items,a,g);this.lastRequestHash=(new Date).getTime()+"-"+String(Math.random()).substring(2);this._lastServerQuery=b.mixin({},e)}))},onResultCount:function(a){}})})},
"esri/geometry/webMercatorUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/has ../kernel ../SpatialReference ./Point".split(" "),function(h,b,k,a,c,d){function e(a,b,d,e){if("point"===a.type){var f=b(a.x,a.y,e);return new a.constructor(f[0],f[1],new c(d))}if("extent"===a.type){var f=b(a.xmin,a.ymin,e),g=b(a.xmax,a.ymax,e);return new a.constructor(f[0],f[1],g[0],g[1],new c(d))}if("polyline"===a.type||"polygon"===a.type){var f="polyline"===a.type,k=[],u;h.forEach(f?a.paths:a.rings,function(a){k.push(u=
[]);h.forEach(a,function(a){u.push(b(a[0],a[1],e))})});return f?new a.constructor({paths:k,spatialReference:d}):new a.constructor({rings:k,spatialReference:d})}if("multipoint"===a.type){var x=[];h.forEach(a.points,function(a){x.push(b(a[0],a[1],e))});return new a.constructor({points:x,spatialReference:d})}}function f(a,b){var c=a&&(null!=a.wkid?a:a.spatialReference),d=b&&(null!=b.wkid?b:b.spatialReference);return!c||!d?!1:d.equals(c)?!0:d._canProject(c)}var g={canProject:f,project:function(a,b){var c=
a&&a.spatialReference,g=b&&(null!=b.wkid?b:b.spatialReference);c&&g?c.equals(g)?a=new a.constructor(a.toJson()):f(c,g)?g.isWebMercator()?a=e(a,d.lngLatToXY,{wkid:102100}):4326===g.wkid&&(a=e(a,d.xyToLngLat,{wkid:4326})):a=null:a=null;return a},lngLatToXY:d.lngLatToXY,xyToLngLat:d.xyToLngLat,geographicToWebMercator:function(a){return e(a,d.lngLatToXY,{wkid:102100})},webMercatorToGeographic:function(a,b){return e(a,d.xyToLngLat,{wkid:4326},b)}};k("extend-esri")&&b.mixin(b.getObject("geometry",!0,a),
g);return g})},"dojo/hccss":function(){define("require ./_base/config ./dom-class ./dom-style ./has ./domReady ./_base/window".split(" "),function(h,b,k,a,c,d,e){c.add("highcontrast",function(){var d=e.doc.createElement("div");d.style.cssText='border: 1px solid; border-color:red green; position: absolute; height: 5px; top: -999px;background-image: url("'+(b.blankGif||h.toUrl("./resources/blank.gif"))+'");';e.body().appendChild(d);var g=a.getComputedStyle(d),l=g.backgroundImage,g=g.borderTopColor==
g.borderRightColor||l&&("none"==l||"url(invalid-url:)"==l);8>=c("ie")?d.outerHTML="":e.body().removeChild(d);return g});d(function(){c("highcontrast")&&k.add(e.body(),"dj_a11y")});return c})},"arcgisonline/sharing/_Search":function(){define(["dijit","dojo","dojox","dojo/require!arcgisonline/sharing/geow/Content"],function(h,b,k){b.provide("arcgisonline.sharing._Search");b.require("arcgisonline.sharing.geow.Content");b.declare("arcgisonline.sharing._Search",null,{_content:arcgisonline.sharing.geow.Content,
_queryStringParams:null,_lastQuery:null,keywords:null,_searchPage:esriGeowConfig.baseUrl+"search.html",_queryTypes:{content:{queryUrl:esriGeowConfig.restBaseUrl+"search"},group:{queryUrl:esriGeowConfig.restBaseUrl+"search"},groups:{queryUrl:esriGeowConfig.restBaseUrl+"community/groups"}},_getSearchParams:function(){return b.queryToObject(window.location.search.slice(1))},goToSearch:function(a,b){window.location.href=this.getSearchUrl(a,b)},getSearchUrl:function(a,c){c||(c={});var d=b.queryToObject(window.location.search.slice(1));
if(!c.clearParams){var e=d.q;a=b.mixin(d,a);"group"===a.t&&e!==a.q&&(a.sortField=null,a.sortOrder=null,a.start=1)}var d=c.useCurrentPageLocation?window.location.href.substring(window.location.href.lastIndexOf("/")+1,window.location.href.indexOf(window.location.search)):this._searchPage,d=d+("?"+b.objectToQuery(a)),e=esriGeowConfig.self&&esriGeowConfig.self.allSSL,f=arcgisonline.sharing.util.usePortalSSL();return e||f?arcgisonline.sharing.util.getSecureUrl(d):arcgisonline.sharing.util.getHttpUrl(d)},
doQuery:function(a){var c="";a.q&&(c=b.trim(a.q),this.keywords=b.trim(a.q));a.f&&(c=null!==c&&0<c.length?"("+c+") "+b.trim(unescape(a.f)):c+(" "+b.trim(unescape(a.f))));if(null==c||0==c.length)c="all"==a.focus?"access:public":"";a.focus&&esriGeowConfig.filterQueries[a.focus]&&(c+=" "+esriGeowConfig.filterQueries[a.focus].f);var d={};d.q=c;void 0!=a.sortField&&(d.sortField=a.sortField);void 0!=a.sortOrder&&(d.sortOrder=a.sortOrder);void 0!=a.start&&(d.start=a.start);0<this.resultsPerPage&&(d.num=this.resultsPerPage);
this._lastQuery=d;this._content.search(a.t?this._queryTypes[a.t].queryUrl:this._queryTypes.content.queryUrl,d,b.hitch(this,this._onQueryResult));this.onQueryExecute(d,this._cleanQuery(d.q))},_onQueryResult:function(a){this.onQueryResult(a)},_cleanQuery:function(a){if((a=a.replace(/\s+/g," ").replace(/: /g,":"))&&0<=a.indexOf(":")){a=a.replace(/\(/g," ( ").replace(/\)/g," ) ");a=a.split(" ");for(var b=[],d=0;d<a.length;d++){for(var e=a[d],f=e.replace(/[^"]/g,"").length;1==f%2&&d<a.length-1;)e+=" "+
a[d+1],d++,f=e.replace(/[^"]/g,"").length;-1===e.indexOf(":")&&b.push(e)}b=this.checkLastKeyword(b);a=b.join(" ");a=a.replace(/  /g," ").replace(/ OR OR /g," OR ").replace(/\( /g,"(").replace(/ \)/g,")").replace(/\(OR OR /g,"(").replace(/ OR OR\)/g,")");a=a.replace(/\(OR/g,"(").replace(/OR\)/g,")").replace(/\( \)/g,"").replace(/\(\)/g,"").replace(/\s+$/,"").replace(/^\s+/,"")}return a},checkLastKeyword:function(a){if(a&&0<a.length){var b=a[a.length-1];if(b.match(/^AND$/i)||b.match(/^OR$/i))return a.pop(),
this.checkLastKeyword(a)}return a},onQueryExecute:function(a,b){},onQueryResult:function(a){}})})},"arcgisonline/sharing/dijit/SignUpInternal":function(){define(["dijit","dojo","dojox","dojo/require!dijit/_Widget,dijit/_Templated,dijit/form/Button,dijit/form/ValidationTextBox,dojo/data/ItemFileReadStore,arcgisonline/sharing/util,arcgisonline/sharing/dijit/dialog/GeneralDlg,arcgisonline/sharing/geow/Account,arcgisonline/sharing/geow/Geow"],function(h,b,k){b.provide("arcgisonline.sharing.dijit.SignUpInternal");
b.require("dijit._Widget");b.require("dijit._Templated");b.require("dijit.form.Button");b.require("dijit.form.ValidationTextBox");b.require("dojo.data.ItemFileReadStore");b.require("arcgisonline.sharing.util");b.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");b.require("arcgisonline.sharing.geow.Account");b.require("arcgisonline.sharing.geow.Geow");b.declare("arcgisonline.sharing.dijit.SignUpInternal",[h._Widget,h._Templated],{util:arcgisonline.sharing.util,geow:arcgisonline.sharing.geow.Geow,
widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContent"\x3e\r\n  \x3cdiv id\x3d"sign-up-form" class\x3d"newStyles grid-50"\x3e\r\n    \x3c!--\x3ch1\x3e${i18n.signUpInternalTitle}\x3c/h1\x3e--\x3e\r\n    \x3cbr/\x3e\x3cdiv id\x3d"register-error"\x3e\x3c/div\x3e\r\n    \x3cform data-dojo-type\x3d"dijit.form.Form" id\x3d"signup-form" method\x3d"POST" action\x3d""\x3e\r\n      \x3cp\x3e${i18n.enterAccountInfo}\x3c/p\x3e\r\n      \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel class\x3d"requiredLabel" for\x3d"register_fullname"\x3e${i18n.fullNameLabel}\x3c/label\x3e\r\n        \x3cinput id\x3d"register_fullname" name\x3d"register_fullname" data-dojo-attach-point\x3d"_fullname" data-dojo-type\x3d"dijit.form.TextBox" data-dojo-props\x3d"trim:true"/\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel class\x3d"requiredLabel" for\x3d"register_email"\x3e${i18n.currentEmailAdr}\x3c/label\x3e\r\n        \x3cinput id\x3d"register_email" name\x3d"register_email" data-dojo-attach-point\x3d"_email" data-dojo-type\x3d"dijit.form.TextBox" data-dojo-props\x3d"trim:true"/\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel class\x3d"requiredLabel" for\x3d"confirm_register_email"\x3e${i18n.confirmEmailAdr}\x3c/label\x3e\r\n        \x3cinput id\x3d"confirm_register_email" name\x3d"confirm_register_email" data-dojo-attach-point\x3d"_confirmEmail" data-dojo-type\x3d"dijit.form.TextBox" data-dojo-props\x3d"trim:true"/\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel class\x3d"requiredLabel" for\x3d"register_username"\x3e${i18n.yourUserName}\x3c/label\x3e\r\n        \x3cinput id\x3d"register_username" name\x3d"register_username" data-dojo-attach-point\x3d"_username" data-dojo-type\x3d"dijit.form.TextBox" data-dojo-attach-event\x3d"onChange:onUsernameChange" data-dojo-props\x3d"trim:true"/\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel class\x3d"requiredLabel" for\x3d"register_password"\x3e${i18n.choosePwd}\x3c/label\x3e\r\n        \x3cinput id\x3d"register_password" name\x3d"register_password" data-dojo-attach-point\x3d"_pwd" type\x3d"password" data-dojo-type\x3d"dijit.form.TextBox" data-dojo-props\x3d"trim:true"/\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel class\x3d"requiredLabel" for\x3d"register_password2"\x3e${i18n.renterPwd}\x3c/label\x3e\r\n        \x3cinput id\x3d"register_password2" name\x3d"register_password2" data-dojo-attach-point\x3d"_verifyPwd" type\x3d"password" data-dojo-type\x3d"dijit.form.TextBox" data-dojo-props\x3d"trim:true"/\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel class\x3d"requiredLabel" for\x3d"identity_question"\x3e${i18n.identityQLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"identity_question" data-dojo-attach-point\x3d"_identityQuestion" data-dojo-type\x3d"dijit.form.ComboBox"\r\n             data-dojo-attach-event\x3d"onChange:onIdentityQuestionChange" style\x3d"width:350px;margin-left:0;margin-right:0;"\r\n             data-dojo-props\x3d"trim:true"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel class\x3d"requiredLabel" for\x3d"identity_answer"\x3e${i18n.identityALabel}\x3c/label\x3e\r\n        \x3cinput id\x3d"identity_answer" data-dojo-attach-point\x3d"_identityAnswer" data-dojo-type\x3d"dijit.form.TextBox" data-dojo-props\x3d"trim:true"/\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"bottom-buttons"\x3e\r\n        \x3cbutton id\x3d"button_create_account" class\x3d"calcite blue" type\x3d"submit" data-dojo-attach-point\x3d"_createAccountBtn" data-dojo-type\x3d"dijit.form.Button"\x3e${i18n.createAcc}\x3c/button\x3e\r\n        \x3cbutton id\x3d"button_cancel" class\x3d"calcite transparent" type\x3d"button" data-dojo-attach-event\x3d"onClick:onCancel" data-dojo-type\x3d"dijit.form.Button"\x3e${i18n.cancel}\x3c/button\x3e\r\n      \x3c/div\x3e\r\n    \x3c/form\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
redirectUrl:esriGeowConfig.baseUrl.replace("https:","http:")+"index.html",orgRedirectUrl:esriGeowConfig.baseUrl.replace("https:","http:")+"organization.html",_fullname:null,_email:null,_confirmEmail:null,_username:null,_pwd:null,_verifyPwd:null,_identityQuestion:null,_identityQuestionID:null,_identityAnswer:null,_createAccountBtn:null,isValidUsername:!1,invitation:null,invitationOrgName:null,identityQuestions:null,accountMode:"arcgis",i18n:null,postMixInProperties:function(){this.inherited(arguments);
this.i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").signUpInternalWidget);this.i18n.securityQuestions=b.i18n.getLocalization("arcgisonline","arcgisonline").securityQuestions},postCreate:function(){},startup:function(){this.inherited(arguments);b.mixin(this,b.queryToObject(window.location.search.slice(1)));esri.config.defaults.io.proxyUrl=esriGeowConfig.proxyServer;this._svcUrl=esriGeowConfig.restBaseUrl+(esriGeowConfig.restBaseUrl.lastIndexOf("/")===
esriGeowConfig.restBaseUrl.length-1?"":"/");this._communityUri=this._svcUrl+"community/";b.attr(b.byId("registerYour"),"innerHTML",this.i18n.signUpInternalTitle);this.setupQuestions();this.loadConnections();this.checkInvitation();setTimeout(b.hitch(this,function(){this._fullname.focus()}),50);b.subscribe("registerUser",this,"registerUser")},setupQuestions:function(){this.identityQuestions=[{id:1,name:this.i18n.securityQuestions[1]},{id:2,name:this.i18n.securityQuestions[2]},{id:3,name:this.i18n.securityQuestions[3]},
{id:4,name:this.i18n.securityQuestions[4]},{id:5,name:this.i18n.securityQuestions[5]},{id:6,name:this.i18n.securityQuestions[6]},{id:7,name:this.i18n.securityQuestions[7]},{id:8,name:this.i18n.securityQuestions[8]},{id:9,name:this.i18n.securityQuestions[9]},{id:10,name:this.i18n.securityQuestions[10]},{id:11,name:this.i18n.securityQuestions[11]},{id:12,name:this.i18n.securityQuestions[12]},{id:13,name:this.i18n.securityQuestions[13]},{id:14,name:this.i18n.securityQuestions[14]}];this._identityQuestion.set("store",
new b.data.ItemFileReadStore({data:{identifier:"name",label:"id",items:this.identityQuestions}}));this._identityQuestion.set("value",this.i18n.securityQLabel)},loadConnections:function(){b.connect(h.byId("signup-form"),"onSubmit",this,"signUp")},checkInvitation:function(){this.invitation&&this._fetchInvitation().then(b.hitch(this,function(a){this.invitationOrgName=a.account.name}))},signIn:function(a,c){esriGeowConfig.self=null;arcgisonline.sharing.geow.Account.getSelf(b.hitch(this,this.routeUser))},
routeUser:function(a,c){var d=this.util.getUser(),e=b.queryToObject(window.location.search.slice(1)).returnUrl;if(a&&!a.code&&!a.message){var f=a.allSSL,g=arcgisonline.sharing.util.usePortalSSL();this.redirectUrl=arcgisonline.sharing.util.getHttpUrl()+"index.html";this.orgRedirectUrl=arcgisonline.sharing.util.getHttpUrl()+"organization.html";e?(g=!!(-1<e.indexOf("https:")),window.location=f||g?arcgisonline.sharing.util.getSecureUrl(e):e):window.location="account_admin"===d.role?f||g?arcgisonline.sharing.util.getSecureUrl()+
"organization.html":this.orgRedirectUrl:f||g?arcgisonline.sharing.util.getSecureUrl()+"index.html":this.redirectUrl}else window.location=null!==e?e:arcgisonline.sharing.util.getHttpUrl()+"user.html?newUser\x3dtrue"},signUp:function(a){a.preventDefault();b.query("#register-error")&&(b.byId("register-error").innerHTML="",b.removeClass("register-error","error"));!1!==this.validateForm()&&(this._createAccountBtn.set("disabled",!0),this._createAccountBtn.set("label",this.i18n.creatingAcc),this.registerUser(!0))},
onUsernameChange:function(a){arcgisonline.sharing.geow.Account.checkUsernames([a],b.hitch(this,this._handleCheckUsername),b.hitch(this,this._handleCheckUsername))},_handleCheckUsername:function(a){this.isValidUsername=!1;if(a&&!a.code&&!a.message){if(a.usernames&&0<a.usernames.length){var b=this._username.get("value");b!==a.usernames[0].suggested?(b=arcgisonline.sharing.util.getSecureUrl(esriGeowConfig.baseUrl),a=esri.substitute({username:a.usernames[0].requested,linkStart:"\x3cspan class\x3d'esriItemLinks'\x3e\x3ca href\x3d'"+
b+esriGeowConfig.signin+window.location.search+"'\x3e",linkEnd:"\x3c/a\x3e\x3c/span\x3e"},this.i18n.error.usernameInUse),this.showError(a)):(this.isValidUsername=!0,this.clearError())}}else a.messageCode&&"DB_0006"===a.messageCode?this.showError(this.i18n.error.restrictedCharacters):b?this.showError(this.i18n.error.checkingUsername):(console.log("error checking usernames",a),this.isValidUsername=!0,this.clearError())},onIdentityQuestionChange:function(a){var c=this._identityQuestion.get("store"),
d;c.fetch({onComplete:b.hitch(this,function(b){for(d=0;d<b.length;d++)if(a==c.getValue(b[d],"name")){this._identityQuestionID=c.getValue(b[d],"id");break}})})},onCancel:function(a){a=esriGeowConfig.baseUrl.replace("http:","https:")+esriGeowConfig.signin;this.invitation&&(a+="?invitation\x3d"+this.invitation);window.location=a},validateForm:function(){var a=this._fullname.get("value"),b=this._email.get("value"),d=this._confirmEmail.get("value"),e=this._username.get("value"),f=this._pwd.get("value"),
g=this._verifyPwd.get("value"),l=this._identityAnswer.get("value"),m=[];(null===a||""===a)&&m.push(this.i18n.error.fullNameReqd);(null===b||""===b)&&m.push(this.i18n.error.emailReqd);null===d||""===d?m.push(this.i18n.error.confirmEmailReqd):b!==d&&m.push(this.i18n.error.confirmEmailNoMatch);null===e||""===e?m.push(this.i18n.error.userReqd):4>e.length||24<e.length?m.push(this.i18n.error.usernameInValid):this.isValidUsername||m.push(esri.substitute({username:e,linkStart:"\x3cspan class\x3d'esriItemLinks'\x3e\x3ca href\x3d'"+
arcgisonline.sharing.util.getSecureUrl(esriGeowConfig.baseUrl)+esriGeowConfig.signin+window.location.search+"'\x3e",linkEnd:"\x3c/a\x3e\x3c/span\x3e"},this.i18n.error.usernameInUse));null===f||""===f?m.push(this.i18n.error.passReqd):(8>f.length||28<f.length)&&m.push(this.i18n.error.invalidPassword);f!==g&&m.push(this.i18n.error.passwordsNotMatch);(!this._identityQuestionID||1>this._identityQuestionID)&&m.push(this.i18n.error.questionSelection);(void 0===l||null===l||""===l)&&m.push(this.i18n.error.answerIsBlank);
60<l.length&&m.push(this.i18n.error.answerTooLong);if(0===m.length)return!0;a="";for(b=0;b<m.length;b++)a+=m[b],a+="\x3cbr/\x3e";arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.notice,message:a});return!1},registerUser:function(a){a=this._fullname.get("value");var c=this._email.get("value"),d=this._username.get("value"),e=this._pwd.get("value"),f=this._identityAnswer.get("value"),g,l;a?(l=a.split(" "),1<l.length?(g="ja"===b.locale?l[l.length-1]:l[0],
l="ja"===b.locale?l[0]:l[l.length-1]):l=g=a):l=g=a;var m={fullname:a,firstname:g,lastname:l,email:c,username:d,password:e,securityQuestionIdx:this._identityQuestionID,securityAnswer:f};this.invitation&&(m.invitationId=this.invitation,m.provider=this.accountMode);this.geow.signup(m,b.hitch(this,function(a,c){null!=a.error&&""!=a.error?(this._createAccountBtn.set("disabled",!1),this._createAccountBtn.set("label",this.i18n.createAcc),a.error.messageCode&&"COM_1054"===a.error.messageCode?arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorTitle,
message:this.i18n.error.maxUsers}):this.errorHandler(a,c)):this.invitation?this.geow.signInHandler(m.username,b.hitch(this,"acceptInvitation",m),b.hitch(this,"signInError"),a,c):this.geow.signInHandler(m.username,b.hitch(this,"signIn"),b.hitch(this,"signInError"),a,c)}),b.hitch(this,"signUpError"))},acceptInvitation:function(a,c,d){arcgisonline.sharing.geow.Account.acceptInvitation(this.invitation,b.hitch(this,function(){this.geow.signin({username:a.username,password:a.password,expiration:esriGeowConfig.tokenExpiration},
b.hitch(this,"signIn"),b.hitch(this,"signInError"))}),b.hitch(this,this.onAcceptFail))},signUpError:function(a,b){h.byId("button_create_account").set("disabled",!1);h.byId("button_create_account").set("label",this.i18n.createAccount);var d=this.i18n.unableCreateAccount,e=this.i18n.contactAdmin;-1<a.message.indexOf("already registered")&&(e=this.i18n.error.emailInUse);-1<a.message.indexOf("Username '")&&-1<a.message.indexOf("' not available.")&&(e=this.i18n.error.usernameInValid);d='\x3cb style\x3d"font-size:1.2em;line-height:30px;"\x3e'+
d+'\x3c/b\x3e\x3cbr/\x3e\x3cspan style\x3d"color:#000000;"\x3e';d+=e;d+="\x3c/span\x3e\x3cbr/\x3e\x26nbsp;";this.showError(d)},signInError:function(a,b){h.byId("button_create_account").set("disabled",!1);h.byId("button_create_account").set("label",this.i18n.createAccount);var d="\x3cb style\x3d'font-size:1.2em;line-height:30px;'\x3e"+this.i18n.unableSignAuto+"\x3c/b\x3e\x3cbr/\x3e",d=d+'\x3cspan style\x3d"color:#000000;"\x3e'+this.i18n.pleaseTrySignManually,d=d+"\x3c/span\x3e\x3cbr/\x3e\x26nbsp;";
this.showError(d)},clearError:function(){b.removeClass("register-error","error");b.attr(b.byId("register-error"),"innerHTML","")},showError:function(a){b.addClass("register-error","error");b.attr(b.byId("register-error"),"innerHTML",a)},onFetchInvitation:function(a,c){var d;if(a&&a.code&&a.message&&403===a.code){var e="\x3cp\x3e"+this.i18n.emailInvitation+"\x3c/p\x3e\x3cp\x3e"+this.i18n.clickOkSignIn+"\x3c/p\x3e";d=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();d.onOkClick=
b.hitch(this,function(a,b){a.hide();window.location=esriGeowConfig.baseUrl.replace("http:","https:")+esriGeowConfig.signin},d);d.show({title:this.i18n.notice,message:e})}else a&&a.code&&a.message&&400===a.code?(e="\x3cp\x3e"+this.i18n.invitationUsedMsg+"\x3c/p\x3e\x3cp\x3e"+this.i18n.clickOkSignIn+"\x3c/p\x3e",d=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),d.onOkClick=b.hitch(this,function(a,b){a.hide();window.location=arcgisonline.sharing.util.getSecureUrl()+esriGeowConfig.signin},
d),d.show({title:this.i18n.notice,message:e})):a&&a.id&&a.id===this.invitation?this.invitationOrgName=a.account.name:this.invitation=null},onAcceptFail:function(a,c){var d=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();d.onOkClick=b.hitch(this,function(a,b){a.hide();this._createAccount.set("disabled",!1);this._createAccount.set("label",this.i18n.createAcc)},d);d.show({title:this.i18n.unableToJoin,message:this.i18n.problemJoining})},_fetchInvitation:function(){return this._request(this._communityUri+
"invitations/"+this.invitation,null,{errBack:b.hitch(this,"onFetchInvitation")})},_acceptInvitation:function(){return this._request(esriGeowConfig.restBaseUrl+"community/invitations/"+this.invitation+"/accept",{token:this.util.getUser().token},{errBack:b.hitch(this,"onAcceptFail")})},_request:function(a,c,d){c=b.mixin(c||{},this._requestParams);return this.util.request({url:a,content:c},d||{}).then(b.hitch(this,function(a){return a.error?d.errBack?d.errBack(a.error):this._showError(a.error):a}),b.hitch(this,
function(a){d.errBack?d.errBack(a):this._showError(a);throw a;}))},_showError:function(a){a=a.error||a||{};a.code=a.code||0;a=this.i18n.errors[a.code]||a;a.details=a.details&&a.details.length?b.filter(a.details,"return item !\x3d\x3d null"):null;a.details&&a.details.length&&(a.details=a.details.join("\x3cbr /\x3e"),a.message=a.message?a.message+"\x3cbr /\x3e"+a.details:a.details);a=b.mixin(b.mixin({},this.i18n.errors.error),a);b.addClass("register-error","error");b.attr(b.byId("register-error"),"innerHTML",
a.message+"\x3cbr/\x3e");return!0}})})},"arcgisonline/sharing/dijit/ChangePassword":function(){define(["dijit","dojo","dojox","dojo/i18n!arcgisonline/nls/arcgisonline","dojo/require!dijit/_Templated,dijit/form/Button,dijit/form/TextBox,dijit/layout/ContentPane,arcgisonline/sharing/util,arcgisonline/sharing/geow/Community,arcgisonline/sharing/dijit/dialog/GeneralDlg"],function(h,b,k){b.provide("arcgisonline.sharing.dijit.ChangePassword");b.require("dijit._Templated");b.require("dijit.form.Button");
b.require("dijit.form.TextBox");b.require("dijit.layout.ContentPane");b.require("arcgisonline.sharing.util");b.require("arcgisonline.sharing.geow.Community");b.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");b.requireLocalization("arcgisonline","arcgisonline");b.declare("arcgisonline.sharing.dijit.ChangePassword",[h._Widget,h._Templated],{widgetsInTemplate:!0,templateString:'\x3cdiv dojotype\x3d"dijit.layout.ContentPane" region\x3d"top" dojoAttachPoint\x3d"containerNode"\x3e\r\n\r\n  \x3ch1\x3e${i18n.changePasswordLabel}\x3c/h1\x3e\r\n  \x3cdiv style\x3d"overflow:auto; margin-top:15px;" class\x3d"userDetails"\x3e\r\n\r\n    \x3cdiv class\x3d"esriFloatLeading" style\x3d"clear:both; width: 150px;"\x3e\r\n      \x3cimg dojoAttachPoint\x3d"thumbnailImage" class\x3d"profileThumbnail" /\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"esriFloatLeading esriLeadingMargin1" style\x3d"width:700px;"\x3e\r\n\r\n      \x3cspan class\x3d"esriItemTitle" style\x3d"display:block;" dojoAttachPoint\x3d"label_fullName"\x3e\x3c/span\x3e\r\n\r\n      \x3cdiv style\x3d"margin-top:1em;" class\x3d"property"\x3e\r\n        \x3ctable\x3e\r\n          \x3ctbody\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\r\n                \x3clabel for\x3d"new_password" style\x3d"padding:0;margin:0;"\x3e\r\n                  ${i18n.newPasswordLabel}\r\n                \x3c/label\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv id\x3d"new_password" name\x3d"new_password" style\x3d"padding:2px;margin:0;" type\x3d"password" dojotype\x3d"dijit.form.TextBox" trim\x3d"true"\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr height\x3d"5"\x3e\r\n              \x3ctd colspan\x3d"2" height\x3d"5"\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\r\n                \x3clabel for\x3d"verify_password" style\x3d"padding:0;margin:0;"\x3e\r\n                  ${i18n.verifyPasswordLabel}\r\n                \x3c/label\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv id\x3d"verify_password" name\x3d"verify_password" style\x3d"padding:2px;margin:0;" type\x3d"password" dojotype\x3d"dijit.form.TextBox" trim\x3d"true"\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cbr/\x3e\r\n                \x3cdiv dojoType\x3d"dijit.form.Button" type\x3d"button" dojoAttachEvent\x3d"onClick:_submitPasswordChange" iconclass\x3d"esriSaveIcon"\x3e${i18n.changePasswordLabel}\x3c/div\x3e\r\n                \x3cdiv dojoType\x3d"dijit.form.Button" type\x3d"button" dojoAttachEvent\x3d"onClick:_cancelPasswordChange" iconclass\x3d"esriCloseIcon"\x3e${i18n.cancel}\x3c/div\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n          \x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n\r\n    \x3c/div\x3e\r\n\r\n  \x3c/div\x3e\r\n\r\n  \x3cform dojoAttachPoint\x3d"passwordForm" method\x3d"post"\x3e\r\n    \x3cinput type\x3d"hidden" name\x3d"username"/\x3e\r\n    \x3cinput type\x3d"hidden" name\x3d"fullName"/\x3e\r\n    \x3cinput type\x3d"hidden" name\x3d"email"/\x3e\r\n    \x3cinput type\x3d"hidden" name\x3d"password"/\x3e\r\n    \x3cinput type\x3d"hidden" name\x3d"organization"/\x3e\r\n    \x3cinput type\x3d"hidden" name\x3d"tags"/\x3e\r\n    \x3cinput type\x3d"hidden" name\x3d"description"/\x3e\r\n    \x3cinput type\x3d"hidden" name\x3d"privacy"/\x3e\r\n    \x3cinput type\x3d"hidden" name\x3d"storageQuota"/\x3e\r\n  \x3c/form\x3e\r\n\x3c/div\x3e\r\n',
_util:arcgisonline.sharing.util,_community:arcgisonline.sharing.geow.Community,_user:null,_showUser:null,_profile:null,_isAdmin:!1,_submitButton:null,_cancelButton:null,thumbnailPath:null,thumbnailImage:null,label_fullName:null,passwordForm:null,accountAdminRole:"account_admin",i18n:null,constructor:function(){var a=b.queryToObject(window.location.search.slice(1));a.user&&0<a.user.length&&(this._showUser=a.user);this._util.isLoggedIn()?(this._user=this._util.getUser(),this._user.accountId&&(this._user.role&&
this._user.role===this.accountAdminRole)&&(this._isAdmin=!0)):this._showUser||this._util.requireAuthentication()},postMixInProperties:function(){this.inherited(arguments);this.i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").changePassword);this.i18n.invalidPasswordLength=b.i18n.getLocalization("arcgisonline","arcgisonline").troubleshoot.errors.invalidPassword.message},postCreate:function(){this.inherited(arguments);
esri.config.defaults.io.proxyUrl=esriGeowConfig.proxyServer;this.thumbnailImage.src=b.baseUrl.substring(0,b.baseUrl.indexOf("/js"))+"/js/arcgisonline/css/images/transparent.gif"},startup:function(){this._community.getProfile(this._isAdmin&&this._showUser?this._showUser:this._user.email,b.hitch(this,this._handle_getProfile))},onProfileLoad:function(a){},_handle_getProfile:function(a){this._profile=a;this._loadProfile(a);this.onProfileLoad(this._profile)},_handle_updateProfile:function(a){this._loadUserPage()},
_loadProfile:function(a){this.thumbnailImage.src=a.thumbnail&&0<a.thumbnail.length?this._community.getProfileThumbnailUrl(a,!0):b.baseUrl.substring(0,b.baseUrl.indexOf("/js"))+"/js/arcgisonline/css/images/no-user-thumb.jpg";this.label_fullName.innerHTML=a.fullName},_submitPasswordChange:function(a){a=this.passwordForm;a.username.value=this._profile.username;a.fullName.value=this._profile.fullName;a.email.value=this._profile.email;a.tags.value=this._profile.tagsStr;a.description.value=this._profile.description;
a.privacy.value=this._profile.privacy;a.storageQuota.value=this._profile.storageQuota;var c=b.byId("new_password").value,d=b.byId("verify_password").value,e=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();8>c.length||28<c.length?e.show({title:this.i18n.invalidPassword,message:this.i18n.invalidPasswordLength}):0<c.length&&0<d.length&&c===d?(a.password.value=c,this._community.updateUserSecure(this._isAdmin&&this._showUser?this._showUser:this._user.email,a,b.hitch(this,this._handle_updateProfile))):
1>c.length?e.show({title:this.i18n.invalidPassword,message:this.i18n.passwordBlank}):e.show({title:this.i18n.invalidPassword,message:this.i18n.noMatch})},_cancelPasswordChange:function(a){this._loadUserPage()},_loadUserPage:function(){var a=esriGeowConfig.baseUrl+"user.html";this._isAdmin&&this._showUser&&(a+="?user\x3d"+this._showUser);window.location=a}})})},"dijit/form/RadioButton":function(){define(["dojo/_base/declare","./CheckBox","./_RadioButtonMixin"],function(h,b,k){return h("dijit.form.RadioButton",
[b,k],{baseClass:"dijitRadio"})})},"dojox/data/QueryReadStore":function(){define(["dojo","dojox","dojo/data/util/sorter","dojo/string"],function(h,b){return h.declare("dojox.data.QueryReadStore",null,{url:"",requestMethod:"get",_className:"dojox.data.QueryReadStore",_items:[],_lastServerQuery:null,_numRows:-1,lastRequestHash:null,doClientPaging:!1,doClientSorting:!1,_itemsByIdentity:null,_identifier:null,_features:{"dojo.data.api.Read":!0,"dojo.data.api.Identity":!0},_labelAttr:"label",constructor:function(b){h.mixin(this,
b)},getValue:function(b,a,c){this._assertIsItem(b);if(!h.isString(a))throw Error(this._className+".getValue(): Invalid attribute, string expected!");return!this.hasAttribute(b,a)&&c?c:b.i[a]},getValues:function(b,a){this._assertIsItem(b);var c=[];this.hasAttribute(b,a)&&c.push(b.i[a]);return c},getAttributes:function(b){this._assertIsItem(b);var a=[],c;for(c in b.i)a.push(c);return a},hasAttribute:function(b,a){return this.isItem(b)&&"undefined"!=typeof b.i[a]},containsValue:function(b,a,c){b=this.getValues(b,
a);a=b.length;for(var d=0;d<a;d++)if(b[d]==c)return!0;return!1},isItem:function(b){return b?"undefined"!=typeof b.r&&b.r==this:!1},isItemLoaded:function(b){return this.isItem(b)},loadItem:function(b){this.isItemLoaded(b.item)},fetch:function(b){b=b||{};b.store||(b.store=this);var a=this;this._fetchItems(b,function(b,d,e){var f=d.abort||null,g=!1,l=d.start?d.start:0;!1==a.doClientPaging&&(l=0);var m=d.count?l+d.count:b.length;d.abort=function(){g=!0;f&&f.call(d)};var n=d.scope||h.global;d.store||(d.store=
a);d.onBegin&&d.onBegin.call(n,e,d);d.sort&&a.doClientSorting&&b.sort(h.data.util.sorter.createSortFunction(d.sort,a));if(d.onItem)for(e=l;e<b.length&&e<m;++e){var k=b[e];g||d.onItem.call(n,k,d)}d.onComplete&&!g&&(e=null,d.onItem||(e=b.slice(l,m)),d.onComplete.call(n,e,d))},function(a,b){b.onError&&b.onError.call(b.scope||h.global,a,b)});return b},getFeatures:function(){return this._features},close:function(b){},getLabel:function(b){if(this._labelAttr&&this.isItem(b))return this.getValue(b,this._labelAttr)},
getLabelAttributes:function(b){return this._labelAttr?[this._labelAttr]:null},_xhrFetchHandler:function(b,a,c,d){b=this._filterResponse(b);b.label&&(this._labelAttr=b.label);d=b.numRows||-1;this._items=[];h.forEach(b.items,function(a){this._items.push({i:a,r:this})},this);b=b.identifier;this._itemsByIdentity={};if(b){this._identifier=b;var e;for(e=0;e<this._items.length;++e){var f=this._items[e].i,g=f[b];if(this._itemsByIdentity[g])throw Error(this._className+":  The json data as specified by: ["+
this.url+"] is malformed.  Items within the list have identifier: ["+b+"].  Value collided: ["+g+"]");this._itemsByIdentity[g]=f}}else{this._identifier=Number;for(e=0;e<this._items.length;++e)this._items[e].n=e}d=this._numRows=-1===d?this._items.length:d;c(this._items,a,d);this._numRows=d},_fetchItems:function(b,a,c){var d=b.serverQuery||b.query||{};this.doClientPaging||(d.start=b.start||0,b.count&&(d.count=b.count));if(!this.doClientSorting&&b.sort){var e=[];h.forEach(b.sort,function(a){a&&a.attribute&&
e.push((a.descending?"-":"")+a.attribute)});d.sort=e.join(",")}if(this.doClientPaging&&null!==this._lastServerQuery&&h.toJson(d)==h.toJson(this._lastServerQuery))this._numRows=-1===this._numRows?this._items.length:this._numRows,a(this._items,b,this._numRows);else{var f=("post"==this.requestMethod.toLowerCase()?h.xhrPost:h.xhrGet)({url:this.url,handleAs:"json-comment-optional",content:d,failOk:!0});b.abort=function(){f.cancel()};f.addCallback(h.hitch(this,function(d){this._xhrFetchHandler(d,b,a,c)}));
f.addErrback(function(a){c(a,b)});this.lastRequestHash=(new Date).getTime()+"-"+String(Math.random()).substring(2);this._lastServerQuery=h.mixin({},d)}},_filterResponse:function(b){return b},_assertIsItem:function(b){if(!this.isItem(b))throw Error(this._className+": Invalid item argument.");},_assertIsAttribute:function(b){if("string"!==typeof b)throw Error(this._className+": Invalid attribute argument ('"+b+"').");},fetchItemByIdentity:function(b){if(this._itemsByIdentity){var a=this._itemsByIdentity[b.identity];
if(void 0!==a){b.onItem&&b.onItem.call(b.scope?b.scope:h.global,{i:a,r:this});return}}this._fetchItems({serverQuery:{id:b.identity}},function(a,d){var e=b.scope?b.scope:h.global;try{var f=null;a&&1==a.length&&(f=a[0]);b.onItem&&b.onItem.call(e,f)}catch(g){b.onError&&b.onError.call(e,g)}},function(a,d){var e=b.scope?b.scope:h.global;b.onError&&b.onError.call(e,a)})},getIdentity:function(b){var a=null;return a=this._identifier===Number?b.n:b.i[this._identifier]},getIdentityAttributes:function(b){return[this._identifier]}})})},
"esri/geometry/jsonUtils":function(){define("dojo/_base/lang dojo/has ../kernel ./Point ./Polyline ./Polygon ./Multipoint ./Extent".split(" "),function(h,b,k,a,c,d,e,f){var g={fromJson:function(b){if(void 0!==b.x&&void 0!==b.y)return new a(b);if(void 0!==b.paths)return new c(b);if(void 0!==b.rings)return new d(b);if(void 0!==b.points)return new e(b);if(void 0!==b.xmin&&void 0!==b.ymin&&void 0!==b.xmax&&void 0!==b.ymax)return new f(b)},getJsonType:function(b){return b instanceof a?"esriGeometryPoint":
b instanceof c?"esriGeometryPolyline":b instanceof d?"esriGeometryPolygon":b instanceof f?"esriGeometryEnvelope":b instanceof e?"esriGeometryMultipoint":null},getGeometryType:function(b){return"esriGeometryPoint"===b?a:"esriGeometryPolyline"===b?c:"esriGeometryPolygon"===b?d:"esriGeometryEnvelope"===b?f:"esriGeometryMultipoint"===b?e:null}};b("extend-esri")&&h.mixin(h.getObject("geometry",!0,k),g);return g})},"dojox/widget/Rotator":function(){define("dojo/aspect dojo/_base/declare dojo/_base/Deferred dojo/_base/lang dojo/_base/array dojo/_base/fx dojo/dom dojo/dom-attr dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/topic dojo/on dojo/parser dojo/query dojo/fx/easing dojo/NodeList-dom".split(" "),
function(h,b,k,a,c,d,e,f,g,l,m,n,q,p,s){b=b("dojox.widget.Rotator",null,{transition:"dojox.widget.rotator.swap",transitionParams:"duration:500",panes:null,constructor:function(b,d){a.mixin(this,b);var k=this,q=k.transition,h=k._transitions={},y=k._idMap={},A=k.transitionParams=eval("({ "+k.transitionParams+" })");d=k._domNode=e.byId(d);k._domNodeContentBox=l.getContentBox(d);var z={left:0,top:0},G=function(a,b){console.warn(k.declaredClass,' - Unable to find transition "',a,'", defaulting to "',b,
'".')};k.id=d.id||(new Date).getTime();"static"==m.get(d,"position")&&m.set(d,"position","relative");h[q]=a.getObject(q);h[q]||(G(q,"dojox.widget.rotator.swap"),h[k.transition="dojox.widget.rotator.swap"]=a.getObject("dojox.widget.rotator.swap"));A.duration||(A.duration=500);c.forEach(k.panes,function(a){g.create("div",a,d)});var F=k.panes=[];s("\x3e *",d).forEach(function(b,d){var e={node:b,idx:d,params:a.mixin({},A,eval("({ "+(f.get(b,"transitionParams")||"")+" })"))},g=e.trans=f.get(b,"transition")||
k.transition;c.forEach(["id","title","duration","waitForEvent"],function(a){e[a]=f.get(b,a)});e.id&&(y[e.id]=d);if(!h[g]&&!(h[g]=a.getObject(g)))G(g,e.trans=k.transition);z.position="absolute";z.display="none";if(null==k.idx||f.get(b,"selected"))null!=k.idx&&m.set(F[k.idx].node,"display","none"),k.idx=d,z.display="";m.set(b,z);s("\x3e script[type^\x3d'dojo/method']",b).orphan().forEach(function(a){var b=f.get(a,"event");b&&(e[b]=p._functionFromScript(a))});F.push(e)});k._controlSub=n.subscribe(k.id+
"/rotator/control",a.hitch(k,this.control))},destroy:function(){c.forEach([this._controlSub,this.wfe],function(a){a.remove()});g.destroy(this._domNode)},next:function(){return this.go(this.idx+1)},prev:function(){return this.go(this.idx-1)},go:function(b){var c=this,d=c.idx,e=c.panes,f=e.length,g=c._idMap[b];c._resetWaitForEvent();b=null!=g?g:b||0;b=b<f?0>b?f-1:b:0;if(b==d||c.anim)return null;var l=e[d],p=e[b];m.set(l.node,"zIndex",2);m.set(p.node,"zIndex",1);var s={current:l,next:p,rotator:c};if(d=
c.anim=c._transitions[p.trans](a.mixin({rotatorBox:c._domNodeContentBox},s,p.params))){var q=new k,B=p.waitForEvent,E=h.after(d,"onEnd",function(){m.set(l.node,{display:"none",left:0,opacity:1,top:0,zIndex:0});E.remove();c.anim=null;c.idx=b;if(l.onAfterOut)l.onAfterOut(s);if(p.onAfterIn)p.onAfterIn(s);c.onUpdate("onAfterTransition");B||(c._resetWaitForEvent(),q.callback())},!0);c.wfe=B?n.subscribe(B,function(){c._resetWaitForEvent();q.callback(!0)}):null;c.onUpdate("onBeforeTransition");if(l.onBeforeOut)l.onBeforeOut(s);
if(p.onBeforeIn)p.onBeforeIn(s);d.play();return q}},onUpdate:function(a,b){n.publish(this.id+"/rotator/update",a,this,b||{})},_resetWaitForEvent:function(){this.wfe&&(this.wfe.remove(),delete this.wfe)},control:function(b){var c=a._toArray(arguments),d=this;c.shift();d._resetWaitForEvent();d[b]?((c=d[b].apply(d,c))&&c.addCallback(function(){d.onUpdate(b)}),d.onManualChange(b)):console.warn(d.declaredClass,' - Unsupported action "',b,'".')},resize:function(a,b){var d=this._domNodeContentBox={w:a,h:b};
l.setContentSize(this._domNode,d);c.forEach(this.panes,function(a){l.setContentSize(a.node,d)})},onManualChange:function(){}});a.setObject("dojox.widget.rotator.swap",function(a){return new d.Animation({play:function(){m.set(a.current.node,"display","none");m.set(a.next.node,"display","");this._fire("onEnd")}})});return b})},"dojo/dnd/AutoSource":function(){define(["../_base/declare","./Source"],function(h,b){return h("dojo.dnd.AutoSource",b,{constructor:function(){this.autoSync=!0}})})},"arcgisonline/sharing/geow/Community":function(){define(["dijit",
"dojo","dojox","dojo/require!arcgisonline/sharing/util,arcgisonline/sharing/dijit/dialog/NotificationsDlg"],function(h,b,k){b.provide("arcgisonline.sharing.geow.Community");b.require("arcgisonline.sharing.util");b.require("arcgisonline.sharing.dijit.dialog.NotificationsDlg");arcgisonline.sharing.geow.Community={util:arcgisonline.sharing.util,i18n:function(){if(this._i18n)return this._i18n;this._i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(this._i18n,b.i18n.getLocalization("arcgisonline",
"arcgisonline").community);return this._i18n},getProfile:function(a,c,d){if(null===a)return b.publish("globalMessage",[{message:this.i18n().noUser,type:"error",duration:0}]),null;this.util.getJson(esriGeowConfig.restBaseUrl+"community/users/"+a,c,null)},getProfileThumbnailUrl:function(a,b){if(null!==a.thumbnail){var d=this.util.getToken();if(b){var e=esriGeowConfig.restBaseUrl;esriGeowConfig.useDefaultIdentityStore&&(e=!1!==esriGeowConfig.useSSL?this.util.getSecureUrl(e):e);return e+"community/users/"+
a.username+"/info/"+a.thumbnail+(null===d||0==d.length?"":"?token\x3d"+d)}return esriGeowConfig.restBaseUrl+"community/users/"+a.username+"/info/"+a.thumbnail+(null===d||0==d.length?"":"?token\x3d"+d)}return null},updateProfile:function(a,c,d){d=this.util.getUser();null==d&&b.publish("globalMessage",[{message:this.i18n().mustLogIn,type:"error",duration:0}]);d=this.util.getSecureUrl(esriGeowConfig.restBaseUrl)+"community/users/"+d.email+"/update";this.util.postForm(a,d,c)},updateProfileByUser:function(a,
b,d){null!=this.util.getUser()&&(d=this.util.getSecureUrl(esriGeowConfig.restBaseUrl)+"community/users/"+a.username.value+"/update",this.util.postForm(a,d,b))},getUserGroups:function(a,b){var d=this.util.getUser();null!=d&&this.util.getJson(esriGeowConfig.restBaseUrl+"community/users/"+d.email,a,b)},getUserGroupsByUser:function(a,b,d){null!=this.util.getUser()&&this.util.getJson(esriGeowConfig.restBaseUrl+"community/users/"+a,b,d)},getGroup:function(a,b,d){this.util.getJson(esriGeowConfig.restBaseUrl+
"community/groups/"+a,b,d)},createGroup:function(a,b,d){null!=this.util.getUser()&&this.util.postForm(a,esriGeowConfig.restBaseUrl+"community/createGroup",b,d)},updateGroup:function(a,b,d,e){null!=this.util.getUser()&&this.util.postForm(b,esriGeowConfig.restBaseUrl+"community/groups/"+a+"/update",d,e)},deleteGroup:function(a,b,d){null!=this.util.getUser()&&this.util.postJson("",esriGeowConfig.restBaseUrl+"community/groups/"+a.id+"/delete",b,d)},reassignGroup:function(a,b,d,e){null!=this.util.getUser()&&
this.util.postJson({targetUsername:b},esriGeowConfig.restBaseUrl+"community/groups/"+a.id+"/reassign",d,e)},leaveGroup:function(a,b,d){this.util.postJson("",esriGeowConfig.restBaseUrl+"community/groups/"+a.id+"/leave",b,d)},inviteToGroup:function(a,b,d){null!=this.util.getUser()&&this.util.globalMessage("TODO: not implemented in rest","error",0)},searchGroups:function(a,b,d){this.util.getJson(esriGeowConfig.restBaseUrl+"community/groups?q\x3d"+a,b)},searchToStore:function(a){var c=[];b.forEach(a.results,
function(a,b){var f={id:b,title:this._getGroupTitleLink(a),owner:a.owner,description:a.description,imageUrl:a.imageUrl,tags:a.keywords,created:a.created};c[b]=f},this);return new b.data.ItemFileReadStore({data:{identifier:"id",label:"item",items:c}})},_getGroupTitleLink:function(a){return"\x3ca href\x3d'group.html?owner\x3d"+a.owner+"\x26title\x3d"+encodeURIComponent(a.title)+'\' class\x3d"esriGroupTitle" alt\x3d'+this.i18n().viewGroupDetails+" title\x3d"+this.i18n().viewGroupDetails+"\x3e"+a.title+
"\x3c/a\x3e"},getNotifications:function(){arcgisonline.sharing.dijit.dialog.NotificationsDlg.prototype.statics.getInstance().show()},getNotificationsCount:function(){var a=this.util.getUser();null!=a&&this.util.getJson(esriGeowConfig.restBaseUrl+"community/users/"+a.email+"/notifications",b.hitch(this,function(a,d){b.publish("onNotificationCount",[a.notifications.length])}))},deleteNotifictation:function(a){var c=this.util.getUser();null!=c&&this.util.postJson("",esriGeowConfig.restBaseUrl+"community/users/"+
c.email+"/notifications/"+a+"/delete",b.hitch(this,function(a,c){b.publish("onNotificationDelete",[""])}))},updateUserSecure:function(a,b,d,e){this.util.getUser();e=esriGeowConfig.restBaseUrl;esriGeowConfig.useDefaultIdentityStore&&(e=!1!==esriGeowConfig.useSSL?this.util.getSecureUrl(e):e);this.util.postForm(b,e+"community/users/"+a+"/update",d)}}})},"dijit/main":function(){define(["dojo/_base/kernel"],function(h){return h.dijit})},"dijit/_OnDijitClickMixin":function(){define("dojo/on dojo/_base/array dojo/keys dojo/_base/declare dojo/has ./a11yclick".split(" "),
function(h,b,k,a,c,d){h=a("dijit._OnDijitClickMixin",null,{connect:function(a,b,c){return this.inherited(arguments,[a,"ondijitclick"==b?d:b,c])}});h.a11yclick=d;return h})},"dojo/dnd/autoscroll":function(){define("../_base/lang ../sniff ../_base/window ../dom-geometry ../dom-style ../window".split(" "),function(h,b,k,a,c,d){var e={};h.setObject("dojo.dnd.autoscroll",e);e.getViewport=d.getBox;e.V_TRIGGER_AUTOSCROLL=32;e.H_TRIGGER_AUTOSCROLL=32;e.V_AUTOSCROLL_VALUE=16;e.H_AUTOSCROLL_VALUE=16;var f,
g=k.doc,l=Infinity,m=Infinity;e.autoScrollStart=function(a){g=a;f=d.getBox(g);a=k.body(g).parentNode;l=Math.max(a.scrollHeight-f.h,0);m=Math.max(a.scrollWidth-f.w,0)};e.autoScroll=function(a){var b=f||d.getBox(g),c=k.body(g).parentNode,s=0,h=0;a.clientX<e.H_TRIGGER_AUTOSCROLL?s=-e.H_AUTOSCROLL_VALUE:a.clientX>b.w-e.H_TRIGGER_AUTOSCROLL&&(s=Math.min(e.H_AUTOSCROLL_VALUE,m-c.scrollLeft));a.clientY<e.V_TRIGGER_AUTOSCROLL?h=-e.V_AUTOSCROLL_VALUE:a.clientY>b.h-e.V_TRIGGER_AUTOSCROLL&&(h=Math.min(e.V_AUTOSCROLL_VALUE,
l-c.scrollTop));window.scrollBy(s,h)};e._validNodes={div:1,p:1,td:1};e._validOverflow={auto:1,scroll:1};e.autoScrollNodes=function(d){for(var f,g,l,m,h,x,w=0,v=0,y=d.target;y;){if(1==y.nodeType&&y.tagName.toLowerCase()in e._validNodes){l=c.getComputedStyle(y);m=l.overflow.toLowerCase()in e._validOverflow;h=l.overflowX.toLowerCase()in e._validOverflow;x=l.overflowY.toLowerCase()in e._validOverflow;if(m||h||x)f=a.getContentBox(y,l),g=a.position(y,!0);if(m||h){l=Math.min(e.H_TRIGGER_AUTOSCROLL,f.w/2);
h=d.pageX-g.x;if(b("webkit")||b("opera"))h+=k.body().scrollLeft;w=0;0<h&&h<f.w&&(h<l?w=-l:h>f.w-l&&(w=l),y.scrollLeft+=w)}if(m||x){m=Math.min(e.V_TRIGGER_AUTOSCROLL,f.h/2);x=d.pageY-g.y;if(b("webkit")||b("opera"))x+=k.body().scrollTop;v=0;0<x&&x<f.h&&(x<m?v=-m:x>f.h-m&&(v=m),y.scrollTop+=v)}if(w||v)return}try{y=y.parentNode}catch(A){y=null}}e.autoScroll(d)};return e})},"dijit/form/_RadioButtonMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/_base/lang dojo/query!css2 ../registry".split(" "),
function(h,b,k,a,c,d){return b("dijit.form._RadioButtonMixin",null,{type:"radio",_getRelatedWidgets:function(){var b=[];c("input[type\x3dradio]",this.focusNode.form||this.ownerDocument).forEach(a.hitch(this,function(a){a.name==this.name&&a.form==this.focusNode.form&&(a=d.getEnclosingWidget(a))&&b.push(a)}));return b},_setCheckedAttr:function(b){this.inherited(arguments);this._created&&b&&h.forEach(this._getRelatedWidgets(),a.hitch(this,function(a){a!=this&&a.checked&&a.set("checked",!1)}))},_getSubmitValue:function(a){return null==
a?"on":a},_onClick:function(b){return this.checked||this.disabled?(b.stopPropagation(),b.preventDefault(),!1):this.readOnly?(b.stopPropagation(),b.preventDefault(),h.forEach(this._getRelatedWidgets(),a.hitch(this,function(a){k.set(this.focusNode||this.domNode,"checked",a.checked)})),!1):this.inherited(arguments)}})})},"arcgisonline/sharing/dijit/Role":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/json esri/lang".split(" "),function(h,b,k,a,c,d){return b(null,
{declaredClass:"arcgisonline.sharing.dijit.Role",basePath:h.toUrl("arcgisonline/sharing/dijit"),id:null,baseRole:null,name:null,description:null,privileges:[],privilegeObj:null,constructor:function(a){a=a||{};this.id=a.id;this.baseRole=a.role;this.name=a.name;this.description=a.description},_initPrivilegesObject:function(){this.privilegeObj={portal:{admin:{inviteUsers:!1,disableUsers:!1,viewUsers:!1,updateUsers:!1,deleteUsers:!1,changeUserRoles:!1,viewGroups:!1,updateGroups:!1,deleteGroups:!1,reassignGroups:!1,
assignToGroups:!1,manageEnterpriseGroups:!1,viewItems:!1,updateItems:!1,deleteItems:!1,reassignItems:!1,manageLicenses:!1},publisher:{publishFeatures:!1,publishTiles:!1,publishScenes:!1},user:{createGroup:!1,joinGroup:!1,joinNonOrgGroup:!1,createItem:!1,shareToGroup:!1,shareToOrg:!1,shareToPublic:!1,shareGroupToOrg:!1,shareGroupToPublic:!1}},features:{user:{edit:!1,fullEdit:!1}},opendata:{user:{openDataAdmin:!1,designateGroup:!1}},premium:{user:{geocode:!1,networkanalysis:!1,spatialanalysis:!1,geoenrichment:!1,
demographics:!1,elevation:!1}},marketplace:{admin:{manage:!1,purchase:!1,startTrial:!1}}}},_readPrivileges:function(b){d.isDefined(b)&&b instanceof Array&&a.forEach(b,k.hitch(this,function(a){this._readPrivilege(a)}))},_readPrivilege:function(a){this._applyEffectToAction(!0,a)},_applyEffectToAction:function(a,b){switch(b){case "portal:admin:inviteUsers":this.privilegeObj.portal.admin.inviteUsers=a;break;case "portal:admin:disableUsers":this.privilegeObj.portal.admin.disableUsers=a;break;case "portal:admin:viewUsers":this.privilegeObj.portal.admin.viewUsers=
a;break;case "portal:admin:updateUsers":this.privilegeObj.portal.admin.updateUsers=a;break;case "portal:admin:deleteUsers":this.privilegeObj.portal.admin.deleteUsers=a;break;case "portal:admin:changeUserRoles":this.privilegeObj.portal.admin.changeUserRoles=a;break;case "portal:admin:viewGroups":this.privilegeObj.portal.admin.viewGroups=a;break;case "portal:admin:updateGroups":this.privilegeObj.portal.admin.updateGroups=a;break;case "portal:admin:deleteGroups":this.privilegeObj.portal.admin.deleteGroups=
a;break;case "portal:admin:reassignGroups":this.privilegeObj.portal.admin.reassignGroups=a;break;case "portal:admin:assignToGroups":this.privilegeObj.portal.admin.assignToGroups=a;break;case "portal:admin:manageEnterpriseGroups":this.privilegeObj.portal.admin.manageEnterpriseGroups=a;break;case "portal:admin:viewItems":this.privilegeObj.portal.admin.viewItems=a;break;case "portal:admin:updateItems":this.privilegeObj.portal.admin.updateItems=a;break;case "portal:admin:deleteItems":this.privilegeObj.portal.admin.deleteItems=
a;break;case "portal:admin:reassignItems":this.privilegeObj.portal.admin.reassignItems=a;break;case "portal:admin:manageLicenses":this.privilegeObj.portal.admin.manageLicenses=a;break;case "portal:publisher:publishFeatures":this.privilegeObj.portal.publisher.publishFeatures=a;break;case "portal:publisher:publishTiles":this.privilegeObj.portal.publisher.publishTiles=a;break;case "portal:publisher:publishScenes":this.privilegeObj.portal.publisher.publishScenes=a;break;case "portal:user:createGroup":this.privilegeObj.portal.user.createGroup=
a;break;case "portal:user:joinGroup":this.privilegeObj.portal.user.joinGroup=a;break;case "portal:user:joinNonOrgGroup":this.privilegeObj.portal.user.joinNonOrgGroup=a;break;case "portal:user:createItem":this.privilegeObj.portal.user.createItem=a;break;case "portal:user:shareToGroup":this.privilegeObj.portal.user.shareToGroup=a;break;case "portal:user:shareToOrg":this.privilegeObj.portal.user.shareToOrg=a;break;case "portal:user:shareToPublic":this.privilegeObj.portal.user.shareToPublic=a;break;case "portal:user:shareGroupToOrg":this.privilegeObj.portal.user.shareGroupToOrg=
a;break;case "portal:user:shareGroupToPublic":this.privilegeObj.portal.user.shareGroupToPublic=a;break;case "features:user:edit":this.privilegeObj.features.user.edit=a;break;case "features:user:fullEdit":this.privilegeObj.features.user.fullEdit=a;break;case "opendata:user:openDataAdmin":this.privilegeObj.opendata.user.openDataAdmin=a;break;case "opendata:user:designateGroup":this.privilegeObj.opendata.user.designateGroup=a;break;case "premium:user:geocode":this.privilegeObj.premium.user.geocode=a;
break;case "premium:user:networkanalysis":this.privilegeObj.premium.user.networkanalysis=a;break;case "premium:user:spatialanalysis":this.privilegeObj.premium.user.spatialanalysis=a;break;case "premium:user:geoenrichment":this.privilegeObj.premium.user.geoenrichment=a;break;case "premium:user:demographics":this.privilegeObj.premium.user.demographics=a;break;case "premium:user:elevation":this.privilegeObj.premium.user.elevation=a;break;case "marketplace:admin:purchase":this.privilegeObj.marketplace.admin.purchase=
a;break;case "marketplace:admin:manage":this.privilegeObj.marketplace.admin.manage=a;break;case "marketplace:admin:startTrial":this.privilegeObj.marketplace.admin.startTrial=a}},_applyToAll:function(a){this.privilegeObj.portal.admin.inviteUsers=a;this.privilegeObj.portal.admin.disableUsers=a;this.privilegeObj.portal.admin.viewUsers=a;this.privilegeObj.portal.admin.updateUsers=a;this.privilegeObj.portal.admin.deleteUsers=a;this.privilegeObj.portal.admin.changeUserRoles=a;this.privilegeObj.portal.admin.viewGroups=
a;this.privilegeObj.portal.admin.updateGroups=a;this.privilegeObj.portal.admin.deleteGroups=a;this.privilegeObj.portal.admin.reassignGroups=a;this.privilegeObj.portal.admin.assignToGroups=a;this.privilegeObj.portal.admin.manageEnterpriseGroups=a;this.privilegeObj.portal.admin.viewItems=a;this.privilegeObj.portal.admin.updateItems=a;this.privilegeObj.portal.admin.deleteItems=a;this.privilegeObj.portal.admin.reassignItems=a;this.privilegeObj.portal.admin.manageLicenses=a;this.privilegeObj.portal.publisher.publishFeatures=
a;this.privilegeObj.portal.publisher.publishTiles=a;this.privilegeObj.portal.publisher.publishScenes=a;this.privilegeObj.portal.user.createGroup=a;this.privilegeObj.portal.user.joinGroup=a;this.privilegeObj.portal.user.joinNonOrgGroup=a;this.privilegeObj.portal.user.createItem=a;this.privilegeObj.portal.user.shareToGroup=a;this.privilegeObj.portal.user.shareToOrg=a;this.privilegeObj.portal.user.shareToPublic=a;this.privilegeObj.portal.user.shareGroupToOrg=a;this.privilegeObj.portal.user.shareGroupToPublic=
a;this.privilegeObj.features.user.edit=a;this.privilegeObj.opendata.user.openDataAdmin=a;this.privilegeObj.opendata.user.designateGroup=a;this.privilegeObj.premium.user.geocode=a;this.privilegeObj.premium.user.networkanalysis=a;this.privilegeObj.premium.user.spatialanalysis=a;this.privilegeObj.premium.user.geoenrichment=a;this.privilegeObj.premium.user.demographics=a;this.privilegeObj.premium.user.elevation=a;this.privilegeObj.marketplace.admin.purchase=a;this.privilegeObj.marketplace.admin.manage=
a;this.privilegeObj.marketplace.admin.startTrial=a},_buildPrivilegesArray:function(){var a=[];!0===this.privilegeObj.portal.admin.inviteUsers&&a.push("portal:admin:inviteUsers");!0===this.privilegeObj.portal.admin.disableUsers&&a.push("portal:admin:disableUsers");!0===this.privilegeObj.portal.admin.viewUsers&&a.push("portal:admin:viewUsers");!0===this.privilegeObj.portal.admin.updateUsers&&a.push("portal:admin:updateUsers");!0===this.privilegeObj.portal.admin.deleteUsers&&a.push("portal:admin:deleteUsers");
!0===this.privilegeObj.portal.admin.changeUserRoles&&a.push("portal:admin:changeUserRoles");!0===this.privilegeObj.portal.admin.viewGroups&&a.push("portal:admin:viewGroups");!0===this.privilegeObj.portal.admin.updateGroups&&a.push("portal:admin:updateGroups");!0===this.privilegeObj.portal.admin.deleteGroups&&a.push("portal:admin:deleteGroups");!0===this.privilegeObj.portal.admin.reassignGroups&&a.push("portal:admin:reassignGroups");!0===this.privilegeObj.portal.admin.assignToGroups&&a.push("portal:admin:assignToGroups");
!0===this.privilegeObj.portal.admin.manageEnterpriseGroups&&a.push("portal:admin:manageEnterpriseGroups");!0===this.privilegeObj.portal.admin.viewItems&&a.push("portal:admin:viewItems");!0===this.privilegeObj.portal.admin.updateItems&&a.push("portal:admin:updateItems");!0===this.privilegeObj.portal.admin.deleteItems&&a.push("portal:admin:deleteItems");!0===this.privilegeObj.portal.admin.reassignItems&&a.push("portal:admin:reassignItems");!0===this.privilegeObj.portal.admin.manageLicenses&&a.push("portal:admin:manageLicenses");
!0===this.privilegeObj.portal.publisher.publishFeatures&&a.push("portal:publisher:publishFeatures");!0===this.privilegeObj.portal.publisher.publishTiles&&a.push("portal:publisher:publishTiles");!0===this.privilegeObj.portal.publisher.publishScenes&&a.push("portal:publisher:publishScenes");!0===this.privilegeObj.portal.user.createGroup&&a.push("portal:user:createGroup");!0===this.privilegeObj.portal.user.joinGroup&&a.push("portal:user:joinGroup");!0===this.privilegeObj.portal.user.joinNonOrgGroup&&
a.push("portal:user:joinNonOrgGroup");!0===this.privilegeObj.portal.user.createItem&&a.push("portal:user:createItem");!0===this.privilegeObj.portal.user.shareToGroup&&a.push("portal:user:shareToGroup");!0===this.privilegeObj.portal.user.shareToOrg&&a.push("portal:user:shareToOrg");!0===this.privilegeObj.portal.user.shareToPublic&&a.push("portal:user:shareToPublic");!0===this.privilegeObj.portal.user.shareGroupToOrg&&a.push("portal:user:shareGroupToOrg");!0===this.privilegeObj.portal.user.shareGroupToPublic&&
a.push("portal:user:shareGroupToPublic");!0===this.privilegeObj.features.user.edit&&a.push("features:user:edit");!0===this.privilegeObj.features.user.fullEdit&&a.push("features:user:fullEdit");!0===this.privilegeObj.opendata.user.openDataAdmin&&a.push("opendata:user:openDataAdmin");!0===this.privilegeObj.opendata.user.designateGroup&&a.push("opendata:user:designateGroup");!0===this.privilegeObj.premium.user.geocode&&a.push("premium:user:geocode");!0===this.privilegeObj.premium.user.networkanalysis&&
a.push("premium:user:networkanalysis");!0===this.privilegeObj.premium.user.spatialanalysis&&a.push("premium:user:spatialanalysis");!0===this.privilegeObj.premium.user.geoenrichment&&a.push("premium:user:geoenrichment");!0===this.privilegeObj.premium.user.demographics&&a.push("premium:user:demographics");!0===this.privilegeObj.premium.user.elevation&&a.push("premium:user:elevation");!0===this.privilegeObj.marketplace.admin.purchase&&a.push("marketplace:admin:purchase");!0===this.privilegeObj.marketplace.admin.manage&&
a.push("marketplace:admin:manage");!0===this.privilegeObj.marketplace.admin.startTrial&&a.push("marketplace:admin:startTrial");return a},isUser:function(){return d.isDefined(this.id)&&("org_user"===this.id||"account_user"===this.id)},isPublisher:function(){return d.isDefined(this.id)&&("org_publisher"===this.id||"account_publisher"===this.id)},isAdmin:function(){return d.isDefined(this.id)&&("org_admin"===this.id||"account_admin"===this.id)},isBasedOnUser:function(){return this.isUser()||d.isDefined(this.baseRole)&&
("org_user"===this.baseRole||"account_user"===this.baseRole)},isBasedOnPublisher:function(){return this.isPublisher()||d.isDefined(this.baseRole)&&("org_publisher"===this.baseRole||"account_publisher"===this.baseRole)},isBasedOnAdmin:function(){return this.isAdmin()||d.isDefined(this.baseRole)&&("org_admin"===this.baseRole||"account_admin"===this.baseRole)},isCustom:function(){return!this.isUser()&&!this.isPublisher()&&!this.isAdmin()&&d.isDefined(this.id)&&0<this.id.length},canInviteUsers:function(){return this.privilegeObj&&
this.privilegeObj.portal.admin.inviteUsers},canDisableUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.disableUsers},canViewUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.viewUsers},canUpdateUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.updateUsers},canDeleteUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.deleteUsers},canChangeUserRoles:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.changeUserRoles},
canViewOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.viewGroups},canUpdateOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.updateGroups},canDeleteOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.deleteGroups},canReassignOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.reassignGroups},canAssignUsersToOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.assignToGroups},
canManageEnterpriseGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.manageEnterpriseGroups},canViewOrgItems:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.viewItems},canUpdateOrgItems:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.updateItems},canDeleteOrgItems:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.deleteItems},canReassignOrgItems:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.reassignItems},
canManageLicenses:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.manageLicenses},canCreateGroup:function(){return this.privilegeObj&&this.privilegeObj.portal.user.createGroup},canJoinOrgGroup:function(){return this.privilegeObj&&this.privilegeObj.portal.user.joinGroup},canJoinNonOrgGroup:function(){return this.privilegeObj&&this.privilegeObj.portal.user.joinNonOrgGroup},canPublishFeatures:function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.publishFeatures},
canPublishTiles:function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.publishTiles},canPublishScenes:function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.publishScenes},canCreateItem:function(){return this.privilegeObj&&this.privilegeObj.portal.user.createItem},canShareItemToGroup:function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareToGroup},canShareItemToOrg:function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareToOrg},canShareItemToPublic:function(){return this.privilegeObj&&
this.privilegeObj.portal.user.shareToPublic},canShareGroupToOrg:function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareGroupToOrg},canShareGroupToPublic:function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareGroupToPublic},canEditFeatures:function(){return this.privilegeObj&&this.privilegeObj.features.user.edit},canEditFeaturesFullControl:function(){return this.privilegeObj&&this.privilegeObj.features.user.fullEdit},canManageOpenData:function(){return this.privilegeObj&&
this.privilegeObj.opendata.user.openDataAdmin},canDesignateOpenDataGroups:function(){return this.privilegeObj&&this.privilegeObj.opendata.user.designateGroup},canUseGeocode:function(){return this.privilegeObj&&this.privilegeObj.premium.user.geocode},canUseNetworkAnalysis:function(){return this.privilegeObj&&this.privilegeObj.premium.user.networkanalysis},canUseSpatialAnalysis:function(){return this.privilegeObj&&this.privilegeObj.premium.user.spatialanalysis},canUseGeoenrichment:function(){return this.privilegeObj&&
this.privilegeObj.premium.user.geoenrichment},canUseDemographics:function(){return this.privilegeObj&&this.privilegeObj.premium.user.demographics},canUseElevation:function(){return this.privilegeObj&&this.privilegeObj.premium.user.elevation},canPurchaseMarketplace:function(){return this.privilegeObj&&this.privilegeObj.marketplace.admin.purchase},canManageMarketplace:function(){return this.privilegeObj&&this.privilegeObj.marketplace.admin.manage},canTrialMarketplace:function(){return this.privilegeObj&&
this.privilegeObj.marketplace.admin.startTrial},setPrivileges:function(a){this.privileges=a;this._initPrivilegesObject();d.isDefined(a)&&this._readPrivileges(a)},stringify:function(){return c.stringify({id:this.id,name:this.name,description:this.description,privileges:this._buildPrivilegesArray()})},stringifyRole:function(){return c.stringify({id:this.id,name:this.name,description:this.description})},stringifyPrivileges:function(){return c.stringify({privileges:this._buildPrivilegesArray()})},stringifyPretty:function(){return c.stringify({id:this.id,
name:this.name,description:this.description,privileges:this._buildPrivilegesArray()},null,"  ")}})})},"dojo/data/ItemFileWriteStore":function(){define("../_base/lang ../_base/declare ../_base/array ../_base/json ../_base/kernel ./ItemFileReadStore ../date/stamp".split(" "),function(h,b,k,a,c,d,e){return b("dojo.data.ItemFileWriteStore",d,{constructor:function(a){this._features["dojo.data.api.Write"]=!0;this._features["dojo.data.api.Notification"]=!0;this._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};
this._datatypeMap.Date.serialize||(this._datatypeMap.Date.serialize=function(a){return e.toISOString(a,{zulu:!0})});a&&!1===a.referenceIntegrity&&(this.referenceIntegrity=!1);this._saveInProgress=!1},referenceIntegrity:!0,_assert:function(a){if(!a)throw Error("assertion failed in ItemFileWriteStore");},_getIdentifierAttribute:function(){return this.getFeatures()["dojo.data.api.Identity"]},newItem:function(a,b){this._assert(!this._saveInProgress);this._loadFinished||this._forceLoad();if("object"!=
typeof a&&"undefined"!=typeof a)throw Error("newItem() was passed something other than an object");var c=null,d=this._getIdentifierAttribute();if(d===Number)c=this._arrayOfAllItems.length;else{c=a[d];if("undefined"===typeof c)throw Error("newItem() was not passed an identity for the new item");if(h.isArray(c))throw Error("newItem() was not passed an single-valued identity");}this._itemsByIdentity&&this._assert("undefined"===typeof this._itemsByIdentity[c]);this._assert("undefined"===typeof this._pending._newItems[c]);
this._assert("undefined"===typeof this._pending._deletedItems[c]);var e={};e[this._storeRefPropName]=this;e[this._itemNumPropName]=this._arrayOfAllItems.length;this._itemsByIdentity&&(this._itemsByIdentity[c]=e,e[d]=[c]);this._arrayOfAllItems.push(e);d=null;if(b&&b.parent&&b.attribute){var d={item:b.parent,attribute:b.attribute,oldValue:void 0},k=this.getValues(b.parent,b.attribute);if(k&&0<k.length){var p=k.slice(0,k.length);d.oldValue=1===k.length?k[0]:k.slice(0,k.length);p.push(e);this._setValueOrValues(b.parent,
b.attribute,p,!1);d.newValue=this.getValues(b.parent,b.attribute)}else this._setValueOrValues(b.parent,b.attribute,e,!1),d.newValue=e}else e[this._rootItemPropName]=!0,this._arrayOfTopLevelItems.push(e);this._pending._newItems[c]=e;for(var s in a){if(s===this._storeRefPropName||s===this._itemNumPropName)throw Error("encountered bug in ItemFileWriteStore.newItem");c=a[s];h.isArray(c)||(c=[c]);e[s]=c;if(this.referenceIntegrity)for(k=0;k<c.length;k++)p=c[k],this.isItem(p)&&this._addReferenceToMap(p,
e,s)}this.onNew(e,d);return e},_removeArrayElement:function(a,b){var c=k.indexOf(a,b);return-1!=c?(a.splice(c,1),!0):!1},deleteItem:function(a){this._assert(!this._saveInProgress);this._assertIsItem(a);var b=a[this._itemNumPropName],c=this.getIdentity(a);if(this.referenceIntegrity){var d=this.getAttributes(a);a[this._reverseRefMap]&&(a["backup_"+this._reverseRefMap]=h.clone(a[this._reverseRefMap]));k.forEach(d,function(b){k.forEach(this.getValues(a,b),function(c){this.isItem(c)&&(a["backupRefs_"+
this._reverseRefMap]||(a["backupRefs_"+this._reverseRefMap]=[]),a["backupRefs_"+this._reverseRefMap].push({id:this.getIdentity(c),attr:b}),this._removeReferenceFromMap(c,a,b))},this)},this);if(d=a[this._reverseRefMap])for(var e in d){var q=null;if(q=this._itemsByIdentity?this._itemsByIdentity[e]:this._arrayOfAllItems[e])for(var p in d[e]){var s=this.getValues(q,p)||[],t=k.filter(s,function(a){return!(this.isItem(a)&&this.getIdentity(a)==c)},this);this._removeReferenceFromMap(a,q,p);t.length<s.length&&
this._setValueOrValues(q,p,t,!0)}}}this._arrayOfAllItems[b]=null;a[this._storeRefPropName]=null;this._itemsByIdentity&&delete this._itemsByIdentity[c];this._pending._deletedItems[c]=a;a[this._rootItemPropName]&&this._removeArrayElement(this._arrayOfTopLevelItems,a);this.onDelete(a);return!0},setValue:function(a,b,c){return this._setValueOrValues(a,b,c,!0)},setValues:function(a,b,c){return this._setValueOrValues(a,b,c,!0)},unsetAttribute:function(a,b){return this._setValueOrValues(a,b,[],!0)},_setValueOrValues:function(a,
b,c,d){this._assert(!this._saveInProgress);this._assertIsItem(a);this._assert(h.isString(b));this._assert("undefined"!==typeof c);var e=this._getIdentifierAttribute();if(b==e)throw Error("ItemFileWriteStore does not have support for changing the value of an item's identifier.");var e=this._getValueOrValues(a,b),q=this.getIdentity(a);if(!this._pending._modifiedItems[q]){var p={},s;for(s in a)p[s]=s===this._storeRefPropName||s===this._itemNumPropName||s===this._rootItemPropName?a[s]:s===this._reverseRefMap?
h.clone(a[s]):a[s].slice(0,a[s].length);this._pending._modifiedItems[q]=p}q=!1;if(h.isArray(c)&&0===c.length){if(q=delete a[b],c=void 0,this.referenceIntegrity&&e){s=e;h.isArray(s)||(s=[s]);for(var t=0;t<s.length;t++)p=s[t],this.isItem(p)&&this._removeReferenceFromMap(p,a,b)}}else{q=h.isArray(c)?c.slice(0,c.length):[c];if(this.referenceIntegrity)if(e){s=e;h.isArray(s)||(s=[s]);var u={};k.forEach(s,function(a){this.isItem(a)&&(a=this.getIdentity(a),u[a.toString()]=!0)},this);k.forEach(q,function(c){if(this.isItem(c)){var d=
this.getIdentity(c);u[d.toString()]?delete u[d.toString()]:this._addReferenceToMap(c,a,b)}},this);for(t in u)this._removeReferenceFromMap(this._itemsByIdentity?this._itemsByIdentity[t]:this._arrayOfAllItems[t],a,b)}else for(t=0;t<q.length;t++)p=q[t],this.isItem(p)&&this._addReferenceToMap(p,a,b);a[b]=q;q=!0}if(d)this.onSet(a,b,e,c);return q},_addReferenceToMap:function(a,b,c){b=this.getIdentity(b);var d=a[this._reverseRefMap];d||(d=a[this._reverseRefMap]={});(a=d[b])||(a=d[b]={});a[c]=!0},_removeReferenceFromMap:function(a,
b,c){b=this.getIdentity(b);var d=a[this._reverseRefMap],e;if(d){for(e in d)e==b&&(delete d[e][c],this._isEmpty(d[e])&&delete d[e]);this._isEmpty(d)&&delete a[this._reverseRefMap]}},_dumpReferenceMap:function(){var b;for(b=0;b<this._arrayOfAllItems.length;b++){var c=this._arrayOfAllItems[b];c&&c[this._reverseRefMap]&&console.log("Item: ["+this.getIdentity(c)+"] is referenced by: "+a.toJson(c[this._reverseRefMap]))}},_getValueOrValues:function(a,b){var c=void 0;this.hasAttribute(a,b)&&(c=this.getValues(a,
b),c=1==c.length?c[0]:c);return c},_flatten:function(a){if(this.isItem(a))return{_reference:this.getIdentity(a)};if("object"===typeof a)for(var b in this._datatypeMap){var c=this._datatypeMap[b];if(h.isObject(c)&&!h.isFunction(c)){if(a instanceof c.type){if(!c.serialize)throw Error("ItemFileWriteStore:  No serializer defined for type mapping: ["+b+"]");return{_type:b,_value:c.serialize(a)}}}else if(a instanceof c)return{_type:b,_value:a.toString()}}return a},_getNewFileContentString:function(){var b=
{},c=this._getIdentifierAttribute();c!==Number&&(b.identifier=c);this._labelAttr&&(b.label=this._labelAttr);b.items=[];for(c=0;c<this._arrayOfAllItems.length;++c){var d=this._arrayOfAllItems[c];if(null!==d){var e={},n;for(n in d)if(n!==this._storeRefPropName&&n!==this._itemNumPropName&&n!==this._reverseRefMap&&n!==this._rootItemPropName){var k=this.getValues(d,n);if(1==k.length)e[n]=this._flatten(k[0]);else for(var p=[],s=0;s<k.length;++s)p.push(this._flatten(k[s])),e[n]=p}b.items.push(e)}}return a.toJson(b,
!0)},_isEmpty:function(a){var b=!0;if(h.isObject(a))for(var c in a){b=!1;break}else h.isArray(a)&&0<a.length&&(b=!1);return b},save:function(a){this._assert(!this._saveInProgress);this._saveInProgress=!0;var b=this,d=function(){b._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};b._saveInProgress=!1;a&&a.onComplete&&a.onComplete.call(a.scope||c.global)},e=function(d){b._saveInProgress=!1;a&&a.onError&&a.onError.call(a.scope||c.global,d)};if(this._saveEverything){var n=this._getNewFileContentString();
this._saveEverything(d,e,n)}this._saveCustom&&this._saveCustom(d,e);!this._saveEverything&&!this._saveCustom&&d()},revert:function(){this._assert(!this._saveInProgress);for(var a in this._pending._modifiedItems){var b=this._pending._modifiedItems[a],c=null,c=this._itemsByIdentity?this._itemsByIdentity[a]:this._arrayOfAllItems[a];b[this._storeRefPropName]=this;for(var d in c)delete c[d];h.mixin(c,b)}var e;for(a in this._pending._deletedItems)e=this._pending._deletedItems[a],e[this._storeRefPropName]=
this,b=e[this._itemNumPropName],e["backup_"+this._reverseRefMap]&&(e[this._reverseRefMap]=e["backup_"+this._reverseRefMap],delete e["backup_"+this._reverseRefMap]),this._arrayOfAllItems[b]=e,this._itemsByIdentity&&(this._itemsByIdentity[a]=e),e[this._rootItemPropName]&&this._arrayOfTopLevelItems.push(e);for(a in this._pending._deletedItems)e=this._pending._deletedItems[a],e["backupRefs_"+this._reverseRefMap]&&(k.forEach(e["backupRefs_"+this._reverseRefMap],function(a){this._addReferenceToMap(this._itemsByIdentity?
this._itemsByIdentity[a.id]:this._arrayOfAllItems[a.id],e,a.attr)},this),delete e["backupRefs_"+this._reverseRefMap]);for(a in this._pending._newItems)b=this._pending._newItems[a],b[this._storeRefPropName]=null,this._arrayOfAllItems[b[this._itemNumPropName]]=null,b[this._rootItemPropName]&&this._removeArrayElement(this._arrayOfTopLevelItems,b),this._itemsByIdentity&&delete this._itemsByIdentity[a];this._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};return!0},isDirty:function(a){return a?
(a=this.getIdentity(a),(new Boolean(this._pending._newItems[a]||this._pending._modifiedItems[a]||this._pending._deletedItems[a])).valueOf()):!this._isEmpty(this._pending._newItems)||!this._isEmpty(this._pending._modifiedItems)||!this._isEmpty(this._pending._deletedItems)},onSet:function(a,b,c,d){},onNew:function(a,b){},onDelete:function(a){},close:function(a){if(this.clearOnClose){if(this.isDirty())throw Error("dojo.data.ItemFileWriteStore: There are unsaved changes present in the store.  Please save or revert the changes before invoking close.");
this.inherited(arguments)}}})})},"arcgisonline/sharing/dijit/SiteFooterMap":function(){define(["dijit","dojo","dojox","dojo/require!dijit/_Widget,dijit/_Templated,arcgisonline/sharing/dijit/SiteFooter"],function(h,b,k){b.provide("arcgisonline.sharing.dijit.SiteFooterMap");b.require("dijit._Widget");b.require("dijit._Templated");b.require("arcgisonline.sharing.dijit.SiteFooter");b.declare("arcgisonline.sharing.dijit.SiteFooterMap",arcgisonline.sharing.dijit.SiteFooter,{templateString:'\x3cdiv style\x3d"border-top:1px solid #ccc; padding-top: 0.5em; padding-left:2px; margin-bottom: 3em; white-space: nowrap; text-align: center;"\x3e\r\n  \x3cspan id\x3d"${id}_links" class\x3d"esriItemLinks esriFloatLeading esriAlignLeading" style\x3d"color:#777; line-height:14px"\x3e\x3c/span\x3e\r\n\x3c/div\x3e\r\n'})})},
"dojo/dnd/TimedMoveable":function(){define(["../_base/declare","./Moveable"],function(h,b){var k=b.prototype.onMove;return h("dojo.dnd.TimedMoveable",b,{timeout:40,constructor:function(a,b){b||(b={});b.timeout&&("number"==typeof b.timeout&&0<=b.timeout)&&(this.timeout=b.timeout)},onMoveStop:function(a){a._timer&&(clearTimeout(a._timer),k.call(this,a,a._leftTop));b.prototype.onMoveStop.apply(this,arguments)},onMove:function(a,b){a._leftTop=b;if(!a._timer){var d=this;a._timer=setTimeout(function(){a._timer=
null;k.call(d,a,a._leftTop)},this.timeout)}}})})},"dojo/NodeList-fx":function(){define(["./query","./_base/lang","./aspect","./_base/fx","./fx"],function(h,b,k,a,c){h=h.NodeList;b.extend(h,{_anim:function(a,e,f){f=f||{};var g=c.combine(this.map(function(c){c={node:c};b.mixin(c,f);return a[e](c)}));return f.auto?g.play()&&this:g},wipeIn:function(a){return this._anim(c,"wipeIn",a)},wipeOut:function(a){return this._anim(c,"wipeOut",a)},slideTo:function(a){return this._anim(c,"slideTo",a)},fadeIn:function(b){return this._anim(a,
"fadeIn",b)},fadeOut:function(b){return this._anim(a,"fadeOut",b)},animateProperty:function(b){return this._anim(a,"animateProperty",b)},anim:function(b,e,f,g,l){var m=c.combine(this.map(function(c){return a.animateProperty({node:c,properties:b,duration:e||350,easing:f})}));g&&k.after(m,"onEnd",g,!0);return m.play(l||0)}});return h})},"dijit/form/_ListMouseMixin":function(){define(["dojo/_base/declare","dojo/on","dojo/touch","./_ListBase"],function(h,b,k,a){return h("dijit.form._ListMouseMixin",a,
{postCreate:function(){this.inherited(arguments);this.domNode.dojoClick=!0;this._listConnect("click","_onClick");this._listConnect("mousedown","_onMouseDown");this._listConnect("mouseup","_onMouseUp");this._listConnect("mouseover","_onMouseOver");this._listConnect("mouseout","_onMouseOut")},_onClick:function(a,b){this._setSelectedAttr(b,!1);this._deferredClick&&this._deferredClick.remove();this._deferredClick=this.defer(function(){this._deferredClick=null;this.onClick(b)})},_onMouseDown:function(a,
b){this._hoveredNode&&(this.onUnhover(this._hoveredNode),this._hoveredNode=null);this._isDragging=!0;this._setSelectedAttr(b,!1)},_onMouseUp:function(a,b){this._isDragging=!1;var e=this.selected,f=this._hoveredNode;e&&b==e?this.defer(function(){this._onClick(a,e)}):f&&this.defer(function(){this._onClick(a,f)})},_onMouseOut:function(a,b){this._hoveredNode&&(this.onUnhover(this._hoveredNode),this._hoveredNode=null);this._isDragging&&(this._cancelDrag=(new Date).getTime()+1E3)},_onMouseOver:function(a,
b){this._cancelDrag&&((new Date).getTime()>this._cancelDrag&&(this._isDragging=!1),this._cancelDrag=null);this._hoveredNode=b;this.onHover(b);this._isDragging&&this._setSelectedAttr(b,!1)}})})},"dojo/cookie":function(){define(["./_base/kernel","./regexp"],function(h,b){h.cookie=function(k,a,c){var d=document.cookie,e;if(1==arguments.length)e=(e=d.match(RegExp("(?:^|; )"+b.escapeString(k)+"\x3d([^;]*)")))?decodeURIComponent(e[1]):void 0;else{c=c||{};d=c.expires;if("number"==typeof d){var f=new Date;
f.setTime(f.getTime()+864E5*d);d=c.expires=f}d&&d.toUTCString&&(c.expires=d.toUTCString());a=encodeURIComponent(a);var d=k+"\x3d"+a,g;for(g in c)d+="; "+g,f=c[g],!0!==f&&(d+="\x3d"+f);document.cookie=d}return e};h.cookie.isSupported=function(){"cookieEnabled"in navigator||(this("__djCookieTest__","CookiesAllowed"),navigator.cookieEnabled="CookiesAllowed"==this("__djCookieTest__"),navigator.cookieEnabled&&this("__djCookieTest__","",{expires:-1}));return navigator.cookieEnabled};return h.cookie})},
"dojo/cache":function(){define(["./_base/kernel","./text"],function(h){return h.cache})},"arcgisonline/sharing/dijit/dialog/NotificationsDlg":function(){define(["dijit","dojo","dojox","dojo/require!dijit/Dialog,dijit/_Widget,dijit/_Templated,arcgisonline/sharing/dijit/NotificationsList"],function(h,b,k){b.provide("arcgisonline.sharing.dijit.dialog.NotificationsDlg");b.require("dijit.Dialog");b.require("dijit._Widget");b.require("dijit._Templated");b.require("arcgisonline.sharing.dijit.NotificationsList");
b.declare("arcgisonline.sharing.dijit.dialog.NotificationsDlg",[h._Widget,h._Templated],{widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContent" \x3e\r\n  \t\x3cdiv dojotype\x3d"dijit.Dialog" dojoAttachPoint\x3d"_notificationDlg" title\x3d"${i18n.notificationDlgTitle}" style\x3d"width:435px;" execute\x3d""\x3e\r\n\t\t\x3clabel \x3e${i18n.notificationMsg}\x3c/label\x3e\r\n\t\t\x3cbr /\x3e\r\n\t\t\x3cbr /\x3e\r\n        \x3cdiv dojotype\x3d"dijit.layout.BorderContainer" id\x3d"notificationsContainer" region\x3d"center" jsid\x3d"container" gutters\x3d"false" design\x3d"headline" style\x3d"height: 180px;"\x3e\r\n            \x3cdiv dojotype\x3d"dijit.layout.ContentPane" region\x3d"top" splitter\x3d"false"\x3e\r\n\t\t\t\t\x3cdiv dojoType\x3d"arcgisonline.sharing.dijit.NotificationsList" jsid\x3d"notificationsList" id\x3d"notificationsList"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\t\t\t\r\n\t  \t\x3cbr /\x3e \t \t\r\n\t  \t\x3cdiv style\x3d"float: right; padding-top:0px; padding-bottom:5px;"\x3e\r\n\t\t  \t\x3cbutton id\x3d"button_notifications-close" dojoType\x3d"dijit.form.Button" class\x3d"primary" dojoAttachEvent\x3d"onClick:_handleCloseBtn"\x3e${i18n.close}\x3c/button\x3e\r\n\t  \t\x3c/div\x3e\r\n\t  \t\x3cbr /\x3e\x26nbsp;\x3cbr /\x3e \r\n  \t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
i18n:null,_notificationDlg:null,statics:{_instance:null,getInstance:function(){null==this._instance&&(this._instance=new arcgisonline.sharing.dijit.dialog.NotificationsDlg);return this._instance}},postMixInProperties:function(){this.inherited(arguments);this.i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").notificationsDlg)},postCreate:function(){this.loadConnections()},show:function(){notificationsList.loadList();
this._notificationDlg.show()},loadConnections:function(){b.subscribe("onNotificationDelete",this,"onNotificationDelete")},_handleCloseBtn:function(a){a.preventDefault();this._notificationDlg.hide()},onNotificationDelete:function(){notificationsList.updateList()},hide:function(){this._notificationDlg.hide()}})})},"dijit/_base/popup":function(){define(["dojo/dom-class","dojo/_base/window","../popup","../BackgroundIframe"],function(h,b,k){var a=k._createWrapper;k._createWrapper=function(c){c.declaredClass||
(c={_popupWrapper:c.parentNode&&h.contains(c.parentNode,"dijitPopup")?c.parentNode:null,domNode:c,destroy:function(){},ownerDocument:c.ownerDocument,ownerDocumentBody:b.body(c.ownerDocument)});return a.call(this,c)};var c=k.open;k.open=function(a){if(a.orient&&"string"!=typeof a.orient&&!("length"in a.orient)){var b=[],f;for(f in a.orient)b.push({aroundCorner:f,corner:a.orient[f]});a.orient=b}return c.call(this,a)};return k})},"dojo/promise/all":function(){define(["../_base/array","../Deferred","../when"],
function(h,b,k){var a=h.some;return function(c){var d,e;c instanceof Array?e=c:c&&"object"===typeof c&&(d=c);var f,g=[];if(d){e=[];for(var l in d)Object.hasOwnProperty.call(d,l)&&(g.push(l),e.push(d[l]));f={}}else e&&(f=[]);if(!e||!e.length)return(new b).resolve(f);var m=new b;m.promise.always(function(){f=g=null});var n=e.length;a(e,function(a,b){d||g.push(b);k(a,function(a){m.isFulfilled()||(f[g[b]]=a,0===--n&&m.resolve(f))},m.reject);return m.isFulfilled()});return m.promise}})},"esri/geometry/mathUtils":function(){define(["dojo/_base/lang",
"dojo/has","../kernel","./Point"],function(h,b,k,a){function c(b,c,d){return b instanceof a?new a(b.x+d*(c.x-b.x),b.y+d*(c.y-b.y)):[b[0]+d*(c[0]-b[0]),b[1]+d*(c[1]-b[1])]}function d(a,b){return 1E-8>Math.abs(a-b)}function e(a,b,c,e){var f,p=d(a[0],b[0])?1E10:(a[1]-b[1])/(a[0]-b[0]),s=d(c[0],e[0])?1E10:(c[1]-e[1])/(c[0]-e[0]),k=a[1]-p*a[0],h=c[1]-s*c[0];if(d(p,s)){if(d(k,h)){if(d(a[0],b[0]))if(Math.min(a[1],b[1])<Math.max(c[1],e[1])||Math.max(a[1],b[1])>Math.min(c[1],e[1]))a=(a[1]+b[1]+c[1]+e[1]-Math.min(a[1],
b[1],c[1],e[1])-Math.max(a[1],b[1],c[1],e[1]))/2,f=(a-k)/p;else return null;else if(Math.min(a[0],b[0])<Math.max(c[0],e[0])||Math.max(a[0],b[0])>Math.min(c[0],e[0]))f=(a[0]+b[0]+c[0]+e[0]-Math.min(a[0],b[0],c[0],e[0])-Math.max(a[0],b[0],c[0],e[0]))/2,a=p*f+k;else return null;return[f,a]}return null}d(p,1E10)?(f=a[0],a=s*f+h):d(s,1E10)?(f=c[0],a=p*f+k):(f=-(k-h)/(p-s),a=a[1]===b[1]?a[1]:c[1]===e[1]?c[1]:p*f+k);return[f,a]}var f={getLength:function(a,b){var c=b.x-a.x,d=b.y-a.y;return Math.sqrt(c*c+
d*d)},_getLength:function(a,b){var c=b[0]-a[0],d=b[1]-a[1];return Math.sqrt(c*c+d*d)},getPointOnLine:c,getMidpoint:function(a,b){return c(a,b,0.5)},_equals:d,_getLineIntersection:e,getLineIntersection:function(b,c,d,f,k){(b=e([b.x,b.y],[c.x,c.y],[d.x,d.y],[f.x,f.y]))&&(b=new a(b[0],b[1],k));return b},_getLineIntersection2:function(a,b){var c=a[0],d=a[1],e=b[0],f=b[1],s=c[0],c=c[1],k=d[0],d=d[1],h=e[0],x=e[1],e=f[0]-h,h=s-h,w=k-s,f=f[1]-x,x=c-x,v=d-c,y=f*w-e*v;if(0===y)return!1;e=(e*x-f*h)/y;h=(w*
x-v*h)/y;return 0<=e&&1>=e&&0<=h&&1>=h?[s+e*(k-s),c+e*(d-c)]:!1},_pointLineDistance:function(a,b){var c=b[0],d=b[1],e=c[0],f=c[1],c=a[0],s=a[1],k=d[0]-e,h=d[1]-f,x=c-e,w=s-f,d=Math.sqrt,v=Math.pow,y=d(v(k,2)+v(h,2)),x=(x*k+w*h)/(y*y),f=f+x*h;return d(v(c-(e+x*k),2)+v(s-f,2))}};b("extend-esri")&&h.mixin(h.getObject("geometry",!0,k),f);return f})},"arcgisonline/sharing/dijit/HelpManager":function(){define(["dijit","dojo","dojox","dojo/require!dijit/_Widget,dojo/io/script,arcgisonline/sharing/util,arcgisonline/sharing/geow/Account"],
function(h,b,k){b.provide("arcgisonline.sharing.dijit.HelpManager");b.require("dijit._Widget");b.require("dojo.io.script");b.require("arcgisonline.sharing.util");b.require("arcgisonline.sharing.geow.Account");b.declare("arcgisonline.sharing.dijit.HelpManager",[h._Widget],{helpBaseUrl:null,helpTopics:null,_isSingleTenant:!1,statics:{_instance:null,getInstance:function(){null===this._instance&&(this._instance=new arcgisonline.sharing.dijit.HelpManager);return this._instance}},postCreate:function(){this._isSingleTenant=
void 0!==esriGeowConfig.isMultiTenant&&null!==esriGeowConfig.isMultiTenant&&!1===esriGeowConfig.isMultiTenant;this._load()},_load:function(){arcgisonline.sharing.geow.Account.getSelf(b.hitch(this,this.handleGetHelp))},handleGetHelp:function(a,b){a&&(!a.code&&!a.message)&&(this.helpBaseUrl=a.helpBase,this.helpTopics=a.helpMap.m,this.onLoad(this.helpBaseUrl,this.helpTopics))},onLoad:function(a,b){},isLoaded:function(){return this.helpBaseUrl&&this.helpTopics},getHelpUrl:function(a){if(this.isLoaded())return this.helpBaseUrl+
this.helpTopics[a];console.log("help not loaded");return"#"}})})},"dojox/main":function(){define(["dojo/_base/kernel"],function(h){return h.dojox})},"dojo/_base/url":function(){define(["./kernel"],function(h){var b=/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/,k=/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,a=function(){for(var c=arguments,d=[c[0]],e=1;e<c.length;e++)if(c[e]){var f=new a(c[e]+""),d=new a(d[0]+"");if(""==f.path&&!f.scheme&&!f.authority&&!f.query)null!=
f.fragment&&(d.fragment=f.fragment),f=d;else if(!f.scheme&&(f.scheme=d.scheme,!f.authority&&(f.authority=d.authority,"/"!=f.path.charAt(0)))){for(var d=(d.path.substring(0,d.path.lastIndexOf("/")+1)+f.path).split("/"),g=0;g<d.length;g++)"."==d[g]?g==d.length-1?d[g]="":(d.splice(g,1),g--):0<g&&(!(1==g&&""==d[0])&&".."==d[g]&&".."!=d[g-1])&&(g==d.length-1?(d.splice(g,1),d[g-1]=""):(d.splice(g-1,2),g-=2));f.path=d.join("/")}d=[];f.scheme&&d.push(f.scheme,":");f.authority&&d.push("//",f.authority);d.push(f.path);
f.query&&d.push("?",f.query);f.fragment&&d.push("#",f.fragment)}this.uri=d.join("");c=this.uri.match(b);this.scheme=c[2]||(c[1]?"":null);this.authority=c[4]||(c[3]?"":null);this.path=c[5];this.query=c[7]||(c[6]?"":null);this.fragment=c[9]||(c[8]?"":null);null!=this.authority&&(c=this.authority.match(k),this.user=c[3]||null,this.password=c[4]||null,this.host=c[6]||c[7],this.port=c[9]||null)};a.prototype.toString=function(){return this.uri};return h._Url=a})},"esri/lang":function(){define("dojo/_base/array dojo/_base/json dojo/_base/kernel dojo/_base/lang dojo/date dojo/has dojo/number dojo/date/locale ./kernel".split(" "),
function(h,b,k,a,c,d,e,f,g){function l(b,c,d){return[a.isString(b)?b.split(""):b,c||k.global,a.isString(d)?new Function("item","index","array",d):d]}function m(a){return void 0!==a&&null!==a}function n(d,g,l){var n=l.match(/([^\(]+)(\([^\)]+\))?/i),s=a.trim(n[1]);l=g[d];var n=b.fromJson((n[2]?a.trim(n[2]):"()").replace(/^\(/,"({").replace(/\)$/,"})")),k=n.utcOffset;if(-1===h.indexOf(p,s))s=a.getObject(s),a.isFunction(s)&&(l=s(l,d,g,n));else if("number"===typeof l||"string"===typeof l&&l&&!isNaN(Number(l)))switch(l=
Number(l),s){case "NumberFormat":return e.format(l,n);case "DateString":d=new Date(l);if(n.local||n.systemLocale)return n.systemLocale?d.toLocaleDateString()+(n.hideTime?"":" "+d.toLocaleTimeString()):d.toDateString()+(n.hideTime?"":" "+d.toTimeString());d=d.toUTCString();n.hideTime&&(d=d.replace(/\s+\d\d\:\d\d\:\d\d\s+(utc|gmt)/i,""));return d;case "DateFormat":return d=new Date(l),m(k)&&(d=c.add(d,"minute",d.getTimezoneOffset()-k)),f.format(d,n)}return m(l)?l:""}function q(a,b){var c;if(b)for(c in a)a.hasOwnProperty(c)&&
(void 0===a[c]?delete a[c]:a[c]instanceof Object&&q(a[c],!0));else for(c in a)a.hasOwnProperty(c)&&void 0===a[c]&&delete a[c];return a}var p=["NumberFormat","DateString","DateFormat"],s=/<\/?[^>]+>/g,t={valueOf:function(a,b){for(var c in a)if(a[c]==b)return c;return null},stripTags:function(a){if(a){var b=typeof a;if("string"===b)a=a.replace(s,"");else if("object"===b)for(var c in a)(b=a[c])&&"string"===typeof b&&(b=b.replace(s,"")),a[c]=b}return a},substitute:function(b,c,d){var e,f,g;m(d)&&(a.isObject(d)?
(e=d.first,f=d.dateFormat,g=d.numberFormat):e=d);if(!c||"${*}"===c){c=[];for(var l in b){d=b[l];if(f&&-1!==h.indexOf(f.properties||"",l))d=n(l,b,f.formatter||"DateString");else if(g&&-1!==h.indexOf(g.properties||"",l))d=n(l,b,g.formatter||"NumberFormat");c.push(l+" \x3d "+(m(d)?d:"")+"\x3cbr/\x3e");if(e)break}return c.join("")}return a.replace(c,a.hitch({obj:b},function(a,b){var c=b.split(":");return 1<c.length?(b=c[0],c.shift(),n(b,this.obj,c.join(":"))):f&&-1!==h.indexOf(f.properties||"",b)?n(b,
this.obj,f.formatter||"DateString"):g&&-1!==h.indexOf(g.properties||"",b)?n(b,this.obj,g.formatter||"NumberFormat"):m(this.obj[b])?this.obj[b]:""}),/\$\{([^\}]+)\}/g)},filter:function(a,b,c){b=l(a,c,b);c={};var d;a=b[0];for(d in a)b[2].call(b[d],a[d],d,a)&&(c[d]=a[d]);return c},isDefined:m,fixJson:q};d("extend-esri")&&(a.mixin(g,t),g._isDefined=m,g._getParts=l,g._sanitize=q);return t})},"arcgisonline/sharing/dijit/SiteHeader":function(){define(["dijit","dojo","dojox","dojo/require!dijit/_Widget,dijit/_Templated,dijit/layout/BorderContainer,arcgisonline/sharing/util,arcgisonline/sharing/geow/Account,arcgisonline/sharing/geow/Geow,arcgisonline/sharing/geow/Community,arcgisonline/sharing/dijit/Search,arcgisonline/sharing/dijit/TextMenu,arcgisonline/sharing/dijit/dialog/SimpleDlg,dojo/topic,dojo/has"],
function(h,b,k){b.provide("arcgisonline.sharing.dijit.SiteHeader");b.require("dijit._Widget");b.require("dijit._Templated");b.require("dijit.layout.BorderContainer");b.require("arcgisonline.sharing.util");b.require("arcgisonline.sharing.geow.Account");b.require("arcgisonline.sharing.geow.Geow");b.require("arcgisonline.sharing.geow.Community");b.require("arcgisonline.sharing.dijit.Search");b.require("arcgisonline.sharing.dijit.TextMenu");b.require("arcgisonline.sharing.dijit.dialog.SimpleDlg");b.require("dojo.topic");
b.require("dojo.has");b.declare("arcgisonline.sharing.dijit.SiteHeader",[h._Widget,h._Templated],{util:arcgisonline.sharing.util,geow:arcgisonline.sharing.geow.Geow,acct:arcgisonline.sharing.geow.Account,allSSL:!1,isPrivateOrg:!1,isPublicOrg:!1,isLoggedIn:!1,isIndexPage:!1,isSignInPage:!1,isSignUpPage:!1,isJoinPage:!1,isSetupPage:!1,isIEPage:!1,isItemDetailsPage:!1,isNewUserPage:!1,isTroubleshootPage:!1,contentMode:null,modeLabelNode:null,webLabel:"",webDescription:"",desktopLabel:"",desktopDescription:"",
modeQueryParam:null,prefsName:esriGeowConfig.contentModeCookieName,displayedPortalNonSSLNotice:!1,_tabs:null,_searchWidgetNode:null,_searchWidget:null,_accountControlsNode:null,_navNode:null,_signInOutLink:null,_organizationLink:null,_profileLink:null,_notificationsLink:null,_myAccountLink:null,_resourceCenterLink:null,_helpMenuNode:null,_modeFilterNode:null,widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContent siteHeader" id\x3d"header" dojoAttachPoint\x3d"containerNode"\x3e\r\n  \x3cdiv class\x3d"container"\x3e\r\n    \x3cdiv class\x3d"header-inner"\x3e\r\n      \x3cdiv class\x3d"navcontainer esriFloatLeading"\x3e\r\n      \x3cdiv id\x3d"header-logo-wrap" class\x3d"siteHeaderLink logo-wrap esriFloatLeading anon pubUser"\x3e\r\n        \x3ca id\x3d"site-logo" class\x3d"siteHeaderLink anon pubUser site_logo current" href\x3d"../features/"\x3e\r\n          ${!i18n.arcGIS}\r\n        \x3c/a\x3e\r\n        \x3cspan id\x3d"site-logo-text" class\x3d"site_logo gray text_only"\x3e${!i18n.arcGIS}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"header-nav-primary" class\x3d"nav esriFloatLeading"\x3e\r\n        \x3cul dojoAttachPoint\x3d"_tabs" class\x3d"esriFloatLeading"\x3e\r\n          \x3cli class\x3d"esriFloatLeading"\x3e\r\n            \x3ca id\x3d"siteHeader-home" class\x3d"siteHeaderLink organization first" dojoAttachEvent\x3d"onclick:_handleLinkClick" page\x3d"index.html"\x3e${i18n.home_link}\x3c/a\x3e\r\n          \x3c/li\x3e\r\n          \x3cli class\x3d"esriFloatLeading"\x3e\r\n            \x3ca id\x3d"siteHeader-features" class\x3d"siteHeaderLink  anon pubUser" dojoAttachEvent\x3d"onclick:_handleLinkClick" page\x3d"../features/features.html"\x3e${i18n.features}\x3c/a\x3e\r\n          \x3c/li\x3e\r\n          \x3cli class\x3d"esriFloatLeading"\x3e\r\n            \x3ca id\x3d"siteHeader-plans" class\x3d"siteHeaderLink anon pubUser" dojoAttachEvent\x3d"onclick:_handleLinkClick" page\x3d"../features/plans/pricing.html"\x3e${i18n.plans}\x3c/a\x3e\r\n          \x3c/li\x3e\r\n          \x3cli class\x3d"esriFloatLeading"\x3e\r\n            \x3ca id\x3d"siteHeader-gallery" class\x3d"siteHeaderLink anon pubUser organization orgUser" dojoAttachEvent\x3d"onclick:_handleLinkClick" page\x3d"gallery.html"\x3e${i18n.gallery}\x3c/a\x3e\r\n          \x3c/li\x3e\r\n          \x3cli class\x3d"esriFloatLeading"\x3e\r\n            \x3ca id\x3d"siteHeader-map" class\x3d"siteHeaderLink anon pubUser organization orgUser" dojoAttachEvent\x3d"onclick:_handleLinkClick" page\x3d"webmap/viewer.html?useExisting\x3d1"\x3e${i18n.map}\x3c/a\x3e\r\n          \x3c/li\x3e\r\n          \x3cli class\x3d"esriFloatLeading" id\x3d"sceneViewer" class\x3d"hide"\x3e\r\n            \x3ca id\x3d"siteHeader-scene" class\x3d"siteHeaderLink" dojoAttachEvent\x3d"onclick:_handleLinkClick" page\x3d"webscene/viewer.html"\x3e${i18n.scene}\x3c/a\x3e\r\n          \x3c/li\x3e\r\n          \x3cli class\x3d"esriFloatLeading"\x3e\r\n            \x3ca id\x3d"siteHeader-groups" class\x3d"siteHeaderLink pubUser organization orgUser" dojoAttachEvent\x3d"onclick:_handleLinkClick" page\x3d"groups.html"\x3e${i18n.groups}\x3c/a\x3e\r\n          \x3c/li\x3e\r\n          \x3cli class\x3d"esriFloatLeading"\x3e\r\n            \x3ca id\x3d"siteHeader-help" class\x3d"siteHeaderLink help anon" dojoAttachEvent\x3d"onclick:_handleLinkClick" page\x3d"support.html"\x3e${i18n.help}\x3c/a\x3e\r\n          \x3c/li\x3e\r\n          \x3cli class\x3d"esriFloatLeading" id\x3d"myContentNav"\x3e\r\n            \x3ca id\x3d"siteHeader-myContent" class\x3d"siteHeaderLink pubUser orgUser" dojoAttachEvent\x3d"onclick:_handleLinkClick" page\x3d"content.html"\x3e${i18n.myContent}\x3c/a\x3e\r\n          \x3c/li\x3e\r\n          \x3cli class\x3d"esriFloatLeading" id\x3d"myOrgNav"\x3e\r\n            \x3ca id\x3d"siteHeader-myOrganization" class\x3d"siteHeaderLink orgUser" dojoAttachEvent\x3d"onclick:_handleLinkClick" page\x3d"organization.html"href\x3d"#"\x3e${i18n.myAccount}\x3c/a\x3e\r\n          \x3c/li\x3e\r\n          \x3c!--\x3cli class\x3d"esriFloatLeading" id\x3d"helpNav"\x3e--\x3e\r\n              \x3c!--\x3ca id\x3d"siteHeader-help" title\x3d"${i18n.help}" class\x3d"siteHeaderLink pubUser orgUser esriHelpIcon" dojoAttachEvent\x3d"onclick:_handleLinkClick" page\x3d"support.html"\x3e\x26nbsp;\x3c/a\x3e--\x3e\r\n          \x3c!--\x3c/li\x3e--\x3e\r\n        \x3c/ul\x3e\r\n      \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"header-status" class\x3d"status esriFloatLeading"\x3e\r\n      \t\x3c!-- Sign in / Menu - START --\x3e\r\n        \x3cdiv id\x3d"logged-out-navigation" class\x3d"dropdown-navigation esriFloatTrailing esriAlignTrailing"\x3e\r\n          \x3ca id\x3d"login-link" class\x3d"btn small light" href\x3d"signin.html"\x3e\x3cspan class\x3d"profile-icon"\x3e\x3c/span\x3e${i18n.signIn}\x3c/a\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv id\x3d"logged-in-navigation" class\x3d"dropdown-navigation dropdown-wrapper hide esriFloatTrailing"\x3e\r\n          \x3ca style\x3d"width:100%;" class\x3d"dropdown btn small light" href\x3d"#"\x3e\r\n            \x3cimg id\x3d"profileImgSmall" width\x3d"16" height\x3d"16" alt\x3d""\x3e\r\n            \x3cspan id\x3d"username"\x3e\x3c/span\x3e\r\n          \x3c/a\x3e\r\n          \x3cdiv class\x3d"dropdown-content"\x3e\r\n            \x3cul\x3e\r\n              \x3cli\x3e\r\n                \x3ca id\x3d"profileLink" dojoAttachEvent\x3d"onclick:_handleLinkClick, ontouchstart:_handleLinkClick" page\x3d"user.html"\x3e\r\n                  \x3cimg id\x3d"dropdown-image" width\x3d"32" height\x3d"32" alt\x3d""\x3e\r\n                  ${i18n.myProfile}\x3cbr/\x3e\r\n                  \x3cspan dojoAttachPoint\x3d"_userProfileLink"\x3e\x3c/span\x3e\r\n                \x3c/a\x3e\r\n              \x3c/li\x3e\r\n              \x3cli id\x3d"esri-community" class\x3d"hide"\x3e\r\n                \x3ca dojoAttachEvent\x3d"onclick:goEsriCommunity, ontouchstart:goEsriCommunity" page\x3d""\x3e${i18n.esriCommunity}\x26nbsp;\x26nbsp;\x3cspan id\x3d"esri-community-img"\x3e\x3c/span\x3e\x3c/a\x3e\r\n              \x3c/li\x3e\r\n              \x3cli id\x3d"my-esri" class\x3d"hide"\x3e\r\n                \x3ca dojoAttachEvent\x3d"onclick:goMyEsri, ontouchstart:goMyEsri" page\x3d""\x3e${i18n.myEsri}\x26nbsp;\x26nbsp;\x3cspan id\x3d"my-esri-img"\x3e\x3c/span\x3e\x3c/a\x3e\r\n              \x3c/li\x3e\r\n              \x3cli id\x3d"training" class\x3d"hide"\x3e\r\n                  \x3ca dojoAttachEvent\x3d"onclick:goTraining, ontouchstart:goTraining" page\x3d""\x3e${i18n.training}\x26nbsp;\x26nbsp;\x3cspan id\x3d"training-img"\x3e\x3c/span\x3e\x3c/a\x3e\r\n              \x3c/li\x3e\r\n              \x3cli id\x3d"trial-download" class\x3d"hide"\x3e\r\n                \x3ca dojoAttachEvent\x3d"onclick:goTrialDownload, ontouchstart:goTrialDownload" page\x3d""\x3e${i18n.trialDownload}\x26nbsp;\x26nbsp;\x3c/a\x3e\r\n              \x3c/li\x3e\r\n              \x3cli\x3e\r\n                \x3ca dojoAttachEvent\x3d"onclick:_handleLinkClick, ontouchstart:_handleLinkClick" page\x3d"support.html"\x3e${i18n.support}\x3c/a\x3e\r\n              \x3c/li\x3e\r\n              \x3cli id\x3d"admin-guide" class\x3d"hide"\x3e\r\n                \x3ca dojoAttachEvent\x3d"onclick:_handleLinkClick, ontouchstart:_handleLinkClick" page\x3d"adminguide.html"\x3e${i18n.adminGuide}\x3c/a\x3e\r\n              \x3c/li\x3e\r\n            \x3c/ul\x3e\r\n            \x3chr\x3e\r\n            \x3cul\x3e\r\n              \x3cli id\x3d"logout-link"\x3e\r\n                \x3ca dojoAttachEvent\x3d"onclick:logOut, ontouchstart:logOut"\x3e${i18n.signOut}\x3c/a\x3e\r\n              \x3c/li\x3e\r\n            \x3c/ul\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \t\x3c!-- Sign in / Menu - END --\x3e\r\n        \x3cdiv id\x3d"header_notifications" class\x3d"user organization"\x3e\x3cdiv id\x3d"notifications_box"\x3e\x3cspan id\x3d"notifications"\x3e0\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"header-search" dojoAttachPoint\x3d"_searchWidgetNode" class\x3d"searchNode esriLeadingMargin05"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
postMixInProperties:function(){this.inherited(arguments);this.geow.checkSharedCookie();this.i18n=b.mixin({},b.i18n.getLocalization("arcgisonline","arcgisonline").common);b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").siteHeader);this.webLabel=this.i18n.webOnly;this.webDescription=this.i18n.webDesc;this.desktopLabel=this.i18n.allContent;this.desktopDescription=this.i18n.allDesc},postCreate:function(){var a=window.location.pathname.toLowerCase();this.isIndexPage=-1!==a.indexOf("index.html")||
-1===a.indexOf(".html");this.isSignInPage=-1!==a.indexOf(esriGeowConfig.signin);this.isSignUpPage=-1!==a.indexOf(esriGeowConfig.signup);this.isJoinPage=-1!==a.indexOf(esriGeowConfig.join);this.isSetupPage=-1!==a.indexOf(esriGeowConfig.setup);this.isIEPage=-1!==a.indexOf("ie6.html");this.isItemDetailsPage=-1!==a.indexOf("item.html");this.isNewUserPage=-1!==a.indexOf("newuser.html");this.isTroubleshootPage=-1!==a.indexOf("troubleshoot.html");this._account=arcgisonline.sharing.geow.Account;7>b.isIE&&
!this.isIEPage&&(window.location="ie6.html");null!==this._searchWidgetNode&&!this.isIEPage&&(this._searchWidget=(new arcgisonline.sharing.dijit.Search({})).placeAt(this._searchWidgetNode));b.subscribe("onSignOut",b.hitch(this,function(a){arcgisonline.sharing.util&&(arcgisonline.sharing.util._cookies&&arcgisonline.sharing.util._cookies.esri_auth)&&delete arcgisonline.sharing.util._cookies.esri_auth}));this.updateLinks()},_loadFilterMode:function(){var a=b.queryToObject(window.location.search.slice(1)),
c=this.util.userPreferences(null,this.prefsName),d="Web";a.content&&"all"===a.content.toLowerCase()?(d="GIS",this.util.userPreferences({contentMode:d},this.prefsName,!0)):a.content&&"web"===a.content.toLowerCase()?this.util.userPreferences({contentMode:d},this.prefsName,!0):c&&c.contentMode&&(d=c.contentMode);this.contentMode=d},_handleModeMenuClick:function(a){b.subscribe("esri/userPreferences"+this.prefsName,b.hitch(this,function(){var a=window.location.search&&b.queryToObject(window.location.search.slice(1));
a&&a.start&&(a.start=null);var d=window.location.href.substring(0,window.location.href.indexOf(window.location.search));window.location.href=d+(a?"?"+b.objectToQuery(a):"")}));"Web"===a?(this.contentMode="Web",this.util.userPreferences({contentMode:this.contentMode},this.prefsName,!0),b.attr(this.modeLabelNode,{innerHTML:this.i18n.show+": "+this.webLabel,alt:this.webDescription,title:this.webDescription})):(this.contentMode="GIS",this.util.userPreferences({contentMode:this.contentMode},this.prefsName,
!0),b.attr(this.modeLabelNode,{innerHTML:this.i18n.show+": "+this.desktopLabel,alt:this.desktopDescription,title:this.desktopDescription}))},startup:function(){this.inherited(arguments);esri.config.defaults.io.corsEnabledServers.push("http://"+location.host);esri.config.defaults.io.corsEnabledServers.push("https://"+location.host);esri.config.defaults.io.proxyUrl=esriGeowConfig.proxyServer;b.query(".siteHeaderLink",this.domNode).style({display:"none"});return this._fetchSelf()},_fetchSelf:function(){var a=
new b.Deferred;this._account.getSelf(b.hitch(this,function(c){this._finishStartup(c);a.resolve(c);b.topic.publish("OnFetchSelf",c)}),b.hitch(this,function(a){this._finishStartup();throw a;}));return a},_finishStartup:function(a){this.geow.setCookies(a||{});if(a&&!a.code&&!a.message){var c,d;a.httpsPort&&(esriGeowConfig.httpsPort=a.httpsPort,d=esri.config.defaults.io.corsEnabledServers.pop());a.httpPort&&(esriGeowConfig.httpPort=a.httpPort,c=esri.config.defaults.io.corsEnabledServers.pop());c&&esri.config.defaults.io.corsEnabledServers.push(arcgisonline.sharing.util.getHttpUrl("http://"+
location.host).replace(/:80$/,""));d&&esri.config.defaults.io.corsEnabledServers.push(arcgisonline.sharing.util.getSecureUrl("http://"+location.host).replace(/:443$/,""));(this.isLoggedIn=this.util.isLoggedIn())?this.loggedIn():this.loggedOut();this._loadFilterMode();a.isPortal&&(arcgisonline.sharing.util._cookies&&-1===arcgisonline.sharing.util._cookies.esri_auth)&&delete arcgisonline.sharing.util._cookies.esri_auth;c=arcgisonline.sharing.util.getUser();a.culture&&!c&&(a.culture=a.culture.toLowerCase(),
b.cookie("arcgisLocale",a.culture),-1!==a.culture.indexOf("ar")?esriGeowConfig.isRightToLeft=!0:esriGeowConfig.isRightToLeft=!1,console.log("cookie set",b.cookie("arcgisLocale")),b.locale!==a.culture&&window.location.reload());c&&(esri.isDefined(c.auth_tier)&&"web"===c.auth_tier)&&b.style(b.byId("logout-link"),"display","none");a.allSSL&&(this.allSSL=esriGeowConfig.allSSL=a.allSSL);esri.isDefined(esriGeowConfig.allSSL)&&(esriGeowConfig.allSSL&&"http:"===location.protocol)&&(window.location=arcgisonline.sharing.util.getSecureUrl(location.href));
a.helpBase&&(esriGeowConfig.help=a.helpBase,esriGeowConfig.helpBase=a.helpBase);a.helpMap&&a.helpMap.m&&(esriGeowConfig.helpMap=a.helpMap.m);a.portalHostname&&(esriGeowConfig.portalHostname=a.portalHostname);a.urlKey&&(esriGeowConfig.urlKey=a.urlKey);a.staticImagesUrl&&(esriGeowConfig.staticImagesUrl=a.staticImagesUrl);if(a.id&&a.access){var e=esriGeowConfig.baseUrl;"private"===a.access?(this.isPrivateOrg=!0,e=arcgisonline.sharing.util.getSecureUrl()+esriGeowConfig.signin,b.create("a",{innerHTML:this.i18n.signOut,
href:e,onclick:b.hitch(this,this.logOut)},this._signInOutLink,"only")):"public"===a.access&&this.isLoggedIn&&(this.isPublicOrg=!0,e+="index.html",e=this.allSSL||arcgisonline.sharing.util.usePortalSSL()?arcgisonline.sharing.util.getSecureUrl(e):arcgisonline.sharing.util.getHttpUrl(e),b.create("a",{innerHTML:this.i18n.signOut,href:e,onclick:b.hitch(this,this.logOut)},this._signInOutLink,"only"))}e=!1===esriGeowConfig.isMultiTenant;if(!e&&(d=window.location.host,d!==a.portalHostname&&(-1!==d.indexOf(a.customBaseUrl)&&
!a.access&&!a.name)&&(window.location=window.location.href.replace(d,a.portalHostname)),c&&("account_admin"===c.role||"org_admin"===c.role)&&a.id&&!a.urlKey&&!this.isSetupPage))window.location=esriGeowConfig.baseUrl+"setup.html";e?(a.access&&("private"===a.access&&!this.isLoggedIn)&&(!this.isSignInPage&&!this.isTroubleshootPage&&!this.isJoinPage&&!this.isSignUpPage)&&(window.location=arcgisonline.sharing.util.getSecureUrl()+esriGeowConfig.signin+"?returnUrl\x3d"+encodeURIComponent(window.location)),
this.switchHeaderGraphic(),a.isPortal&&"singletenant"===a.portalMode&&(arcgisonline.sharing.util.getUser()||b.cookie("esri_auth_guest")&&"7443"!==location.port&&b.addClass(b.byId("logged-out-navigation"),"hide"),("7080"===location.port||"7443"===location.port)&&arcgisonline.sharing.util.checkForIAA().then(b.hitch(this,function(c){if(c&&c.hasIAA&&(a.portalHostname.match(/:7080\//)&&("http:"===location.protocol&&-1===location.href.indexOf("error.html"))&&(window.location=arcgisonline.sharing.util.getHttpUrl(esriGeowConfig.baseUrl)+
"error.html?c\x3dWebAdaptorRequired"),!a.portalHostname.match(/:7080\//)&&80!==esriGeowConfig.httpPort&&443!==esriGeowConfig.httpsPort&&"http:"===location.protocol&&-1===location.href.indexOf("error.html"))){c=new b._Url(location.href);var d=c.path.indexOf("/home/"),d=c.path.substring(d+6);c=esri.isDefined(c.query)?"?"+c.query:"";window.location=arcgisonline.sharing.util.getHttpUrl("http://"+a.portalHostname)+"/home/"+d+c}})))):!a.id&&a.urlKey&&!this.isLoggedIn?!this.isSignInPage&&!this.isTroubleshootPage&&
!this.isJoinPage?window.location=esriGeowConfig.baseUrl.replace("http:","https:")+esriGeowConfig.signin+"?returnUrl\x3d"+encodeURIComponent(window.location):this.switchHeaderGraphic():a.id&&(a.urlKey&&!this.isLoggedIn)&&this.switchHeaderGraphic()}c=esriGeowConfig.baseUrl;if(this.isSignInPage){if(esriGeowConfig.urlKey&&window.location.hostname!==esriGeowConfig.portalHostname){if(b.query("#signInForm #left").style("display","none"),b.query("#signInForm #leftAgo").style("display","none"),b.query("#signInForm #rightAgo").addClass("rightAgoSolo"),
(e=b.query("#signInForm #right"))&&0<e.length)e=e[0],b.removeClass(e,"esriFloatTrailing"),b.addClass(e,"esriFloatLeading"),esriGeowConfig.isRightToLeft?b.style(e,"paddingRight","30%"):b.style(e,"paddingLeft","30%")}else e||(e=b.create("a",{href:b.attr("site-logo","href")}),b.attr("site-logo","href",e.href.replace("https:","http:")));document.referrer&&-1<document.referrer.indexOf("http://")&&(c=c.replace("https:","http:"))}!this.util.isPortal()&&this.isSetupPage&&(b.query('a[page\x3d"user.html"]').forEach(b.hitch(this,
function(a){b.addClass(a,"disabled")})),b.addClass(b.byId("header"),"setupWorkflow"));!this.util.isPortal()&&this.isSignInPage&&b.addClass(b.byId("header"),"hideSignInButton");!this.util.isPortal()&&this.isLoggedIn&&b.attr(b.byId("site-logo"),"href","index.html");this.util.isPortal()&&(b.byId("siteHeader-features")&&b.style(b.byId("siteHeader-features"),"display","none"),b.byId("siteHeader-plan")&&b.style(b.byId("siteHeader-plan"),"display","none"),b.attr(b.byId("site-logo"),"innerHTML",this.i18n.home_link),
b.attr(b.byId("site-logo"),"href","index.html"));e=this.util.getUser();esriGeowConfig.restrictOrganizationPageToAdmin&&(e&&e.accountId&&e.role&&"account_admin"!==e.role)&&b.style(b.byId("siteHeader-myOrganization"),"display","none");esriGeowConfig.userRole&&(esriGeowConfig.userRole.isCustom()&&!esriGeowConfig.userRole.canCreateItem())&&b.style(b.byId("siteHeader-myContent"),"display","none");b.byId("esri-community-img-icon")||b.create("img",{id:"esri-community-img-icon",src:this.util.relativeToExplicitUrl("js/arcgisonline/css/images/LinkToOtherApp16.png")},
b.byId("esri-community-img"));b.byId("my-esri-img-icon")||b.create("img",{id:"my-esri-img-icon",src:this.util.relativeToExplicitUrl("js/arcgisonline/css/images/LinkToOtherApp16.png")},b.byId("my-esri-img"));!this.util.isPortal()&&(e&&"both"===e.userType)&&(b.removeClass(b.byId("esri-community"),"hide"),b.removeClass(b.byId("my-esri"),"hide"));this.util.isPortal()||(b.removeClass(b.byId("training"),"hide"),b.byId("training-img-icon")||b.create("img",{id:"training-img-icon",src:this.util.relativeToExplicitUrl("js/arcgisonline/css/images/LinkToOtherApp16.png")},
b.byId("training-img")));!this.util.isPortal()&&(esriGeowConfig.self&&esriGeowConfig.self.subscriptionInfo&&"Trial"===esriGeowConfig.self.subscriptionInfo.type)&&b.removeClass(b.byId("trial-download"),"hide")},updateEsriAccessLinks:function(a){!this.util.isPortal()&&a&&"both"===a?(b.removeClass(b.byId("esri-community"),"hide"),b.removeClass(b.byId("my-esri"),"hide")):(b.addClass(b.byId("esri-community"),"hide"),b.addClass(b.byId("my-esri"),"hide"))},handleItemEnter:function(a){b.hasClass(a.currentTarget.id,
"selected")||b.addClass(a.currentTarget.id,"hover")},handleItemLeave:function(a){b.hasClass(a.currentTarget.id,"selected")||b.removeClass(a.currentTarget.id,"hover")},openPage:function(a){document.location=a},openPageNewWindow:function(a){window.open(a,"_blank")},updateLinks:function(){},adjustNavBar:function(){var a=this.util.getUser();b.attr("header-nav-primary","style",{width:"auto","max-width":"100%"});b.query(".siteHeaderLink",this.domNode).style({display:"none"});esriGeowConfig.sceneViewerEnabled&&
(b.query("#sceneViewer",this.domNode).removeClass("hide"),b.query("#siteHeader-scene",this.domNode).style({display:""}));esriGeowConfig.self&&esriGeowConfig.self.urlKey||this.util.isPortal()?(b.query(".organization",this.domNode).style({display:""}),a&&(b.query(".orgUser",this.domNode).style({display:""}),b.query(".help",this.domNode).style({display:"none"}),b.attr(b.byId("site-logo"),"href","index.html"))):(b.query(".anon",this.domNode).style({display:""}),a&&(b.query(".pubUser",this.domNode).style({display:""}),
b.query(".help",this.domNode).style({display:"none"})));9>b.has("ie")&&b.query(".helpNav",this.domNode).style({display:"none"})},loggedOut:function(){var a="";b.removeClass(b.byId("logged-out-navigation"),"hide");b.addClass(b.byId("logged-in-navigation"),"hide");this.adjustNavBar();if(-1===esriGeowConfig.signin.indexOf("http")&&(a=esriGeowConfig.baseUrl,this.allSSL||!1!==esriGeowConfig.useSSL))if(a=a.replace("http:","https:"),!1===esriGeowConfig.isMultiTenant||esriGeowConfig.self&&esriGeowConfig.self.portalMode&&
"singletenant"===esriGeowConfig.self.portalMode)a=arcgisonline.sharing.util.getSecureUrl();if(this.isNewUserPage)b.create("span",{style:{color:"#BBBBBB",marginLeft:"18px"},innerHTML:this.i18n.signIn},this._signInOutLink,"only");else{var c=b.create("a",{href:"#",innerHTML:this.i18n.signIn},this._signInOutLink,"only");this.isItemDetailsPage?b.attr(c,"href",a+esriGeowConfig.signin+"?returnUrl\x3d"+document.location.href):b.attr(c,"href",a+esriGeowConfig.signin+"?")}b.query(".menu-logged-in",this.domNode).style({display:"none"});
arcgisonline.sharing.util.isPortal()||b.attr(b.byId("login-link"),"href",esriGeowConfig.baseUrl+esriGeowConfig.signin)},loggedIn:function(){var a=this.util.getUser();if(null===a)this.loggedOut();else{var c=this.util.getUserDisplayName(a);b.attr(b.byId("username"),"innerHTML",c);b.attr(b.byId("username"),"title",a.fullName);b.attr(this._userProfileLink,"innerHTML",a.username);b.attr("profileLink","title",a.fullName);b.addClass(b.byId("logged-out-navigation"),"hide");b.removeClass(b.byId("logged-in-navigation"),
"hide");this.util.isPortal()&&"account_admin"===a.role?b.removeClass(b.byId("admin-guide"),"hide"):b.addClass(b.byId("admin-guide"),"hide");c=this.allSSL||arcgisonline.sharing.util.usePortalSSL()?arcgisonline.sharing.util.getSecureUrl(esriGeowConfig.restBaseUrl):esriGeowConfig.restBaseUrl;c=esriGeowConfig.userInfo.thumbnail?c+"community/users/"+esriGeowConfig.userInfo.username+"/info/"+esriGeowConfig.userInfo.thumbnail+"?token\x3d"+esriGeowConfig.userInfo.token:this.util.relativeToExplicitUrl("js/arcgisonline/css/images/no-user-thumb.jpg");
b.attr("dropdown-image","src",c);b.attr("profileImgSmall","src",c);a.accountId&&null!==a.accountId&&(void 0===esriGeowConfig.isMultiTenant||!0===esriGeowConfig.isMultiTenant)&&!esriGeowConfig.portalName&&this.switchHeaderGraphic();this.adjustNavBar();b.subscribe("onNotificationCount",this,"notificationCountHandler");arcgisonline.sharing.geow.Community.getNotificationsCount()}},logOut:function(){b.cookie("esri_webmap","",{expires:-1,path:"/"});var a=arcgisonline.sharing.util.getHttpUrl()+"index.html";
this.isPrivateOrg&&(a=arcgisonline.sharing.util.getSecureUrl()+esriGeowConfig.signin);this.isPublicOrg&&(a=(this.allSSL||arcgisonline.sharing.util.usePortalSSL()?arcgisonline.sharing.util.getSecureUrl():arcgisonline.sharing.util.getHttpUrl())+"index.html");this.geow.signout(a)},notificationCountHandler:function(a){var c=0;0<a&&(c=a);b.create("a",{title:this.i18n.notifications,innerHTML:c,href:"#",onclick:b.hitch(this,arcgisonline.sharing.geow.Community.getNotifications)},b.byId("notifications"),"only");
0===a?b.addClass(b.byId("header_notifications"),"noNotifications"):1<=a&&b.addClass(b.byId("header_notifications"),"notifications")},switchHeaderGraphic:function(){var a=b.query(".siteHeader div.mainSearch"),c=b.query(".siteHeader ul.mainTabs li a"),d,e=b.baseUrl.substring(0,b.baseUrl.indexOf("/js"));for(d=0;d<a.length;d++)b.style(a[d],{background:esriGeowConfig.isRightToLeft?"url('"+e+"/js/arcgisojs/arcgisonlineanization-global-nav-rtl-"+(-1!==b.locale.indexOf("-")?b.locale.split("-")[0]:b.locale)+
".png') no-repeat scroll 0 0 transparent":"url('"+e+"/js/arcgisonlinejs/arcgisonlinetion-global-nav"+("en"!==b.locale.split("-")[0]?"-"+b.locale:"")+".png') no-repeat 100% 0"}),b.addClass(a[d],"esriOrg");for(d=0;d<c.length;d++)b.style(c[d],{backgroundImage:esriGeowConfig.isRightToLeft?"url('"+e+"/js/arcgisonline/css/js/arcgisonlineglobal-nav-rtl-"+(-1!==b.locale.indexOf("-")?b.locale.split("-")[0]:b.locale)+".png')":"url('"+e+"/js/arcgisonline/css/images/organization-global-nav"+("en"!==b.locale.split("-")[0]?
"-"+b.locale:"")+".png')"}),b.addClass(c[d],"esriOrg")},goEsriCommunity:function(a){a.preventDefault();this.openPageNewWindow(esriGeowConfig.esriCommunityLink)},goMyEsri:function(a){a.preventDefault();this.openPageNewWindow(esriGeowConfig.myEsriLink)},goTraining:function(a){a.preventDefault();a={administrator:"//www.esri.com/training/main/arcgis-online-training/administrators",publisher:"//www.esri.com/training/main/arcgis-online-training/publishers",user:"//www.esri.com/training/main/arcgis-online-training/users",
"public":"//www.esri.com/training/main/arcgis-online-training",custom:"//www.esri.com/training/main/arcgis-online-training"};var b=esriGeowConfig.userRole,d;b?b.isAdmin()||b.isBasedOnAdmin()?d=a.administrator:b.isPublisher()||b.isBasedOnPublisher()?d=a.publisher:b.isUser()||b.isBasedOnUser()?d=a.user:b.isCustom()&&(d=a.custom):d=a["public"];this.openPageNewWindow(d)},goTrialDownload:function(a){a.preventDefault();a=(esriGeowConfig.self&&esriGeowConfig.self.user&&esriGeowConfig.self.user.culture||
esriGeowConfig.self&&esriGeowConfig.self.culture||dojoConfig.locale||"en").toLowerCase();a=esriGeowConfig.learnArcGIS+"/"+(a in{"pt-br":1,"pt-pt":1,"zh-cn":1}?a:a.split("-")[0].toLowerCase())+"/trial";this.openPageNewWindow(a)},_handleLinkClick:function(a){if(a.currentTarget&&b.attr(a.currentTarget,"page")){var c=arcgisonline.sharing.util.usePortalSSL(),c=this.allSSL||c?arcgisonline.sharing.util.getSecureUrl():arcgisonline.sharing.util.getHttpUrl(),d=esriGeowConfig.self&&esriGeowConfig.self.helpBase||
"support.html";this.util.isPortal()?"support.html"===b.attr(a.currentTarget,"page")?(a.preventDefault(),this.openPageNewWindow(d)):"adminguide.html"===b.attr(a.currentTarget,"page")?(a.preventDefault(),this.openPageNewWindow(d.replace("/website/","/admin/"))):("7443"===location.port&&(c=arcgisonline.sharing.util.getSecureUrl()),this.openPage(c+b.attr(a.currentTarget,"page"))):(a="support.html"===b.attr(a.currentTarget,"page")?d:c+b.attr(a.currentTarget,"page"),this.openPage(a))}return!1}})})},"esri/geometry/Multipoint":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../SpatialReference ./Geometry ./Point ./Extent".split(" "),
function(h,b,k,a,c,d,e,f){var g={type:"multipoint",points:null};h=h(d,{declaredClass:"esri.geometry.Multipoint",constructor:function(a){b.mixin(this,g);this.points=[];a&&(a.points?b.mixin(this,a):this.spatialReference=a,this.spatialReference&&(this.spatialReference=new c(this.spatialReference)));this.verifySR()},addPoint:function(a){this.clearCache();b.isArray(a)?this.points.push(a):this.points.push([a.x,a.y]);return this},removePoint:function(a){if(this._validateInputs(a))return this.clearCache(),
new e(this.points.splice(a,1)[0],this.spatialReference)},getExtent:function(){var a=this.getCacheValue("_extent");if(a)return new f(a);var a=this.points,b=a.length;if(b){var c=a[0],d,e,g=d=c[0],k=e=c[1],h=Math.min,x=Math.max,w=this.spatialReference,v,y;for(y=0;y<b;y++)c=a[y],v=c[0],c=c[1],g=h(g,v),k=h(k,c),d=x(d,v),e=x(e,c);a={xmin:g,ymin:k,xmax:d,ymax:e,spatialReference:w?w.toJson():null};this.setCacheValue("_extent",a);return new f(a)}},_validateInputs:function(a){return null===a||0>a||a>=this.points.length?
!1:!0},getPoint:function(a){if(this._validateInputs(a))return a=this.points[a],new e(a[0],a[1],this.spatialReference)},setPoint:function(a,b){if(this._validateInputs(a))return this.clearCache(),this.points[a]=[b.x,b.y],this},toJson:function(){var a={points:b.clone(this.points)},c=this.spatialReference;c&&(a.spatialReference=c.toJson());return a}});h.defaultProps=g;k("extend-esri")&&(b.setObject("geometry.Multipoint",h,a),a.geometry.defaultMultipoint=g);return h})},"esri/deferredUtils":function(){define(["dojo/_base/lang",
"dojo/has","./kernel"],function(h,b,k){var a={_dfdCanceller:function(a){a.canceled=!0;var b=a._pendingDfd;-1===a.fired&&(b&&-1===b.fired)&&b.cancel();a._pendingDfd=null},_fixDfd:function(a){var b=a.then;a.then=function(a,c,g){if(a){var l=a;a=function(a){return a&&a._argsArray?l.apply(null,a):l(a)}}return b.call(this,a,c,g)};return a},_resDfd:function(a,b,e){var f=b.length;1===f?e?a.errback(b[0]):a.callback(b[0]):1<f?(b._argsArray=!0,a.callback(b)):a.callback()}};b("extend-esri")&&h.mixin(k,a);return a})},
"dojox/widget/rotator/Fade":function(){define(["dojo/_base/lang","dojo/_base/fx","dojo/dom-style","dojo/fx"],function(h,b,k,a){function c(c,d){var g=c.next.node;k.set(g,{display:"",opacity:0});c.node=c.current.node;return a[d]([b.fadeOut(c),b.fadeIn(h.mixin(c,{node:g}))])}var d={fade:function(a){return c(a,"chain")},crossFade:function(a){return c(a,"combine")}};h.mixin(h.getObject("dojox.widget.rotator"),d);return d})},"dojo/uacss":function(){define(["./dom-geometry","./_base/lang","./domReady","./sniff",
"./_base/window"],function(h,b,k,a,c){var d=c.doc.documentElement;c=a("ie");var e=a("opera"),f=Math.floor,g=a("ff"),l=h.boxModel.replace(/-/,""),e={dj_quirks:a("quirks"),dj_opera:e,dj_khtml:a("khtml"),dj_webkit:a("webkit"),dj_safari:a("safari"),dj_chrome:a("chrome"),dj_gecko:a("mozilla"),dj_ios:a("ios"),dj_android:a("android")};c&&(e.dj_ie=!0,e["dj_ie"+f(c)]=!0,e.dj_iequirks=a("quirks"));g&&(e["dj_ff"+f(g)]=!0);e["dj_"+l]=!0;var m="",n;for(n in e)e[n]&&(m+=n+" ");d.className=b.trim(d.className+" "+
m);k(function(){if(!h.isBodyLtr()){var a="dj_rtl dijitRtl "+m.replace(/ /g,"-rtl ");d.className=b.trim(d.className+" "+a+"dj_rtl dijitRtl "+m.replace(/ /g,"-rtl "))}});return a})},"dijit/layout/LayoutContainer":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-style dojo/_base/lang ../_WidgetBase ./_LayoutWidget ./utils".split(" "),function(h,b,k,a,c,d,e,f){b=b("dijit.layout.LayoutContainer",e,{design:"headline",baseClass:"dijitLayoutContainer",startup:function(){this._started||
(h.forEach(this.getChildren(),this._setupChild,this),this.inherited(arguments))},_setupChild:function(a){this.inherited(arguments);a.region&&k.add(a.domNode,this.baseClass+"Pane")},_getOrderedChildren:function(){var a=h.map(this.getChildren(),function(a,b){return{pane:a,weight:["center"==a.region?Infinity:0,a.layoutPriority,("sidebar"==this.design?1:-1)*(/top|bottom/.test(a.region)?1:-1),b]}},this);a.sort(function(a,b){for(var c=a.weight,d=b.weight,e=0;e<c.length;e++)if(c[e]!=d[e])return c[e]-d[e];
return 0});return h.map(a,function(a){return a.pane})},layout:function(){f.layoutChildren(this.domNode,this._contentBox,this._getOrderedChildren())},addChild:function(a,b){this.inherited(arguments);this._started&&this.layout()},removeChild:function(b){this.inherited(arguments);this._started&&this.layout();k.remove(b.domNode,this.baseClass+"Pane");a.set(b.domNode,{top:"auto",bottom:"auto",left:"auto",right:"auto",position:"static"});a.set(b.domNode,/top|bottom/.test(b.region)?"width":"height","auto")}});
b.ChildWidgetProperties={region:"",layoutAlign:"",layoutPriority:0};c.extend(d,b.ChildWidgetProperties);return b})},"esri/request":function(){define("require dojo/_base/array dojo/_base/config dojo/_base/Deferred dojo/_base/lang dojo/_base/url dojo/_base/xhr dojo/io/script dojo/io/iframe dojo/dom-construct dojo/io-query ./kernel ./config ./sniff ./lang ./urlUtils ./deferredUtils".split(" "),function(h,b,k,a,c,d,e,f,g,l,m,n,q,p,s,t,u){function x(a){a=new d(a);return(a.host+(a.port?":"+a.port:"")).toLowerCase()}
function w(d,h,q,u){var w=!1,v=!1,y;s.isDefined(h)&&(c.isObject(h)?(w=!!h.useProxy,v=!!h.usePost,y=h.crossOrigin):w=!!h);d=c.mixin({},d);d._ssl&&(d.url=d.url.replace(/^http:/i,"https:"));h=d.content;var A=d.url,B=q&&d.form,z=F;y=s.isDefined(y)?y:z.useCors;d.load=function(a){var b;a&&(a.error?(b=c.mixin(Error(),a.error),b.log=k.isDebug):"error"===a.status&&(b=c.mixin(Error(),a),b.log=k.isDebug),b&&!s.isDefined(b.httpCode)&&(b.httpCode=b.code));return b||a};d.error=function(a,b){b&&b.xhr&&b.xhr.abort();
a instanceof Error||(a=c.mixin(Error(),a));a.log=k.isDebug;z.errorHandler(a,b);return a};d._token&&(d.content=d.content||{},d.content.token=d._token);var N=0,I;h&&A&&(I=m.objectToQuery(h),N=I.length+A.length+1,p("esri-url-encodes-apostrophe")&&(N=I.replace(/'/g,"%27").length+A.length+1));d.timeout=s.isDefined(d.timeout)?d.timeout:z.timeout;d.handleAs=d.handleAs||"json";try{var M,T,R=y&&t.canUseXhr(d.url)&&!/https?:\/\/[^\/]+\/[^\/]+\/admin\/?(\/.*)?$/i.test(d.url),Y=t.hasSameOrigin(d.url,window.location.href)||
R,U=v||q||N>z.postLength?!0:!1,V=!Y&&-1!==d.handleAs.indexOf("json")&&d.callbackParamName&&!q?!0:!1,W=t.getProxyRule(d.url)||z.alwaysUseProxy||w||(!V||U)&&!Y?!0:!1;q&&(!p("esri-file-upload")&&!W&&R)&&(W=!0);if(W)if(M=t.getProxyUrl(A,y),T=M.path,M._xo&&(R=!0),!U&&T.length+1+N>z.postLength&&(U=!0),d.url=T+"?"+A,U)d.content=c.mixin(M.query||{},h);else{var fa=m.objectToQuery(c.mixin(M.query||{},h));fa&&(d.url+="?"+fa);d.content=null}if(V&&!U)return!s.isDefined(d.isAsync)&&4>p("ff")&&(d.isAsync=!0),f.get(G?
G(d):d);var Z=d.headers;if(R&&(!Z||!Z.hasOwnProperty("X-Requested-With")))Z=d.headers=Z||{},Z["X-Requested-With"]=null;if(q){var ba=d.callbackParamName||"callback.html",ga=d.callbackElementName||"textarea",$,ca,aa,da,ia=B.elements?B.elements.length:0,ea;if(h=d.content)for($ in h)if(aa=h[$],s.isDefined(aa)){ca=null;for(da=0;da<ia;da++)if(ea=B.elements[da],ea.name===$){ca=ea;break}ca?ca.value=aa:u?B.append($,aa):B.appendChild(l.create("input",{type:"hidden",name:$,value:aa}))}if(p("esri-file-upload"))b.forEach(B.elements,
function(a){a.name===ba&&B.removeChild(a)}),d.contentType=!1,d.postData=u?B:new FormData(B),delete d.form;else{B.enctype="multipart/form-data";9>p("ie")&&(B.encoding="multipart/form-data");B.method="post";b.some(B.elements,function(a){return a.name===ba})||B.appendChild(l.create("input",{type:"hidden",name:ba,value:ga}));if(-1!==A.toLowerCase().indexOf("addattachment")||-1!==A.toLowerCase().indexOf("updateattachment"))d.url=A+(-1===A.indexOf("?")?"?":"\x26")+ba+"\x3d"+ga,W&&(d.url=T+"?"+d.url);delete d.content}}if(R&&
!d.hasOwnProperty("withCredentials"))if(u=W?T:A,-1!==b.indexOf(F.webTierAuthServers,x(u)))d.withCredentials=!0;else if(n.id){var ha=n.id.findServerInfo(u);ha&&ha.webTierAuth&&(d.withCredentials=!0)}d=G?G(d):d;if(U){if(q&&!p("esri-file-upload"))return g.send(d);!W&&p("safari")&&(d.url+=(-1===d.url.indexOf("?")?"?":"\x26")+"_ts\x3d"+(new Date).getTime()+E++);return e.post(d)}return e.get(d)}catch(ja){return q=new a,q.errback(d.error(ja)),q}}function v(a){var b=F.corsStatus,c=t.canUseXhr(a,!0);-1<c&&
F.corsEnabledServers.splice(c,1);b[x(a)]=1;return c}function y(a){var b=F.corsStatus;if(F.corsDetection&&F.useCors)try{var c=x(a);p("esri-cors")&&(a&&-1!==a.toLowerCase().indexOf("/rest/services")&&!t.hasSameOrigin(a,window.location.href)&&!t.canUseXhr(a)&&!b[c])&&(b[c]=-1,e.get({url:a.substring(0,a.toLowerCase().indexOf("/rest/")+6)+"info",content:{f:"json"},failOk:!0,handleAs:"json",headers:{"X-Requested-With":null}}).then(function(d){d?(b[c]=2,t.canUseXhr(a)||F.corsEnabledServers.push(c)):b[c]=
1},function(a){b[c]=1}))}catch(d){console.log("esri._detectCors: an unknown error occurred while detecting CORS support")}}function A(a){G=a}function z(c,d){function f(a){a._pendingDfd=w(c,d,N,G);if(!a._pendingDfd){a.ioArgs=a._pendingDfd&&a._pendingDfd.ioArgs;var e=Error("Deferred object is missing");e.log=k.isDebug;c._usrDfd=null;a.errback(e);a._pendingDfd=null;return a}a._pendingDfd.addCallback(function(b){a.ioArgs=a._pendingDfd&&a._pendingDfd.ioArgs;c._usrDfd=null;a.callback(b);a._pendingDfd=null}).addErrback(function(e){var f,
g,l;e&&(f=e.code,g=e.subcode,l=(l=e.messageCode)&&l.toUpperCase());if(e&&403==f&&(4==g||e.message&&-1<e.message.toLowerCase().indexOf("ssl")&&-1===e.message.toLowerCase().indexOf("permission"))){if(!c._ssl){c._ssl=c._sslFromServer=!0;c._usrDfd=a;z(c,d);return}}else if(e&&415==e.status){if(v(c.url),!c._err415){c._err415=1;c._usrDfd=a;z(c,d);return}}else if(n.id&&-1!==b.indexOf(n.id._errorCodes,f)&&!n.id._isPublic(c.url)&&!m&&(403!=f||-1===b.indexOf(B,l)&&(!s.isDefined(g)||2==g))){a._pendingDfd=n.id.getCredential(c.url,
{token:c._token,error:e});a._pendingDfd.addCallback(function(b){c._token=b.token;c._usrDfd=a;c._credential=b;c._ssl=c._sslFromServer||b.ssl;z(c,d)}).addErrback(function(b){c._usrDfd=null;a.errback(b);a._pendingDfd=null});return}a.ioArgs=a._pendingDfd&&a._pendingDfd.ioArgs;c._usrDfd=null;a.errback(e);a._pendingDfd=null})}c.url=t.fixUrl(c.url);"file:"!==window.location.protocol&&(c.url=t.getAbsoluteUrl(c.url));d=d||{};var g,l=c.form,m=d.disableIdentityLookup,q=d._preLookup,A=!1;if(p("esri-workers")&&
!1!==F.useWorkers)if(!0===d.useWorkers||!0===F.useWorkers)A=!0;else if(d.workerOptions){var E=d.workerOptions;if(E.callback||E.worker&&E.worker.worker instanceof Worker)A=!0}var G=l&&l.append,N=l&&(l.elements?b.some(l.elements,function(a){return"file"===a.type}):G),I=-1!==c.url.toLowerCase().indexOf("token\x3d")||c.content&&c.content.token||N&&b.some(l.elements,function(a){return"token"===a.name})?1:0;y(c.url);if(c._usrDfd)g=c._usrDfd;else{g=new a(u._dfdCanceller);g.addCallback(function(a){/\/sharing\/rest\/accounts\/self/i.test(c.url)&&
(!I&&!c._token&&a.user&&a.user.username)&&F.webTierAuthServers.push(x(c.url));if(a=c._credential){var b=n.id.findServerInfo(a.server);if(b=b&&b.owningSystemUrl)b=b.replace(/\/?$/,"/sharing"),(a=n.id.findCredential(b,a.userId))&&-1===n.id._getIdenticalSvcIdx(b,a)&&a.resources.splice(0,0,b)}});g.addBoth(function(a){delete c._credential;if(a&&(!p("ie")||!a.nodeType))a._ssl=c._ssl});var M=c.load,T=c.error;M&&g.addCallback(function(a){var b=g._pendingDfd,b=b&&b.ioArgs;return M.call(b&&b.args,a,b)});T&&
g.addErrback(function(a){var b=g._pendingDfd,b=b&&b.ioArgs;return T.call(b&&b.args,a,b)})}if(n.id&&!I&&!c._token&&!n.id._isPublic(c.url)&&(!m||q))if(l=n.id.findCredential(c.url))c._token=l.token,c._ssl=l.ssl;A?d.workerOptions&&d.workerOptions.worker?(e=d.workerOptions.worker,f(g)):h(["./workers/RequestClient"],function(a){if(d.workerOptions){var b=d.workerOptions;e=a.getClient(b.callback,b.cbFunction)}else e=a.getClient();f(g)}):f(g);return g}var G,F=q.defaults.io,B=["COM_0056","COM_0057"],E=0;z._request=
w;z._disableCors=v;z._detectCors=y;z.setRequestPreCallback=A;p("extend-esri")&&(n.request=z,n._request=w,n._disableCors=v,n._detectCors=y,n.setRequestPreCallback=A);return z})},"dojo/string":function(){define(["./_base/kernel","./_base/lang"],function(h,b){var k=/[&<>'"\/]/g,a={"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#x27;","/":"\x26#x2F;"},c={};b.setObject("dojo.string",c);c.escape=function(b){return!b?"":b.replace(k,function(b){return a[b]})};c.rep=function(a,
b){if(0>=b||!a)return"";for(var c=[];;){b&1&&c.push(a);if(!(b>>=1))break;a+=a}return c.join("")};c.pad=function(a,b,f,g){f||(f="0");a=String(a);b=c.rep(f,Math.ceil((b-a.length)/f.length));return g?a+b:b+a};c.substitute=function(a,c,f,g){g=g||h.global;f=f?b.hitch(g,f):function(a){return a};return a.replace(/\$\{([^\s\:\}]+)(?:\:([^\s\:\}]+))?\}/g,function(a,d,n){a=b.getObject(d,!1,c);n&&(a=b.getObject(n,!1,g).call(g,a,d));return f(a,d).toString()})};c.trim=String.prototype.trim?b.trim:function(a){a=
a.replace(/^\s+/,"");for(var b=a.length-1;0<=b;b--)if(/\S/.test(a.charAt(b))){a=a.substring(0,b+1);break}return a};return c})},"dijit/Tooltip":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/fx dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/lang dojo/mouse dojo/on dojo/sniff ./_base/manager ./place ./_Widget ./_TemplatedMixin ./BackgroundIframe dojo/text!./templates/Tooltip.html ./main".split(" "),function(h,b,k,a,c,d,e,f,g,l,m,n,q,p,s,t,u,x){function w(){}var v=
b("dijit._MasterTooltip",[p,s],{duration:n.defaultDuration,templateString:u,postCreate:function(){this.ownerDocumentBody.appendChild(this.domNode);this.bgIframe=new t(this.domNode);this.fadeIn=k.fadeIn({node:this.domNode,duration:this.duration,onEnd:f.hitch(this,"_onShow")});this.fadeOut=k.fadeOut({node:this.domNode,duration:this.duration,onEnd:f.hitch(this,"_onHide")})},show:function(a,b,c,d,g,l,m){if(!this.aroundNode||!(this.aroundNode===b&&this.containerNode.innerHTML==a))if("playing"==this.fadeOut.status())this._onDeck=
arguments;else{this.containerNode.innerHTML=a;g&&this.set("textDir",g);this.containerNode.align=d?"right":"left";var n=q.around(this.domNode,b,c&&c.length?c:y.defaultPosition,!d,f.hitch(this,"orient")),k=n.aroundNodePos;"M"==n.corner.charAt(0)&&"M"==n.aroundCorner.charAt(0)?(this.connectorNode.style.top=k.y+(k.h-this.connectorNode.offsetHeight>>1)-n.y+"px",this.connectorNode.style.left=""):"M"==n.corner.charAt(1)&&"M"==n.aroundCorner.charAt(1)?this.connectorNode.style.left=k.x+(k.w-this.connectorNode.offsetWidth>>
1)-n.x+"px":(this.connectorNode.style.left="",this.connectorNode.style.top="");e.set(this.domNode,"opacity",0);this.fadeIn.play();this.isShowingNow=!0;this.aroundNode=b;this.onMouseEnter=l||w;this.onMouseLeave=m||w}},orient:function(a,b,c,e,f){this.connectorNode.style.top="";var g=e.h;e=e.w;a.className="dijitTooltip "+{"MR-ML":"dijitTooltipRight","ML-MR":"dijitTooltipLeft","TM-BM":"dijitTooltipAbove","BM-TM":"dijitTooltipBelow","BL-TL":"dijitTooltipBelow dijitTooltipABLeft","TL-BL":"dijitTooltipAbove dijitTooltipABLeft",
"BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight","BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft"}[b+"-"+c];this.domNode.style.width="auto";var l=d.position(this.domNode);if(m("ie")||m("trident"))l.w+=2;var n=Math.min(Math.max(e,1),l.w);d.setMarginBox(this.domNode,{w:n});"B"==c.charAt(0)&&"B"==b.charAt(0)?(a=d.position(a),b=this.connectorNode.offsetHeight,a.h>g?(this.connectorNode.style.top=g-(f.h+b>>1)+"px",this.connectorNode.style.bottom=""):
(this.connectorNode.style.bottom=Math.min(Math.max(f.h/2-b/2,0),a.h-b)+"px",this.connectorNode.style.top="")):(this.connectorNode.style.top="",this.connectorNode.style.bottom="");return Math.max(0,l.w-e)},_onShow:function(){m("ie")&&(this.domNode.style.filter="")},hide:function(a){this._onDeck&&this._onDeck[1]==a?this._onDeck=null:this.aroundNode===a&&(this.fadeIn.stop(),this.isShowingNow=!1,this.aroundNode=null,this.fadeOut.play());this.onMouseEnter=this.onMouseLeave=w},_onHide:function(){this.domNode.style.cssText=
"";this.containerNode.innerHTML="";this._onDeck&&(this.show.apply(this,this._onDeck),this._onDeck=null)}});m("dojo-bidi")&&v.extend({_setAutoTextDir:function(a){this.applyTextDir(a);h.forEach(a.children,function(a){this._setAutoTextDir(a)},this)},_setTextDirAttr:function(a){this._set("textDir",a);"auto"==a?this._setAutoTextDir(this.containerNode):this.containerNode.dir=this.textDir}});x.showTooltip=function(a,b,c,d,e,f,g){c&&(c=h.map(c,function(a){return{after:"after-centered",before:"before-centered"}[a]||
a}));y._masterTT||(x._masterTT=y._masterTT=new v);return y._masterTT.show(a,b,c,d,e,f,g)};x.hideTooltip=function(a){return y._masterTT&&y._masterTT.hide(a)};var y=b("dijit.Tooltip",p,{label:"",showDelay:400,hideDelay:400,connectId:[],position:[],selector:"",_setConnectIdAttr:function(b){h.forEach(this._connections||[],function(a){h.forEach(a,function(a){a.remove()})},this);this._connectIds=h.filter(f.isArrayLike(b)?b:b?[b]:[],function(b){return a.byId(b,this.ownerDocument)},this);this._connections=
h.map(this._connectIds,function(b){b=a.byId(b,this.ownerDocument);var c=this.selector,d=c?function(a){return l.selector(c,a)}:function(a){return a},e=this;return[l(b,d(g.enter),function(){e._onHover(this)}),l(b,d("focusin"),function(){e._onHover(this)}),l(b,d(g.leave),f.hitch(e,"_onUnHover")),l(b,d("focusout"),f.hitch(e,"set","state","DORMANT"))]},this);this._set("connectId",b)},addTarget:function(a){a=a.id||a;-1==h.indexOf(this._connectIds,a)&&this.set("connectId",this._connectIds.concat(a))},removeTarget:function(a){a=
h.indexOf(this._connectIds,a.id||a);0<=a&&(this._connectIds.splice(a,1),this.set("connectId",this._connectIds))},buildRendering:function(){this.inherited(arguments);c.add(this.domNode,"dijitTooltipData")},startup:function(){this.inherited(arguments);var a=this.connectId;h.forEach(f.isArrayLike(a)?a:[a],this.addTarget,this)},getContent:function(a){return this.label||this.domNode.innerHTML},state:"DORMANT",_setStateAttr:function(a){if(!(this.state==a||"SHOW TIMER"==a&&"SHOWING"==this.state||"HIDE TIMER"==
a&&"DORMANT"==this.state)){this._hideTimer&&(this._hideTimer.remove(),delete this._hideTimer);this._showTimer&&(this._showTimer.remove(),delete this._showTimer);switch(a){case "DORMANT":this._connectNode&&(y.hide(this._connectNode),delete this._connectNode,this.onHide());break;case "SHOW TIMER":"SHOWING"!=this.state&&(this._showTimer=this.defer(function(){this.set("state","SHOWING")},this.showDelay));break;case "SHOWING":var b=this.getContent(this._connectNode);if(!b){this.set("state","DORMANT");
return}y.show(b,this._connectNode,this.position,!this.isLeftToRight(),this.textDir,f.hitch(this,"set","state","SHOWING"),f.hitch(this,"set","state","HIDE TIMER"));this.onShow(this._connectNode,this.position);break;case "HIDE TIMER":this._hideTimer=this.defer(function(){this.set("state","DORMANT")},this.hideDelay)}this._set("state",a)}},_onHover:function(a){this._connectNode&&a!=this._connectNode&&this.set("state","DORMANT");this._connectNode=a;this.set("state","SHOW TIMER")},_onUnHover:function(a){this.set("state",
"HIDE TIMER")},open:function(a){this.set("state","DORMANT");this._connectNode=a;this.set("state","SHOWING")},close:function(){this.set("state","DORMANT")},onShow:function(){},onHide:function(){},destroy:function(){this.set("state","DORMANT");h.forEach(this._connections||[],function(a){h.forEach(a,function(a){a.remove()})},this);this.inherited(arguments)}});y._MasterTooltip=v;y.show=x.showTooltip;y.hide=x.hideTooltip;y.defaultPosition=["after-centered","before-centered"];return y})},"dijit/form/DropDownButton":function(){define("dojo/_base/declare dojo/_base/lang dojo/query ../registry ../popup ./Button ../_Container ../_HasDropDown dojo/text!./templates/DropDownButton.html ../a11yclick".split(" "),
function(h,b,k,a,c,d,e,f,g){return h("dijit.form.DropDownButton",[d,e,f],{baseClass:"dijitDropDownButton",templateString:g,_fillContent:function(){if(this.srcNodeRef){var a=k("*",this.srcNodeRef);this.inherited(arguments,[a[0]]);this.dropDownContainer=this.srcNodeRef}},startup:function(){if(!this._started){if(!this.dropDown&&this.dropDownContainer){var b=k("[widgetId]",this.dropDownContainer)[0];b&&(this.dropDown=a.byNode(b));delete this.dropDownContainer}this.dropDown&&c.hide(this.dropDown);this.inherited(arguments)}},
isLoaded:function(){var a=this.dropDown;return!!a&&(!a.href||a.isLoaded)},loadDropDown:function(a){var c=this.dropDown,d=c.on("load",b.hitch(this,function(){d.remove();a()}));c.refresh()},isFocusable:function(){return this.inherited(arguments)&&!this._mouseDown}})})},"dijit/form/_FormValueMixin":function(){define("dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on ./_FormWidgetMixin".split(" "),function(h,b,k,a,c,d){return h("dijit.form._FormValueMixin",d,{readOnly:!1,_setReadOnlyAttr:function(a){b.set(this.focusNode,
"readOnly",a);this._set("readOnly",a)},postCreate:function(){this.inherited(arguments);void 0===this._resetValue&&(this._lastValueReported=this._resetValue=this.value)},_setValueAttr:function(a,b){this._handleOnChange(a,b)},_handleOnChange:function(a,b){this._set("value",a);this.inherited(arguments)},undo:function(){this._setValueAttr(this._lastValueReported,!1)},reset:function(){this._hasBeenBlurred=!1;this._setValueAttr(this._resetValue,!0)}})})},"dijit/form/_FormWidgetMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/dom-style dojo/_base/lang dojo/mouse dojo/on dojo/sniff dojo/window ../a11y".split(" "),
function(h,b,k,a,c,d,e,f,g,l){return b("dijit.form._FormWidgetMixin",null,{name:"",alt:"",value:"",type:"text","aria-label":"focusNode",tabIndex:"0",_setTabIndexAttr:"focusNode",disabled:!1,intermediateChanges:!1,scrollOnFocus:!0,_setIdAttr:"focusNode",_setDisabledAttr:function(a){this._set("disabled",a);k.set(this.focusNode,"disabled",a);this.valueNode&&k.set(this.valueNode,"disabled",a);this.focusNode.setAttribute("aria-disabled",a?"true":"false");a?(this._set("hovering",!1),this._set("active",
!1),a="tabIndex"in this.attributeMap?this.attributeMap.tabIndex:"_setTabIndexAttr"in this?this._setTabIndexAttr:"focusNode",h.forEach(c.isArray(a)?a:[a],function(a){a=this[a];f("webkit")||l.hasDefaultTabStop(a)?a.setAttribute("tabIndex","-1"):a.removeAttribute("tabIndex")},this)):""!=this.tabIndex&&this.set("tabIndex",this.tabIndex)},_onFocus:function(a){if("mouse"==a&&this.isFocusable())var b=this.own(e(this.focusNode,"focus",function(){l.remove();b.remove()}))[0],d=f("pointer-events")?"pointerup":
f("MSPointer")?"MSPointerUp":f("touch-events")?"touchend, mouseup":"mouseup",l=this.own(e(this.ownerDocumentBody,d,c.hitch(this,function(a){l.remove();b.remove();this.focused&&("touchend"==a.type?this.defer("focus"):this.focus())})))[0];this.scrollOnFocus&&this.defer(function(){g.scrollIntoView(this.domNode)});this.inherited(arguments)},isFocusable:function(){return!this.disabled&&this.focusNode&&"none"!=a.get(this.domNode,"display")},focus:function(){if(!this.disabled&&this.focusNode.focus)try{this.focusNode.focus()}catch(a){}},
compare:function(a,b){return"number"==typeof a&&"number"==typeof b?isNaN(a)&&isNaN(b)?0:a-b:a>b?1:a<b?-1:0},onChange:function(){},_onChangeActive:!1,_handleOnChange:function(a,b){if(void 0==this._lastValueReported&&(null===b||!this._onChangeActive))this._resetValue=this._lastValueReported=a;this._pendingOnChange=this._pendingOnChange||typeof a!=typeof this._lastValueReported||0!=this.compare(a,this._lastValueReported);if((this.intermediateChanges||b||void 0===b)&&this._pendingOnChange)this._lastValueReported=
a,this._pendingOnChange=!1,this._onChangeActive&&(this._onChangeHandle&&this._onChangeHandle.remove(),this._onChangeHandle=this.defer(function(){this._onChangeHandle=null;this.onChange(a)}))},create:function(){this.inherited(arguments);this._onChangeActive=!0},destroy:function(){this._onChangeHandle&&(this._onChangeHandle.remove(),this.onChange(this._lastValueReported));this.inherited(arguments)}})})},"dijit/a11yclick":function(){define(["dojo/keys","dojo/mouse","dojo/on","dojo/touch"],function(h,
b,k,a){function c(a){if((a.keyCode===h.ENTER||a.keyCode===h.SPACE)&&!/input|button|textarea/i.test(a.target.nodeName))for(a=a.target;a;a=a.parentNode)if(a.dojoClick)return!0}var d;k(document,"keydown",function(a){c(a)?(d=a.target,a.preventDefault()):d=null});k(document,"keyup",function(a){c(a)&&a.target==d&&(d=null,k.emit(a.target,"click",{cancelable:!0,bubbles:!0,ctrlKey:a.ctrlKey,shiftKey:a.shiftKey,metaKey:a.metaKey,altKey:a.altKey,_origType:a.type}))});var e=function(a,b){a.dojoClick=!0;return k(a,
"click",b)};e.click=e;e.press=function(c,d){var e=k(c,a.press,function(a){("mousedown"!=a.type||b.isLeft(a))&&d(a)}),m=k(c,"keydown",function(a){(a.keyCode===h.ENTER||a.keyCode===h.SPACE)&&d(a)});return{remove:function(){e.remove();m.remove()}}};e.release=function(c,d){var e=k(c,a.release,function(a){("mouseup"!=a.type||b.isLeft(a))&&d(a)}),m=k(c,"keyup",function(a){(a.keyCode===h.ENTER||a.keyCode===h.SPACE)&&d(a)});return{remove:function(){e.remove();m.remove()}}};e.move=a.move;return e})},"esri/geometry/Polyline":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./Extent".split(" "),
function(h,b,k,a,c,d,e,f,g,l){var m={type:"polyline",paths:null};h=h(f,{declaredClass:"esri.geometry.Polyline",constructor:function(a){k.mixin(this,m);this.paths=[];this._path=0;a&&(k.isArray(a)?this.paths=k.isArray(a[0][0])?a:[a]:a.paths?k.mixin(this,a):this.spatialReference=a,this.spatialReference&&(this.spatialReference=new e(this.spatialReference)));this.verifySR()},addPath:function(a){this.clearCache();this._path=this.paths.length;this.paths[this._path]=[];k.isArray(a[0])?b.forEach(a,this._addPointArr,
this):b.forEach(a,this._addPoint,this);return this},_addPointArr:function(a){this.paths[this._path].push(a)},_addPoint:function(a){this.paths[this._path].push([a.x,a.y])},_insertPoints:function(a,c){this.clearCache();this._path=c;this.paths[this._path]||(this.paths[this._path]=[]);b.forEach(a,this._addPoint,this)},_validateInputs:function(a,b){return null!==a&&void 0!==a&&(0>a||a>=this.paths.length)||null!==b&&void 0!==a&&(0>b||b>=this.paths[a].length)?!1:!0},getPoint:function(a,b){if(this._validateInputs(a,
b))return new g(this.paths[a][b],this.spatialReference)},setPoint:function(a,b,c){if(this._validateInputs(a,b))return this.clearCache(),this.paths[a][b]=[c.x,c.y],this},insertPoint:function(a,b,c){if(this._validateInputs(a)&&d.isDefined(b)&&0<=b&&b<=this.paths[a].length)return this.clearCache(),this.paths[a].splice(b,0,[c.x,c.y]),this},removePath:function(a){if(this._validateInputs(a,null)){this.clearCache();a=this.paths.splice(a,1)[0];var b,c=a.length,d=this.spatialReference;for(b=0;b<c;b++)a[b]=
new g(a[b],d);return a}},removePoint:function(a,b){if(this._validateInputs(a,b))return this.clearCache(),new g(this.paths[a].splice(b,1)[0],this.spatialReference)},getExtent:function(){var a;a=this.getCacheValue("_extent");var b=this.getCacheValue("_partwise");if(a)return a=new l(a),a._partwise=b,a;a=this.paths;var c=a.length;if(c&&a[0].length){var d,e,f,g,m,k,h,A,z=g=a[0][0][0],G=m=a[0][0][1],F=Math.min,B=Math.max,E=this.spatialReference,b=[],K,O,P,Q;for(k=0;k<c;k++){d=a[k];K=O=d[0]&&d[0][0];P=Q=
d[0]&&d[0][1];A=d.length;for(h=0;h<A;h++)e=d[h],f=e[0],e=e[1],z=F(z,f),G=F(G,e),g=B(g,f),m=B(m,e),K=F(K,f),P=F(P,e),O=B(O,f),Q=B(Q,e);b.push(new l({xmin:K,ymin:P,xmax:O,ymax:Q,spatialReference:E?E.toJson():null}))}a={xmin:z,ymin:G,xmax:g,ymax:m,spatialReference:E?E.toJson():null};b=1<b.length?b:null;this.setCacheValue("_extent",a);this.setCacheValue("_partwise",b);a=new l(a);a._partwise=b;return a}},toJson:function(){var a={paths:k.clone(this.paths)},b=this.spatialReference;b&&(a.spatialReference=
b.toJson());return a}});h.defaultProps=m;a("extend-esri")&&(k.setObject("geometry.Polyline",h,c),c.geometry.defaultPolyline=m);return h})},"dojo/date":function(){define(["./has","./_base/lang"],function(h,b){var k={getDaysInMonth:function(a){var b=a.getMonth();return 1==b&&k.isLeapYear(a)?29:[31,28,31,30,31,30,31,31,30,31,30,31][b]},isLeapYear:function(a){a=a.getFullYear();return!(a%400)||!(a%4)&&!!(a%100)},getTimezoneName:function(a){var b=a.toString(),d="",e=b.indexOf("(");if(-1<e)d=b.substring(++e,
b.indexOf(")"));else if(e=/([A-Z\/]+) \d{4}$/,b=b.match(e))d=b[1];else if(b=a.toLocaleString(),e=/ ([A-Z\/]+)$/,b=b.match(e))d=b[1];return"AM"==d||"PM"==d?"":d},compare:function(a,b,d){a=new Date(+a);b=new Date(+(b||new Date));"date"==d?(a.setHours(0,0,0,0),b.setHours(0,0,0,0)):"time"==d&&(a.setFullYear(0,0,0),b.setFullYear(0,0,0));return a>b?1:a<b?-1:0},add:function(a,b,d){var e=new Date(+a),f=!1,g="Date";switch(b){case "day":break;case "weekday":var l;(b=d%5)?l=parseInt(d/5):(b=0<d?5:-5,l=0<d?(d-
5)/5:(d+5)/5);var m=a.getDay(),k=0;6==m&&0<d?k=1:0==m&&0>d&&(k=-1);m+=b;if(0==m||6==m)k=0<d?2:-2;d=7*l+b+k;break;case "year":g="FullYear";f=!0;break;case "week":d*=7;break;case "quarter":d*=3;case "month":f=!0;g="Month";break;default:g="UTC"+b.charAt(0).toUpperCase()+b.substring(1)+"s"}if(g)e["set"+g](e["get"+g]()+d);f&&e.getDate()<a.getDate()&&e.setDate(0);return e},difference:function(a,b,d){b=b||new Date;d=d||"day";var e=b.getFullYear()-a.getFullYear(),f=1;switch(d){case "quarter":a=a.getMonth();
b=b.getMonth();a=Math.floor(a/3)+1;b=Math.floor(b/3)+1;f=b+4*e-a;break;case "weekday":e=Math.round(k.difference(a,b,"day"));d=parseInt(k.difference(a,b,"week"));f=e%7;if(0==f)e=5*d;else{var g=0,l=a.getDay();b=b.getDay();d=parseInt(e/7);f=e%7;a=new Date(a);a.setDate(a.getDate()+7*d);a=a.getDay();if(0<e)switch(!0){case 6==l:g=-1;break;case 0==l:g=0;break;case 6==b:g=-1;break;case 0==b:g=-2;break;case 5<a+f:g=-2}else if(0>e)switch(!0){case 6==l:g=0;break;case 0==l:g=1;break;case 6==b:g=2;break;case 0==
b:g=1;break;case 0>a+f:g=2}e=e+g-2*d}f=e;break;case "year":f=e;break;case "month":f=b.getMonth()-a.getMonth()+12*e;break;case "week":f=parseInt(k.difference(a,b,"day")/7);break;case "day":f/=24;case "hour":f/=60;case "minute":f/=60;case "second":f/=1E3;case "millisecond":f*=b.getTime()-a.getTime()}return Math.round(f)}};b.mixin(b.getObject("dojo.date",!0),k);return k})},"dijit/Destroyable":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare"],function(h,b,k){return k("dijit.Destroyable",
null,{destroy:function(a){this._destroyed=!0},own:function(){var a=["destroyRecursive","destroy","remove"];h.forEach(arguments,function(c){function d(){f.remove();h.forEach(g,function(a){a.remove()})}var e,f=b.before(this,"destroy",function(a){c[e](a)}),g=[];c.then?(e="cancel",c.then(d,d)):h.forEach(a,function(a){"function"===typeof c[a]&&(e||(e=a),g.push(b.after(c,a,d,!0)))})},this);return arguments}})})},"dijit/layout/_ContentPaneResizeMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/lang dojo/query ../registry ../Viewport ./utils".split(" "),
function(h,b,k,a,c,d,e,f,g,l){return b("dijit.layout._ContentPaneResizeMixin",null,{doLayout:!0,isLayoutContainer:!0,startup:function(){if(!this._started){var a=this.getParent();this._childOfLayoutWidget=a&&a.isLayoutContainer;this._needLayout=!this._childOfLayoutWidget;this.inherited(arguments);this._isShown()&&this._onShow();this._childOfLayoutWidget||this.own(g.on("resize",d.hitch(this,"resize")))}},_checkIfSingleChild:function(){if(this.doLayout){var a=[],b=!1;e("\x3e *",this.containerNode).some(function(c){var d=
f.byNode(c);d&&d.resize?a.push(d):!/script|link|style/i.test(c.nodeName)&&c.offsetHeight&&(b=!0)});this._singleChild=1==a.length&&!b?a[0]:null;k.toggle(this.containerNode,this.baseClass+"SingleChild",!!this._singleChild)}},resize:function(a,b){this._resizeCalled=!0;this._scheduleLayout(a,b)},_scheduleLayout:function(a,b){this._isShown()?this._layout(a,b):(this._needLayout=!0,this._changeSize=a,this._resultSize=b)},_layout:function(b,c){delete this._needLayout;!this._wasShown&&!1!==this.open&&this._onShow();
b&&a.setMarginBox(this.domNode,b);var e=this.containerNode;if(e===this.domNode){var f=c||{};d.mixin(f,b||{});if(!("h"in f)||!("w"in f))f=d.mixin(a.getMarginBox(e),f);this._contentBox=l.marginBox2contentBox(e,f)}else this._contentBox=a.getContentBox(e);this._layoutChildren()},_layoutChildren:function(){this._checkIfSingleChild();if(this._singleChild&&this._singleChild.resize){var b=this._contentBox||a.getContentBox(this.containerNode);this._singleChild.resize({w:b.w,h:b.h})}else for(var b=this.getChildren(),
c,d=0;c=b[d++];)c.resize&&c.resize()},_isShown:function(){if(this._childOfLayoutWidget)return this._resizeCalled&&"open"in this?this.open:this._resizeCalled;if("open"in this)return this.open;var a=this.domNode,b=this.domNode.parentNode;return"none"!=a.style.display&&"hidden"!=a.style.visibility&&!k.contains(a,"dijitHidden")&&b&&b.style&&"none"!=b.style.display},_onShow:function(){this._wasShown=!0;this._needLayout&&this._layout(this._changeSize,this._resultSize);this.inherited(arguments)}})})},"dijit/WidgetSet":function(){define(["dojo/_base/array",
"dojo/_base/declare","dojo/_base/kernel","./registry"],function(h,b,k,a){var c=b("dijit.WidgetSet",null,{constructor:function(){this._hash={};this.length=0},add:function(a){if(this._hash[a.id])throw Error("Tried to register widget with id\x3d\x3d"+a.id+" but that id is already registered");this._hash[a.id]=a;this.length++},remove:function(a){this._hash[a]&&(delete this._hash[a],this.length--)},forEach:function(a,b){b=b||k.global;var c=0,g;for(g in this._hash)a.call(b,this._hash[g],c++,this._hash);
return this},filter:function(a,b){b=b||k.global;var f=new c,g=0,l;for(l in this._hash){var m=this._hash[l];a.call(b,m,g++,this._hash)&&f.add(m)}return f},byId:function(a){return this._hash[a]},byClass:function(a){var b=new c,f,g;for(f in this._hash)g=this._hash[f],g.declaredClass==a&&b.add(g);return b},toArray:function(){var a=[],b;for(b in this._hash)a.push(this._hash[b]);return a},map:function(a,b){return h.map(this.toArray(),a,b)},every:function(a,b){b=b||k.global;var c=0,g;for(g in this._hash)if(!a.call(b,
this._hash[g],c++,this._hash))return!1;return!0},some:function(a,b){b=b||k.global;var c=0,g;for(g in this._hash)if(a.call(b,this._hash[g],c++,this._hash))return!0;return!1}});h.forEach("forEach filter byClass map every some".split(" "),function(b){a[b]=c.prototype[b]});return c})},"dojo/dnd/Moveable":function(){define("../_base/array ../_base/declare ../_base/lang ../dom ../dom-class ../Evented ../on ../topic ../touch ./common ./Mover ../_base/window".split(" "),function(h,b,k,a,c,d,e,f,g,l,m,n){return b("dojo.dnd.Moveable",
[d],{handle:"",delay:0,skip:!1,constructor:function(b,c){this.node=a.byId(b);c||(c={});this.handle=c.handle?a.byId(c.handle):null;this.handle||(this.handle=this.node);this.delay=0<c.delay?c.delay:0;this.skip=c.skip;this.mover=c.mover?c.mover:m;this.events=[e(this.handle,g.press,k.hitch(this,"onMouseDown")),e(this.handle,"dragstart",k.hitch(this,"onSelectStart")),e(this.handle,"selectstart",k.hitch(this,"onSelectStart"))]},markupFactory:function(a,b,c){return new c(b,a)},destroy:function(){h.forEach(this.events,
function(a){a.remove()});this.events=this.node=this.handle=null},onMouseDown:function(a){if(!this.skip||!l.isFormElement(a)){if(this.delay)this.events.push(e(this.handle,g.move,k.hitch(this,"onMouseMove")),e(this.handle,g.release,k.hitch(this,"onMouseUp"))),this._lastX=a.pageX,this._lastY=a.pageY;else this.onDragDetected(a);a.stopPropagation();a.preventDefault()}},onMouseMove:function(a){if(Math.abs(a.pageX-this._lastX)>this.delay||Math.abs(a.pageY-this._lastY)>this.delay)this.onMouseUp(a),this.onDragDetected(a);
a.stopPropagation();a.preventDefault()},onMouseUp:function(a){for(var b=0;2>b;++b)this.events.pop().remove();a.stopPropagation();a.preventDefault()},onSelectStart:function(a){if(!this.skip||!l.isFormElement(a))a.stopPropagation(),a.preventDefault()},onDragDetected:function(a){new this.mover(this.node,a,this)},onMoveStart:function(a){f.publish("/dnd/move/start",a);c.add(n.body(),"dojoMove");c.add(this.node,"dojoMoveItem")},onMoveStop:function(a){f.publish("/dnd/move/stop",a);c.remove(n.body(),"dojoMove");
c.remove(this.node,"dojoMoveItem")},onFirstMove:function(){},onMove:function(a,b){this.onMoving(a,b);var c=a.node.style;c.left=b.l+"px";c.top=b.t+"px";this.onMoved(a,b)},onMoving:function(){},onMoved:function(){}})})},"dijit/TooltipDialog":function(){define("dojo/_base/declare dojo/dom-class dojo/has dojo/keys dojo/_base/lang dojo/on ./focus ./layout/ContentPane ./_DialogMixin ./form/_FormMixin ./_TemplatedMixin dojo/text!./templates/TooltipDialog.html ./main".split(" "),function(h,b,k,a,c,d,e,f,
g,l,m,n,q){h=h("dijit.TooltipDialog",[f,m,l,g],{title:"",doLayout:!1,autofocus:!0,baseClass:"dijitTooltipDialog",_firstFocusItem:null,_lastFocusItem:null,templateString:n,_setTitleAttr:"containerNode",postCreate:function(){this.inherited(arguments);this.own(d(this.domNode,"keydown",c.hitch(this,"_onKey")))},orient:function(a,c,d){a={"MR-ML":"dijitTooltipRight","ML-MR":"dijitTooltipLeft","TM-BM":"dijitTooltipAbove","BM-TM":"dijitTooltipBelow","BL-TL":"dijitTooltipBelow dijitTooltipABLeft","TL-BL":"dijitTooltipAbove dijitTooltipABLeft",
"BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight","BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft","BR-TL":"dijitTooltipBelow dijitTooltipABLeft","BL-TR":"dijitTooltipBelow dijitTooltipABRight","TL-BR":"dijitTooltipAbove dijitTooltipABRight","TR-BL":"dijitTooltipAbove dijitTooltipABLeft"}[c+"-"+d];b.replace(this.domNode,a,this._currentOrientClass||"");this._currentOrientClass=a},focus:function(){this._getFocusItems();e.focus(this._firstFocusItem)},
onOpen:function(a){this.orient(this.domNode,a.aroundCorner,a.corner);var b=a.aroundNodePos;"M"==a.corner.charAt(0)&&"M"==a.aroundCorner.charAt(0)?(this.connectorNode.style.top=b.y+(b.h-this.connectorNode.offsetHeight>>1)-a.y+"px",this.connectorNode.style.left=""):"M"==a.corner.charAt(1)&&"M"==a.aroundCorner.charAt(1)&&(this.connectorNode.style.left=b.x+(b.w-this.connectorNode.offsetWidth>>1)-a.x+"px");this._onShow()},onClose:function(){this.onHide()},_onKey:function(b){if(b.keyCode==a.ESCAPE)this.defer("onCancel"),
b.stopPropagation(),b.preventDefault();else if(b.keyCode==a.TAB){var c=b.target;this._getFocusItems();this._firstFocusItem==this._lastFocusItem?(b.stopPropagation(),b.preventDefault()):c==this._firstFocusItem&&b.shiftKey?(e.focus(this._lastFocusItem),b.stopPropagation(),b.preventDefault()):c==this._lastFocusItem&&!b.shiftKey?(e.focus(this._firstFocusItem),b.stopPropagation(),b.preventDefault()):b.stopPropagation()}}});k("dojo-bidi")&&h.extend({_setTitleAttr:function(a){this.containerNode.title=this.textDir&&
this.enforceTextDirWithUcc?this.enforceTextDirWithUcc(null,a):a;this._set("title",a)},_setTextDirAttr:function(a){if(!this._created||this.textDir!=a)this._set("textDir",a),this.textDir&&this.title&&(this.containerNode.title=this.enforceTextDirWithUcc(null,this.title))}});return h})},"dojo/store/util/SimpleQueryEngine":function(){define(["../../_base/array"],function(h){return function(b,k){function a(a){a=h.filter(a,b);var c=k&&k.sort;c&&a.sort("function"==typeof c?c:function(a,b){for(var d,f=0;d=
c[f];f++){var k=a[d.attribute],p=b[d.attribute],k=null!=k?k.valueOf():k,p=null!=p?p.valueOf():p;if(k!=p)return!!d.descending==(null==k||k>p)?-1:1}return 0});if(k&&(k.start||k.count)){var f=a.length;a=a.slice(k.start||0,(k.start||0)+(k.count||Infinity));a.total=f}return a}switch(typeof b){default:throw Error("Can not query with a "+typeof b);case "object":case "undefined":var c=b;b=function(a){for(var b in c){var f=c[b];if(f&&f.test){if(!f.test(a[b],a))return!1}else if(f!=a[b])return!1}return!0};break;
case "string":if(!this[b])throw Error("No filter function "+b+" was found in store");b=this[b];case "function":}a.matches=b;return a}})},"arcgisonline/sharing/dijit/ComboBox":function(){define(["dijit","dojo","dojox","dojo/require!dijit/form/ComboBox"],function(h,b,k){b.provide("arcgisonline.sharing.dijit.ComboBox");b.require("dijit.form.ComboBox");b.declare("arcgisonline.sharing.dijit.ComboBox",h.form.ComboBox,{autoComplete:!1,templateString:b.cache("arcgisonline.sharing.dijit","templates/ComboBox.html",
'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n     id\x3d"widget_${id}"\r\n     role\x3d"combobox"\r\n     aria-haspopup\x3d"true"\r\n     data-dojo-attach-point\x3d"_popupStateNode"\r\n    \x3e\x3cdiv class\x3d\'dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer\'\r\n          data-dojo-attach-point\x3d"_buttonNode" role\x3d"presentation"\r\n    \x3e\x3cinput class\x3d"dijitReset dijitInputField dijitArrowButtonInner" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"button presentation" aria-hidden\x3d"true"\r\n  ${_buttonInputDisabled}\r\n  /\x3e\x3c/div\r\n    \x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\r\n    \x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n    /\x3e\x3c/div\r\n    \x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\r\n    \x3e\x3cinput class\x3d\'dijitReset dijitInputInner\' readonly\x3d"readonly" ${!nameAttrSetting} type\x3d"text" autocomplete\x3d"off"\r\n  data-dojo-attach-point\x3d"textbox,focusNode" role\x3d"textbox"\r\n  /\x3e\x3c/div\r\n\x3e\x3c/div\x3e')})})},
"dijit/typematic":function(){define("dojo/_base/array dojo/_base/connect dojo/_base/lang dojo/on dojo/sniff ./main".split(" "),function(h,b,k,a,c,d){var e=d.typematic={_fireEventAndReload:function(){this._timer=null;this._callback(++this._count,this._node,this._evt);this._currentTimeout=Math.max(0>this._currentTimeout?this._initialDelay:1<this._subsequentDelay?this._subsequentDelay:Math.round(this._currentTimeout*this._subsequentDelay),this._minDelay);this._timer=setTimeout(k.hitch(this,"_fireEventAndReload"),
this._currentTimeout)},trigger:function(a,b,c,d,e,h,p,s){if(e!=this._obj){this.stop();this._initialDelay=p||500;this._subsequentDelay=h||0.9;this._minDelay=s||10;this._obj=e;this._node=c;this._count=this._currentTimeout=-1;this._callback=k.hitch(b,d);this._evt={faux:!0};for(var t in a)"layerX"!=t&&"layerY"!=t&&(b=a[t],"function"!=typeof b&&"undefined"!=typeof b&&(this._evt[t]=b));this._fireEventAndReload()}},stop:function(){this._timer&&(clearTimeout(this._timer),this._timer=null);this._obj&&(this._callback(-1,
this._node,this._evt),this._obj=null)},addKeyListener:function(c,d,l,m,n,q,p){var s="keyCode"in d?"keyCode":"charCode"in d?"charCode":"charOrCode",t=[a(c,"keyCode"in d?"keydown":"charCode"in d?"keypress":b._keypress,k.hitch(this,function(a){a[s]==d[s]&&(void 0===d.ctrlKey||d.ctrlKey==a.ctrlKey)&&(void 0===d.altKey||d.altKey==a.altKey)&&(void 0===d.metaKey||d.metaKey==(a.metaKey||!1))&&(void 0===d.shiftKey||d.shiftKey==a.shiftKey)?(a.stopPropagation(),a.preventDefault(),e.trigger(a,l,c,m,d,n,q,p)):
e._obj==d&&e.stop()})),a(c,"keyup",k.hitch(this,function(){e._obj==d&&e.stop()}))];return{remove:function(){h.forEach(t,function(a){a.remove()})}}},addMouseListener:function(b,d,l,m,n,q){var p=[a(b,"mousedown",k.hitch(this,function(a){a.preventDefault();e.trigger(a,d,b,l,b,m,n,q)})),a(b,"mouseup",k.hitch(this,function(a){this._obj&&a.preventDefault();e.stop()})),a(b,"mouseout",k.hitch(this,function(a){this._obj&&a.preventDefault();e.stop()})),a(b,"dblclick",k.hitch(this,function(a){a.preventDefault();
9>c("ie")&&(e.trigger(a,d,b,l,b,m,n,q),setTimeout(k.hitch(this,e.stop),50))}))];return{remove:function(){h.forEach(p,function(a){a.remove()})}}},addListener:function(a,b,c,d,e,k,p,s){var t=[this.addKeyListener(b,c,d,e,k,p,s),this.addMouseListener(a,d,e,k,p,s)];return{remove:function(){h.forEach(t,function(a){a.remove()})}}}};return e})},"dijit/MenuItem":function(){define("dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/kernel dojo/sniff dojo/_base/lang ./_Widget ./_TemplatedMixin ./_Contained ./_CssStateMixin dojo/text!./templates/MenuItem.html".split(" "),
function(h,b,k,a,c,d,e,f,g,l,m,n){e=h("dijit.MenuItem"+(d("dojo-bidi")?"_NoBidi":""),[f,g,l,m],{templateString:n,baseClass:"dijitMenuItem",label:"",_setLabelAttr:function(a){this._set("label",a);var b="",c;c=a.search(/{\S}/);if(0<=c){var b=a.charAt(c+1),d=a.substr(0,c);a=a.substr(c+3);c=d+b+a;a=d+'\x3cspan class\x3d"dijitMenuItemShortcutKey"\x3e'+b+"\x3c/span\x3e"+a}else c=a;this.domNode.setAttribute("aria-label",c+" "+this.accelKey);this.containerNode.innerHTML=a;this._set("shortcutKey",b)},iconClass:"dijitNoIcon",
_setIconClassAttr:{node:"iconNode",type:"class"},accelKey:"",disabled:!1,_fillContent:function(a){a&&!("label"in this.params)&&this._set("label",a.innerHTML)},buildRendering:function(){this.inherited(arguments);k.set(this.containerNode,"id",this.id+"_text");this.accelKeyNode&&k.set(this.accelKeyNode,"id",this.id+"_accel");b.setSelectable(this.domNode,!1)},onClick:function(){},focus:function(){try{8==d("ie")&&this.containerNode.focus(),this.focusNode.focus()}catch(a){}},_setSelected:function(b){a.toggle(this.domNode,
"dijitMenuItemSelected",b)},setLabel:function(a){c.deprecated("dijit.MenuItem.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",a)},setDisabled:function(a){c.deprecated("dijit.Menu.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0");this.set("disabled",a)},_setDisabledAttr:function(a){this.focusNode.setAttribute("aria-disabled",a?"true":"false");this._set("disabled",a)},_setAccelKeyAttr:function(a){this.accelKeyNode&&(this.accelKeyNode.style.display=
a?"":"none",this.accelKeyNode.innerHTML=a,k.set(this.containerNode,"colSpan",a?"1":"2"));this._set("accelKey",a)}});d("dojo-bidi")&&(e=h("dijit.MenuItem",e,{_setLabelAttr:function(a){this.inherited(arguments);"auto"===this.textDir&&this.applyTextDir(this.textDirNode)}}));return e})},"dojo/cldr/supplemental":function(){define(["../_base/lang","../i18n"],function(h,b){var k={};h.setObject("dojo.cldr.supplemental",k);k.getFirstDayOfWeek=function(a){a={bd:5,mv:5,ae:6,af:6,bh:6,dj:6,dz:6,eg:6,iq:6,ir:6,
jo:6,kw:6,ly:6,ma:6,om:6,qa:6,sa:6,sd:6,sy:6,ye:6,ag:0,ar:0,as:0,au:0,br:0,bs:0,bt:0,bw:0,by:0,bz:0,ca:0,cn:0,co:0,dm:0,"do":0,et:0,gt:0,gu:0,hk:0,hn:0,id:0,ie:0,il:0,"in":0,jm:0,jp:0,ke:0,kh:0,kr:0,la:0,mh:0,mm:0,mo:0,mt:0,mx:0,mz:0,ni:0,np:0,nz:0,pa:0,pe:0,ph:0,pk:0,pr:0,py:0,sg:0,sv:0,th:0,tn:0,tt:0,tw:0,um:0,us:0,ve:0,vi:0,ws:0,za:0,zw:0}[k._region(a)];return void 0===a?1:a};k._region=function(a){a=b.normalizeLocale(a);a=a.split("-");var c=a[1];c?4==c.length&&(c=a[2]):c={aa:"et",ab:"ge",af:"za",
ak:"gh",am:"et",ar:"eg",as:"in",av:"ru",ay:"bo",az:"az",ba:"ru",be:"by",bg:"bg",bi:"vu",bm:"ml",bn:"bd",bo:"cn",br:"fr",bs:"ba",ca:"es",ce:"ru",ch:"gu",co:"fr",cr:"ca",cs:"cz",cv:"ru",cy:"gb",da:"dk",de:"de",dv:"mv",dz:"bt",ee:"gh",el:"gr",en:"us",es:"es",et:"ee",eu:"es",fa:"ir",ff:"sn",fi:"fi",fj:"fj",fo:"fo",fr:"fr",fy:"nl",ga:"ie",gd:"gb",gl:"es",gn:"py",gu:"in",gv:"gb",ha:"ng",he:"il",hi:"in",ho:"pg",hr:"hr",ht:"ht",hu:"hu",hy:"am",ia:"fr",id:"id",ig:"ng",ii:"cn",ik:"us","in":"id",is:"is",it:"it",
iu:"ca",iw:"il",ja:"jp",ji:"ua",jv:"id",jw:"id",ka:"ge",kg:"cd",ki:"ke",kj:"na",kk:"kz",kl:"gl",km:"kh",kn:"in",ko:"kr",ks:"in",ku:"tr",kv:"ru",kw:"gb",ky:"kg",la:"va",lb:"lu",lg:"ug",li:"nl",ln:"cd",lo:"la",lt:"lt",lu:"cd",lv:"lv",mg:"mg",mh:"mh",mi:"nz",mk:"mk",ml:"in",mn:"mn",mo:"ro",mr:"in",ms:"my",mt:"mt",my:"mm",na:"nr",nb:"no",nd:"zw",ne:"np",ng:"na",nl:"nl",nn:"no",no:"no",nr:"za",nv:"us",ny:"mw",oc:"fr",om:"et",or:"in",os:"ge",pa:"in",pl:"pl",ps:"af",pt:"br",qu:"pe",rm:"ch",rn:"bi",ro:"ro",
ru:"ru",rw:"rw",sa:"in",sd:"in",se:"no",sg:"cf",si:"lk",sk:"sk",sl:"si",sm:"ws",sn:"zw",so:"so",sq:"al",sr:"rs",ss:"za",st:"za",su:"id",sv:"se",sw:"tz",ta:"in",te:"in",tg:"tj",th:"th",ti:"et",tk:"tm",tl:"ph",tn:"za",to:"to",tr:"tr",ts:"za",tt:"ru",ty:"pf",ug:"cn",uk:"ua",ur:"pk",uz:"uz",ve:"za",vi:"vn",wa:"be",wo:"sn",xh:"za",yi:"il",yo:"ng",za:"cn",zh:"cn",zu:"za",ace:"id",ady:"ru",agq:"cm",alt:"ru",amo:"ng",asa:"tz",ast:"es",awa:"in",bal:"pk",ban:"id",bas:"cm",bax:"cm",bbc:"id",bem:"zm",bez:"tz",
bfq:"in",bft:"pk",bfy:"in",bhb:"in",bho:"in",bik:"ph",bin:"ng",bjj:"in",bku:"ph",bqv:"ci",bra:"in",brx:"in",bss:"cm",btv:"pk",bua:"ru",buc:"yt",bug:"id",bya:"id",byn:"er",cch:"ng",ccp:"in",ceb:"ph",cgg:"ug",chk:"fm",chm:"ru",chp:"ca",chr:"us",cja:"kh",cjm:"vn",ckb:"iq",crk:"ca",csb:"pl",dar:"ru",dav:"ke",den:"ca",dgr:"ca",dje:"ne",doi:"in",dsb:"de",dua:"cm",dyo:"sn",dyu:"bf",ebu:"ke",efi:"ng",ewo:"cm",fan:"gq",fil:"ph",fon:"bj",fur:"it",gaa:"gh",gag:"md",gbm:"in",gcr:"gf",gez:"et",gil:"ki",gon:"in",
gor:"id",grt:"in",gsw:"ch",guz:"ke",gwi:"ca",haw:"us",hil:"ph",hne:"in",hnn:"ph",hoc:"in",hoj:"in",ibb:"ng",ilo:"ph",inh:"ru",jgo:"cm",jmc:"tz",kaa:"uz",kab:"dz",kaj:"ng",kam:"ke",kbd:"ru",kcg:"ng",kde:"tz",kdt:"th",kea:"cv",ken:"cm",kfo:"ci",kfr:"in",kha:"in",khb:"cn",khq:"ml",kht:"in",kkj:"cm",kln:"ke",kmb:"ao",koi:"ru",kok:"in",kos:"fm",kpe:"lr",krc:"ru",kri:"sl",krl:"ru",kru:"in",ksb:"tz",ksf:"cm",ksh:"de",kum:"ru",lag:"tz",lah:"pk",lbe:"ru",lcp:"cn",lep:"in",lez:"ru",lif:"np",lis:"cn",lki:"ir",
lmn:"in",lol:"cd",lua:"cd",luo:"ke",luy:"ke",lwl:"th",mad:"id",mag:"in",mai:"in",mak:"id",man:"gn",mas:"ke",mdf:"ru",mdh:"ph",mdr:"id",men:"sl",mer:"ke",mfe:"mu",mgh:"mz",mgo:"cm",min:"id",mni:"in",mnk:"gm",mnw:"mm",mos:"bf",mua:"cm",mwr:"in",myv:"ru",nap:"it",naq:"na",nds:"de","new":"np",niu:"nu",nmg:"cm",nnh:"cm",nod:"th",nso:"za",nus:"sd",nym:"tz",nyn:"ug",pag:"ph",pam:"ph",pap:"bq",pau:"pw",pon:"fm",prd:"ir",raj:"in",rcf:"re",rej:"id",rjs:"np",rkt:"in",rof:"tz",rwk:"tz",saf:"gh",sah:"ru",saq:"ke",
sas:"id",sat:"in",saz:"in",sbp:"tz",scn:"it",sco:"gb",sdh:"ir",seh:"mz",ses:"ml",shi:"ma",shn:"mm",sid:"et",sma:"se",smj:"se",smn:"fi",sms:"fi",snk:"ml",srn:"sr",srr:"sn",ssy:"er",suk:"tz",sus:"gn",swb:"yt",swc:"cd",syl:"bd",syr:"sy",tbw:"ph",tcy:"in",tdd:"cn",tem:"sl",teo:"ug",tet:"tl",tig:"er",tiv:"ng",tkl:"tk",tmh:"ne",tpi:"pg",trv:"tw",tsg:"ph",tts:"th",tum:"mw",tvl:"tv",twq:"ne",tyv:"ru",tzm:"ma",udm:"ru",uli:"fm",umb:"ao",unr:"in",unx:"in",vai:"lr",vun:"tz",wae:"ch",wal:"et",war:"ph",xog:"ug",
xsr:"np",yao:"mz",yap:"fm",yav:"cm",zza:"tr"}[a[0]];return c};k.getWeekend=function(a){var b=k._region(a);a={"in":0,af:4,dz:4,ir:4,om:4,sa:4,ye:4,ae:5,bh:5,eg:5,il:5,iq:5,jo:5,kw:5,ly:5,ma:5,qa:5,sd:5,sy:5,tn:5}[b];b={af:5,dz:5,ir:5,om:5,sa:5,ye:5,ae:6,bh:5,eg:6,il:6,iq:6,jo:6,kw:6,ly:6,ma:6,qa:6,sd:6,sy:6,tn:6}[b];void 0===a&&(a=6);void 0===b&&(b=0);return{start:a,end:b}};return k})},"arcgisonline/sharing/dijit/TextMenu":function(){define(["dijit","dojo","dojox","dojo/require!arcgisonline/sharing/util"],
function(h,b,k){b.provide("arcgisonline.sharing.dijit.TextMenu");b.require("arcgisonline.sharing.util");b.declare("arcgisonline.sharing.dijit.TextMenu",[h._Widget],{_util:arcgisonline.sharing.util,textMenuItems:[{label:"No menu items",href:"#",iconClass:null}],labelNode:null,triggerNode:null,menu:null,handlers:[],constructor:function(a){b.mixin(this,a)},postCreate:function(){this.menu=(new h.Menu({})).placeAt(b.body());b.addClass(this.menu.domNode,"esriTextMenu");h.popup.moveOffScreen(this.menu.domNode);
null!==this.textMenuItems&&this._renderItems(this.textMenuItems);b.style(this.triggerNode,"cursor","hand");b.style(this.triggerNode,"cursor","pointer");this.handlers.push(b.connect(this.triggerNode,"onclick",this,this.show));b.connect(this.menu,"onMouseLeave",b.hitch(this,function(){this.hide()}))},show:function(a){a.preventDefault();h.popup.open({popup:this.menu,around:this.labelNode,orient:{BL:"TL",BR:"TR",TL:"BL",TR:"BR"},onExecute:b.hitch(this,this.hide),onCancel:b.hitch(this,this.hide)});this.menu.focus()},
hide:function(){h.popup.close(this.menu)},destroy:function(){this.hide();b.forEach(this.handlers,function(a){b.disconnect(a)});b.forEach(b.query(".esriTextMenuItem"),function(a){h.byNode(a).destroy()},this);this.menu.destroy();this.inherited(arguments)},_renderItems:function(a){b.forEach(a,function(a){a=new h.MenuItem(a);b.addClass(a.domNode,"esriTextMenuItem");this.menu.addChild(a)},this)}})})},"arcgisonline/sharing/dijit/Gallery":function(){define(["dijit","dojo","dojox","dojo/i18n!arcgisonline/nls/arcgisonline",
"dojo/require!arcgisonline/sharing/dijit/views,dijit/_Widget,dijit/_Templated,dojo/NodeList-fx,dijit/layout/ContentPane,arcgisonline/sharing/util,dijit/form/Button,arcgisonline/sharing/geow/QueryReadStore"],function(h,b,k){b.provide("arcgisonline.sharing.dijit.Gallery");b.require("arcgisonline.sharing.dijit.views");b.require("dijit._Widget");b.require("dijit._Templated");b.require("dojo.NodeList-fx");b.require("dijit.layout.ContentPane");b.require("arcgisonline.sharing.util");b.require("dijit.form.Button");
b.requireLocalization("arcgisonline","arcgisonline");b.require("arcgisonline.sharing.geow.QueryReadStore");b.declare("arcgisonline.sharing.dijit.Gallery",[h._Widget,h._Templated],{widgetsInTemplate:!0,templateString:'\x3cdiv dojoAttachPoint\x3d"containerNode"\x3e\r\n  \x3cdiv class\x3d"clearfix galleryBackground"\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"flowContainer" class\x3d"clearfix"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"pageControls" class\x3d"esriFloatLeading" style\x3d"maxheight: 3em; width: 100%; clear: both;"\x3e\r\n      \x3cp style\x3d"text-align: center;"\x3e\r\n        \x3cspan dojoType\x3d"dijit.form.Button" dojoAttachPoint\x3d"_prev" style\x3d"display:none;"\x3e${i18n.previous}\x3c/span\x3e\r\n        \x3cspan dojoAttachPoint\x3d"_pages" dojoAttachEvent\x3d"onClick:goToPage" class\x3d"esriItemLinks esriPagingLinks"\x3e\x3c/span\x3e\r\n        \x3cspan dojoType\x3d"dijit.form.Button" dojoAttachPoint\x3d"_next" style\x3d"display:none;"\x3e${i18n.next}\x3c/span\x3e\r\n      \x3c/p\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
tooltip:null,showToolTip:!0,showNodeLabels:!0,showThumbnailInDetails:!0,fadeOutOtherNodes:!0,animFadeOut:!0,unfocusedOpacity:0.5,highlightFocusedNode:!0,largeNodes:0,maxNodes:0,flowContainer:null,showDelay:300,nodesPerPage:4,currentPage:1,pageCount:1,maxPages:null,showPageControls:!0,_prev:null,_next:null,_pages:null,nodeClass:"galleryNode",nodeHighlightClass:"highlight",thumbClass:"galleryThumbnail",labelClass:"label",labelBgClass:"galleryLabelContainer",detailsClass:"galleryDetail",detailsThumbClass:"galleryDetailThumb",
messageClass:"galleryMessage",_lastFocusedNode:null,_timer:null,_galleryFadeIn:null,_galleryFadeOut:null,_galleryFadeOutTotal:null,_suspendTooltip:!1,includeNode:null,_defaultNoResultsMessage:null,noResultsMessage:null,items:null,i18n:null,postMixInProperties:function(){this.inherited(arguments);this.i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").gallery);this._defaultNoResultsMessage=this.i18n.filterNoResults},
postCreate:function(){this._userToken=(this._user=arcgisonline.sharing.util.getUser())&&this._user.token;null===this.tooltip&&(this.tooltip=new arcgisonline.sharing.dijit._GalleryContentPane({_gallery:this},b.create("div",{id:this.id+"_popup"},b.body())),this._galleryFadeIn=b.animateProperty({node:this.flowContainer,properties:{opacity:1}}),this._galleryFadeOut=b.animateProperty({node:this.flowContainer,properties:{opacity:this.unfocusedOpacity}}),this._galleryFadeOutTotal=b.animateProperty({node:this.flowContainer,
properties:{opacity:0}}),b.connect(this.domNode,"scroll",this,function(){this.tooltip&&this.tooltip.isShowing&&this.tooltip.hide()}),this.showPageControls&&(b.connect(this,"onContentChange",this,this._layoutPageControls),b.connect(this,"onPageChange",this,this._layoutPageControls)))},_showTooltip:function(a,c){var d=this.tooltip.domNode,e;esriGeowConfig.isRightToLeft||(e=this.showThumbnailInDetails?{TL:"TL",TR:"TR"}:{TL:"TR",TR:"TL"});esriGeowConfig.isRightToLeft&&(e=this.showThumbnailInDetails?{BR:"BR"}:
{BR:"TR"});e=h.placeOnScreenAroundNode(d,a,e);this.tooltip.set("content",this._buildItemDetailsLayout(c,e,a));if(this.showThumbnailInDetails){var f="none"==b.style(d,"display");f&&b.style(d,{visibility:"hidden",display:"block"});var g=b.contentBox(d),l=b.coords(d);f&&b.style(d,{visibility:"",display:"none"});"TR"==e.aroundCorner?(b.style(d,"top",l.t-g.t+"px"),b.style(d,"left",l.l+g.l+"px")):"TL"==e.aroundCorner&&(b.style(d,"top",l.t-g.t+"px"),b.style(d,"left",l.l-g.l+"px"))}this._highlightNode(c);
this.tooltip.show()},node_onMouseEnter:function(a){var c=a.currentTarget,d=this._getItemByNode(c);this.onNodeMouseEnter(a,d);!this._suspendTooltip&&this.showToolTip&&(this.tooltip.isShowing&&this.tooltip.hide(),this._timer&&(clearTimeout(this._timer),this._timer=null),this._unhighlightNodes(),this._timer||(this._timer=setTimeout(b.hitch(this,function(){this._showTooltip(c,d)}),this.showDelay)))},node_onMouseLeave:function(a){this._timer&&(clearTimeout(this._timer),this._timer=null);var b=this._getItemByNode(a.currentTarget);
this.onNodeMouseLeave(a,b)},tooltip_onMouseLeave:function(a){this._unhighlightNodes();this.tooltip.hide()},_highlightNode:function(a){a=b.byId("galleryNode_"+a.id);this.fadeOutOtherNodes&&(this.animFadeOut?(this._galleryFadeIn.stop(),this._galleryFadeOut.play()):b.style(this.flowContainer,"opacity",this.unfocusedOpacity));this.highlightFocusedNode&&b.addClass(a,this.nodeHighlightClass);this._lastFocusedNode=a},_unhighlightNodes:function(){this.fadeOutOtherNodes&&(this.animFadeOut?(this._galleryFadeOut.stop(),
this._galleryFadeIn.play()):b.style(this.flowContainer,"opacity",1));null!==this._lastFocusedNode&&b.removeClass(this._lastFocusedNode,this.nodeHighlightClass);this._lastFocusedNode=null},_loadItems:function(a){this.tooltip&&this.tooltip.hide();this._galleryFadeIn.stop();this._galleryFadeOut.stop();this._galleryFadeOutTotal.onEnd=b.hitch(this,function(a){b.empty(this.flowContainer);0<a.length?(this.maxNodes&&(a=a.splice(0,this.maxNodes)),b.forEach(a,b.hitch(this,function(a,b){a.id||(a.id=b);this.flowContainer.appendChild(this._buildNodeLayout(a,
b<this.largeNodes))})),b.create("br",{style:{clear:"both"}},this.flowContainer),a=b.query("."+this.nodeClass,this.domNode),a.connect("onmouseenter",this,this.node_onMouseEnter),a.connect("onmouseleave",this,this.node_onMouseLeave),this.tooltip&&b.connect(this.tooltip.domNode,"onmouseleave",this,this.tooltip_onMouseLeave)):b.create("span",{innerHTML:this.noResultsMessage||this._defaultNoResultsMessage,"class":this.messageClass},this.flowContainer);this._galleryFadeIn.play();this._galleryFadeOut.onEnd=
null;this._suspendTooltip=!1},a);this._galleryFadeOutTotal.play()},clear:function(a){this.tooltip&&this.tooltip.hide();this._galleryFadeIn.stop();this._galleryFadeOut.stop();b.empty(this.flowContainer);b.empty(this._pages);b.create("span",{innerHTML:a,"class":this.messageClass},this.flowContainer);this._galleryFadeIn.play();this._galleryFadeOut.onEnd=null;this._suspendTooltip=!1},_buildNodeLayout:function(a,c){var d=b.create("div",{id:"galleryNode_"+a.id,"class":this.nodeClass});b.addClass(d,c?"large":
"small");var e=arcgisonline.sharing.util,f=e.relativeToExplicitUrl("images/transparent.gif");"Web Mapping Application"==a.type&&e.getStaticImagesUrl();f="Mobile Application"==a.type?e.getStaticImagesUrl()+"/mobileapp.png":e.getStaticImagesUrl()+"/desktopapp.png";e.getGalleryMainLinkInfo(a);e=b.create("a",{href:"#"},d);b.connect(e,"onclick",this,this.onNodeClick,a);b.create("img",{"class":this.thumbClass,src:a.thumbnail?this._getThumbailUrl(a):f},e);this.showNodeLabels&&(f=b.create("div",{"class":"galleryLabelContainer"},
d),e=a.title||"",b.create("span",{innerHTML:e,alt:e,title:e},f));return d},_buildItemDetailsLayout:function(a,b,d){return arcgisonline.sharing.dijit.views.item.medium(a,{showThumb:this.showThumbnailInDetails,align:(esriGeowConfig.isRightToLeft?0:"TR"==b.aroundCorner)?"right":"left",hideOpenMenu:!0,showProfilePopup:!1})},_getItemByNode:function(a){for(;!b.hasClass(a,this.nodeClass);)a=a.parentNode;a=a.id.substr(a.id.indexOf("_")+1);for(var c=0;c<this.items.length;c++)if(this.items[c].id==a)return this.items[c];
return null},_getThumbailUrl:function(a){var b=this._userToken;return esriGeowConfig.restBaseUrl+"content/items/"+a.id+"/info/"+a.thumbnail+(b?"?token\x3d"+b:"")},_layoutPageControls:function(){b.empty(this._pages);if(1!==this.pageCount){for(var a=1;a<=this.pageCount;a++){var c=b.create("span",{innerHTML:a},b.create("a",{onclick:b.hitch(this,this.goToPage,a)},this._pages));a==this.currentPage&&b.addClass(c,"currentPage")}1==this.currentPage?b.style(this._prev.domNode,"visibility","hidden"):b.style(this._prev.domNode,
"visbility","");this.currentPage==this.pageCount?b.style(this._next.domNode,"visibility","hidden"):b.style(this._next.domNode,"visbility","")}},nextPage:function(){this.currentPage<this.pageCount&&this.goToPage(this.currentPage+1)},prevPage:function(){1<this.currentPage&&this.goToPage(this.currentPage-1)},goToPage:function(a){0<this.pageCount&&(!isNaN(a)&&0<a)&&(this._suspendTooltip=!0,this._loadRange((a-1)*this.nodesPerPage,this.nodesPerPage),this.currentPage=a,this.onPageChange(this.currentPage,
-1))},_loadRange:function(a,c){var d=b.clone(this.items);this._loadItems(d.splice(a,c))},_setItemsAttr:function(a){this.items=this.includeNode?b.filter(a,this.includeNode):a;0==this.items.length?(this.pageCount=1,this.onContentChange(0)):(this.pageCount=Math.ceil(this.items.length/this.nodesPerPage),this.onContentChange(this.items.length));this.currentPage=1;this.goToPage(1)},onPageChange:function(a,b){},onContentChange:function(a){},onNodeClick:function(a,b){},onNodeMouseEnter:function(a,b){},onNodeMouseLeave:function(a,
b){}});b.declare("arcgisonline.sharing.dijit._GalleryContentPane",h.layout.ContentPane,{_gallery:null,animateShowHide:!0,"class":"galleryPopup",fadeDuration:300,isShowing:!1,postCreate:function(){this.inherited(arguments);b.style(this.domNode,{position:"absolute",top:"-1000px",opacity:0});b.style(this.domNode,esriGeowConfig.isRightToLeft?"right":"left","-1000px");this.fadeIn=b.fadeIn({node:this.domNode,duration:this.fadeDuration});this.fadeOut=b.fadeOut({node:this.domNode,duration:this.fadeDuration,
onEnd:b.hitch(this,"_afterFade")})},_afterFade:function(){b.style(this.domNode,{top:"-1000px"});b.style(this.domNode,esriGeowConfig.isRightToLeft?"right":"left","-1000px")},show:function(a){this.isShowing=!0;this.animateShowHide?(this.fadeOut.stop(),this.fadeIn.play()):b.style(this.domNode,"display","block")},hide:function(){this.isShowing=!1;this.animateShowHide?(this.fadeIn.stop(),this.fadeOut.play()):b.style(this.domNode,"display","none")}})})},"dijit/layout/_LayoutWidget":function(){define("dojo/_base/lang ../_Widget ../_Container ../_Contained ../Viewport dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style".split(" "),
function(h,b,k,a,c,d,e,f,g){return d("dijit.layout._LayoutWidget",[b,k,a],{baseClass:"dijitLayoutContainer",isLayoutContainer:!0,_setTitleAttr:null,buildRendering:function(){this.inherited(arguments);e.add(this.domNode,"dijitContainer")},startup:function(){if(!this._started){this.inherited(arguments);var a=this.getParent&&this.getParent();if(!a||!a.isLayoutContainer)this.resize(),this.own(c.on("resize",h.hitch(this,"resize")))}},resize:function(a,b){var c=this.domNode;a&&f.setMarginBox(c,a);var d=
b||{};h.mixin(d,a||{});if(!("h"in d)||!("w"in d))d=h.mixin(f.getMarginBox(c),d);var e=g.getComputedStyle(c),k=f.getMarginExtents(c,e),t=f.getBorderExtents(c,e),d=this._borderBox={w:d.w-(k.w+t.w),h:d.h-(k.h+t.h)},k=f.getPadExtents(c,e);this._contentBox={l:g.toPixelValue(c,e.paddingLeft),t:g.toPixelValue(c,e.paddingTop),w:d.w-k.w,h:d.h-k.h};this.layout()},layout:function(){},_setupChild:function(a){e.add(a.domNode,this.baseClass+"-child "+(a.baseClass?this.baseClass+"-"+a.baseClass:""))},addChild:function(a,
b){this.inherited(arguments);this._started&&this._setupChild(a)},removeChild:function(a){e.remove(a.domNode,this.baseClass+"-child"+(a.baseClass?" "+this.baseClass+"-"+a.baseClass:""));this.inherited(arguments)}})})},"dojo/request/script":function(){define("module ./watch ./util ../_base/kernel ../_base/array ../_base/lang ../on ../dom ../dom-construct ../has ../_base/window".split(" "),function(h,b,k,a,c,d,e,f,g,l,m){function n(a,b){a.canDelete&&u._remove(a.id,b.options.frameDoc,!0)}function q(a){z&&
z.length&&(c.forEach(z,function(a){u._remove(a.id,a.frameDoc);a.frameDoc=null}),z=[]);return a.options.jsonp?!a.data:!0}function p(a){return!!this.scriptLoaded}function s(a){return(a=a.options.checkString)&&eval("typeof("+a+') !\x3d\x3d "undefined"')}function t(a,b){if(this.canDelete){var c=this.response.options;z.push({id:this.id,frameDoc:c.ioArgs?c.ioArgs.frameDoc:c.frameDoc});c.ioArgs&&(c.ioArgs.frameDoc=null);c.frameDoc=null}b?this.reject(b):this.resolve(a)}function u(a,c,f){var g=k.parseArgs(a,
k.deepCopy({},c));a=g.url;c=g.options;var l=k.deferred(g,n,q,c.jsonp?null:c.checkString?s:p,t);d.mixin(l,{id:x+w++,canDelete:!1});c.jsonp&&(RegExp("[?\x26]"+c.jsonp+"\x3d").test(a)||(a+=(~a.indexOf("?")?"\x26":"?")+c.jsonp+"\x3d"+(c.frameDoc?"parent.":"")+x+"_callbacks."+l.id),l.canDelete=!0,A[l.id]=function(a){g.data=a;l.handleResponse(g)});k.notify&&k.notify.emit("send",g,l.promise.cancel);if(!c.canAttach||c.canAttach(l)){var m=u._attach(l.id,a,c.frameDoc);if(!c.jsonp&&!c.checkString)var h=e(m,
v,function(a){if("load"===a.type||y.test(m.readyState))h.remove(),l.scriptLoaded=a})}b(l);return f?l:l.promise}l.add("script-readystatechange",function(a,b){return"undefined"!==typeof b.createElement("script").onreadystatechange&&("undefined"===typeof a.opera||"[object Opera]"!==a.opera.toString())});var x=h.id.replace(/[\/\.\-]/g,"_"),w=0,v=l("script-readystatechange")?"readystatechange":"load",y=/complete|loaded/,A=a.global[x+"_callbacks"]={},z=[];u.get=u;u._attach=function(a,b,c){c=c||m.doc;var d=
c.createElement("script");d.type="text/javascript";d.src=b;d.id=a;d.async=!0;d.charset="utf-8";return c.getElementsByTagName("head")[0].appendChild(d)};u._remove=function(a,b,c){g.destroy(f.byId(a,b));A[a]&&(c?A[a]=function(){delete A[a]}:delete A[a])};u._callbacksProperty=x+"_callbacks";return u})},"dijit/_base/manager":function(){define(["dojo/_base/array","dojo/_base/config","dojo/_base/lang","../registry","../main"],function(h,b,k,a,c){var d={};h.forEach("byId getUniqueId findWidgets _destroyAll byNode getEnclosingWidget".split(" "),
function(b){d[b]=a[b]});k.mixin(d,{defaultDuration:b.defaultDuration||200});k.mixin(c,d);return c})},"dijit/layout/StackController":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-construct dojo/keys dojo/_base/lang dojo/on dojo/topic ../focus ../registry ../_Widget ../_TemplatedMixin ../_Container ../form/ToggleButton dojo/touch".split(" "),function(h,b,k,a,c,d,e,f,g,l,m,n,q,p){a=b("dijit.layout._StackButton",p,{tabIndex:"-1",closeButton:!1,_aria_attr:"aria-selected",
buildRendering:function(a){this.inherited(arguments);(this.focusNode||this.domNode).setAttribute("role","tab")}});b=b("dijit.layout.StackController",[m,n,q],{baseClass:"dijitStackController",templateString:"\x3cspan role\x3d'tablist' data-dojo-attach-event\x3d'onkeydown'\x3e\x3c/span\x3e",containerId:"",buttonWidget:a,buttonWidgetCloseClass:"dijitStackCloseButton",pane2button:function(a){return l.byId(this.id+"_"+a)},postCreate:function(){this.inherited(arguments);this.own(f.subscribe(this.containerId+
"-startup",d.hitch(this,"onStartup")),f.subscribe(this.containerId+"-addChild",d.hitch(this,"onAddChild")),f.subscribe(this.containerId+"-removeChild",d.hitch(this,"onRemoveChild")),f.subscribe(this.containerId+"-selectChild",d.hitch(this,"onSelectChild")),f.subscribe(this.containerId+"-containerKeyDown",d.hitch(this,"onContainerKeyDown")));this.containerNode.dojoClick=!0;this.own(e(this.containerNode,"click",d.hitch(this,function(a){var b=l.getEnclosingWidget(a.target);if(b!=this.containerNode&&
!b.disabled&&b.page)for(a=a.target;a!==this.containerNode;a=a.parentNode)if(k.contains(a,this.buttonWidgetCloseClass)){this.onCloseButtonClick(b.page);break}else if(a==b.domNode){this.onButtonClick(b.page);break}})))},onStartup:function(a){this.textDir=a.textDir;h.forEach(a.children,this.onAddChild,this);if(a.selected)this.onSelectChild(a.selected);var b=l.byId(this.containerId).containerNode,c=d.hitch(this,"pane2button");a={title:"label",showtitle:"showLabel",iconclass:"iconClass",closable:"closeButton",
tooltip:"title",disabled:"disabled",textdir:"textdir"};var f=function(a,d){return e(b,"attrmodified-"+a,function(a){var b=c(a.detail&&a.detail.widget&&a.detail.widget.id);b&&b.set(d,a.detail.newValue)})},g;for(g in a)this.own(f(g,a[g]))},destroy:function(a){this.destroyDescendants(a);this.inherited(arguments)},onAddChild:function(a,b){var c=new (d.isString(this.buttonWidget)?d.getObject(this.buttonWidget):this.buttonWidget)({id:this.id+"_"+a.id,name:this.id+"_"+a.id,label:a.title,disabled:a.disabled,
ownerDocument:this.ownerDocument,dir:a.dir,lang:a.lang,textDir:a.textDir||this.textDir,showLabel:a.showTitle,iconClass:a.iconClass,closeButton:a.closable,title:a.tooltip,page:a});this.addChild(c,b);a.controlButton=c;if(!this._currentChild)this.onSelectChild(a);c=a._wrapper.getAttribute("aria-labelledby")?a._wrapper.getAttribute("aria-labelledby")+" "+c.id:c.id;a._wrapper.removeAttribute("aria-label");a._wrapper.setAttribute("aria-labelledby",c)},onRemoveChild:function(a){this._currentChild===a&&(this._currentChild=
null);var b=this.pane2button(a.id);b&&(this.removeChild(b),b.destroy());delete a.controlButton},onSelectChild:function(a){if(a){if(this._currentChild){var b=this.pane2button(this._currentChild.id);b.set("checked",!1);b.focusNode.setAttribute("tabIndex","-1")}b=this.pane2button(a.id);b.set("checked",!0);this._currentChild=a;b.focusNode.setAttribute("tabIndex","0");l.byId(this.containerId)}},onButtonClick:function(a){var b=this.pane2button(a.id);g.focus(b.focusNode);this._currentChild&&this._currentChild.id===
a.id&&b.set("checked",!0);l.byId(this.containerId).selectChild(a)},onCloseButtonClick:function(a){l.byId(this.containerId).closeChild(a);this._currentChild&&(a=this.pane2button(this._currentChild.id))&&g.focus(a.focusNode||a.domNode)},adjacent:function(a){if(!this.isLeftToRight()&&(!this.tabPosition||/top|bottom/.test(this.tabPosition)))a=!a;var b=this.getChildren(),c=h.indexOf(b,this.pane2button(this._currentChild.id)),d=b[c],e;do c=(c+(a?1:b.length-1))%b.length,e=b[c];while(e.disabled&&e!=d);return e},
onkeydown:function(a,b){if(!this.disabled&&!a.altKey){var d=null;if(a.ctrlKey||!a._djpage){switch(a.keyCode){case c.LEFT_ARROW:case c.UP_ARROW:a._djpage||(d=!1);break;case c.PAGE_UP:a.ctrlKey&&(d=!1);break;case c.RIGHT_ARROW:case c.DOWN_ARROW:a._djpage||(d=!0);break;case c.PAGE_DOWN:a.ctrlKey&&(d=!0);break;case c.HOME:for(var e=this.getChildren(),f=0;f<e.length;f++){var g=e[f];if(!g.disabled){this.onButtonClick(g.page);break}}a.stopPropagation();a.preventDefault();break;case c.END:e=this.getChildren();
for(f=e.length-1;0<=f;f--)if(g=e[f],!g.disabled){this.onButtonClick(g.page);break}a.stopPropagation();a.preventDefault();break;case c.DELETE:case 87:if(this._currentChild.closable&&(a.keyCode==c.DELETE||a.ctrlKey))this.onCloseButtonClick(this._currentChild),a.stopPropagation(),a.preventDefault();break;case c.TAB:a.ctrlKey&&(this.onButtonClick(this.adjacent(!a.shiftKey).page),a.stopPropagation(),a.preventDefault())}null!==d&&(this.onButtonClick(this.adjacent(d).page),a.stopPropagation(),a.preventDefault())}}},
onContainerKeyDown:function(a){a.e._djpage=a.page;this.onkeydown(a.e)}});b.StackButton=a;return b})},"dijit/popup":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/keys dojo/_base/lang dojo/on ./place ./BackgroundIframe ./Viewport ./main".split(" "),function(h,b,k,a,c,d,e,f,g,l,m,n,q,p,s,t){function u(){this._popupWrapper&&(d.destroy(this._popupWrapper),delete this._popupWrapper)}k=k(null,{_stack:[],
_beginZIndex:1E3,_idGen:1,_repositionAll:function(){if(this._firstAroundNode){var a=this._firstAroundPosition,b=e.position(this._firstAroundNode,!0),c=b.x-a.x,a=b.y-a.y;if(c||a){this._firstAroundPosition=b;for(b=0;b<this._stack.length;b++){var d=this._stack[b].wrapper.style;d.top=parseFloat(d.top)+a+"px";"auto"==d.right?d.left=parseFloat(d.left)+c+"px":d.right=parseFloat(d.right)-c+"px"}}this._aroundMoveListener=setTimeout(m.hitch(this,"_repositionAll"),c||a?10:50)}},_createWrapper:function(a){var c=
a._popupWrapper,e=a.domNode;c||(c=d.create("div",{"class":"dijitPopup",style:{display:"none"},role:"region","aria-label":a["aria-label"]||a.label||a.name||a.id},a.ownerDocumentBody),c.appendChild(e),e=e.style,e.display="",e.visibility="",e.position="",e.top="0px",a._popupWrapper=c,b.after(a,"destroy",u,!0),"ontouchend"in document&&n(c,"touchend",function(a){/^(input|button|textarea)$/i.test(a.target.tagName)||a.preventDefault()}));return c},moveOffScreen:function(a){var b=this._createWrapper(a);a=
e.isBodyLtr(a.ownerDocument);var c={visibility:"hidden",top:"-9999px",display:""};c[a?"left":"right"]="-9999px";c[a?"right":"left"]="auto";f.set(b,c);return b},hide:function(a){var b=this._createWrapper(a);f.set(b,{display:"none",height:"auto",overflow:"visible",border:""});a=a.domNode;"_originalStyle"in a&&(a.style.cssText=a._originalStyle)},getTopPopup:function(){for(var a=this._stack,b=a.length-1;0<b&&a[b].parent===a[b-1].widget;b--);return a[b]},open:function(b){for(var d=this._stack,k=b.popup,
h=k.domNode,t=b.orient||["below","below-alt","above","above-alt"],u=b.parent?b.parent.isLeftToRight():e.isBodyLtr(k.ownerDocument),G=b.around,F=b.around&&b.around.id?b.around.id+"_dropdown":"popup_"+this._idGen++;d.length&&(!b.parent||!a.isDescendant(b.parent.domNode,d[d.length-1].widget.domNode));)this.close(d[d.length-1].widget);var B=this.moveOffScreen(k);k.startup&&!k._started&&k.startup();var E,K=e.position(h);if("maxHeight"in b&&-1!=b.maxHeight)E=b.maxHeight||Infinity;else{E=s.getEffectiveBox(this.ownerDocument);
var O=G?e.position(G,!1):{y:b.y-(b.padding||0),h:2*(b.padding||0)};E=Math.floor(Math.max(O.y,E.h-(O.y+O.h)))}K.h>E&&(K=f.getComputedStyle(h),f.set(B,{overflowY:"scroll",height:E+"px",border:K.borderLeftWidth+" "+K.borderLeftStyle+" "+K.borderLeftColor}),h._originalStyle=h.style.cssText,h.style.border="none");c.set(B,{id:F,style:{zIndex:this._beginZIndex+d.length},"class":"dijitPopup "+(k.baseClass||k["class"]||"").split(" ")[0]+"Popup",dijitPopupParent:b.parent?b.parent.id:""});0==d.length&&G&&(this._firstAroundNode=
G,this._firstAroundPosition=e.position(G,!0),this._aroundMoveListener=setTimeout(m.hitch(this,"_repositionAll"),50));g("config-bgIframe")&&!k.bgIframe&&(k.bgIframe=new p(B));F=k.orient?m.hitch(k,"orient"):null;t=G?q.around(B,G,t,u,F):q.at(B,b,"R"==t?["TR","BR","TL","BL"]:["TL","BL","TR","BR"],b.padding,F);B.style.visibility="visible";h.style.visibility="visible";h=[];h.push(n(B,"keydown",m.hitch(this,function(a){if(a.keyCode==l.ESCAPE&&b.onCancel)a.stopPropagation(),a.preventDefault(),b.onCancel();
else if(a.keyCode==l.TAB&&(a.stopPropagation(),a.preventDefault(),(a=this.getTopPopup())&&a.onCancel))a.onCancel()})));k.onCancel&&b.onCancel&&h.push(k.on("cancel",b.onCancel));h.push(k.on(k.onExecute?"execute":"change",m.hitch(this,function(){var a=this.getTopPopup();if(a&&a.onExecute)a.onExecute()})));d.push({widget:k,wrapper:B,parent:b.parent,onExecute:b.onExecute,onCancel:b.onCancel,onClose:b.onClose,handlers:h});if(k.onOpen)k.onOpen(t);return t},close:function(a){for(var b=this._stack;a&&h.some(b,
function(b){return b.widget==a})||!a&&b.length;){var c=b.pop(),d=c.widget,e=c.onClose;d.bgIframe&&(d.bgIframe.destroy(),delete d.bgIframe);if(d.onClose)d.onClose();for(var f;f=c.handlers.pop();)f.remove();d&&d.domNode&&this.hide(d);e&&e()}0==b.length&&this._aroundMoveListener&&(clearTimeout(this._aroundMoveListener),this._firstAroundNode=this._firstAroundPosition=this._aroundMoveListener=null)}});return t.popup=new k})},"arcgisonline/sharing/dijit/dialog/SubscriptionStatusDlg":function(){define(["dijit",
"dojo","dojox","dojo/require!dijit/Dialog,dijit/_Widget,dijit/_Templated,dijit/form/Button,arcgisonline/sharing/util"],function(h,b,k){b.provide("arcgisonline.sharing.dijit.dialog.SubscriptionStatusDlg");b.require("dijit.Dialog");b.require("dijit._Widget");b.require("dijit._Templated");b.require("dijit.form.Button");b.require("arcgisonline.sharing.util");b.declare("arcgisonline.sharing.dijit.dialog.SubscriptionStatusDlg",[h._Widget,h._Templated],{widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContent" \x3e\r\n  \x3cdiv dojotype\x3d"dijit.Dialog" id\x3d"subscription-status-dialog" dojoAttachPoint\x3d"subscriptionStatusDlg" title\x3d"" execute\x3d""\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"subscriptionStateDiv"\x3e\x3c/div\x3e\r\n    \x3cbr/\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"actionNeededDiv"\x3e\x3c/div\x3e\r\n    \x3cbr/\x3e\r\n    \x3cdiv class\x3d"esriFloatTrailing"\x3e\x3cbutton dojoAttachPoint\x3d"closeButton" dojoAttachEvent\x3d"onClick:onOkClick" class\x3d"jevent primary" dojoType\x3d"dijit.form.Button"\x3e${i18n.ok}\x3c/button\x3e\x3c/div\x3e\r\n    \x3cbr style\x3d"clear:both;"/\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
util:arcgisonline.sharing.util,statics:{_instance:null,getInstance:function(){null==this._instance&&(this._instance=new arcgisonline.sharing.dijit.dialog.SubscriptionStatusDlg);return this._instance}},subscriptionStatusDlg:null,subscriptionStateDiv:null,actionNeededDiv:null,closeButton:null,postMixInProperties:function(){this.inherited(arguments);this.i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").subscriptionStatusDlg)},
postCreate:function(){this.loadConnections()},show:function(a){this.clear();this.setSubscriptionState(a);this.setActionMessage(a);this.subscriptionStatusDlg.show()},showOther:function(a){this.clear();this.setOtherSubscriptionStatus(a);b.style(this.actionNeededDiv,"display","none");this.subscriptionStatusDlg.show()},setSubscriptionState:function(a){if(a&&a.state){var c=this.i18n.subscriptionStatusExpiredMsg;a=a.state.toLowerCase();"expired"===a?c=this.i18n.subscriptionStatusExpiredMsg:"cancelled"===
a?c=this.i18n.subscriptionStatusCancelledMsg:"suspended"===a&&(c=this.i18n.subscriptionStatusSuspendedMsg);b.attr(this.subscriptionStateDiv,"innerHTML",c)}},setOtherSubscriptionStatus:function(a){this.subscriptionStatusDlg.set("title",this.i18n.errorTitle);var c=this.i18n.expiredStatus;a&&("SB_0005"===a?c=this.i18n.suspendedStatus:"SB_0006"===a?c=this.i18n.cancelledStatus:"SB_007"===a&&(c=this.i18n.expiredStatus));a=esri.substitute({subscriptionState:c},this.i18n.otherSubscriptionStatusMsg);b.attr(this.subscriptionStateDiv,
"innerHTML",a)},setActionMessage:function(a){var c=arcgisonline.sharing.util.getUser();c&&c.role&&"account_admin"===c.role?(a=a.type.toLowerCase(),a=esri.substitute({buttonLabel:"trial"===a||"evaluation"===a?this.i18n.manageSubscriptionLabel:this.i18n.upgradeSubscriptionLabel},this.i18n.adminActionMsg),b.attr(this.actionNeededDiv,"innerHTML",a)):b.attr(this.actionNeededDiv,"innerHTML",this.i18n.nonAdminActionMsg)},loadConnections:function(){b.query(".jevent").connect("onclick",function(a){a.preventDefault()});
b.connect(this.subscriptionStatusDlg,"onCancel",b.hitch(this,function(a){this.onCancel(a)}));b.connect(this.subscriptionStatusDlg,"hide",b.hitch(this,function(a){this.onHide(a)}))},clear:function(){this.subscriptionStatusDlg.set("title",this.i18n.subscriptionStatusTitle);b.attr(this.subscriptionStateDiv,"innerHTML","");b.attr(this.actionNeededDiv,"innerHTML","");b.style(this.actionNeededDiv,"display","")},hide:function(){this.subscriptionStatusDlg.hide()},onOkClick:function(a){h.byId("subscription-status-dialog").hide()},
onCancel:function(){},onHide:function(){}})})},"dojo/dnd/Mover":function(){define("../_base/array ../_base/declare ../_base/lang ../sniff ../_base/window ../dom ../dom-geometry ../dom-style ../Evented ../on ../touch ./common ./autoscroll".split(" "),function(h,b,k,a,c,d,e,f,g,l,m,n,q){return b("dojo.dnd.Mover",[g],{constructor:function(a,b,c){function e(a){a.preventDefault();a.stopPropagation()}this.node=d.byId(a);this.marginBox={l:b.pageX,t:b.pageY};this.mouseButton=b.button;b=this.host=c;a=a.ownerDocument;
this.events=[l(a,m.move,k.hitch(this,"onFirstMove")),l(a,m.move,k.hitch(this,"onMouseMove")),l(a,m.release,k.hitch(this,"onMouseUp")),l(a,"dragstart",e),l(a.body,"selectstart",e)];q.autoScrollStart(a);if(b&&b.onMoveStart)b.onMoveStart(this)},onMouseMove:function(a){q.autoScroll(a);var b=this.marginBox;this.host.onMove(this,{l:b.l+a.pageX,t:b.t+a.pageY},a);a.preventDefault();a.stopPropagation()},onMouseUp:function(b){(a("webkit")&&a("mac")&&2==this.mouseButton?0==b.button:this.mouseButton==b.button)&&
this.destroy();b.preventDefault();b.stopPropagation()},onFirstMove:function(a){var b=this.node.style,d,g=this.host;switch(b.position){case "relative":case "absolute":d=Math.round(parseFloat(b.left))||0;b=Math.round(parseFloat(b.top))||0;break;default:b.position="absolute";b=e.getMarginBox(this.node);d=c.doc.body;var l=f.getComputedStyle(d),m=e.getMarginBox(d,l),l=e.getContentBox(d,l);d=b.l-(l.l-m.l);b=b.t-(l.t-m.t)}this.marginBox.l=d-this.marginBox.l;this.marginBox.t=b-this.marginBox.t;if(g&&g.onFirstMove)g.onFirstMove(this,
a);this.events.shift().remove()},destroy:function(){h.forEach(this.events,function(a){a.remove()});var a=this.host;if(a&&a.onMoveStop)a.onMoveStop(this);this.events=this.node=this.host=null}})})},"arcgisonline/sharing/dijit/SignUp":function(){define(["dijit","dojo","dojox","dojo/require!dijit/_Widget,dijit/_Templated,dijit/form/Button,dijit/form/ValidationTextBox,arcgisonline/sharing/util,arcgisonline/sharing/geow/Geow,arcgisonline/sharing/geow/Account,arcgisonline/sharing/dijit/dialog/ChoiceDlg,arcgisonline/sharing/dijit/dialog/TermsOfUseDlg"],
function(h,b,k){b.provide("arcgisonline.sharing.dijit.SignUp");b.require("dijit._Widget");b.require("dijit._Templated");b.require("dijit.form.Button");b.require("dijit.form.ValidationTextBox");b.require("arcgisonline.sharing.util");b.require("arcgisonline.sharing.geow.Geow");b.require("arcgisonline.sharing.geow.Account");b.require("arcgisonline.sharing.dijit.dialog.ChoiceDlg");b.require("arcgisonline.sharing.dijit.dialog.TermsOfUseDlg");b.declare("arcgisonline.sharing.dijit.SignUp",[h._Widget,h._Templated],
{util:arcgisonline.sharing.util,termsOfUseDlg:arcgisonline.sharing.dijit.dialog.TermsOfUseDlg,geow:arcgisonline.sharing.geow.Geow,redirectUrl:esriGeowConfig.baseUrl+"index.html",orgRedirectUrl:esriGeowConfig.baseUrl+"organization.html",setupRedirectUrl:esriGeowConfig.baseUrl+"setup.html",widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContent"\x3e\r\n  \x3cdiv id\x3d"sign-up-form" class\x3d"grid_16"\x3e\r\n    \x3ch1 id\x3d"sign_up_title"\x3e\x3c/h1\x3e\r\n    \x3cdiv id\x3d"register-error"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv dojotype\x3d"dijit.form.Form" id\x3d"register-form" method\x3d"POST" action\x3d""\x3e\r\n      \x3cp class\x3d"register"\x3e\r\n        \x3cb id\x3d"sign-up-title"\x3e\x3c/b\x3e\r\n      \x3c/p\x3e\r\n      \x3cp class\x3d"freeTrial" style\x3d"display:none;"\x3e${i18n.activateTrialMsg}\x3c/p\x3e\r\n      \x3cp\x3e\r\n        \x3ctable\x3e\r\n          \x3ctbody\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd class\x3d"grid_2 alpha"\x3e\r\n                \x3clabel for\x3d"register_username" style\x3d"padding:0;margin:0;"\x3e\r\n                  ${i18n.userLabel}\r\n                \x3c/label\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv id\x3d"register_username" name\x3d"register_username" class\x3d"grid_6 omega" style\x3d"padding:2px;margin:0;" dojotype\x3d"dijit.form.TextBox" trim\x3d"true"\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr height\x3d"5"\x3e\r\n              \x3ctd colspan\x3d"2" height\x3d"5"\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd class\x3d"grid_2 alpha"\x3e\r\n                \x3clabel for\x3d"register_password" style\x3d"padding:0;margin:0;"\x3e\r\n                  ${i18n.passwordLabel}\r\n                \x3c/label\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv id\x3d"register_password" name\x3d"register_password" class\x3d"grid_6 omega" style\x3d"padding:2px;margin:0;" type\x3d"password" dojotype\x3d"dijit.form.TextBox"trim\x3d"true"\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv class\x3d"freeTrial" style\x3d"display:none;"\x3e\r\n                  \x3ca dojoAttachPoint\x3d"_signInHelpLink" href\x3d"troubleshoot.html"\x3e${i18n.needHelpSign}\x3c/a\x3e\r\n                  \x3cdiv\x3e\r\n                    \x3cinput id\x3d"remember-me" value\x3d"off" dojotype\x3d"dijit.form.CheckBox" /\x3e\r\n                    \x3clabel for\x3d"remember-me"\x3e${i18n.rememberMe}\x3c/label\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"register"\x3e\r\n                  \x3cdiv id\x3d"forgotPasswordLinkDiv"\x3e\r\n                    \x3ca id\x3d"forgotPasswordLink"\x3e${i18n.forgotPassword}\x3c/a\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv style\x3d"margin-top:10px;"\x3e\r\n                  \x3cbutton id\x3d"button_sign_in" class\x3d"calcite blue" dojoAttachPoint\x3d\'_btnSignIn\' type\x3d"submit" label\x3d"${i18n.register}" dojotype\x3d"dijit.form.Button"\x3e\r\n\r\n                  \x3c/button\x3e\r\n                  \x3cimg dojoAttachPoint\x3d\'_keyImgicon\' style\x3d"display:none; position:absolute; padding-left:10px;"/\x3e\r\n                  \x3cbr/\x3e\r\n                  \x3cbr/\x3e\r\n                  \x3cdiv id\x3d"registerDiv"\x3e\r\n                  \x3cp\x3e\r\n                    \x3cb id\x3d"sign-up-no-account"\x3e\x3c/b\x3e\r\n                    \x3cbr/\x3e\r\n                    \x3cspan\x3e\x3ca id\x3d"registerLink"\x3e${i18n.createAccount}\x3c/a\x3e\x3c/span\x3e\r\n                  \x3c/p\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n          \x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv style\x3d"width:100%; clear:both;"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n',
i18n:null,postMixInProperties:function(){this.inherited(arguments);this.i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").signUpWidget);this.defaultOrgTitleText=this.i18n.myAccount},postCreate:function(){b.attr(this._keyImgicon,"src",this.util.relativeToExplicitUrl("images/goldKey.gif"));esriGeowConfig.portalName&&b.style(this._keyImgicon,"display","none")},startup:function(){this.inherited(arguments);b.mixin(this,
b.queryToObject(window.location.search.slice(1)));this.trial=this.type&&"trial"===this.type.toLowerCase();esri.config.defaults.io.proxyUrl=esriGeowConfig.proxyServer;this._svcUrl=esriGeowConfig.restBaseUrl+(esriGeowConfig.restBaseUrl.lastIndexOf("/")===esriGeowConfig.restBaseUrl.length-1?"":"/");this._communityUri=this._svcUrl+"community/";this._usersUri=this._communityUri+"users/";this._accountsUri=this._svcUrl+"portals/";this._requestParams={f:"json"};this.loadConnections();esriGeowConfig.account_registration?
b.byId("registerLink").href=esriGeowConfig.account_registration:b.style(b.byId("registerDiv"),"display","none");esriGeowConfig.forgotPwd?b.byId("forgotPasswordLink").href=esriGeowConfig.forgotPwd:b.style(b.byId("forgotPasswordLinkDiv"),"display","none");b.byId("sign-up-title").innerHTML=b.string.substitute(this.i18n.enterYourAccountInfo,{account:esriGeowConfig.esriGlobalAccount?esriGeowConfig.esriGlobalAccount:this.i18n.esriGlobalAccount});b.byId("sign-up-no-account").innerHTML=b.string.substitute(this.i18n.dontHaveAccount,
{account:esriGeowConfig.esriGlobalAccount?esriGeowConfig.esriGlobalAccount:this.i18n.esriGlobalAccount});this.trial?(b.attr("registerYour","innerHTML",this.i18n.activateTrial),this._btnSignIn.set("label",this.i18n.signIn),b.query(".registerYour").style("display","none"),b.query(".freeTrial").style("display","block")):esriGeowConfig.useDefaultIdentityStore?b.attr("registerYour","innerHTML",this.i18n.createAccount):b.attr("registerYour","innerHTML",this.i18n.registerYour+(esriGeowConfig.esriGlobalAccount||
this.i18n.esriGlobalAccount));setTimeout("dojo.byId('register_username').focus()",350);b.subscribe("registerUser",this,"registerUser");b.subscribe("declineTermsOfUse",this,"declineTermsOfUse")},loadConnections:function(){b.connect(h.byId("button_register"),"onClick",this,"signUp");b.connect(h.byId("register-form"),"onSubmit",this,"signUp")},signIn:function(a){this.invitation?arcgisonline.sharing.geow.Account.getInvitation(this.invitation,b.hitch(this,this.onInvitationInfo),b.hitch(this,this.onInvitationInfo)):
this.activationcode?this._activateAccount(a).then(b.hitch(this,"routeUser")):this.routeUser()},onInvitationInfo:function(a,c){var d;if(a&&a.code&&a.message&&403===a.code){var e="\x3cp\x3e"+this.i18n.emailInvitation+"\x3c/p\x3e\x3cp\x3e"+this.i18n.clickOkInstructions+"\x3c/p\x3e";d=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();d.onOkClick=b.hitch(this,function(a,b){a.hide();this.routeUser()},d);d.show({title:this.i18n.notice,message:e})}else if(a&&a.code&&a.message&&
400===a.code)e="\x3cp\x3e"+this.i18n.invitationUsedMsg+"\x3c/p\x3e\x3cp\x3e"+this.i18n.clickOkSignIn+"\x3c/p\x3e",d=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),d.onOkClick=b.hitch(this,function(a,b){a.hide();this.routeUser()},d),d.show({title:this.i18n.notice,message:e});else if(a&&a.id&&a.id===this.invitation){var f="\x3cp\x3e"+b.string.substitute(this.i18n.membershipPending,{account:"\x3cstrong\x3e"+a.account.name+"\x3c/strong\x3e"})+"\x3c/p\x3e";d="\x3cp\x3e\x3cstrong\x3e"+
b.string.substitute(this.i18n.ByAcceptingInvite,{account:a.account.name})+"\x3c/strong\x3e\x3c/p\x3e\x3cp\x3e\x3cul\x3e\x3cli\x3e"+b.string.substitute(this.i18n.itemsMsg,{beginStrong:"\x3cstrong\x3e",endStrong:"\x3c/strong\x3e"})+"\x3c/li\x3e\x3cli\x3e"+this.i18n.accountManagedMsg+"\x3c/li\x3e\x3cli\x3e"+this.i18n.leaveOrganization+"\x3c/li\x3e\x3c/ul\x3e\x3c/p\x3e\x3cp\x3e"+b.string.substitute(this.i18n.currentOrNewAccount,{account:a.account.name})+"\x3c/p\x3e";e={title:this.i18n.notice,message:d,
choiceOneTitle:this.i18n.useCurrentAccount,choiceTwoTitle:this.i18n.createNewOne};e.choiceOneHandler=b.hitch(this,function(c){a.mustApprove&&!0===a.mustApprove?(console.log(a),c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),c.onOkClick=b.hitch(this,function(a){a.hide();arcgisonline.sharing.geow.Account.acceptInvitation(this.invitation,b.hitch(this,this.onInvitationAccepted),b.hitch(this,this.onInvitationAccepted))},c),c.show({title:this.i18n.notice,message:f})):arcgisonline.sharing.geow.Account.acceptInvitation(this.invitation,
b.hitch(this,this.onInvitationAccepted),b.hitch(this,this.onInvitationAccepted))});e.choiceTwoHandler=b.hitch(this,function(a){this.routeUser()});d=arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance();d.show(e)}else this.routeUser()},onInvitationAccepted:function(a){var c;a&&a.success&&!0===a.success?(c={username:h.byId("register_username").getValue(),password:h.byId("register_password").getValue(),expiration:esriGeowConfig.tokenExpiration},this.geow.signin(c,b.hitch(this,this.routeUser),
b.hitch(this,"signInError"))):a&&a.code&&a.message&&500===a.code&&"Invitation has already been accepted."===b.trim(a.message)?(a="\x3cp\x3e"+this.i18n.acceptedInvite+"\x3c/p\x3e\x3cp\x3e"+this.i18n.clickOk+"\x3c/p\x3e",c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),c.onOkClick=b.hitch(this,function(a,b){a.hide();this.routeUser()},c),c.show({title:this.i18n.notice,message:a})):(c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),c.onOkClick=
b.hitch(this,function(a,b){a.hide();window.location=esriGeowConfig.baseUrl.replace("http:","https:")+esriGeowConfig.signin+"?invitation\x3d"+this.invitation},c),a.code&&a.message?("User already member of an account."===a.message&&(a.message=this.i18n.userAnotheOrg),c.show({title:this.i18n.unableJoin,message:a.message})):c.show({title:this.i18n.unableJoin,message:this.i18n.problemJoingOrg}))},routeUser:function(){var a=this.returnUrl,c=esriGeowConfig.baseUrl+esriGeowConfig.signin;a&&-1<a.indexOf(c)&&
(a=null);(this._user=this.util.getUser()).accountId?this._fetchSelf().then(b.hitch(this,"routeOrg")):window.location=a?a:esriGeowConfig.baseUrl.replace("https:","http:")+"user.html?newUser\x3dtrue"},routeOrg:function(a,b){var d=this._user,e=this.returnUrl,f=esriGeowConfig.baseUrl+esriGeowConfig.signin;e&&-1<e.indexOf(f)&&(e=null);var g=this._organization=a||{},f=g.allSSL,l;e?(g.urlKey&&g.customBaseUrl&&(d=this._util.parseUrl(e).host,-1===d.indexOf(g.urlKey+"."+g.customBaseUrl)&&(l=this.util.getCookie("esri_auth"),
e=e.replace(d,g.urlKey+"."+g.customBaseUrl),e=this.util.getBridgeUrl(e,l))),window.location=f?e.replace("http:","https:"):e):g.urlKey&&g.customBaseUrl?(e=(f?"https:":"http:")+"//"+g.urlKey+"."+g.customBaseUrl,l=null,-1===window.location.host.indexOf(g.urlKey+"."+g.customBaseUrl)&&(l=this.util.getCookie("esri_auth")),e=(f?"https:":"http:")+"//"+g.urlKey+"."+g.customBaseUrl,g=esriGeowConfig.baseUrl.indexOf(location.host),e=-1<g?e+(esriGeowConfig.baseUrl.substring(g+location.host.length)+("account_admin"===
d.role?"organization.html":"index.html")):f?this.redirectUrl.replace("http:","https:"):this.redirectUrl.replace("https:","http:"),l&&(e=esriGeowConfig.bridgeUrl+"?url\x3d"+e+"\x26exp\x3d"+Math.ceil((new Date(l.expires)-new Date)/1E3)),window.location=e):window.location="account_admin"===d.role&&!g.urlKey?f?this.setupRedirectUrl.replace("http:","https:"):this.setupRedirectUrl.replace("https:","http:"):"account_admin"===d.role&&this.activationcode?f?this.orgRedirectUrl.replace("http:","https:"):this.orgRedirectUrl.replace("https:",
"http:"):f?this.redirectUrl.replace("http:","https:"):this.redirectUrl.replace("https:","http:")},signUp:function(a){a.preventDefault();b.query("#register-error")&&(b.byId("register-error").innerHTML="",b.removeClass("register-error","error"));!1!=this.validateForm()&&(h.byId("button_sign_in").set("disabled",!0),this.trial||h.byId("button_sign_in").set("label",this.i18n.registering),esriGeowConfig.portalName?this.registerUser():this.trial&&this.activationcode?(this.signout(),this._signin(b.hitch(this,
function(){this.termsOfUseDlg.prototype.statics.getInstance().show()})).then(b.hitch(this,function(){this._showAlreadyRegisteredDlg()}))):this.termsOfUseDlg.prototype.statics.getInstance().show())},_showAlreadyRegisteredDlg:function(){var a=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();a.show({title:this.i18n.alreadyRegisteredTitle,message:this.i18n.alreadyRegistered});var c=b.connect(a,"onHide",b.hitch(this,function(){b.disconnect(c);h.byId("register_username").set("value",
"");h.byId("register_password").set("value","");h.byId("button_sign_in").set("disabled",!1);setTimeout(b.hitch(function(){h.byId("register_username").focus()}),300)}))},validateForm:function(){var a=h.byId("register_username").getValue(),b=h.byId("register_password").getValue(),d=null;if((null==a||""==a)&&(null==b||""==b))d=this.i18n.error.userNamePassRqd;else if(null==a||""==a)d=this.i18n.error.usernameRqd;else if(null==b||""==b)d=this.i18n.error.passRqd;if(null==d)return!0;this.showError({message:d});
return!1},signout:function(){esriGeowConfig.userInfo=null;esriGeowConfig.userPreferences=null;b.cookie("esri_auth",null,{expires:-1,path:"/",domain:document.domain});b.cookie("ESRI_Webmap",null,{expires:-1,path:"/",domain:document.domain});b.publish("onSignOut",[])},registerUser:function(a){a=b.byId("register_username").value;var c=b.byId("register_password").value;a={username:a,password:c};this.signout();this.geow.signup(a,b.hitch(this,function(a,c){if(null!=a.error&&""!=a.error)h.byId("button_sign_in").set("disabled",
!1),h.byId("button_sign_in").set("label",this.trial?this.i18n.signIn:this.i18n.register),this.errorHandler(a,c);else return this._signin().then(b.hitch(this,"signIn"))}),b.hitch(this,"signInError"))},declineTermsOfUse:function(){h.byId("button_sign_in").set("disabled",!1)},signInError:function(a,c){h.byId("button_sign_in").set("disabled",!1);h.byId("button_sign_in").set("label",this.trial?this.i18n.signIn:this.i18n.register);var d="\x3cb style\x3d'font-size:1.2em;line-height:30px;'\x3e"+b.string.substitute(this.i18n.unableRegister,
{portalName:esriGeowConfig.portalName?esriGeowConfig.portalName:this.i18n.arcgisOnline})+"\x3c/b\x3e\x3cbr/\x3e",d=d+"\x3cspan style\x3d'color:#000000;'\x3e",d=a.code&&500===a.code&&a.message&&"Unable to register user. Username contains unsupported characters."===a.message?d+this.i18n.invalidUsername:d+(this.i18n.usernameSpellCheck+"\x3cbr/\x3e"+this.i18n.caseSensitive);this.showError({message:d+"\x3c/span\x3e\x3cbr/\x3e\x26nbsp;"})},_activateAccount:function(a){return this._request(this._accountsUri+
"activate",{code:this.activationcode,token:a.token},{usePost:!0,errBack:b.hitch(this,"_activateError")}).then(b.hitch(this,"_signin"))},_activateError:function(a){a.details=a.details&&a.details.length?b.filter(a.details,"return item !\x3d\x3d null"):null;a.details&&a.details.length&&(a.details=a.details.join("\x3cbr /\x3e"),a.message=a.message?a.message+"\x3cbr /\x3e"+a.details:a.details);a=b.mixin(b.mixin({},{title:"Error",message:"There was an error."}),a);var c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();
c.onOkClick=b.hitch(this,function(a){a.hide();this.routeUser()},c);c.show(a)},_signin:function(a){var c=new b.Deferred,d={username:h.byId("register_username").getValue(),password:h.byId("register_password").getValue(),expiration:b.byId("remember-me").checked?esriGeowConfig.longTokenExpiration:esriGeowConfig.tokenExpiration};this.geow.signin(d,b.hitch(this,"_resolveDfd",c),a||b.hitch(this,"signInError"));return c},_resolveDfd:function(a,b){if(b.error)throw this.signInError(b.error),b.error;a.resolve(b)},
_fetchSelf:function(){var a=this.util.getUser();esriGeowConfig.self=null;return this._request(this._accountsUri+"self",{token:a.token})},_request:function(a,c,d){c=b.mixin(c||{},this._requestParams);return this.util.request({url:a,content:c},d||{}).then(b.hitch(this,function(a){return a.error?d.errBack?d.errBack(a.error):this._showError(a.error):a}),b.hitch(this,function(a){d.errBack?d.errBack(a):this._showError(a);throw a;}))},showError:function(a){a=a.error||a||{};a.code=a.code||0;a.details=a.details&&
a.details.length?b.filter(a.details,"return item !\x3d\x3d null"):null;a.details&&a.details.length&&(a.details=a.details.join("\x3cbr /\x3e"),a.message=a.message?a.message+"\x3cbr /\x3e"+a.details:a.details);b.addClass("register-error","error");b.attr(b.byId("register-error"),"innerHTML",a.message+"");return!0}})})},"dijit/BackgroundIframe":function(){define("require ./main dojo/_base/config dojo/dom-construct dojo/dom-style dojo/_base/lang dojo/on dojo/sniff".split(" "),function(h,b,k,a,c,d,e,f){f.add("config-bgIframe",
f("ie")&&!/IEMobile\/10\.0/.test(navigator.userAgent)||f("trident")&&/Windows NT 6.[01]/.test(navigator.userAgent));var g=new function(){var b=[];this.pop=function(){var d;b.length?(d=b.pop(),d.style.display=""):(9>f("ie")?(d="\x3ciframe src\x3d'"+(k.dojoBlankHtmlUrl||h.toUrl("dojo/resources/blank.html")||'javascript:""')+"' role\x3d'presentation' style\x3d'position: absolute; left: 0px; top: 0px;z-index: -1; filter:Alpha(Opacity\x3d\"0\");'\x3e",d=document.createElement(d)):(d=a.create("iframe"),
d.src='javascript:""',d.className="dijitBackgroundIframe",d.setAttribute("role","presentation"),c.set(d,"opacity",0.1)),d.tabIndex=-1);return d};this.push=function(a){a.style.display="none";b.push(a)}};b.BackgroundIframe=function(a){if(!a.id)throw Error("no id");if(f("config-bgIframe")){var b=this.iframe=g.pop();a.appendChild(b);7>f("ie")||f("quirks")?(this.resize(a),this._conn=e(a,"resize",d.hitch(this,"resize",a))):c.set(b,{width:"100%",height:"100%"})}};d.extend(b.BackgroundIframe,{resize:function(a){this.iframe&&
c.set(this.iframe,{width:a.offsetWidth+"px",height:a.offsetHeight+"px"})},destroy:function(){this._conn&&(this._conn.remove(),this._conn=null);this.iframe&&(this.iframe.parentNode.removeChild(this.iframe),g.push(this.iframe),delete this.iframe)}});return b.BackgroundIframe})},"dojo/dnd/Avatar":function(){define("../_base/declare ../_base/window ../dom ../dom-attr ../dom-class ../dom-construct ../hccss ../query".split(" "),function(h,b,k,a,c,d,e,f){return h("dojo.dnd.Avatar",null,{constructor:function(a){this.manager=
a;this.construct()},construct:function(){var b=d.create("table",{"class":"dojoDndAvatar",style:{position:"absolute",zIndex:"1999",margin:"0px"}}),c=this.manager.source,f,k=d.create("tbody",null,b),h=d.create("tr",null,k),p=d.create("td",null,h),s=Math.min(5,this.manager.nodes.length),t=0;e("highcontrast")&&d.create("span",{id:"a11yIcon",innerHTML:this.manager.copy?"+":"\x3c"},p);d.create("span",{innerHTML:c.generateText?this._generateText():""},p);for(a.set(h,{"class":"dojoDndAvatarHeader",style:{opacity:0.9}});t<
s;++t)c.creator?f=c._normalizedCreator(c.getItem(this.manager.nodes[t].id).data,"avatar").node:(f=this.manager.nodes[t].cloneNode(!0),"tr"==f.tagName.toLowerCase()&&(h=d.create("table"),d.create("tbody",null,h).appendChild(f),f=h)),f.id="",h=d.create("tr",null,k),p=d.create("td",null,h),p.appendChild(f),a.set(h,{"class":"dojoDndAvatarItem",style:{opacity:(9-t)/10}});this.node=b},destroy:function(){d.destroy(this.node);this.node=!1},update:function(){c.toggle(this.node,"dojoDndAvatarCanDrop",this.manager.canDropFlag);
if(e("highcontrast")){var a=k.byId("a11yIcon"),b="+";this.manager.canDropFlag&&!this.manager.copy?b="\x3c ":!this.manager.canDropFlag&&!this.manager.copy?b="o":this.manager.canDropFlag||(b="x");a.innerHTML=b}f("tr.dojoDndAvatarHeader td span"+(e("highcontrast")?" span":""),this.node).forEach(function(a){a.innerHTML=this.manager.source.generateText?this._generateText():""},this)},_generateText:function(){return this.manager.nodes.length.toString()}})})},"arcgisonline/sharing/dijit/SignIn":function(){define(["dijit",
"dojo","dojox","dojo/i18n!arcgisonline/nls/arcgisonline","dojo/require!dijit/_Widget,dijit/_Templated,dijit/form/Form,dijit/form/Button,dijit/form/ValidationTextBox,dojo/DeferredList,arcgisonline/sharing/util,arcgisonline/sharing/geow/Account,arcgisonline/sharing/geow/Geow,arcgisonline/sharing/dijit/dialog/ChoiceDlg,arcgisonline/sharing/dijit/dialog/GeneralDlg,arcgisonline/sharing/dijit/dialog/SubscriptionStatusDlg"],function(h,b,k){b.provide("arcgisonline.sharing.dijit.SignIn");b.require("dijit._Widget");
b.require("dijit._Templated");b.require("dijit.form.Form");b.require("dijit.form.Button");b.require("dijit.form.ValidationTextBox");b.require("dojo.DeferredList");b.require("arcgisonline.sharing.util");b.require("arcgisonline.sharing.geow.Account");b.require("arcgisonline.sharing.geow.Geow");b.require("arcgisonline.sharing.dijit.dialog.ChoiceDlg");b.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");b.require("arcgisonline.sharing.dijit.dialog.SubscriptionStatusDlg");b.requireLocalization("arcgisonline",
"arcgisonline");b.declare("arcgisonline.sharing.dijit.SignIn",[h._Widget,h._Templated],{_util:arcgisonline.sharing.util,_geow:arcgisonline.sharing.geow.Geow,_account:arcgisonline.sharing.geow.Account,redirectUrl:esriGeowConfig.baseUrl+"index.html",orgRedirectUrl:esriGeowConfig.baseUrl+"organization.html",setupRedirectUrl:esriGeowConfig.baseUrl+"setup.html",widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContent"\x3e\r\n  \x3cdiv id\x3d"login-form" class\x3d"esriFloatLeading respond-small" style\x3d"display:block; clear:both;"\x3e\r\n    \x3cdiv dojotype\x3d"dijit.form.Form" id\x3d"sign-in-form" method\x3d"POST" action\x3d""\x3e\r\n      \x3cdiv id\x3d"organizationTitle" style\x3d"display:none; margin:10px 0 40px 0; text-align:center;"\x3e\x3c/div\x3e\r\n      \x3cdiv id\x3d"left" style\x3d"display:none;" class\x3d"grid_7 alpha first esriFloatLeading"\x3e\r\n        \x3ch1 id\x3d"leftPanelTitle"\x3e${i18n.firstTimeSign}\x3c/h1\x3e\r\n        \x3cbr/\x3e\r\n        \x3cdiv id\x3d"not_a_member_msg"\x3e\r\n        \x3c/div\x3e\r\n        \x3cbr/\x3e\r\n        \x3cbr/\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"leftAgo" style\x3d"display:none;" class\x3d"grid_7 alpha first esriFloatLeading"\x3e\r\n        \x3ch1\x3e${i18n.agsNoAccount}\x3c/h1\x3e\r\n        \x3cdiv id\x3d"trial" style\x3d"display:none;"\x3e\r\n          \x3cdiv style\x3d\'font-weight:bold;margin:20px 0 5px 0\'\x3e${i18n.agsTrial}\x3c/div\x3e\r\n          \x3cp\x3e${i18n.agsSubscriptionInfo}\x3c/p\x3e\r\n          \x3cbutton dojoAttachPoint\x3d"_trialUrl" style\x3d"margin:10px 0 10px 0;" class\x3d"calcite blue" type\x3d"button" dojotype\x3d"dijit.form.Button"\x3e\r\n            ${i18n.ags30DayTrial}\r\n          \x3c/button\x3e\r\n          \x3cdiv style\x3d\'font-weight:bold;margin:20px 0 5px 0\'\x3e${i18n.agsNoTrial}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!--\x3cdiv\x3e--\x3e\r\n          \x3c!--\x3cdiv style\x3d"margin:10px 0 10px 0;"\x3e${i18n.agsCreatePersonalMsg}\x3c/div\x3e--\x3e\r\n          \x3c!--\x3cdiv style\x3d\'margin:15px 0 5px 0\'\x3e${i18n.agsHavePersonal}\x3c/div\x3e--\x3e\r\n          \x3c!--\x3cbutton dojoAttachPoint\x3d"_agoRegister" style\x3d"margin:10px 0 10px 0;" type\x3d"button" class\x3d"calcite light" dojotype\x3d"dijit.form.Button"\x3e--\x3e\r\n            \x3c!--${i18n.agsRegisterPersonalBtn}--\x3e\r\n          \x3c!--\x3c/button\x3e--\x3e\r\n        \x3c!--\x3c/div\x3e--\x3e\r\n        \x3cdiv\x3e\r\n          \x3cdiv style\x3d\'margin:15px 0 15px 0\'\x3e${i18n.createPublicAccountMsg}\x3c/div\x3e\r\n          \x3cbutton dojoAttachPoint\x3d"_agoCreate" class\x3d"calcite light" style\x3d"margin:10px 0 10px 0;" type\x3d"button" dojotype\x3d"dijit.form.Button"\x3e\r\n            ${i18n.agsCreatePersonalBtn}\r\n          \x3c/button\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"rightAgo" class\x3d"grid_7 omega last esriFloatTrailing"\x3e\r\n        \x3c!--\x3ch1 id\x3d"rightPanelTitle"\x3e${i18n.SignIn}\x3c/h1\x3e--\x3e\r\n        \x3cp id\x3d\'rightPanelSubTitle\'\x3e\x3c/p\x3e\r\n        \x3cbr/\x3e\r\n        \x3cdiv id\x3d"sign-in-error"\x3e\r\n        \x3c/div\x3e\r\n        \x3ciframe dojoattachpoint\x3d"_iFrame" id\x3d"oAuthFrame" scrolling\x3d"no" style\x3d"display:none; border:0" marginheight\x3d"0" marginwidth\x3d"0" frameborder\x3d"0" width\x3d"400" height\x3d"500"\x3e\r\n           Your browser does not support iframes.\r\n        \x3c/iframe\x3e\r\n        \x3ctable id\x3d"authTable" style\x3d"width:100%;display:none"\x3e\r\n          \x3ctbody\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd class\x3d"grid_2 alpha"\x3e\r\n                \x3clabel for\x3d"user_username" style\x3d"padding:0;margin:0;"\x3e${i18n.userLabel}\x3c/label\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv id\x3d"user_username" name\x3d"user_username" class\x3d"grid_5 omega" style\x3d"padding:2px;margin:0;" dojotype\x3d"dijit.form.TextBox" trim\x3d"true"\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr height\x3d"5"\x3e\r\n              \x3ctd colspan\x3d"2" height\x3d"5"\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd class\x3d"grid_2 alpha"\x3e\r\n                \x3clabel for\x3d"user_password" style\x3d"padding:0;margin:0;"\x3e${i18n.passwordLabel}\x3c/label\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv id\x3d"user_password" name\x3d"user_password" class\x3d"grid_5 omega" style\x3d"padding:2px;margin:0;" type\x3d"password" dojotype\x3d"dijit.form.TextBox"trim\x3d"true"\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv id\x3d"signInHelp"\x3e\r\n                  \x3ca id\x3d"signInHelpLink"\x3e${i18n.needHelpSign}\x3c/a\x3e\r\n                  \x3cbr/\x3e\r\n                  \x3cbr/\x3e\r\n                \x3c/div\x3e\r\n                \x3cinput id\x3d"remember-me" style\x3d"height:24px;margin:auto;" value\x3d"off" dojotype\x3d"dijit.form.CheckBox" /\x3e\r\n                \x3clabel id\x3d"remember-me-label" for\x3d"remember-me"\x3e${i18n.rememberMe}\x3c/label\x3e\r\n                \x3cdiv id\x3d"invitationReminder" style\x3d"display:none; font-size:0.9em;"\x3e\x3c/div\x3e\r\n                \x3cbr/\x3e\r\n                \x3cbr/\x3e\r\n                \x3cbutton id\x3d"button_sign_in" style\x3d"margin:0;padding:0;" type\x3d"submit" dojotype\x3d"dijit.form.Button"\x3e\r\n                  ${i18n.SignIn}\r\n                \x3c/button\x3e\r\n                \x3cimg dojoAttachPoint\x3d\'_keyImgicon\' class\x3d"esriLeadingMargin1" style\x3d"position:absolute;"/\x3e\r\n                \x3cbr/\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n          \x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv style\x3d"width:100%; clear:both;"\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
baseClass:"esriSignIn",activationId:null,defaultOrgTitleText:null,invitation:null,orgName:null,usr:null,pwd:null,exp:null,i18n:null,postMixInProperties:function(){this.inherited(arguments);this.i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").signInWidget);b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").signInForm);b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").troubleshoot);
this.defaultOrgTitleText=this.i18n.myAccount;this._viewTrialLink=["us"];this._oAuthInfo={url:esriGeowConfig.restBaseUrl+"oauth2/authorize",clientId:"arcgisonline",redirectUri:esriGeowConfig.baseUrl+"postsignin.html",parent:window.location.protocol+"//"+window.location.host,expiration:20160,locale:b.locale}},postCreate:function(){b.attr(this._keyImgicon,"src",this._util.relativeToExplicitUrl("images/goldKey.gif"));!1===esriGeowConfig.showSignUp&&(b.style(b.byId("left"),"display","none"),b.style(b.byId("leftAgo"),
"display","none"),b.removeClass(b.byId("right"),"esriFloatTrailing"),b.addClass(b.byId("right"),"esriFloatLeading"),esriGeowConfig.isRightToLeft?b.style(b.byId("right"),"paddingRight","30%"):b.style(b.byId("right"),"paddingLeft","30%"));esriGeowConfig.portalName&&b.style(this._keyImgicon,"display","none");this._account.getSelf(b.hitch(this,function(a){!esriGeowConfig.self||!esriGeowConfig.self.supportsOAuth?(esri.show(b.byId("authTable")),esri.hide(b.byId("oAuthFrame"))):(window.onOAuthSignIn=b.hitch(this,
"onOAuthSignIn"),window.checkOAuthResponse=b.hitch(this,"checkOAuthResponse"),window.onOAuthSignInError=b.hitch(this,"onOAuthSignInError"),this._oAuthInfo.url=arcgisonline.sharing.util.getSecureUrl(this._oAuthInfo.url),this._authorizeUrl=esri.substitute(this._oAuthInfo,"${url}?client_id\x3d${clientId}\x26redirect_uri\x3d${redirectUri}\x26response_type\x3dtoken\x26display\x3diframe\x26parent\x3d${parent}\x26expiration\x3d${expiration}\x26locale\x3d${locale}"),b.attr(this._iFrame,"src",this._authorizeUrl),
esri.hide(b.byId("authTable")),esri.show(b.byId("oAuthFrame")));document.referrer&&-1<document.referrer.indexOf("https://")?(this.redirectUrl=this.redirectUrl.replace("http:","https:"),this.orgRedirectUrl=this.orgRedirectUrl.replace("http:","https:"),this.setupRedirectUrl=this.setupRedirectUrl.replace("http:","https:")):(this.redirectUrl=this.redirectUrl.replace("https:","http:"),this.orgRedirectUrl=this.orgRedirectUrl.replace("https:","http:"),this.setupRedirectUrl=this.setupRedirectUrl.replace("https:",
"http:"))}))},startup:function(){this.inherited(arguments);b.mixin(this,b.queryToObject(window.location.search.slice(1)));if(this.returnUrl){var a=window.location.host.split(".").slice(-2).join(".")+"/";-1===this.returnUrl.indexOf(a)&&(-1===this.returnUrl.indexOf("arcgis.com/")&&-1===this.returnUrl.indexOf("esri.com/"))&&(this.returnUrl=null)}esri.config.defaults.io.proxyUrl=esriGeowConfig.proxyServer;this._svcUrl=esriGeowConfig.restBaseUrl+(esriGeowConfig.restBaseUrl.lastIndexOf("/")===esriGeowConfig.restBaseUrl.length-
1?"":"/");this._communityUri=this._svcUrl+"community/";this._usersUri=this._communityUri+"users/";this._accountsUri=this._svcUrl+"portals/";this._geoIPUri=this._svcUrl+"geoip.jsp";this._optinlistUri=document.location.protocol+"//"+document.location.hostname+"/about/js/optinlist.js";this._requestParams={f:"json"};a=esriGeowConfig.portalName?esriGeowConfig.portalName:this.i18n.arcgisOnline;if(this.activationcode){b.style(b.byId("left"),"display",!1===esriGeowConfig.showSignUp?"none":"block");b.create("h1",
{id:"rightPanelTitle",innerHTML:b.string.substitute(this.i18n.alreadyUsingPortal,{portalName:a})},"rightPanelSubTitle","before");b.byId("rightPanelSubTitle").innerHTML=b.string.substitute(this.i18n.alreadyUserSignIn,{portalName:a});var c="\x3ch1\x3e"+this.i18n.activationTitle+"\x3c/h1\x3e";b.byId("organizationTitle").innerHTML=c;b.style(b.byId("organizationTitle"),{display:"block",textAlign:"left",marginBottom:"20px"});b.addClass(b.byId("left"),"invitation");b.style(b.byId("left"),"width","47%");
b.byId("leftPanelTitle").innerHTML=b.string.substitute(this.i18n.firstTimeWith,{portalName:a});b.byId("not_a_member_msg")&&(a="\x3cspan\x3e"+b.string.substitute(this.i18n.userNewToPortal,{portalName:a})+"\x3c/span\x3e",a+="\x3cbr/\x3e\x3cbr /\x3e\x3cspan\x3e\x3cbutton id\x3d'registerLink' class\x3d'calcite light' type\x3d'button' dojotype\x3d'dijit.form.Button'\x3e"+this.i18n.createNewAccount+"\x3c/button\x3e\x3c/span\x3e",c=b.byId("invitationReminder"),b.create("strong",{innerHTML:"\x3cbr/\x3ePlease note\x3cbr/\x3e"},
c),b.create("em",{innerHTML:this.i18n.signInExistingNewOrg},c),b.style(c,"display","block"),b.byId("not_a_member_msg").innerHTML=a,b.parser.parse(b.byId("not_a_member_msg")),b.connect(b.byId("registerLink"),"onclick",b.hitch(this,function(a){a=esriGeowConfig.createAccount;var b=this.activationcode;b&&(a+="?activationcode\x3d"+b);document.location=a})))}else this.invitation?(b.style(b.byId("left"),"display",!1===esriGeowConfig.showSignUp?"none":"block"),this._fetchInvitation().then(b.hitch(this,function(a){a.account&&
a.account.name&&(this.orgName=a.account.name,b.byId("organizationTitle").innerHTML="\x3ch1\x3e"+b.string.substitute(this.i18n.useOption,{orgName:this.orgName})+"\x3c/h1\x3e",b.style(b.byId("organizationTitle"),"display","block"),a=b.byId("invitationReminder"),b.create("strong",{innerHTML:"\x3cbr/\x3e\x3cbr/\x3e\x3cbr/\x3e"+this.i18n.pleaseNote+"\x3cbr/\x3e"},a),b.create("em",{innerHTML:b.string.substitute(this.i18n.signInExisting,{orgName:this.orgName})},a),b.style(a,"display","block"))})),b.addClass(b.byId("left"),
"invitation"),b.byId("leftPanelTitle").innerHTML=b.string.substitute(this.i18n.firstTimeWith,{portalName:a}),b.addClass(b.byId("leftPanelTitle"),"subtitle"),b.style(b.byId("left"),"width","47%"),b.addClass(b.byId("rightAgo"),"invitation"),b.create("h1",{id:"rightPanelTitle",innerHTML:b.string.substitute(this.i18n.alreadyUsingPortal,{portalName:a})},rightAgo,"first"),b.addClass(b.byId("rightPanelTitle"),"subtitle"),b.place(b.create("br"),b.byId("rightPanelTitle"),"after"),b.byId("not_a_member_msg")&&
(a="\x3cbr/\x3e\x3cbr/\x3e",esriGeowConfig.account_registration&&0<esriGeowConfig.account_registration.length?a+="\x3cspan\x3e\x3ca id\x3d'registerLink' class\x3d\"calcite light\"\x3e"+this.i18n.createAccount+"\x3c/a\x3e\x3c/span\x3e":esriGeowConfig.accountApi&&0<esriGeowConfig.accountApi.length&&(a+="\x3cspan\x3e\x3cbutton id\x3d'registerLink' class\x3d\"calcite light\" type\x3d'button' dojotype\x3d'dijit.form.Button'\x3e"+this.i18n.createNewAccount+"\x3c/button\x3e\x3c/span\x3e"),b.byId("not_a_member_msg").innerHTML=
a,b.parser.parse(b.byId("not_a_member_msg")),esriGeowConfig.accountApi&&0<esriGeowConfig.accountApi.length&&b.connect(b.byId("registerLink"),"onclick",b.hitch(this,function(a){a=esriGeowConfig.createAccount;this.invitation&&(a+="?invitation\x3d"+this.invitation);document.location=a})))):this._account.getSelf(b.hitch(this,function(a){function c(){var a=esriGeowConfig.signup,b=this.returnUrl;null!=b?a+="?returnUrl\x3d"+b:document.referrer&&-1<document.referrer.indexOf("https://")&&(a+="?returnUrl\x3d"+
esriGeowConfig.baseUrl.replace("http:","https:")+"user.html?newUser\x3dtrue");document.location=a}function d(){document.location=esriGeowConfig.createAccount}if(a.urlKey||"singletenant"===a.portalMode){if(b.byId("not_a_member_msg")){var e="\x3cspan\x3e"+b.string.substitute(this.i18n.signinMsg,{account:esriGeowConfig.esriGlobalAccount?esriGeowConfig.esriGlobalAccount:this.i18n.esriGlobalAccount,portal:esriGeowConfig.portalName?esriGeowConfig.portalName:this.i18n.arcgisOnline})+"\x3c/span\x3e",e=e+
"     \x3cbr /\x3e\x3cbr /\x3e"+("    \x3cbutton id\x3d'registerButton' type\x3d'button' dojotype\x3d'dijit.form.Button'\x3e"+b.string.substitute(this.i18n.registerAccount,{account:esriGeowConfig.esriGlobalAccount?esriGeowConfig.esriGlobalAccount:this.i18n.esriGlobalAccount})+"\x3c/button\x3e");esriGeowConfig.account_registration&&0<esriGeowConfig.account_registration.length?(e+="     \x3cbr /\x3e\x3cbr /\x3e",e+="    \x3cspan style\x3d'line-height:20px;'\x3e\x3cb\x3e"+b.string.substitute(this.i18n.dontHaveAccount,
{account:esriGeowConfig.esriGlobalAccount?esriGeowConfig.esriGlobalAccount:this.i18n.esriGlobalAccount})+"\x3c/b\x3e\x3c/span\x3e",e+="     \x3cbr /\x3e",e+="    \x3cspan\x3e\x3ca id\x3d'registerLink'\x3e"+this.i18n.createAccount+"\x3c/a\x3e\x3c/span\x3e "):esriGeowConfig.accountApi&&0<esriGeowConfig.accountApi.length&&(e+="     \x3cbr /\x3e\x3cbr /\x3e",e+="    \x3cspan style\x3d'line-height:20px;'\x3e\x3cb\x3e"+b.string.substitute(this.i18n.dontHaveAccount,{account:esriGeowConfig.esriGlobalAccount?
esriGeowConfig.esriGlobalAccount:this.i18n.esriGlobalAccount})+"\x3c/b\x3e\x3c/span\x3e",e+="     \x3cbr /\x3e",e+="    \x3cspan\x3e\x3cbutton id\x3d'registerLink' type\x3d'button' dojotype\x3d'dijit.form.Button'\x3e"+this.i18n.createAccount+"\x3c/button\x3e\x3c/span\x3e ");b.byId("not_a_member_msg").innerHTML=e;b.parser.parse(b.byId("not_a_member_msg"));b.connect(h.byId("registerButton"),"onClick",c);esriGeowConfig.accountApi&&0<esriGeowConfig.accountApi.length&&b.connect(h.byId("registerLink"),
"onClick",d);b.style(b.byId("left"),"display","singletenant"!==a.portalMode||!1===esriGeowConfig.showSignUp?"none":"block");"singletenant"!==a.portalMode&&a.name&&(b.byId("signInTitle").innerHTML=this.i18n.signInTo+" "+a.name)}}else b.connect(this._agoRegister,"onClick",c),esriGeowConfig.accountApi&&0<esriGeowConfig.accountApi.length&&b.connect(this._agoCreate,"onClick",d),b.connect(this._trialUrl,"onClick",function(){window.location="http://"+document.location.hostname+"/about/free-trial.html?origin\x3darcgis"}),
b.style("trial","display","block"),b.style("left","display","none"),b.style("leftAgo","display",!1===esriGeowConfig.showSignUp?"none":"block")}));this.loadConnections();a=this.returnUrl||null;null!=a&&(this.redirectUrl=a);if(c=this.error){var d={code:c};if("400"!==c&&"403"!==c)this._showError(d);else if(a&&-1!==a.indexOf("viewer.html"))if("400"==c)this._account.getSelf(b.hitch(this,function(a){-1<document.location.href.indexOf(a.customBaseUrl)&&this.signInError({code:400})}));else return"";else this._showError(d)}b.byId("registerLink")&&
(b.byId("registerLink").href=esriGeowConfig.account_registration);b.byId("signInHelpLink").href="troubleshoot.html";this.checkCookieSupport();try{setTimeout("dojo.byId('user_username').focus()",350)}catch(e){}},checkCookieSupport:function(){if(10>=b.isIE){b.cookie("test","enabled",{path:"/"});var a=b.cookie("test");b.cookie("test",null,{expires:-1});"enabled"!==a&&arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorTitle,message:this.i18n.error.cookiesRequired})}else b.cookie.isSupported()||
arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorTitle,message:this.i18n.error.cookiesRequired})},loadConnections:function(){b.connect(h.byId("sign-in-form"),"onSubmit",this,"signIn")},signIn:function(a){a.preventDefault();-1!==b.byId("sign-in-error").className.indexOf("error")&&(b.byId("sign-in-error").innerHTML="\x26nbsp;",b.removeClass("sign-in-error","error"));if(!1===this.validateForm())return!1;h.byId("button_sign_in").set("disabled",!0);
h.byId("button_sign_in").set("label",this.i18n.signingIn);this._user=this._user||{};b.mixin(this._user,{username:b.byId("user_username").value,password:b.byId("user_password").value,expiration:b.byId("remember-me").checked?esriGeowConfig.longTokenExpiration:esriGeowConfig.tokenExpiration});this._signin().then(b.hitch(this,"onSignIn"))},onOAuthSignIn:function(){-1!==b.byId("sign-in-error").className.indexOf("error")&&(b.byId("sign-in-error").innerHTML="\x26nbsp;",b.removeClass("sign-in-error","error"))},
checkOAuthResponse:function(a){a=new b._Url(a);a=a.fragment?b.queryToObject(a.fragment):null;a.error?(b.addClass("sign-in-error","error"),b.attr(b.byId("sign-in-error"),"innerHTML",a.error_description+"\x3cbr/\x3e\x3cbr/\x3e"),b.attr(this._iFrame,"src",this._authorizeUrl)):(this._user=b.mixin(this._user,b.mixin(a,{token:a.access_token})),this._geow.signInHandler2(this._user).then(b.hitch(this,"onSignIn")))},onOAuthSignInError:function(a){a&&a.length&&-1!==a[0].toLowerCase().indexOf("not a member")?
(b.addClass("sign-in-error","error"),b.attr(b.byId("sign-in-error"),"innerHTML",this.i18n.error.notOrgMember+"\x3cbr/\x3e\x3cbr/\x3e")):a&&a.length&&(-1!==a[0].toLowerCase().indexOf("too many invalid logins")||-1!==a[0].toLowerCase().indexOf("too many invalid attempts"))?(b.addClass("sign-in-error","error"),b.attr(b.byId("sign-in-error"),"innerHTML",this.i18n.error.tooManyAttempts+"\x3cbr/\x3e\x3cbr/\x3e")):a&&a.length&&-1!==a[0].toLowerCase().indexOf("invalid verification code")?(b.addClass("sign-in-error",
"error"),b.attr(b.byId("sign-in-error"),"innerHTML",this.i18n.error.invalidVerificationCode+"\x3cbr/\x3e\x3cbr/\x3e")):this.signInError({code:400})},onSignIn:function(a,c){this._user=b.mixin(this._user||{},a);this._requestParams.token=this._user.token;this.invitation?this._fetchInvitation().then(b.hitch(this,"onFetchInvitation")):this.activationcode?this._activateAccount().then(b.hitch(this,"_setCookie")).then(b.hitch(this,"routeUser")):(this.returnUrl=!a||!a.noSecurityQuestion?this.returnUrl:esriGeowConfig.baseUrl.replace("http:",
"https:")+"user.html?requireSecurity\x3dtrue",this.routeUser())},_setCookie:function(a){return this._geow.signInHandler2({username:this._user.username,token:this._user.token,expires_in:this._user.expires_in})},onFetchInvitation:function(a,c){var d;if(a&&a.code&&a.message&&(403===a.code||"IdentityManagerBase.1"===a.code)){var e="\x3cp\x3e"+this.i18n.emailInvitation+"\x3c/p\x3e\x3cp\x3e"+this.i18n.clickOkInstructions+"\x3c/p\x3e";d=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();
d.onOkClick=b.hitch(this,function(a,b){a.hide();this.routeUser()},d);d.show({title:this.i18n.notice,message:e})}else if(a&&a.code&&a.message&&400===a.code)e="\x3cp\x3e"+this.i18n.invitationUsedMsg+"\x3c/p\x3e\x3cp\x3e"+this.i18n.clickOkSignIn+"\x3c/p\x3e",d=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),d.onOkClick=b.hitch(this,function(a,b){a.hide();window.location=esriGeowConfig.baseUrl.replace("http:","https:")+esriGeowConfig.signin},d),d.show({title:this.i18n.notice,
message:e});else if(a&&a.id&&a.id===this.invitation){var f="\x3cp\x3e"+b.string.substitute(this.i18n.membershipPending,{account:"\x3cstrong\x3e"+a.account.name+"\x3c/strong\x3e"})+"\x3c/p\x3e";d="\x3cp\x3e\x3cstrong\x3e"+b.string.substitute(this.i18n.ByAcceptingInvite,{account:a.account.name})+"\x3c/strong\x3e\x3c/p\x3e\x3cp\x3e\x3cul\x3e\x3cli\x3e"+b.string.substitute(this.i18n.itemsMsg,{beginStrong:"\x3cstrong\x3e",endStrong:"\x3c/strong\x3e"})+"\x3c/li\x3e\x3cli\x3e"+this.i18n.accountManagedMsg+
"\x3c/li\x3e\x3cli\x3e"+this.i18n.leaveOrganization+"\x3c/li\x3e\x3c/ul\x3e\x3c/p\x3e\x3cp\x3e"+b.string.substitute(this.i18n.currentOrNewAccount,{account:a.account.name})+"\x3c/p\x3e";e={title:this.i18n.notice,message:d,choiceOneTitle:this.i18n.useCurrentAccount,choiceTwoTitle:this.i18n.createNewOne};e.choiceOneHandler=b.hitch(this,function(c){a.mustApprove&&!0===a.mustApprove?(c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),c.onOkClick=b.hitch(this,function(a){a.hide();
this._acceptInvitation().then(b.hitch(this,"_setCookie")).then(b.hitch(this,"routeUser"))},c),c.show({title:this.i18n.notice,message:f})):this._acceptInvitation().then(b.hitch(this,"_setCookie")).then(b.hitch(this,"routeUser"))});e.choiceTwoHandler=b.hitch(this,function(a){a=arcgisonline.sharing.util.getSecureUrl();this._geow.signout(a+esriGeowConfig.createAccount+"?invitation\x3d"+this.invitation)});d=arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance();d.show(e)}else this.routeUser()},
onInvitationAcceptedError:function(a,c){var d,e;if(a&&a.code&&a.message&&500===a.code&&"Invitation has already been accepted."===b.trim(a.message)){var f="\x3cp\x3e"+this.i18n.acceptedInvite+"\x3c/p\x3e\x3cp\x3e"+this.i18n.clickOk+"\x3c/p\x3e";d=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();d.onOkClick=b.hitch(this,function(a,b){a.hide();window.location=e?esriGeowConfig.baseUrl.replace("http:","https:")+esriGeowConfig.signin:esriGeowConfig.baseUrl.replace("http:","https:")+
esriGeowConfig.signin+"?invitation\x3d"+this.invitation+"\x26org\x3d"+this.orgName},d);d.show({title:this.i18n.notice,message:f})}else console.log(a),d=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),d.onOkClick=b.hitch(this,function(a,b){a.hide();window.location=e?esriGeowConfig.baseUrl.replace("http:","https:")+esriGeowConfig.signin:esriGeowConfig.baseUrl.replace("http:","https:")+esriGeowConfig.signin+"?invitation\x3d"+this.invitation+"\x26org\x3d"+this.orgName},d),
a.code&&a.message?("User already member of an account."===a.message&&(e=!0,a.message=this.i18n.userAnotheOrg),d.show({title:this.i18n.unableJoin,message:a.message})):d.show({title:this.i18n.unableJoin,message:this.i18n.problemJoingOrg})},onActivationAcceptedError:function(a){a.details=a.details&&a.details.length?b.filter(a.details,"return item !\x3d\x3d null"):null;a.details&&a.details.length&&(a.details=a.details.join("\x3cbr /\x3e"),a.message=a.message?a.message+"\x3cbr /\x3e"+a.details:a.details);
a=b.mixin(b.mixin({},this.i18n.errors.error),a);var c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();c.onOkClick=b.hitch(this,function(a){a.hide();this.routeUser()},c);c.show(a)},routeUser:function(){var a=this.returnUrl,c=esriGeowConfig.baseUrl+esriGeowConfig.signin;a&&-1<a.indexOf(c)&&(a=null);c=this._user=arcgisonline.sharing.util.getUser();!esriGeowConfig.isDebug&&c&&c.accountId?this._fetchSelf().then(b.hitch(this,"routeOrg")):window.location=a?a:this.redirectUrl},
routeOrg:function(a,c){var d=this._user,e=this.returnUrl,f=esriGeowConfig.baseUrl+esriGeowConfig.signin;e&&-1<e.indexOf(f)&&(e=null);var f=this._organization=a||{},g=f.allSSL,l;if(e)d=this._util.parseUrl(e).host,a&&(!a.isPortal&&d===a.portalHostname)&&(f.urlKey&&f.customBaseUrl&&-1===d.indexOf(f.urlKey+"."+f.customBaseUrl))&&(l=this._util.getCookie("esri_auth"),this._geow.setAuthCookie(l),e=e.replace(d,f.urlKey+"."+f.customBaseUrl),e=g?e.replace("http:","https:"):e,e=this._util.getBridgeUrl(e,l)),
window.location=g?e.replace("http:","https:"):e;else{var m;if(f.urlKey&&f.customBaseUrl){e=(g?"https:":"http:")+"//"+f.urlKey+"."+f.customBaseUrl;l=null;-1===window.location.host.indexOf(f.urlKey+"."+f.customBaseUrl)&&(l=this._util.getCookie("esri_auth"));var e=(g?"https:":"http:")+"//"+f.urlKey+"."+f.customBaseUrl,k=esriGeowConfig.baseUrl.indexOf(location.host),e=-1<k?e+(esriGeowConfig.baseUrl.substring(k+location.host.length)+("account_admin"===d.role?"organization.html":"index.html")):g?this.redirectUrl.replace("http:",
"https:"):this.redirectUrl.replace("https:","http:");l&&(this._geow.setAuthCookie(l),e=this._util.getBridgeUrl(e,l));m=g?e.replace("http:","https:"):e}else m="account_admin"===d.role&&!f.urlKey?g?this.setupRedirectUrl.replace("http:","https:"):this.setupRedirectUrl.replace("https:","http:"):"account_admin"===d.role&&this.activationcode?g?this.orgRedirectUrl.replace("http:","https:"):this.orgRedirectUrl.replace("https:","http:"):g?this.redirectUrl.replace("http:","https:"):this.redirectUrl.replace("https:",
"http:");if(f.subscriptionInfo&&"active"!==f.subscriptionInfo.state){var h=arcgisonline.sharing.dijit.dialog.SubscriptionStatusDlg.prototype.statics.getInstance();h.onOkClick=b.hitch(this,function(){h.hide();window.location=m});h.show(f.subscriptionInfo)}else window.location=m}},validateForm:function(){var a=h.byId("user_username").get("value"),b=h.byId("user_password").get("value"),d=null;if((null==a||""==a)&&(null==b||""==b))d=this.i18n.error.userNamePassRqd;else if(null==a||""==a)d=this.i18n.error.usernameRqd;
else if(null==b||""==b)d=this.i18n.error.passRqd;if(null==d)return!0;this._showError({message:d});return!1},signInError:function(a,c){h.byId("button_sign_in").set("disabled",!1);h.byId("button_sign_in").set("label",this.i18n.SignIn);if(void 0!==a&&null!==a&&""!==a)switch(b.addClass("sign-in-error","error"),a.code){case 400:var d="\x3cb style\x3d'font-size:1.2em;line-height:30px;'\x3e"+b.string.substitute(this.i18n.unableSignIn,{portalName:esriGeowConfig.portalName?esriGeowConfig.portalName:this.i18n.arcgisOnline})+
"\x3c/b\x3e\x3cbr/\x3e",d=d+'\x3cspan style\x3d"color:#000000;"\x3e'+(this.i18n.usernamePasswordSpell+'\x26nbsp;\x26nbsp;\x3ca href\x3d"troubleshoot.html"\x3e'+this.i18n.troubleshootTitle+"\x3c/a\x3e"),d=d+"\x3c/span\x3e";this._showError({title:"Sign in error",message:d});try{b.byId("user_username").focus()}catch(e){}break;default:this._showError({message:this.i18n.error.signinError})}},_activateAccount:function(){return this._request(this._accountsUri+"activate",{code:this.activationcode},{usePost:!0,
errBack:b.hitch(this,"onActivationAcceptedError")})},_fetchSelf:function(){esriGeowConfig.self=null;return this._request(this._accountsUri+"self?culture\x3d"+b.locale).then(function(a){return esriGeowConfig.self=a})},_fetchInvitation:function(){return this._request(this._communityUri+"invitations/"+this.invitation,null,{errBack:b.hitch(this,"onFetchInvitation")})},_acceptInvitation:function(){return this._request(this._communityUri+"invitations/"+this.invitation+"/accept",null,{usePost:!0,errBack:b.hitch(this,
"onInvitationAcceptedError")})},_signin:function(){var a=new b.Deferred;this._geow.signin({username:this._user.username,password:this._user.password,expiration:this._user.expiration},b.hitch(this,"_resolveDfd",a),b.hitch(this,"signInError"));return a},_resolveDfd:function(a,b){if(b.error)throw this.signInError(b.error),b.error;a.resolve(b)},_request:function(a,c,d){c=b.mixin(c||{},this._requestParams);return this._util.request({url:a,content:c},d||{}).then(b.hitch(this,function(a){return a.error?
d.errBack?d.errBack(a.error):this._showError(a.error):a}),b.hitch(this,function(a){d&&d.errBack?d.errBack(a):this._showError(a);throw a;}))},_showError:function(a){a=a.error||a||{};a.code=a.code||0;var c=a.code;a=this.i18n.errors[a.code]||a;a.details=a.details&&a.details.length?b.filter(a.details,"return item !\x3d\x3d null"):null;a.details&&a.details.length&&(a.details=a.details.join("\x3cbr /\x3e"),a.message=a.message?a.message+"\x3cbr /\x3e"+a.details:a.details);var d=b.mixin(b.mixin({},this.i18n.errors.error),
a);this._account.getSelf(b.hitch(this,function(a){if(("400"===c||"403"===c)&&-1<document.location.href.indexOf(a.customBaseUrl)&&-1===document.location.href.indexOf("error\x3d403"))d.message=this.i18n.error.notOrgMember;b.addClass("sign-in-error","error");b.attr(b.byId("sign-in-error"),"innerHTML",d.message+"\x3cbr/\x3e\x3cbr/\x3e")}));return!0}})})},"dijit/form/Button":function(){define("require dojo/_base/declare dojo/dom-class dojo/has dojo/_base/kernel dojo/_base/lang dojo/ready ./_FormWidget ./_ButtonMixin dojo/text!./templates/Button.html ../a11yclick".split(" "),
function(h,b,k,a,c,d,e,f,g,l){a("dijit-legacy-requires")&&e(0,function(){h(["dijit/form/DropDownButton","dijit/form/ComboButton","dijit/form/ToggleButton"])});e=b("dijit.form.Button"+(a("dojo-bidi")?"_NoBidi":""),[f,g],{showLabel:!0,iconClass:"dijitNoIcon",_setIconClassAttr:{node:"iconNode",type:"class"},baseClass:"dijitButton",templateString:l,_setValueAttr:"valueNode",_setNameAttr:function(a){this.valueNode&&this.valueNode.setAttribute("name",a)},_fillContent:function(a){if(a&&(!this.params||!("label"in
this.params)))if(a=d.trim(a.innerHTML))this.label=a},_setShowLabelAttr:function(a){this.containerNode&&k.toggle(this.containerNode,"dijitDisplayNone",!a);this._set("showLabel",a)},setLabel:function(a){c.deprecated("dijit.form.Button.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",a)},_setLabelAttr:function(a){this.inherited(arguments);!this.showLabel&&!("title"in this.params)&&(this.titleNode.title=d.trim(this.containerNode.innerText||this.containerNode.textContent||
""))}});a("dojo-bidi")&&(e=b("dijit.form.Button",e,{_setLabelAttr:function(a){this.inherited(arguments);this.titleNode.title&&this.applyTextDir(this.titleNode,this.titleNode.title)},_setTextDirAttr:function(a){this._created&&this.textDir!=a&&(this._set("textDir",a),this._setLabelAttr(this.label))}}));return e})},"dijit/_WidgetBase":function(){define("require dojo/_base/array dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/_base/kernel dojo/_base/lang dojo/on dojo/ready dojo/Stateful dojo/topic dojo/_base/window ./Destroyable dojo/has!dojo-bidi?./_BidiMixin ./registry".split(" "),
function(h,b,k,a,c,d,e,f,g,l,m,n,q,p,s,t,u,x,w,v,y,A,z){function G(a){return function(b){f[b?"set":"remove"](this.domNode,a,b);this._set(a,b)}}q.add("dijit-legacy-requires",!p.isAsync);q.add("dojo-bidi",!1);q("dijit-legacy-requires")&&u(0,function(){h(["dijit/_base/manager"])});var F={};a=d("dijit._WidgetBase",[x,y],{id:"",_setIdAttr:"domNode",lang:"",_setLangAttr:G("lang"),dir:"",_setDirAttr:G("dir"),"class":"",_setClassAttr:{node:"domNode",type:"class"},_setTypeAttr:null,style:"",title:"",tooltip:"",
baseClass:"",srcNodeRef:null,domNode:null,containerNode:null,ownerDocument:null,_setOwnerDocumentAttr:function(a){this._set("ownerDocument",a)},attributeMap:{},_blankGif:a.blankGif||h.toUrl("dojo/resources/blank.gif"),_introspect:function(){var a=this.constructor;if(!a._setterAttrs){var b=a.prototype,c=a._setterAttrs=[],a=a._onMap={},d;for(d in b.attributeMap)c.push(d);for(d in b)/^on/.test(d)&&(a[d.substring(2).toLowerCase()]=d),/^_set[A-Z](.*)Attr$/.test(d)&&(d=d.charAt(4).toLowerCase()+d.substr(5,
d.length-9),(!b.attributeMap||!(d in b.attributeMap))&&c.push(d))}},postscript:function(a,b){this.create(a,b)},create:function(a,b){this._introspect();this.srcNodeRef=e.byId(b);this._connects=[];this._supportingWidgets=[];this.srcNodeRef&&"string"==typeof this.srcNodeRef.id&&(this.id=this.srcNodeRef.id);a&&(this.params=a,s.mixin(this,a));this.postMixInProperties();this.id||(this.id=z.getUniqueId(this.declaredClass.replace(/\./g,"_")),this.params&&delete this.params.id);this.ownerDocument=this.ownerDocument||
(this.srcNodeRef?this.srcNodeRef.ownerDocument:document);this.ownerDocumentBody=v.body(this.ownerDocument);z.add(this);this.buildRendering();var c;if(this.domNode){this._applyAttributes();var d=this.srcNodeRef;d&&(d.parentNode&&this.domNode!==d)&&(d.parentNode.replaceChild(this.domNode,d),c=!0);this.domNode.setAttribute("widgetId",this.id)}this.postCreate();c&&delete this.srcNodeRef;this._created=!0},_applyAttributes:function(){var a={},c;for(c in this.params||{})a[c]=this._get(c);b.forEach(this.constructor._setterAttrs,
function(b){if(!(b in a)){var c=this._get(b);c&&this.set(b,c)}},this);for(c in a)this.set(c,a[c])},postMixInProperties:function(){},buildRendering:function(){this.domNode||(this.domNode=this.srcNodeRef||this.ownerDocument.createElement("div"));if(this.baseClass){var a=this.baseClass.split(" ");this.isLeftToRight()||(a=a.concat(b.map(a,function(a){return a+"Rtl"})));g.add(this.domNode,a)}},postCreate:function(){},startup:function(){this._started||(this._started=!0,b.forEach(this.getChildren(),function(a){!a._started&&
(!a._destroyed&&s.isFunction(a.startup))&&(a.startup(),a._started=!0)}))},destroyRecursive:function(a){this._beingDestroyed=!0;this.destroyDescendants(a);this.destroy(a)},destroy:function(a){function c(b){b.destroyRecursive?b.destroyRecursive(a):b.destroy&&b.destroy(a)}this._beingDestroyed=!0;this.uninitialize();b.forEach(this._connects,s.hitch(this,"disconnect"));b.forEach(this._supportingWidgets,c);this.domNode&&b.forEach(z.findWidgets(this.domNode,this.containerNode),c);this.destroyRendering(a);
z.remove(this.id);this._destroyed=!0},destroyRendering:function(a){this.bgIframe&&(this.bgIframe.destroy(a),delete this.bgIframe);this.domNode&&(a?f.remove(this.domNode,"widgetId"):l.destroy(this.domNode),delete this.domNode);this.srcNodeRef&&(a||l.destroy(this.srcNodeRef),delete this.srcNodeRef)},destroyDescendants:function(a){b.forEach(this.getChildren(),function(b){b.destroyRecursive&&b.destroyRecursive(a)})},uninitialize:function(){return!1},_setStyleAttr:function(a){var b=this.domNode;s.isObject(a)?
n.set(b,a):b.style.cssText=b.style.cssText?b.style.cssText+("; "+a):a;this._set("style",a)},_attrToDom:function(a,c,d){d=3<=arguments.length?d:this.attributeMap[a];b.forEach(s.isArray(d)?d:[d],function(b){var d=this[b.node||b||"domNode"];switch(b.type||"attribute"){case "attribute":s.isFunction(c)&&(c=s.hitch(this,c));b=b.attribute?b.attribute:/^on[A-Z][a-zA-Z]*$/.test(a)?a.toLowerCase():a;d.tagName?f.set(d,b,c):d.set(b,c);break;case "innerText":d.innerHTML="";d.appendChild(this.ownerDocument.createTextNode(c));
break;case "innerHTML":d.innerHTML=c;break;case "class":g.replace(d,c,this[a])}},this)},get:function(a){var b=this._getAttrNames(a);return this[b.g]?this[b.g]():this._get(a)},set:function(a,b){if("object"===typeof a){for(var c in a)this.set(c,a[c]);return this}c=this._getAttrNames(a);var d=this[c.s];if(s.isFunction(d))var e=d.apply(this,Array.prototype.slice.call(arguments,1));else{var d=this.focusNode&&!s.isFunction(this.focusNode)?"focusNode":"domNode",f=this[d]&&this[d].tagName,g;if(g=f)if(!(g=
F[f])){g=this[d];var l={},m;for(m in g)l[m.toLowerCase()]=!0;g=F[f]=l}m=g;c=a in this.attributeMap?this.attributeMap[a]:c.s in this?this[c.s]:m&&c.l in m&&"function"!=typeof b||/^aria-|^data-|^role$/.test(a)?d:null;null!=c&&this._attrToDom(a,b,c);this._set(a,b)}return e||this},_attrPairNames:{},_getAttrNames:function(a){var b=this._attrPairNames;if(b[a])return b[a];var c=a.replace(/^[a-z]|-[a-zA-Z]/g,function(a){return a.charAt(a.length-1).toUpperCase()});return b[a]={n:a+"Node",s:"_set"+c+"Attr",
g:"_get"+c+"Attr",l:c.toLowerCase()}},_set:function(a,b){var c=this[a];this[a]=b;if(this._created&&!(c===b||c!==c&&b!==b))this._watchCallbacks&&this._watchCallbacks(a,c,b),this.emit("attrmodified-"+a,{detail:{prevValue:c,newValue:b}})},_get:function(a){return this[a]},emit:function(a,b,c){b=b||{};void 0===b.bubbles&&(b.bubbles=!0);void 0===b.cancelable&&(b.cancelable=!0);b.detail||(b.detail={});b.detail.widget=this;var d,e=this["on"+a];e&&(d=e.apply(this,c?c:[b]));this._started&&!this._beingDestroyed&&
t.emit(this.domNode,a.toLowerCase(),b);return d},on:function(a,b){var c=this._onMap(a);return c?k.after(this,c,b,!0):this.own(t(this.domNode,a,b))[0]},_onMap:function(a){var b=this.constructor,c=b._onMap;if(!c){var c=b._onMap={},d;for(d in b.prototype)/^on/.test(d)&&(c[d.replace(/^on/,"").toLowerCase()]=d)}return c["string"==typeof a&&a.toLowerCase()]},toString:function(){return"[Widget "+this.declaredClass+", "+(this.id||"NO ID")+"]"},getChildren:function(){return this.containerNode?z.findWidgets(this.containerNode):
[]},getParent:function(){return z.getEnclosingWidget(this.domNode.parentNode)},connect:function(a,b,d){return this.own(c.connect(a,b,this,d))[0]},disconnect:function(a){a.remove()},subscribe:function(a,b){return this.own(w.subscribe(a,s.hitch(this,b)))[0]},unsubscribe:function(a){a.remove()},isLeftToRight:function(){return this.dir?"ltr"==this.dir.toLowerCase():m.isBodyLtr(this.ownerDocument)},isFocusable:function(){return this.focus&&"none"!=n.get(this.domNode,"display")},placeAt:function(a,b){var c=
!a.tagName&&z.byId(a);c&&c.addChild&&(!b||"number"===typeof b)?c.addChild(this,b):(c=c&&"domNode"in c?c.containerNode&&!/after|before|replace/.test(b||"")?c.containerNode:c.domNode:e.byId(a,this.ownerDocument),l.place(this.domNode,c,b),!this._started&&(this.getParent()||{})._started&&this.startup());return this},defer:function(a,b){var c=setTimeout(s.hitch(this,function(){c&&(c=null,this._destroyed||s.hitch(this,a)())}),b||0);return{remove:function(){c&&(clearTimeout(c),c=null);return null}}}});q("dojo-bidi")&&
a.extend(A);return a})},"dijit/form/Form":function(){define("dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/sniff ../_Widget ../_TemplatedMixin ./_FormMixin ../layout/_ContentPaneResizeMixin".split(" "),function(h,b,k,a,c,d,e,f){return h("dijit.form.Form",[c,d,e,f],{name:"",action:"",method:"",encType:"","accept-charset":"",accept:"",target:"",templateString:"\x3cform data-dojo-attach-point\x3d'containerNode' data-dojo-attach-event\x3d'onreset:_onReset,onsubmit:_onSubmit' ${!nameAttrSetting}\x3e\x3c/form\x3e",
postMixInProperties:function(){this.nameAttrSetting=this.name?"name\x3d'"+this.name+"'":"";this.inherited(arguments)},execute:function(){},onExecute:function(){},_setEncTypeAttr:function(c){b.set(this.domNode,"encType",c);a("ie")&&(this.domNode.encoding=c);this._set("encType",c)},reset:function(a){var b={returnValue:!0,preventDefault:function(){this.returnValue=!1},stopPropagation:function(){},currentTarget:a?a.target:this.domNode,target:a?a.target:this.domNode};!1!==this.onReset(b)&&b.returnValue&&
this.inherited(arguments,[])},onReset:function(){return!0},_onReset:function(a){this.reset(a);a.stopPropagation();a.preventDefault();return!1},_onSubmit:function(a){var b=this.constructor.prototype;if(this.execute!=b.execute||this.onExecute!=b.onExecute)k.deprecated("dijit.form.Form:execute()/onExecute() are deprecated. Use onSubmit() instead.","","2.0"),this.onExecute(),this.execute(this.getValues());!1===this.onSubmit(a)&&(a.stopPropagation(),a.preventDefault())},onSubmit:function(){return this.isValid()},
submit:function(){!1!==this.onSubmit()&&this.containerNode.submit()}})})},"arcgisonline/gallery":function(){define(["dijit","dojo","dojox","dojo/require!dojo/date/locale,esri/utils,arcgisonline/sharing/dijit/Gallery,arcgisonline/sharing/util,arcgisonline/sharing/dijit/views,dojo/parser,dijit/_base,dijit/form/DropDownButton,dijit/form/ComboButton,dijit/form/ToggleButton,dijit/form/RadioButton,dijit/PopupMenuItem"],function(h,b,k){b.provide("arcgisonline.gallery");b.require("dojo.date.locale");b.require("esri.utils");
b.require("arcgisonline.sharing.dijit.Gallery");b.require("arcgisonline.sharing.util");b.require("arcgisonline.sharing.dijit.views");b.require("dojo.parser");b.require("dijit._base");b.require("dijit.form.DropDownButton");b.require("dijit.form.ComboButton");b.require("dijit.form.ToggleButton");b.require("dijit.form.RadioButton");b.require("dijit.PopupMenuItem")})},"dojo/store/Memory":function(){define(["../_base/declare","./util/QueryResults","./util/SimpleQueryEngine"],function(h,b,k){return h("dojo.store.Memory",
null,{constructor:function(a){for(var b in a)this[b]=a[b];this.setData(this.data||[])},data:null,idProperty:"id",index:null,queryEngine:k,get:function(a){return this.data[this.index[a]]},getIdentity:function(a){return a[this.idProperty]},put:function(a,b){var d=this.data,e=this.index,f=this.idProperty,f=a[f]=b&&"id"in b?b.id:f in a?a[f]:Math.random();if(f in e){if(b&&!1===b.overwrite)throw Error("Object already exists");d[e[f]]=a}else e[f]=d.push(a)-1;return f},add:function(a,b){(b=b||{}).overwrite=
!1;return this.put(a,b)},remove:function(a){var b=this.index,d=this.data;if(a in b)return d.splice(b[a],1),this.setData(d),!0},query:function(a,c){return b(this.queryEngine(a,c)(this.data))},setData:function(a){a.items?(this.idProperty=a.identifier||this.idProperty,a=this.data=a.items):this.data=a;this.index={};for(var b=0,d=a.length;b<d;b++)this.index[a[b][this.idProperty]]=b}})})},"esri/IdentityManagerDialog":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/config dojo/_base/Deferred dojo/_base/lang dojo/has dojo/dom-attr dojo/keys dijit/registry dijit/Dialog ./kernel ./lang ./domUtils ./Credential ./IdentityManagerBase dojo/i18n!./nls/jsapi dojo/query dijit/form/Button dijit/form/ValidationTextBox".split(" "),
function(h,b,k,a,c,d,e,f,g,l,m,n,q,p,s,t){b=b([s],{declaredClass:"esri.IdentityManager",_eventMap:{"dialog-cancel":["info"]},constructor:function(a){c.mixin(this,a);this.registerConnectEvents()},_dialogContent:"\x3cdiv class\x3d'dijitDialogPaneContentArea'\x3e\x3cdiv style\x3d'padding-bottom: 5px; word-wrap: break-word;'\x3e${info}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriErrorMsg' style\x3d'display: none; color: white; background-color: #D46464; text-align: center; padding-top: 3px; padding-bottom: 3px;'\x3e${invalidUser}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3ctable style\x3d'width: 100%;'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel\x3e${lblUser}\x3c/label\x3e\x3cbr/\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' data-dojo-props\x3d'type:\"text\", \"class\":\"esriIdUser\", required:true, trim:true, style:\"width: 100%;\", autocapitalize:\"none\", autocorrect:\"off\", spellcheck:false' /\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel\x3e${lblPwd}\x3c/label\x3e\x3cbr/\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' data-dojo-props\x3d'type:\"password\", \"class\":\"esriIdPwd\", required:true, style:\"width: 100%;\"' /\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitDialogPaneActionBar'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdSubmit\"'\x3e${lblOk}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdCancel\"'\x3e${lblCancel}\x3c/button\x3e\x3c/div\x3e",
onDialogCreate:function(){},onDialogCancel:function(){},signIn:function(b,c,d){this._nls||(this._nls=t.identity);this._loginDialog||(this._loginDialog=this.dialog=this._createLoginDialog(),this.onDialogCreate());var f=this._loginDialog,g=d&&d.error,l=d&&d.token,m=new a(function(){f.onCancel()});if(f.open)return b=Error("BUSY"),b.code="IdentityManager.1",b.log=k.isDebug,m.errback(b),m;q.hide(f.errMsg_);g&&(403==g.code&&l)&&(e.set(f.errMsg_,"innerHTML",this._nls.forbidden),q.show(f.errMsg_));f.dfd_=
m;f.serverInfo_=c;f.resUrl_=b;f.admin_=d&&d.isAdmin;e.set(f.resLink_,{title:b,innerHTML:"("+(this.getResourceName(b)||this._nls.lblItem)+")"});e.set(f.serverLink_,{title:c.server,innerHTML:(-1!==c.server.toLowerCase().indexOf("arcgis.com")?"ArcGIS Online":c.server)+" "});f.txtPwd_.set("value","");f.show();return m},_createLoginDialog:function(){var a=this._nls,b=n.substitute(a,this._dialogContent),b=n.substitute({resource:"\x3cspan class\x3d'resLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e",
server:"\x3cspan class\x3d'serverLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e"},b),c=new l({title:a.title,content:b,"class":"esriSignInDialog",style:"width: 18em;",esriIdMgr_:this,keypressed_:function(a){a.charOrCode===f.ENTER&&this.execute_()},execute_:function(){var b=this.txtUser_.get("value"),c=this.txtPwd_.get("value"),d=this.dfd_,f=this;if(b&&c){this.btnSubmit_.set("label",a.lblSigning);var g=m.id.findCredential(f.resUrl_,b),k=function(c){f.btnSubmit_.set("label",a.lblOk);f.btnSubmit_.set("disabled",
!1);q.hide(f.errMsg_);f.hide();l._DialogLevelManager.hide(f);var e=f.serverInfo_;f.dfd_=f.serverInfo_=f.generateDfd_=f.resUrl_=null;var m,k,h=g,s;c&&(m=c.token,k=n.isDefined(c.expires)?Number(c.expires):null,s=!!c.ssl,h?(h.userId=b,h.token=m,h.expires=k,h.validity=c.validity,h.ssl=s,h.creationTime=(new Date).getTime()):h=new p({userId:b,server:e.server,token:m,expires:k,ssl:s,isAdmin:f.admin_,validity:c.validity}));d.callback(h)};g&&!g._enqueued?k():(f.btnSubmit_.set("disabled",!0),f.generateDfd_=
m.id.generateToken(this.serverInfo_,{username:b,password:c},{isAdmin:this.admin_}).addCallback(k).addErrback(function(b){f.btnSubmit_.set("disabled",!1);f.generateDfd_=null;f.btnSubmit_.set("label",a.lblOk);e.set(f.errMsg_,"innerHTML",b&&b.code?a.invalidUser:a.noAuthService);q.show(f.errMsg_)}))}},cancel_:function(){c.generateDfd_&&c.generateDfd_.cancel();var a=c.dfd_,b=c.resUrl_,d=c.serverInfo_;c.btnSubmit_.set("disabled",!1);c.dfd_=c.serverInfo_=c.generateDfd_=c.resUrl_=null;q.hide(c.errMsg_);l._DialogLevelManager.hide(c);
c.esriIdMgr_.onDialogCancel({resourceUrl:b,serverInfo:d});b=Error("ABORTED");b.code="IdentityManager.2";b.log=k.isDebug;a.errback(b)}}),b=c.domNode;c.txtUser_=g.byNode(h.query(".esriIdUser",b)[0]);c.txtPwd_=g.byNode(h.query(".esriIdPwd",b)[0]);c.btnSubmit_=g.byNode(h.query(".esriIdSubmit",b)[0]);c.btnCancel_=g.byNode(h.query(".esriIdCancel",b)[0]);c.resLink_=h.query(".resLink",b)[0];c.serverLink_=h.query(".serverLink",b)[0];c.errMsg_=h.query(".esriErrorMsg",b)[0];c.connect(c.txtUser_,"onKeyPress",
c.keypressed_);c.connect(c.txtPwd_,"onKeyPress",c.keypressed_);c.connect(c.btnSubmit_,"onClick",c.execute_);c.connect(c.btnCancel_,"onClick",c.onCancel);c.connect(c,"onCancel",c.cancel_);return c}});d("extend-esri")&&(m.IdentityManagerDialog=m.IdentityManager=b);return b})},"dijit/_base/sniff":function(){define(["dojo/uacss"],function(){})},"dojo/request/iframe":function(){define("module require ./watch ./util ./handlers ../_base/lang ../io-query ../query ../has ../dom ../dom-construct ../_base/window ../NodeList-dom".split(" "),
function(h,b,k,a,c,d,e,f,g,l,m,n){function q(a){return!this.isFulfilled()}function p(a){return!!this._finished}function s(a,b){if(!b)try{var e=a.options,g=u.doc(u._frame),l=e.handleAs;if("html"!==l){if("xml"===l)if("html"===g.documentElement.tagName.toLowerCase()){f("a",g.documentElement).orphan();var m=g.documentElement.innerText,m=m.replace(/>\s+</g,"\x3e\x3c");a.text=d.trim(m)}else a.data=g;else a.text=g.getElementsByTagName("textarea")[0].value;c(a)}else a.data=g}catch(k){b=k}b?this.reject(b):
this._finished?this.resolve(a):this.reject(Error("Invalid dojo/request/iframe request state"))}function t(a){this._callNext()}function u(b,c,d){var e=a.parseArgs(b,a.deepCreate(v,c),!0);b=e.url;c=e.options;if("GET"!==c.method&&"POST"!==c.method)throw Error(c.method+" not supported by dojo/request/iframe");u._frame||(u._frame=u.create(u._iframeName,w+"();"));b=a.deferred(e,null,q,p,s,t);b._callNext=function(){this._calledNext||(this._calledNext=!0,u._currentDfd=null,u._fireNextRequest())};b._legacy=
d;u._dfdQueue.push(b);u._fireNextRequest();k(b);return d?b:b.promise}var x=h.id.replace(/[\/\.\-]/g,"_"),w=x+"_onload";n.global[w]||(n.global[w]=function(){var a=u._currentDfd;if(a){var b=l.byId(a.response.options.form)||a._tmpForm;if(b){for(var c=a._contentToClean,d=0;d<c.length;d++)for(var e=c[d],f=0;f<b.childNodes.length;f++){var g=b.childNodes[f];if(g.name===e){m.destroy(g);break}}a._originalAction&&b.setAttribute("action",a._originalAction);a._originalMethod&&(b.setAttribute("method",a._originalMethod),
b.method=a._originalMethod);a._originalTarget&&(b.setAttribute("target",a._originalTarget),b.target=a._originalTarget)}a._tmpForm&&(m.destroy(a._tmpForm),delete a._tmpForm);a._finished=!0}else u._fireNextRequest()});var v={method:"POST"};u.create=function(a,c,d){if(n.global[a])return n.global[a];if(n.global.frames[a])return n.global.frames[a];d||(g("config-useXDomain")&&!g("config-dojoBlankHtmlUrl")&&console.warn("dojo/request/iframe: When using cross-domain Dojo builds, please save dojo/resources/blank.html to your domain and set dojoConfig.dojoBlankHtmlUrl to the path on your domain to blank.html"),
d=g("config-dojoBlankHtmlUrl")||b.toUrl("dojo/resources/blank.html"));c=m.place('\x3ciframe id\x3d"'+a+'" name\x3d"'+a+'" src\x3d"'+d+'" onload\x3d"'+c+'" style\x3d"position: absolute; left: 1px; top: 1px; height: 1px; width: 1px; visibility: hidden"\x3e',n.body());return n.global[a]=c};u.doc=function(a){if(a.contentDocument)return a.contentDocument;var b=a.name;if(b){var c=n.doc.getElementsByTagName("iframe");if(a.document&&c[b].contentWindow&&c[b].contentWindow.document)return c[b].contentWindow.document;
if(n.doc.frames[b]&&n.doc.frames[b].document)return n.doc.frames[b].document}return null};u.setSrc=function(a,b,c){a=n.global.frames[a.name];a.contentWindow&&(a=a.contentWindow);try{c?a.location.replace(b):a.location=b}catch(d){console.log("dojo/request/iframe.setSrc: ",d)}};u._iframeName=x+"_IoIframe";u._notifyStart=function(){};u._dfdQueue=[];u._currentDfd=null;u._fireNextRequest=function(){var b;try{if(!u._currentDfd&&u._dfdQueue.length){do b=u._currentDfd=u._dfdQueue.shift();while(b&&(b.canceled||
b.isCanceled&&b.isCanceled())&&u._dfdQueue.length);if(!b||b.canceled||b.isCanceled&&b.isCanceled())u._currentDfd=null;else{var c=b.response,f=c.options,g=b._contentToClean=[],k=l.byId(f.form),h=a.notify,p=f.data||null,s;!b._legacy&&"POST"===f.method&&!k?k=b._tmpForm=m.create("form",{name:x+"_form",style:{position:"absolute",top:"-1000px",left:"-1000px"}},n.body()):"GET"===f.method&&(k&&-1<c.url.indexOf("?"))&&(s=c.url.slice(c.url.indexOf("?")+1),p=d.mixin(e.queryToObject(s),p));if(k){if(!b._legacy){var t=
k;do t=t.parentNode;while(t&&t!==n.doc.documentElement);t||(k.style.position="absolute",k.style.left="-1000px",k.style.top="-1000px",n.body().appendChild(k));k.name||(k.name=x+"_form")}if(p){var t=function(a,b){m.create("input",{type:"hidden",name:a,value:b},k);g.push(a)},q;for(q in p){var w=p[q];if(d.isArray(w)&&1<w.length)for(s=0;s<w.length;s++)t(q,w[s]);else k[q]?k[q].value=w:t(q,w)}}var v=k.getAttributeNode("action"),H=k.getAttributeNode("method"),D=k.getAttributeNode("target");c.url&&(b._originalAction=
v?v.value:null,v?v.value=c.url:k.setAttribute("action",c.url));if(b._legacy){if(!H||!H.value)H?H.value=f.method:k.setAttribute("method",f.method)}else b._originalMethod=H?H.value:null,H?H.value=f.method:k.setAttribute("method",f.method);b._originalTarget=D?D.value:null;D?D.value=u._iframeName:k.setAttribute("target",u._iframeName);k.target=u._iframeName;h&&h.emit("send",c,b.promise.cancel);u._notifyStart(c);k.submit()}else f="",c.options.data&&(f=c.options.data,"string"!==typeof f&&(f=e.objectToQuery(f))),
t=c.url+(-1<c.url.indexOf("?")?"\x26":"?")+f,h&&h.emit("send",c,b.promise.cancel),u._notifyStart(c),u.setSrc(u._frame,t,!0)}}}catch(J){b.reject(J)}};a.addCommonMethods(u,["GET","POST"]);return u})},"dijit/Toolbar":function(){define("require dojo/_base/declare dojo/has dojo/keys dojo/ready ./_Widget ./_KeyNavContainer ./_TemplatedMixin".split(" "),function(h,b,k,a,c,d,e,f){k("dijit-legacy-requires")&&c(0,function(){h(["dijit/ToolbarSeparator"])});return b("dijit.Toolbar",[d,f,e],{templateString:'\x3cdiv class\x3d"dijit" role\x3d"toolbar" tabIndex\x3d"${tabIndex}" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e',
baseClass:"dijitToolbar",_onLeftArrow:function(){this.focusPrev()},_onRightArrow:function(){this.focusNext()}})})},"dojo/fx/easing":function(){define(["../_base/lang"],function(h){var b={linear:function(b){return b},quadIn:function(b){return Math.pow(b,2)},quadOut:function(b){return-1*b*(b-2)},quadInOut:function(b){b*=2;return 1>b?Math.pow(b,2)/2:-1*(--b*(b-2)-1)/2},cubicIn:function(b){return Math.pow(b,3)},cubicOut:function(b){return Math.pow(b-1,3)+1},cubicInOut:function(b){b*=2;return 1>b?Math.pow(b,
3)/2:(Math.pow(b-2,3)+2)/2},quartIn:function(b){return Math.pow(b,4)},quartOut:function(b){return-1*(Math.pow(b-1,4)-1)},quartInOut:function(b){b*=2;return 1>b?Math.pow(b,4)/2:-0.5*(Math.pow(b-2,4)-2)},quintIn:function(b){return Math.pow(b,5)},quintOut:function(b){return Math.pow(b-1,5)+1},quintInOut:function(b){b*=2;return 1>b?Math.pow(b,5)/2:(Math.pow(b-2,5)+2)/2},sineIn:function(b){return-1*Math.cos(b*(Math.PI/2))+1},sineOut:function(b){return Math.sin(b*(Math.PI/2))},sineInOut:function(b){return-1*
(Math.cos(Math.PI*b)-1)/2},expoIn:function(b){return 0==b?0:Math.pow(2,10*(b-1))},expoOut:function(b){return 1==b?1:-1*Math.pow(2,-10*b)+1},expoInOut:function(b){if(0==b)return 0;if(1==b)return 1;b*=2;if(1>b)return Math.pow(2,10*(b-1))/2;--b;return(-1*Math.pow(2,-10*b)+2)/2},circIn:function(b){return-1*(Math.sqrt(1-Math.pow(b,2))-1)},circOut:function(b){return Math.sqrt(1-Math.pow(b-1,2))},circInOut:function(b){b*=2;return 1>b?-0.5*(Math.sqrt(1-Math.pow(b,2))-1):0.5*(Math.sqrt(1-Math.pow(b-2,2))+
1)},backIn:function(b){return Math.pow(b,2)*(2.70158*b-1.70158)},backOut:function(b){b-=1;return Math.pow(b,2)*(2.70158*b+1.70158)+1},backInOut:function(b){b*=2;if(1>b)return Math.pow(b,2)*(3.5949095*b-2.5949095)/2;b-=2;return(Math.pow(b,2)*(3.5949095*b+2.5949095)+2)/2},elasticIn:function(b){if(0==b||1==b)return b;b-=1;return-1*Math.pow(2,10*b)*Math.sin((b-0.075)*2*Math.PI/0.3)},elasticOut:function(b){return 0==b||1==b?b:Math.pow(2,-10*b)*Math.sin((b-0.075)*2*Math.PI/0.3)+1},elasticInOut:function(b){if(0==
b)return 0;b*=2;if(2==b)return 1;var a=0.3*1.5,c=a/4;if(1>b)return b-=1,-0.5*Math.pow(2,10*b)*Math.sin((b-c)*2*Math.PI/a);b-=1;return 0.5*Math.pow(2,-10*b)*Math.sin((b-c)*2*Math.PI/a)+1},bounceIn:function(k){return 1-b.bounceOut(1-k)},bounceOut:function(b){b<1/2.75?b=7.5625*Math.pow(b,2):b<2/2.75?b=7.5625*Math.pow(b-1.5/2.75,2)+0.75:b<2.5/2.75?(b-=2.25/2.75,b=7.5625*Math.pow(b,2)+0.9375):(b-=2.625/2.75,b=7.5625*Math.pow(b,2)+0.984375);return b},bounceInOut:function(k){return 0.5>k?b.bounceIn(2*k)/
2:b.bounceOut(2*k-1)/2+0.5}};h.setObject("dojo.fx.easing",b);return b})},"arcgisonline/sharing/dijit/dialog/ChoiceDlg":function(){define(["dijit","dojo","dojox","dojo/require!dijit/Dialog,dijit/_Widget,dijit/_Templated"],function(h,b,k){b.provide("arcgisonline.sharing.dijit.dialog.ChoiceDlg");b.require("dijit.Dialog");b.require("dijit._Widget");b.require("dijit._Templated");b.declare("arcgisonline.sharing.dijit.dialog.ChoiceDlg",[h._Widget,h._Templated],{widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContent"\x3e\r\n  \x3cdiv dojoType\x3d"dijit.Dialog" id\x3d"choice-dialog" title\x3d"${i18n.choiceDlgTitle}" execute\x3d"" style\x3d"width:400px;"\x3e\r\n    \x3cdiv style\x3d"margin-top:1em;" id\x3d"choice-dialog-content"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"clear: both; margin-top: 2em;" class\x3d"esriFloatTrailing"\x3e\r\n      \x3cbutton dojoAttachPoint\x3d"choiceOneButton" dojoAttachEvent\x3d"onClick:onChoiceOneClick" class\x3d"jevent primary" type\x3d"button" dojoType\x3d"dijit.form.Button"\x3e\r\n        ${i18n.ok}\r\n      \x3c/button\x3e\r\n      \x3cbutton dojoAttachPoint\x3d"choiceTwoButton" dojoAttachEvent\x3d"onClick:onChoiceTwoClick" class\x3d"jevent cancel" type\x3d"button" dojoType\x3d"dijit.form.Button"\x3e\r\n        ${i18n.cancel}\r\n      \x3c/button\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"clear:both; float:none; height: 0;"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
title:"Notice",message:"",choiceOneButton:null,choiceOneTitle:"OK",choiceOneHandler:null,choiceTwoButton:null,choiceTwoTitle:"Cancel",choiceTwoHandler:null,choiceOneConn:null,choiceTwoConn:null,i18n:null,statics:{_instance:null,getInstance:function(){null===this._instance&&(this._instance=new arcgisonline.sharing.dijit.dialog.ChoiceDlg);return this._instance}},postCreate:function(){this.loadConnections()},postMixInProperties:function(){this.inherited(arguments);this.i18n=b.i18n.getLocalization("arcgisonline",
"arcgisonline").common;b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").choiceDlg)},show:function(a){a.title&&""!==a.title&&(this.title=a.title);a.message&&""!==a.message&&(this.message=a.message);a.choiceOneTitle&&""!==a.choiceOneTitle&&(this.choiceOneTitle=a.choiceOneTitle);a.choiceTwoTitle&&""!==a.choiceTwoTitle&&(this.choiceTwoTitle=a.choiceTwoTitle);a.choiceOneHandler&&(this.choiceOneHandler=a.choiceOneHandler,this.setChoiceOneHandler());a.choiceTwoHandler&&(this.choiceTwoHandler=
a.choiceTwoHandler,this.setChoiceTwoHandler());b.byId("choice-dialog_title").innerHTML=this.title;b.byId("choice-dialog-content").innerHTML=this.message;this.choiceOneButton.set("label",this.choiceOneTitle);this.choiceTwoButton.set("label",this.choiceTwoTitle);h.byId("choice-dialog").show()},setChoiceOneHandler:function(){esri.isDefined(this.choiceOneConn)&&b.disconnect(this.choiceOneConn);this.choiceOneConn=b.connect(this.choiceOneButton,"onClick",b.hitch(this,function(){this.hide();this.choiceOneHandler()}))},
setChoiceTwoHandler:function(){esri.isDefined(this.choiceTwoConn)&&b.disconnect(this.choiceTwoConn);this.choiceTwoConn=b.connect(this.choiceTwoButton,"onClick",b.hitch(this,function(){this.hide();this.choiceTwoHandler()}))},loadConnections:function(){b.query(".jevent").connect("onclick",function(a){a.preventDefault()})},onChoiceOneClick:function(a){this.hide()},onChoiceTwoClick:function(a){this.hide()},hide:function(){h.byId("choice-dialog").hide()}})})},"dojo/regexp":function(){define(["./_base/kernel",
"./_base/lang"],function(h,b){var k={};b.setObject("dojo.regexp",k);k.escapeString=function(a,b){return a.replace(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,function(a){return b&&-1!=b.indexOf(a)?a:"\\"+a})};k.buildGroupRE=function(a,b,d){if(!(a instanceof Array))return b(a);for(var e=[],f=0;f<a.length;f++)e.push(b(a[f]));return k.group(e.join("|"),d)};k.group=function(a,b){return"("+(b?"?:":"")+a+")"};return k})},"dojox/rpc/Service":function(){define("dojox/rpc/Service",["dojo","dojox","dojo/AdapterRegistry",
"dojo/_base/url"],function(h,b){h.declare("dojox.rpc.Service",null,{constructor:function(b,a){function c(a){a._baseUrl=new h._Url(h.isBrowser?location.href:h.config.baseUrl,d||".")+"";e._smd=a;for(var b in e._smd.services){a=b.split(".");for(var c=e,f=0;f<a.length-1;f++)c=c[a[f]]||(c[a[f]]={});c[a[a.length-1]]=e._generateService(b,e._smd.services[b])}}var d,e=this;if(b)if(h.isString(b)||b instanceof h._Url){d=b instanceof h._Url?b+"":b;var f=h._getText(d);if(f)c(h.fromJson(f));else throw Error("Unable to load SMD from "+
b);}else c(b);this._options=a?a:{};this._requestId=0},_generateService:function(k,a){if(this[a])throw Error("WARNING: "+k+" already exists for service. Unable to generate function");a.name=k;var c=h.hitch(this,"_executeMethod",a),d=b.rpc.transportRegistry.match(a.transport||this._smd.transport);d.getExecutor&&(c=d.getExecutor(c,a,this));d=a.returns||(a._schema={});d._service=c;c.servicePath="/"+k+"/";c._schema=d;c.id=b.rpc.Service._nextId++;return c},_getRequest:function(k,a){var c=this._smd,d=b.rpc.envelopeRegistry.match(k.envelope||
c.envelope||"NONE"),e=(k.parameters||[]).concat(c.parameters||[]);if(d.namedParams){if(1==a.length&&h.isObject(a[0]))a=a[0];else{for(var f={},g=0;g<k.parameters.length;g++)if("undefined"!=typeof a[g]||!k.parameters[g].optional)f[k.parameters[g].name]=a[g];a=f}if(k.strictParameters||c.strictParameters)for(g in a){for(var f=!1,l=0;l<e.length;l++)e[l].name==g&&(f=!0);f||delete a[g]}for(g=0;g<e.length;g++)if(f=e[g],!f.optional&&f.name&&!a[f.name])if(f["default"])a[f.name]=f["default"];else if(!(f.name in
a))throw Error("Required parameter "+f.name+" was omitted");}else e&&(e[0]&&e[0].name&&1==a.length&&h.isObject(a[0]))&&(a=!1===d.namedParams?b.rpc.toOrdered(e,a):a[0]);h.isObject(this._options)&&(a=h.mixin(a,this._options));e=k._schema||k.returns;g=d.serialize.apply(this,[c,k,a]);g._envDef=d;return h.mixin(g,{sync:b.rpc._sync,contentType:k.contentType||c.contentType||g.contentType,headers:k.headers||c.headers||g.headers||{},target:g.target||b.rpc.getTarget(c,k),transport:k.transport||c.transport||
g.transport,envelope:k.envelope||c.envelope||g.envelope,timeout:k.timeout||c.timeout,callbackParamName:k.callbackParamName||c.callbackParamName,rpcObjectParamName:k.rpcObjectParamName||c.rpcObjectParamName,schema:e,handleAs:g.handleAs||"auto",preventCache:k.preventCache||c.preventCache,frameDoc:this._options.frameDoc||void 0})},_executeMethod:function(k){var a=[],c;for(c=1;c<arguments.length;c++)a.push(arguments[c]);var d=this._getRequest(k,a),a=b.rpc.transportRegistry.match(d.transport).fire(d);
a.addBoth(function(a){return d._envDef.deserialize.call(this,a)});return a}});b.rpc.getTarget=function(b,a){var c=b._baseUrl;b.target&&(c=new h._Url(c,b.target)+"");a.target&&(c=new h._Url(c,a.target)+"");return c};b.rpc.toOrdered=function(b,a){if(h.isArray(a))return a;for(var c=[],d=0;d<b.length;d++)c.push(a[b[d].name]);return c};b.rpc.transportRegistry=new h.AdapterRegistry(!0);b.rpc.envelopeRegistry=new h.AdapterRegistry(!0);b.rpc.envelopeRegistry.register("URL",function(b){return"URL"==b},{serialize:function(b,
a,c){return{data:h.objectToQuery(c),transport:"POST"}},deserialize:function(b){return b},namedParams:!0});b.rpc.envelopeRegistry.register("JSON",function(b){return"JSON"==b},{serialize:function(b,a,c){return{data:h.toJson(c),handleAs:"json",contentType:"application/json"}},deserialize:function(b){return b}});b.rpc.envelopeRegistry.register("PATH",function(b){return"PATH"==b},{serialize:function(k,a,c){var d;k=b.rpc.getTarget(k,a);if(h.isArray(c))for(d=0;d<c.length;d++)k+="/"+c[d];else for(d in c)k+=
"/"+d+"/"+c[d];return{data:"",target:k}},deserialize:function(b){return b}});b.rpc.transportRegistry.register("POST",function(b){return"POST"==b},{fire:function(b){b.url=b.target;b.postData=b.data;return h.rawXhrPost(b)}});b.rpc.transportRegistry.register("GET",function(b){return"GET"==b},{fire:function(b){b.url=b.target+(b.data?"?"+(b.rpcObjectParamName?b.rpcObjectParamName+"\x3d":"")+b.data:"");return h.xhrGet(b)}});b.rpc.transportRegistry.register("JSONP",function(b){return"JSONP"==b},{fire:function(b){b.url=
b.target+(-1==b.target.indexOf("?")?"?":"\x26")+(b.rpcObjectParamName?b.rpcObjectParamName+"\x3d":"")+b.data;b.callbackParamName=b.callbackParamName||"callback";return h.io.script.get(b)}});b.rpc.Service._nextId=1;h._contentHandlers.auto=function(b){var a=h._contentHandlers,c=b.getResponseHeader("Content-Type");return!c?a.text(b):c.match(/\/.*json/)?a.json(b):c.match(/\/javascript/)?a.javascript(b):c.match(/\/xml/)?a.xml(b):a.text(b)};return b.rpc.Service})},"dijit/form/ComboBox":function(){define(["dojo/_base/declare",
"./ValidationTextBox","./ComboBoxMixin"],function(h,b,k){return h("dijit.form.ComboBox",[b,k],{})})},"dijit/form/_FormMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/on dojo/window".split(" "),function(h,b,k,a,c,d){return b("dijit.form._FormMixin",null,{state:"",_getDescendantFormWidgets:function(a){var b=[];h.forEach(a||this.getChildren(),function(a){"value"in a?b.push(a):b=b.concat(this._getDescendantFormWidgets(a.getChildren()))},this);return b},
reset:function(){h.forEach(this._getDescendantFormWidgets(),function(a){a.reset&&a.reset()})},validate:function(){var a=!1;return h.every(h.map(this._getDescendantFormWidgets(),function(b){b._hasBeenBlurred=!0;var c=b.disabled||!b.validate||b.validate();!c&&!a&&(d.scrollIntoView(b.containerNode||b.domNode),b.focus(),a=!0);return c}),function(a){return a})},setValues:function(a){k.deprecated(this.declaredClass+"::setValues() is deprecated. Use set('value', val) instead.","","2.0");return this.set("value",
a)},_setValueAttr:function(b){var c={};h.forEach(this._getDescendantFormWidgets(),function(a){a.name&&(c[a.name]||(c[a.name]=[])).push(a)});for(var d in c)if(c.hasOwnProperty(d)){var l=c[d],m=a.getObject(d,!1,b);void 0!==m&&(m=[].concat(m),"boolean"==typeof l[0].checked?h.forEach(l,function(a){a.set("value",-1!=h.indexOf(m,a._get("value")))}):l[0].multiple?l[0].set("value",m):h.forEach(l,function(a,b){a.set("value",m[b])}))}},getValues:function(){k.deprecated(this.declaredClass+"::getValues() is deprecated. Use get('value') instead.",
"","2.0");return this.get("value")},_getValueAttr:function(){var b={};h.forEach(this._getDescendantFormWidgets(),function(c){var d=c.name;if(d&&!c.disabled){var l=c.get("value");"boolean"==typeof c.checked?/Radio/.test(c.declaredClass)?!1!==l?a.setObject(d,l,b):(l=a.getObject(d,!1,b),void 0===l&&a.setObject(d,null,b)):(c=a.getObject(d,!1,b),c||(c=[],a.setObject(d,c,b)),!1!==l&&c.push(l)):(c=a.getObject(d,!1,b),"undefined"!=typeof c?a.isArray(c)?c.push(l):a.setObject(d,[c,l],b):a.setObject(d,l,b))}});
return b},isValid:function(){return""==this.state},onValidStateChange:function(){},_getState:function(){var a=h.map(this._descendants,function(a){return a.get("state")||""});return 0<=h.indexOf(a,"Error")?"Error":0<=h.indexOf(a,"Incomplete")?"Incomplete":""},disconnectChildren:function(){},connectChildren:function(a){this._descendants=this._getDescendantFormWidgets();h.forEach(this._descendants,function(a){a._started||a.startup()});a||this._onChildChange()},_onChildChange:function(a){(!a||"state"==
a||"disabled"==a)&&this._set("state",this._getState());if(!a||"value"==a||"disabled"==a||"checked"==a)this._onChangeDelayTimer&&this._onChangeDelayTimer.remove(),this._onChangeDelayTimer=this.defer(function(){delete this._onChangeDelayTimer;this._set("value",this.get("value"))},10)},startup:function(){this.inherited(arguments);this._descendants=this._getDescendantFormWidgets();this.value=this.get("value");this.state=this._getState();var a=this;this.own(c(this.containerNode,"attrmodified-state, attrmodified-disabled, attrmodified-value, attrmodified-checked",
function(b){b.target!=a.domNode&&a._onChildChange(b.type.replace("attrmodified-",""))}));this.watch("state",function(a,b,c){this.onValidStateChange(""==c)})},destroy:function(){this.inherited(arguments)}})})},"dijit/_AttachMixin":function(){define("require dojo/_base/array dojo/_base/connect dojo/_base/declare dojo/_base/lang dojo/mouse dojo/on dojo/touch ./_WidgetBase".split(" "),function(h,b,k,a,c,d,e,f,g){var l=c.delegate(f,{mouseenter:d.enter,mouseleave:d.leave,keypress:k._keypress}),m;k=a("dijit._AttachMixin",
null,{constructor:function(){this._attachPoints=[];this._attachEvents=[]},buildRendering:function(){this.inherited(arguments);this._attachTemplateNodes(this.domNode);this._beforeFillContent()},_beforeFillContent:function(){},_attachTemplateNodes:function(a){for(var b=a;;)if(1==b.nodeType&&(this._processTemplateNode(b,function(a,b){return a.getAttribute(b)},this._attach)||this.searchContainerNode)&&b.firstChild)b=b.firstChild;else{if(b==a)break;for(;!b.nextSibling;)if(b=b.parentNode,b==a)return;b=
b.nextSibling}},_processTemplateNode:function(a,b,d){var e=!0,f=this.attachScope||this,g=b(a,"dojoAttachPoint")||b(a,"data-dojo-attach-point");if(g)for(var l=g.split(/\s*,\s*/);g=l.shift();)c.isArray(f[g])?f[g].push(a):f[g]=a,e="containerNode"!=g,this._attachPoints.push(g);if(b=b(a,"dojoAttachEvent")||b(a,"data-dojo-attach-event")){g=b.split(/\s*,\s*/);for(l=c.trim;b=g.shift();)if(b){var m=null;-1!=b.indexOf(":")?(m=b.split(":"),b=l(m[0]),m=l(m[1])):b=l(b);m||(m=b);this._attachEvents.push(d(a,b,c.hitch(f,
m)))}}return e},_attach:function(a,b,c){b=b.replace(/^on/,"").toLowerCase();b="dijitclick"==b?m||(m=h("./a11yclick")):l[b]||b;return e(a,b,c)},_detachTemplateNodes:function(){var a=this.attachScope||this;b.forEach(this._attachPoints,function(b){delete a[b]});this._attachPoints=[];b.forEach(this._attachEvents,function(a){a.remove()});this._attachEvents=[]},destroyRendering:function(){this._detachTemplateNodes();this.inherited(arguments)}});c.extend(g,{dojoAttachEvent:"",dojoAttachPoint:""});return k})},
"esri/ServerInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","./kernel","./lang"],function(h,b,k,a,c){h=h(null,{declaredClass:"esri.ServerInfo",constructor:function(a){b.mixin(this,a)},toJson:function(){return c.fixJson({server:this.server,tokenServiceUrl:this.tokenServiceUrl,adminTokenServiceUrl:this.adminTokenServiceUrl,shortLivedTokenValidity:this.shortLivedTokenValidity,owningSystemUrl:this.owningSystemUrl,owningTenant:this.owningTenant,currentVersion:this.currentVersion,
hasPortal:this.hasPortal,hasServer:this.hasServer,webTierAuth:this.webTierAuth})}});k("extend-esri")&&(a.ServerInfo=h);return h})},"dijit/DropDownMenu":function(){define(["dojo/_base/declare","dojo/keys","dojo/text!./templates/Menu.html","./_MenuBase"],function(h,b,k,a){return h("dijit.DropDownMenu",a,{templateString:k,baseClass:"dijitMenu",_onUpArrow:function(){this.focusPrev()},_onDownArrow:function(){this.focusNext()},_onRightArrow:function(a){this._moveToPopup(a);a.stopPropagation();a.preventDefault()},
_onLeftArrow:function(a){if(this.parentMenu)if(this.parentMenu._isMenuBar)this.parentMenu.focusPrev();else this.onCancel(!1);else a.stopPropagation(),a.preventDefault()}})})},"dojo/data/util/simpleFetch":function(){define(["../../_base/lang","../../_base/kernel","./sorter"],function(h,b,k){var a={};h.setObject("dojo.data.util.simpleFetch",a);a.errorHandler=function(a,d){d.onError&&d.onError.call(d.scope||b.global,a,d)};a.fetchHandler=function(a,d){var e=d.abort||null,f=!1,g=d.start?d.start:0,l=d.count&&
Infinity!==d.count?g+d.count:a.length;d.abort=function(){f=!0;e&&e.call(d)};var m=d.scope||b.global;d.store||(d.store=this);d.onBegin&&d.onBegin.call(m,a.length,d);d.sort&&a.sort(k.createSortFunction(d.sort,this));if(d.onItem)for(var h=g;h<a.length&&h<l;++h){var q=a[h];f||d.onItem.call(m,q,d)}d.onComplete&&!f&&(h=null,d.onItem||(h=a.slice(g,l)),d.onComplete.call(m,h,d))};a.fetch=function(a){a=a||{};a.store||(a.store=this);this._fetchItems(a,h.hitch(this,"fetchHandler"),h.hitch(this,"errorHandler"));
return a};return a})},"arcgisonline/sharing/util":function(){define(["dijit","dojo","dojox","dojo/require!arcgisonline/sharing/dijit/dialog/GeneralDlg,arcgisonline/sharing/dijit/dialog/SubscriptionStatusDlg,esri/IdentityManager,dojo/cookie"],function(h,b,k){b.provide("arcgisonline.sharing.util");b.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");b.require("arcgisonline.sharing.dijit.dialog.SubscriptionStatusDlg");b.require("esri.IdentityManager");b.require("dojo.cookie");arcgisonline.sharing.util=
{getSocialNetworkBadges:function(a,c){var d={},e=b.create,f=arcgisonline.sharing.util.socialNetworkTitle(a.title),g=unescape(window.location.href);if(!1===a.isOrganization||!0===a.isOrganization)g=arcgisonline.sharing.util.urlToObject(window.location.href).path+"?id\x3d"+a.id;esriGeowConfig.self&&esriGeowConfig.self.customBaseUrl&&-1<g.indexOf(esriGeowConfig.self.customBaseUrl)&&(g=g.replace(location.host,esriGeowConfig.self.portalHostname));var l=e("span",{"class":"esriItemLinks"}),m=encodeURI("socialnetwork.html?t\x3d"+
f+"\x26n\x3dfb\x26u\x3d"+g),h=esri.i18nBundle.itemLinks.shareFacebook,k=e("a",{target:"_blank",onclick:b.partial(this._checkShare,a,"Facebook"),href:m,alt:h,title:h},l);e("span",{"class":"badge facebookBadge dijitInline"},k);m=e("a",{target:"_blank",onclick:b.partial(this._checkShare,a,"Facebook"),href:m,alt:h,title:h},l);e("span",{innerHTML:esri.i18nBundle.itemLinks.facebook,"class":"label"},m);d.facebook=l;l=e("span",{"class":"esriItemLinks"});m=encodeURI("socialnetwork.html?t\x3d"+f+"\x26n\x3dtw\x26u\x3d"+
g);h=esri.i18nBundle.itemLinks.shareTwitter;k=e("a",{target:"_blank",onclick:b.partial(this._checkShare,a,"Twitter"),href:m,alt:h,title:h},l);e("span",{"class":"badge twitterBadge dijitInline"},k);m=e("a",{target:"_blank",onclick:b.partial(this._checkShare,a,"Twitter"),href:m,alt:h,title:h},l);e("span",{innerHTML:esri.i18nBundle.itemLinks.twitter,"class":"label"},m);d.twitter=l;c(d)},socialNetworkTitle:function(a){100<a.length&&(a=a.substring(0,97)+"...");return encodeURIComponent(a.replace(/ /g,
"+"))},shortenUrl:function(a,c,d){var e=esriGeowConfig.bitlyUrl;"https:"==location.protocol&&(e=esriGeowConfig.bitlyUrlSSL);e+="\x26longUrl\x3d"+escape(a)+"\x26format\x3djson";b.io.script.get({url:e,callbackParamName:"callback",load:function(a,b){a&&200==a.status_code&&a.data&&a.data.url&&0<a.data.url.length?c(a.data.url):d&&d(a,b)},error:function(a,b){d&&d(a,b)}})},_checkShare:function(a,b,d){b=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();if(a.access&&"public"!==a.access)b.show({title:esri.i18nBundle.itemLinks.shareItem,
message:esri.substitute({appTitle:esriGeowConfig.portalName||"ArcGIS.com"},esri.i18nBundle.itemLinks.shareItemMsg)});else if(!1===a.isPublic&&(!1===a.isOrganization||!0===a.isOrganization))b.show({title:esri.i18nBundle.itemLinks.shareGroup,message:esri.substitute({appTitle:esriGeowConfig.portalName||"ArcGIS.com"},esri.i18nBundle.itemLinks.shareGroupMsg)})},checkSession:function(){var a=this.getCookie("esri_auth"),c=null;a&&(c=a);if(c&&(!c.error||""==c.error))esriGeowConfig.userInfo=b.mixin(esriGeowConfig.userInfo||
{},c)},isLoggedIn:function(){return null==this.getUser()?!1:!0},isSilverlightInstalled:function(){if(esriGeowConfig.isSilverlightInstalled)return esriGeowConfig.isSilverlightInstalled;esriGeowConfig.isSilverlightInstalled=!1;if(b.isIE)try{new ActiveXObject("AgControl.AgControl"),esriGeowConfig.isSilverlightInstalled=!0}catch(a){console.log("Silverlight plug-in not found in IE browser.")}else navigator.plugins["Silverlight Plug-In"]&&(esriGeowConfig.isSilverlightInstalled=!0);return esriGeowConfig.isSilverlightInstalled},
couldHaveArcGISDesktop:function(){return-1!=navigator.userAgent.indexOf("Windows")&&-1==navigator.userAgent.indexOf("Windows Phone")?!0:!1},requireAuthentication:function(){if(!0==this.isLoggedIn())return!0;var a="";-1==esriGeowConfig.signin.indexOf("http")&&(a=esriGeowConfig.baseUrl,!1!==esriGeowConfig.useSSL&&(a=arcgisonline.sharing.util.getSecureUrl(a)));a+=esriGeowConfig.signin;window.location!==a&&(a+="?returnUrl\x3d"+escape(window.location));window.location=a+"\x26error\x3d403";return!1},htmlHasText:function(a){if(a&&
0<a.length){a=b.trim(a);for(var c=!1,d=0;d<a.length;d++){var e=a.charAt(d);if("\x3c"==e)c=!0;else if("\x3e"==e)c=!1;else if(!c&&""!=e)return!0}}return!1},endsWith:function(a,b){return null==a||null==b?!1:a.toLowerCase().lastIndexOf(b.toLowerCase())==a.length-b.length},toFullDateString:function(a){a=new Date(parseFloat(a));return b.date.locale.format(a,{selector:"date",formatLength:"long"})},capitalize:function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()},getItemDetailsLinkInfo:function(a){var b=
null,d=null,e=null;esri.isDefined(a.isInvitationOnly)?(b=esriGeowConfig.baseUrl+"group.html?owner\x3d"+a.owner+"\x26title\x3d"+encodeURIComponent(a.title),d=esri.i18nBundle.itemLinks.details,e=esri.i18nBundle.itemLinks.viewGroupDetails):(b=esriGeowConfig.baseUrl+"item.html?id\x3d"+a.id,d=esri.i18nBundle.itemLinks.details,e=esri.i18nBundle.itemLinks.viewDetails);return null!==b&&null!==d?{link:b,label:d,tip:e}:null},_isOperationsViewSupportedBrowser:function(){var a=navigator.userAgent.toLowerCase();
if(a.match(/iphone/i)||a.match(/ipod/i)||-1<a.indexOf("android")&&-1<a.indexOf("mobile")||-1<a.indexOf("windows phone")||b.has("bb"))return!1;var c;return void 0!==b.has("chrome")?(c=b.has("chrome"),!isNaN(c)&&19<=c):void 0!==b.has("ff")?4<=b.has("ff"):void 0!==b.has("ie")?9<=b.has("ie"):void 0!==b.has("trident")?5<=b.has("trident"):void 0!==b.has("safari")?(c=parseFloat(a.split("version/")[1]),a=parseFloat(a.split("crios/")[1]),isNaN(c)&&isNaN(a)||!isNaN(c)&&5.1>c||!isNaN(a)&&31>a?!1:!0):!1},_isPremiumService:function(a){return a.owner&&
-1<a.owner.toLowerCase().indexOf("esri")&&(-1<b.indexOf(a.typeKeywords,"Requires Subscription")||-1<b.indexOf(a.typeKeywords,"Requires Credits"))},getGalleryMainLinkInfo:function(a){var c=a.type?a.type:"",d="",e="",f="",g=null,e=this.getUser(),d=!1,d=null;esriGeowConfig.portalHostname&&(d=esriGeowConfig.portalHostname);d&&(f=d.split("."),1<f.length&&(d=f[f.length-2]+"."+f[f.length-1]));if("Web Map"==c)d=!e&&this._isPremiumService(a),e='JavaScript:arcgisonline.map.mapUtil.openMap("'+a.id+'",'+d+")",
f=esri.substitute({appTitle:""},esri.i18nBundle.itemLinks.openViewer),d=esri.i18nBundle.itemLinks.open;else if("CityEngine Web Scene"===c)g=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/apps/CEWebViewer/viewer.html?3dWebScene\x3d"+a.id,e="JavaScript:void(0)",g=b.hitch(arcgisonline.sharing.util,"openPage",g),f=esri.i18nBundle.itemLinks.viewApp,d=esri.i18nBundle.itemLinks.open;else if("Web Scene"===c&&esriGeowConfig.sceneViewerEnabled)g=window.location.protocol+
"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/home/webscene/viewer.html?webscene\x3d"+a.id,e="JavaScript:void(0)",g=b.hitch(arcgisonline.sharing.util,"openPage",g,!0),f=esri.i18nBundle.itemLinks.openSceneViewer,d=esri.i18nBundle.itemLinks.open;else if("Scene Service"===c&&esriGeowConfig.sceneViewerEnabled)g=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/home/webscene/viewer.html?layers\x3d"+a.id,e="JavaScript:void(0)",
g=b.hitch(arcgisonline.sharing.util,"openPageAndCount",a.id,g,!0),f=esri.i18nBundle.itemLinks.addToSceneViewer,d=esri.i18nBundle.itemLinks.open;else if("Operation View"===c){g=window.location;c=arcgisonline.sharing.util.isPortal();g=g.protocol+"//"+(c?esriGeowConfig.self.portalHostname:g.host);e=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/apps/dashboard/index.html#/"+a.id;if(this.couldHaveArcGISDesktop())g=b.partial(arcgisonline.sharing.util.openPageAndCount,
a.id,g+(c?"/apps/dashboard-win/":"/opsdashboard/")+"OperationsDashboard.application?open\x3d"+a.id);else if(this._isOperationsViewSupportedBrowser())g=b.hitch(arcgisonline.sharing.util,"openPageAndCount",a.id,e,!1);else return null;e="JavaScript:void(0)";f=esri.i18nBundle.itemLinks.openOperationView;d=esri.i18nBundle.itemLinks.open}else if("Map Service"==c||"Feature Service"==c||"Image Service"==c||"KML"==c||"Feature Collection"==c||"Stream Service"==c)f=a&&a.extraUrlParams?!0:!1,d=!e&&this._isPremiumService(a),
e='JavaScript:arcgisonline.map.mapUtil.addToMap("'+a.id+'",'+d+","+f+")",d=esri.i18nBundle.itemLinks.open,f=esri.substitute({appTitle:esriGeowConfig.portalName||"ArcGIS.com"},esri.i18nBundle.itemLinks.addToViewer),esriGeowConfig.sceneViewerEnabled&&("Image Service"===c&&-1<b.indexOf(a.typeKeywords,"Elevation 3D Layer"))&&(e=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/home/webscene/viewer.html?layers\x3d"+a.id,f=esri.i18nBundle.itemLinks.addToSceneViewer,
d=esri.i18nBundle.itemLinks.open);else if("WMS"==c)e=a.noWebMercator?'JavaScript:arcgisonline.map.mapUtil.openOnGCSMap("'+a.id+'")':'JavaScript:arcgisonline.map.mapUtil.addToMap("'+a.id+'")',d=esri.i18nBundle.itemLinks.open,f=esri.substitute({appTitle:esriGeowConfig.portalName||"ArcGIS.com"},esri.i18nBundle.itemLinks.addToViewer);else if(this.couldHaveArcGISDesktop()&&("Globe Service"==c||"Workflow Manager Service"==c))e="JavaScript:void(0)",g=b.hitch(arcgisonline.sharing.util,"openPageAndCount",
a.id,a.url+"?f\x3dlyr\x26v\x3d9.3"),d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.openDesktop;else if(this.couldHaveArcGISDesktop()&&("Map Package"==c||"Basemap Package"===c||"Mobile Map Package"==c||"Mobile Basemap Package"===c||"Layer Package"==c||"Pro Map"==c||"Layout"==c||-1<b.indexOf(a.typeKeywords,"lyrx")))a&&a.name.indexOf(".mmpk")&&a.name.indexOf(".bpk")&&-1===a.name.indexOf(".bpkx")&&-1===a.name.indexOf(".lpkx")&&-1===a.name.indexOf(".mpkx")&&-1===a.name.indexOf(".lyrx")&&
-1===a.name.indexOf(".mapx")&&-1===a.name.indexOf(".pagx")?(e=this.getItemPkgPath(a),d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.openDesktop):(e=this.getItemDataPath(a),d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.downloadArchive);else if(this.couldHaveArcGISDesktop()&&("Geoprocessing Package"==c||"Locator Package"==c||"Tile Package"==c))e=this.getItemPkgPath(a),d=esri.i18nBundle.itemLinks.open,f="Task File"!==c?esri.i18nBundle.itemLinks.openDesktop:esri.i18nBundle.itemLinks.openProfessional;
else if(this.couldHaveArcGISDesktop()&&("Map Document"==c||"Published Map"==c||"Globe Document"==c||"Scene Document"==c||"Layer"==c))e=this.getItemDataPath(a),d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.openDesktop;else if(this.couldHaveArcGISDesktop()&&"Desktop Add In"==c)e=this.getItemDataPath(a),d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.openDesktop;else if(this.isSilverlightInstalled()&&("Explorer Map"==c||"Explorer Layer"==c||"Explorer Add In"==c))e=this.getItemDataPath(a),
d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.openExplorer;else if("File Geodatabase"===c||"CSV Collection"===c||"KML Collection"===c||"Rule Package"===c||"GeoJson"===c||"Shapefile"===c||"CSV"===c||"Map Template"===c||"Code Sample"===c||"Geoprocessing Sample"===c||"Service Definition"===c||"Workflow Manager Package"===c||"Windows Viewer Add-in"===c||"ArcPad Package"===c||"Operations Dashboard Addin"===c||"CAD Drawing"===c||"Microsoft Word"===c||"Raster function template"===c||"Microsoft PowerPoint"===
c||"Microsoft Powerpoint"===c||"Microsoft Excel"===c||"iWork Pages"===c||"iWork Keynote"===c||"iWork Numbers"===c||"Image"===c||"Visio Document"===c||"PDF"===c||"Desktop Application"===c||"Task File"===c||"Project Package"===c||"Project Template"===c||"Desktop Style"===c)e=this.getItemDataPath(a),d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.downloadArchive;else if(("Web Mapping Application"==c||"Application"==c)&&-1===b.indexOf(a.typeKeywords,"Web AppBuilder for ArcGIS"))if(a.url&&
0<a.url.length){if(esriGeowConfig.urlKey&&(-1<a.url.indexOf(esriGeowConfig.urlKey)||d&&-1<a.url.indexOf(d)))a.url=esriGeowConfig.allSSL?a.url.replace("http:","https:"):a.url;a.access&&"public"!==a.access&&arcgisonline.sharing.util.isHostedTemplateItem(a.url)&&(c=arcgisonline.sharing.util.parseUrl(a.url),a.url=a.url.replace(c.host,window.location.hostname));arcgisonline.sharing.util.isPortal()&&(a.url&&0===a.url.indexOf("/"))&&(c=esriGeowConfig.self.portalHostname.substring(esriGeowConfig.self.portalHostname.indexOf("/")),
-1===a.url.indexOf(c)&&(a.url=c+a.url));e="JavaScript:void(0)";g=b.hitch(arcgisonline.sharing.util,"openPageAndCount",a.id,a.url);f=esri.i18nBundle.itemLinks.viewApp;d=esri.i18nBundle.itemLinks.open}else e=esriGeowConfig.baseUrl+"item.html?id\x3d"+a.id,d=esri.i18nBundle.itemLinks.details,f=esri.i18nBundle.itemLinks.viewDetails;else if("Desktop Application Template"==c)-1<b.indexOf(a.typeKeywords,"desktopApplicationTemplateUrl")&&a.url&&0<a.url.length?(e="JavaScript:void(0)",g=b.hitch(arcgisonline.sharing.util,
"openPageAndCount",a.id,a.url),f=esri.i18nBundle.itemLinks.viewApp,d=esri.i18nBundle.itemLinks.open):(e=this.getItemDataPath(a),d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.downloadArchive);else if("Mobile Application"==c)if(a.url&&0<a.url.length){if(esriGeowConfig.urlKey&&(-1<a.url.indexOf(esriGeowConfig.urlKey)||d&&-1<a.url.indexOf(d)))a.url=esriGeowConfig.allSSL?a.url.replace("http:","https:"):a.url;e="JavaScript:void(0)";g=b.hitch(arcgisonline.sharing.util,"openPageAndCount",a.id,
a.url);d=esri.i18nBundle.itemLinks.open;f=esri.i18nBundle.itemLinks.getApp}else e=esriGeowConfig.baseUrl+"item.html?id\x3d"+a.id,d=esri.i18nBundle.itemLinks.details,f=esri.i18nBundle.itemLinks.viewDetails;else"Windows Mobile Package"==c?(e=this.getItemDataPath(a),d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.download):"Document Link"===c?(e="JavaScript:void(0)",g=b.hitch(arcgisonline.sharing.util,"openPageAndCount",a.id,a.url),d=f=esri.i18nBundle.itemLinks.open):(e=esriGeowConfig.baseUrl+
"item.html?id\x3d"+a.id,d=esri.i18nBundle.itemLinks.details,f=esri.i18nBundle.itemLinks.viewDetails);return{label:d,href:e,target:"",tip:f,onclick:g}},getHomePageGalleryLinkInfo:function(a){var c=a.type?a.type:"",d="",e="",f="",g=null,d=this.getUser(),e=!1,e=null;esriGeowConfig.portalHostname&&(e=esriGeowConfig.portalHostname);e&&(f=e.split("."),1<f.length&&(e=f[f.length-2]+"."+f[f.length-1]));if("Web Map"==c)var f=esriGeowConfig.baseUrl+"webmap/viewer.html?webmap\x3d"+a.id,l=esriGeowConfig.baseUrl+
"signin.html?returnUrl\x3d"+encodeURIComponent(f),e=(e=!d&&this._isPremiumService(a))?l:f,f=esri.substitute({appTitle:""},esri.i18nBundle.itemLinks.openViewer),d=esri.i18nBundle.itemLinks.open;else if("CityEngine Web Scene"===c)e=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/apps/CEWebViewer/viewer.html?3dWebScene\x3d"+a.id,f=esri.i18nBundle.itemLinks.viewApp,d=esri.i18nBundle.itemLinks.open;else if("Web Scene"===c&&esriGeowConfig.sceneViewerEnabled)e=
window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/home/webscene/viewer.html?webscene\x3d"+a.id,f=esri.i18nBundle.itemLinks.openSceneViewer,d=esri.i18nBundle.itemLinks.open;else if("Scene Service"===c&&esriGeowConfig.sceneViewerEnabled)e=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/home/webscene/viewer.html?layers\x3d"+a.id,f=esri.i18nBundle.itemLinks.addToSceneViewer,d=esri.i18nBundle.itemLinks.open;
else if("Operation View"===c){d=window.location;c=arcgisonline.sharing.util.isPortal();d=d.protocol+"//"+(c?esriGeowConfig.self.portalHostname:d.host);e=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/apps/dashboard/index.html#/"+a.id;if(this.couldHaveArcGISDesktop())e=d+(c?"/apps/dashboard-win/":"/opsdashboard/")+"OperationsDashboard.application?open\x3d"+a.id;else if(!this._isOperationsViewSupportedBrowser())return null;f=esri.i18nBundle.itemLinks.openOperationView;
d=esri.i18nBundle.itemLinks.open}else if("Map Service"==c||"Feature Service"==c||"Image Service"==c||"KML"==c||"Stream Service"==c)f=esriGeowConfig.baseUrl+"webmap/viewer.html?layers\x3d"+a.id,l=esriGeowConfig.baseUrl+"signin.html?returnUrl\x3d"+encodeURIComponent(f),e=(e=!d&&this._isPremiumService(a))?l:f,d=esri.i18nBundle.itemLinks.open,f=esri.substitute({appTitle:esriGeowConfig.portalName||"ArcGIS.com"},esri.i18nBundle.itemLinks.addToNewViewer),esriGeowConfig.sceneViewerEnabled&&("Image Service"===
c&&-1<b.indexOf(a.typeKeywords,"Elevation 3D Layer"))&&(e=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/home/webscene/viewer.html?layers\x3d"+a.id,f=esri.i18nBundle.itemLinks.addToSceneViewer,d=esri.i18nBundle.itemLinks.open);else if("WMS"==c)e=esriGeowConfig.baseUrl+"webmap/viewer.html?layers\x3d"+a.id,d=esri.i18nBundle.itemLinks.open,f=esri.substitute({appTitle:esriGeowConfig.portalName||"ArcGIS.com"},esri.i18nBundle.itemLinks.addToNewViewer);
else if(this.couldHaveArcGISDesktop()&&("Globe Service"==c||"Workflow Manager Service"==c))e="JavaScript:void(0)",g=b.hitch(arcgisonline.sharing.util,"openPageAndCount",a.id,a.url+"?f\x3dlyr\x26v\x3d9.3"),d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.openDesktop;else if(this.couldHaveArcGISDesktop()&&("Map Package"==c||"Mobile Map Package"==c||"Basemap Package"===c||"Mobile Basemap Package"===c||"Layer Package"==c||"Pro Map"==c||"Layout"==c||-1<b.indexOf(a.typeKeywords,"lyrx")))a&&
-1===a.name.indexOf(".bpkx")&&-1===a.name.indexOf(".mmpk")&&-1===a.name.indexOf(".bpk")&&-1===a.name.indexOf(".lpkx")&&-1===a.name.indexOf(".mpkx")&&-1===a.name.indexOf(".lyrx")&&-1===a.name.indexOf(".mapx")&&-1===a.name.indexOf(".pagx")?(e=this.getItemPkgPath(a),d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.openDesktop):(e=this.getItemDataPath(a),d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.downloadArchive);else if(this.couldHaveArcGISDesktop()&&("Geoprocessing Package"==
c||"Locator Package"==c||"Tile Package"==c))e=this.getItemPkgPath(a),d=esri.i18nBundle.itemLinks.open,f="Task File"!==c?esri.i18nBundle.itemLinks.openDesktop:esri.i18nBundle.itemLinks.openProfessional;else if(this.couldHaveArcGISDesktop()&&("Map Document"==c||"Published Map"==c||"Globe Document"==c||"Scene Document"==c||"Layer"==c))e=this.getItemDataPath(a),d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.openDesktop;else if(this.couldHaveArcGISDesktop()&&"Desktop Add In"==c)e=this.getItemDataPath(a),
d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.openDesktop;else if(this.isSilverlightInstalled()&&("Explorer Map"==c||"Explorer Layer"==c||"Explorer Add In"==c))e=this.getItemDataPath(a),d=esri.i18nBundle.itemLinks.open,f=esri.substitute({appTitle:""},esri.i18nBundle.itemLinks.openViewer);else if("File Geodatabase"===c||"CSV Collection"===c||"KML Collection"===c||"Rule Package"===c||"GeoJson"===c||"Shapefile"===c||"CSV"===c||"Map Template"===c||"Code Sample"===c||"Geoprocessing Sample"===
c||"Service Definition"===c||"Workflow Manager Package"===c||"Windows Viewer Add-in"===c||"ArcPad Package"===c||"Operations Dashboard Addin"===c||"Microsoft Word"===c||"CAD Drawing"===c||"Raster function template"===c||"Microsoft PowerPoint"===c||"Microsoft Powerpoint"===c||"Microsoft Excel"===c||"iWork Pages"===c||"iWork Keynote"===c||"iWork Numbers"===c||"Image"===c||"Visio Document"===c||"PDF"===c||"Desktop Application"===c||"Task File"===c||"Project Package"===c||"Project Template"===c||"Desktop Style"===
c)e=this.getItemDataPath(a),d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.downloadArchive;else if("Desktop Application Template"==c)-1<b.indexOf(a.typeKeywords,"desktopApplicationTemplateUrl")&&a.url&&0<a.url.length?(e="JavaScript:void(0)",g=b.hitch(arcgisonline.sharing.util,"openPageAndCount",a.id,a.url),d=f=esri.i18nBundle.itemLinks.open):(e=this.getItemDataPath(a),d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.downloadArchive);else if("Web Mapping Application"==c&&
-1===b.indexOf(a.typeKeywords,"Web AppBuilder for ArcGIS"))if(a.url&&0<a.url.length){if(esriGeowConfig.urlKey&&(-1<a.url.indexOf(esriGeowConfig.urlKey)||e&&-1<a.url.indexOf(e)))a.url=esriGeowConfig.allSSL?a.url.replace("http:","https:"):a.url;a.access&&"public"!==a.access&&arcgisonline.sharing.util.isHostedTemplateItem(a.url)&&(g=arcgisonline.sharing.util.parseUrl(a.url),a.url=a.url.replace(g.host,window.location.hostname));e="JavaScript:void(0)";g=b.hitch(arcgisonline.sharing.util,"openPageAndCount",
a.id,a.url);f=esri.i18nBundle.itemLinks.viewApp;d=esri.i18nBundle.itemLinks.open}else e=esriGeowConfig.baseUrl+"item.html?id\x3d"+a.id,d=esri.i18nBundle.itemLinks.details,f=esri.i18nBundle.itemLinks.viewDetails;else if("Mobile Application"==c)if(a.url&&0<a.url.length){if(esriGeowConfig.urlKey&&(-1<a.url.indexOf(esriGeowConfig.urlKey)||e&&-1<a.url.indexOf(e)))a.url=esriGeowConfig.allSSL?a.url.replace("http:","https:"):a.url;e="JavaScript:void(0)";g=b.hitch(arcgisonline.sharing.util,"openPageAndCount",
a.id,a.url);d=esri.i18nBundle.itemLinks.open;f=esri.i18nBundle.itemLinks.getApp}else e=esriGeowConfig.baseUrl+"item.html?id\x3d"+a.id,d=esri.i18nBundle.itemLinks.details,f=esri.i18nBundle.itemLinks.viewDetails;else"Windows Mobile Package"==c?(e=this.getItemDataPath(a),d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.download):"Document Link"===c?(e="JavaScript:void(0)",g=b.hitch(arcgisonline.sharing.util,"openPageAndCount",a.id,a.url),d=f=esri.i18nBundle.itemLinks.open):(e=esriGeowConfig.baseUrl+
"item.html?id\x3d"+a.id,d=esri.i18nBundle.itemLinks.details,f=esri.i18nBundle.itemLinks.viewDetails);return{label:d,href:e,target:"",tip:f,onclick:g}},getItemOpenLinkObjects:function(a,c){var d=this.isSilverlightInstalled(),e=[],f=a.type?a.type:"",g=this.getUser(),l=!1;if("Web Map"==f&&-1==b.indexOf(a.typeKeywords,"ArcGIS Online")&&d&&esriGeowConfig.explorerOnline)e.push({label:esri.substitute({appTitle:""},esri.i18nBundle.itemLinks.openViewer),onClick:b.partial(arcgisonline.map.mapUtil.openMap,a.id,
l)}),this.couldHaveArcGISDesktop()&&e.push({label:esri.i18nBundle.itemLinks.openDesktop,onClick:b.partial(arcgisonline.sharing.util.openPage,arcgisonline.sharing.util.getItemPkgPath(a))});else if("Web Map"==f)l=!g&&this._isPremiumService(a),e.push({label:esri.substitute({appTitle:""},esri.i18nBundle.itemLinks.openViewer),onClick:b.partial(arcgisonline.map.mapUtil.openMap,a.id,l)}),this.couldHaveArcGISDesktop()&&e.push({label:esri.i18nBundle.itemLinks.openDesktop,onClick:b.partial(arcgisonline.sharing.util.openPage,
arcgisonline.sharing.util.getItemPkgPath(a))}),f=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/apps/presentation/index.html?webmap\x3d"+a.id,-1<b.indexOf(a.typeKeywords,"Presentation Map")?(e.push({label:esri.i18nBundle.aboutPanel.viewPresentation,onClick:b.partial(arcgisonline.sharing.util.openPage,f)}),c&&e.push({label:esri.i18nBundle.aboutPanel.editPresentation,onClick:b.partial(arcgisonline.sharing.util.openPage,f+"\x26builder",!0)})):c&&e.push({label:esri.i18nBundle.aboutPanel.createPresentation,
onClick:b.partial(arcgisonline.sharing.util.openPage,f+"\x26builder",!0)});else if("Map Service"==f)l=!g&&this._isPremiumService(a),e.push({label:esri.substitute({appTitle:esriGeowConfig.portalName||"ArcGIS.com"},esri.i18nBundle.itemLinks.addToViewer),onClick:b.partial(arcgisonline.map.mapUtil.addToMap,a.id,l)}),e.push({label:esri.substitute({appTitle:esriGeowConfig.portalName||"ArcGIS.com"},esri.i18nBundle.itemLinks.addToNewViewer),onClick:b.partial(arcgisonline.map.mapUtil.openOnMap,a.id,l)}),esriGeowConfig.sceneViewerEnabled&&
e.push({label:esri.i18nBundle.itemLinks.addToSceneViewer,onClick:b.partial(arcgisonline.sharing.util.openPageAndCount,a.id,window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/home/webscene/viewer.html?layers\x3d"+a.id,!0)}),this.couldHaveArcGISDesktop()&&!arcgisonline.sharing.util.isHostedServiceItem(a)&&(-1<b.indexOf(a.typeKeywords,"Hosted Service")&&arcgisonline.sharing.util.portalSupportsHostedServices()?e.push({label:esri.i18nBundle.itemLinks.openDesktop,
onClick:b.partial(arcgisonline.sharing.util.openPage,arcgisonline.sharing.util.getPItemPath(a))}):!arcgisonline.sharing.util.isPortal()&&arcgisonline.sharing.util.onAGOLFederatedServer(a.url)||arcgisonline.sharing.util.isPortal()&&arcgisonline.sharing.util.onFederatedServer(a.url)?e.push({label:esri.i18nBundle.itemLinks.openDesktop,onClick:b.partial(arcgisonline.sharing.util.openPage,arcgisonline.sharing.util.getPItemPath(a))}):a.url&&-1!==a.url.indexOf(".arcgis.com/")&&-1!==a.url.indexOf("//landscape")?
e.push({label:esri.i18nBundle.itemLinks.openDesktop,onClick:b.partial(arcgisonline.sharing.util.openPage,arcgisonline.sharing.util.getPItemPath(a))}):e.push({label:esri.i18nBundle.itemLinks.openDesktop,onClick:b.partial(arcgisonline.sharing.util.openPageAndCount,a.id,a.url+"?f\x3dlyr\x26v\x3d9.3")})),this.couldHaveArcGISDesktop()&&arcgisonline.sharing.util.isHostedServiceItem(a)&&e.push({label:esri.i18nBundle.itemLinks.openDesktop,onClick:b.partial(arcgisonline.sharing.util.openPage,arcgisonline.sharing.util.getPItemPath(a))});
else if(this.couldHaveArcGISDesktop()&&("Globe Service"==f||"Workflow Manager Service"==f))e.push({label:esri.i18nBundle.itemLinks.openDesktop,onClick:b.partial(arcgisonline.sharing.util.openPageAndCount,a.id,a.url+"?f\x3dlyr\x26v\x3d9.3")});else if("Image Service"==f||"Feature Service"==f||"KML"==f||"Feature Collection"==f||"Stream Service"==f)if(d=a&&a.extraUrlParams?!0:!1,l=!g&&this._isPremiumService(a),e.push({label:esri.substitute({appTitle:esriGeowConfig.portalName||"ArcGIS.com"},esri.i18nBundle.itemLinks.addToViewer),
onClick:b.partial(arcgisonline.map.mapUtil.addToMap,a.id,l,d)}),e.push({label:esri.substitute({appTitle:esriGeowConfig.portalName||"ArcGIS.com"},esri.i18nBundle.itemLinks.addToNewViewer),onClick:b.partial(arcgisonline.map.mapUtil.openOnMap,a.id,l,d)}),"KML"==f)this.couldHaveArcGISDesktop()&&e.push({label:esri.i18nBundle.itemLinks.openDesktop,onClick:b.partial(arcgisonline.sharing.util.openPage,arcgisonline.sharing.util.getPItemPath(a))}),e.push({label:esri.i18nBundle.itemLinks.download,onClick:b.partial(arcgisonline.sharing.util.openPage,
arcgisonline.sharing.util.getItemDataPath(a))});else{if("Image Service"===f||"Feature Service"===f)esriGeowConfig.sceneViewerEnabled&&(-1===b.indexOf(a.typeKeywords,"Table")&&("Feature Service"===f||"Map Service"===f||"Image Service"===f&&-1<b.indexOf(a.typeKeywords,"Elevation 3D Layer")))&&e.push({label:esri.i18nBundle.itemLinks.addToSceneViewer,onClick:b.partial(arcgisonline.sharing.util.openPageAndCount,a.id,window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+
"/home/webscene/viewer.html?layers\x3d"+a.id,!0)}),this.couldHaveArcGISDesktop()&&"Image Service"===f&&(a.url&&-1!==a.url.indexOf(".arcgis.com/")||!arcgisonline.sharing.util.isPortal()&&arcgisonline.sharing.util.onAGOLFederatedServer(a.url)||arcgisonline.sharing.util.isPortal()&&arcgisonline.sharing.util.onFederatedServer(a.url)?e.push({label:esri.i18nBundle.itemLinks.openDesktop,onClick:b.partial(arcgisonline.sharing.util.openPage,arcgisonline.sharing.util.getPItemPath(a))}):e.push({label:esri.i18nBundle.itemLinks.openDesktop,
onClick:b.partial(arcgisonline.sharing.util.openPageAndCount,a.id,a.url+"?f\x3dlyr\x26v\x3d9.3")})),this.couldHaveArcGISDesktop()&&"Feature Service"===f&&this.couldHaveArcGISDesktop()&&e.push({label:esri.i18nBundle.itemLinks.openDesktop,onClick:b.partial(arcgisonline.sharing.util.openPage,arcgisonline.sharing.util.getPItemPath(a))})}else if("Geoprocessing Service"===f&&this.couldHaveArcGISDesktop())e.push({label:esri.i18nBundle.itemLinks.openDesktop,onClick:b.partial(arcgisonline.sharing.util.openPage,
arcgisonline.sharing.util.getPItemPath(a))});else if("WMS"==f)a.noWebMercator?e.push({label:esri.substitute({appTitle:esriGeowConfig.portalName||"ArcGIS.com"},esri.i18nBundle.itemLinks.addToNewViewer),onClick:b.partial(arcgisonline.map.mapUtil.openOnGCSMap,a.id)}):(e.push({label:esri.substitute({appTitle:esriGeowConfig.portalName||"ArcGIS.com"},esri.i18nBundle.itemLinks.addToViewer),onClick:b.partial(arcgisonline.map.mapUtil.addToMap,a.id)}),e.push({label:esri.substitute({appTitle:esriGeowConfig.portalName||
"ArcGIS.com"},esri.i18nBundle.itemLinks.addToNewViewer),onClick:b.partial(arcgisonline.map.mapUtil.openOnMap,a.id)})),this.couldHaveArcGISDesktop()&&e.push({label:esri.i18nBundle.itemLinks.openDesktop,onClick:b.partial(arcgisonline.sharing.util.openPage,arcgisonline.sharing.util.getPItemPath(a))});else if("File Geodatabase"===f||"CSV Collection"===f||"KML Collection"===f||"Rule Package"==f||"CSV"==f||"GeoJson"===f||"Shapefile"==f||"Service Definition"==f||"ArcPad Package"===f||"Operations Dashboard Addin"===
f)e.push({label:esri.i18nBundle.itemLinks.download,onClick:b.partial(arcgisonline.sharing.util.openPage,arcgisonline.sharing.util.getItemDataPath(a))});else if("Map Package"==f||"Mobile Map Package"===f||"Basemap Package"===f||"Mobile Basemap Package"===f||"Layer Package"==f||"Pro Map"==f||"Layout"==f||-1<b.indexOf(a.typeKeywords,"lyrx"))this.couldHaveArcGISDesktop()&&a&&(-1===a.name.indexOf(".bpkx")&&-1===a.name.indexOf(".mmpk")&&-1===a.name.indexOf(".bpk")&&-1===a.name.indexOf(".lpkx")&&-1===a.name.indexOf(".mpkx")&&
-1===a.name.indexOf(".lyrx")&&-1===a.name.indexOf(".mapx")&&-1===a.name.indexOf(".pagx"))&&e.push({label:esri.i18nBundle.itemLinks.openDesktop,onClick:b.partial(arcgisonline.sharing.util.openPage,arcgisonline.sharing.util.getItemPkgPath(a))}),e.push({label:esri.i18nBundle.itemLinks.download,onClick:b.partial(arcgisonline.sharing.util.openPage,arcgisonline.sharing.util.getItemDataPath(a))});else if("Geoprocessing Package"==f||"Locator Package"==f||"Tile Package"==f||"Project Package"===f||"Project Template"===
f)this.couldHaveArcGISDesktop()&&("Task File"!==f&&"Project Package"!==f&&"Project Template"!==f)&&e.push({label:"Task File"!==f?esri.i18nBundle.itemLinks.openDesktop:esri.i18nBundle.itemLinks.openProfessional,onClick:b.partial(arcgisonline.sharing.util.openPage,arcgisonline.sharing.util.getItemPkgPath(a))}),e.push({label:esri.i18nBundle.itemLinks.download,onClick:b.partial(arcgisonline.sharing.util.openPage,arcgisonline.sharing.util.getItemDataPath(a))});else if("Scene Package"==f)e.push({label:esri.i18nBundle.itemLinks.download,
onClick:b.partial(arcgisonline.sharing.util.openPage,arcgisonline.sharing.util.getItemDataPath(a))});else if(this.couldHaveArcGISDesktop()&&("Map Document"==f||"Published Map"==f||"Globe Document"==f||"Scene Document"==f||"Layer"==f))e.push({label:esri.i18nBundle.itemLinks.openDesktop,onClick:b.partial(arcgisonline.sharing.util.openPage,arcgisonline.sharing.util.getItemDataPath(a))});else if(this.couldHaveArcGISDesktop()&&"Desktop Add In"==f)e.push({label:esri.i18nBundle.itemLinks.openDesktop,onClick:b.partial(arcgisonline.sharing.util.openPage,
arcgisonline.sharing.util.getItemDataPath(a))});else if("Explorer Layer"==f||"Explorer Add In"==f||"Explorer Map"==f)e.push({label:esri.i18nBundle.itemLinks.openExplorer,onClick:b.partial(arcgisonline.sharing.util.openPage,arcgisonline.sharing.util.getItemDataPath(a))});else if("Map Template"===f||"Code Sample"===f||"Geoprocessing Sample"===f||"Workflow Manager Package"===f||"Windows Viewer Add In"===f||"Microsoft Word"===f||"CAD Drawing"===f||"Raster function template"===f||"Microsoft PowerPoint"===
f||"Microsoft Powerpoint"===f||"Microsoft Excel"===f||"iWork Pages"===f||"iWork Keynote"===f||"iWork Numbers"===f||"Image"===f||"Visio Document"===f||"PDF"===f||"Desktop Application"===f||"Task File"===f||"Desktop Style"===f)e.push({label:"PDF"!==f?esri.i18nBundle.itemLinks.download:esri.i18nBundle.itemLinks.open,onClick:b.partial(arcgisonline.sharing.util.openPage,arcgisonline.sharing.util.getItemDataPath(a))});else if("Desktop Application Template"===f){if((f=-1<b.indexOf(a.typeKeywords,"desktopApplicationTemplateUrl"))&&
a.url&&a.url.length)f=!0,e.push({label:esri.i18nBundle.itemLinks.open,onClick:b.partial(arcgisonline.sharing.util.openPageAndCount,a.id,a.url)});f||e.push({label:esri.i18nBundle.itemLinks.download,onClick:b.partial(arcgisonline.sharing.util.openPage,arcgisonline.sharing.util.getItemDataPath(a))})}else if("Web Mapping Application"==f&&-1===b.indexOf(a.typeKeywords,"Web AppBuilder for ArcGIS")||"Mobile Application"==f||"Application"==f)g=esri.i18nBundle.itemLinks.viewApp,"Mobile Application"==f&&(g=
esri.i18nBundle.itemLinks.getApp),a.url&&0<a.url.length&&e.push({label:g,onClick:b.partial(arcgisonline.sharing.util.openPageAndCount,a.id,a.url)}),-1<b.indexOf(a.typeKeywords,"Web AppBuilder")&&c&&(f=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/apps/webappbuilder/index.html?id\x3d"+a.id,f="https:"===window.location.protocol?arcgisonline.sharing.util.getSecureUrl(f):arcgisonline.sharing.util.getHttpUrl(f),e.push({label:esri.i18nBundle.itemLinks.editApp,
onClick:b.partial(arcgisonline.sharing.util.openPage,f,!0)}));else if("Windows Mobile Package"==f)e.push({label:esri.i18nBundle.itemLinks.download,onClick:b.partial(arcgisonline.sharing.util.openPage,arcgisonline.sharing.util.getItemDataPath(a))});else if("CityEngine Web Scene"==f)g=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/apps/CEWebViewer/viewer.html?3dWebScene\x3d"+a.id,e.push({label:esri.i18nBundle.itemLinks.viewApp,onClick:b.partial(arcgisonline.sharing.util.openPage,
g)}),f=arcgisonline.sharing.util.useSSL(arcgisonline.sharing.util.getItemDataPath(a)),e.push({label:esri.i18nBundle.itemLinks.download,onClick:b.partial(arcgisonline.sharing.util.openPage,f)});else if("Web Scene"===f&&esriGeowConfig.sceneViewerEnabled)g=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/home/webscene/viewer.html?webscene\x3d"+a.id,e.push({label:esri.i18nBundle.itemLinks.openSceneViewer,onClick:b.partial(arcgisonline.sharing.util.openPage,
g,!0)});else if("Scene Service"===f&&esriGeowConfig.sceneViewerEnabled)g=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/home/webscene/viewer.html?layers\x3d"+a.id,e.push({label:esri.i18nBundle.itemLinks.addToSceneViewer,onClick:b.partial(arcgisonline.sharing.util.openPageAndCount,a.id,g,!0)});else if("Operation View"===f){var g=window.location,f=arcgisonline.sharing.util.isPortal(),g=g.protocol+"//"+(f?esriGeowConfig.self.portalHostname:g.host),
l=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/apps/dashboard/index.html#/"+a.id,d=-1<b.indexOf(a.typeKeywords,"TabletLayout"),m=this.couldHaveArcGISDesktop(),h=this._isOperationsViewSupportedBrowser();m&&e.push({label:d&&h?esri.i18nBundle.itemLinks.openOperationViewDesktop:esri.i18nBundle.itemLinks.openOperationView,onClick:b.partial(arcgisonline.sharing.util.openPage,g+(f?"/apps/dashboard-win/":"/opsdashboard/")+"OperationsDashboard.application?open\x3d"+
a.id)});d&&h&&e.push({label:!m?esri.i18nBundle.itemLinks.openOperationView:esri.i18nBundle.itemLinks.openOperationViewUrl,onClick:b.partial(arcgisonline.sharing.util.openPage,l,!1)})}else"Document Link"===f&&e.push({label:esri.i18nBundle.itemLinks.open,onClick:b.partial(arcgisonline.sharing.util.openPageAndCount,a.id,a.url)});esriGeowConfig.metadataEnabled&&(a.typeKeywords&&-1<b.indexOf(a.typeKeywords,"Metadata"))&&e.push({label:esri.i18nBundle.itemLinks.downloadMetadata,onClick:b.partial(arcgisonline.sharing.util.openPage,
esriGeowConfig.restBaseUrl+"content/items/"+a.id+"/info/metadata/metadata.xml?f\x3ddefault",!1)});return e},getGroupLinks:function(a){var c=b.create,d=c("span",{"class":"esriItemLinks",style:"white-space: nowrap"});c("a",{href:esriGeowConfig.baseUrl+"group.html?owner\x3d"+a.owner+"\x26title\x3d"+encodeURIComponent(a.title),innerHTML:esri.i18nBundle.itemLinks.details,title:esri.i18nBundle.itemLinks.viewGroupDetails,alt:esri.i18nBundle.itemLinks.viewGroupDetails},d);return d},getItemDataPath:function(a){var b=
arcgisonline.sharing.util.getToken(),b=b?"?token\x3d"+b:"",d=esriGeowConfig.restBaseUrl+"content/items/"+a.id+"/data";return"KML"==a.type&&a.url&&-1===a.url.indexOf(d)?a.url:d+b},getItemPkgPath:function(a){var b=arcgisonline.sharing.util.getToken();return esriGeowConfig.restBaseUrl+"content/items/"+a.id+"/item.pkinfo"+(b?"?token\x3d"+b:"")},getPItemPath:function(a){var b=arcgisonline.sharing.util.getToken();return esriGeowConfig.restBaseUrl+"content/items/"+a.id+"/item.pitem"+(b?"?token\x3d"+b:"")},
getItemZipPath:function(a){var b=arcgisonline.sharing.util.getToken();return esriGeowConfig.restBaseUrl+"content/items/"+a.id+"/data?f\x3dzip"+(b?"\x26token\x3d"+b:"")},getUser:function(){this.checkSession();return""==esriGeowConfig.userInfo?null:esriGeowConfig.userInfo},meetsPasswordStrength:function(a){return 8<=a.length&&a.match("^.*(?\x3d.*\\d)(?\x3d.*[a-zA-Z]).*$")},meetsPasswordPolicyStrength:function(a,b){var d={meetsRequirements:function(){return this.minLength&&this.minLetter&&this.minUpper&&
this.minLower&&this.minDigit&&this.minOther},minLength:!0,minLetter:!0,minUpper:!0,minLower:!0,minDigit:!0,minOther:!0};if(b&&0<b.length){a.minLength&&(d.minLength=b.length>=a.minLength);if(a.minLetter){var e=b.match(/[A-Za-z]/g);d.minLetter=!!(e&&e.length>=a.minLetter)}a.minUpper&&(e=b.match(/[A-Z]/g),d.minUpper=!!(e&&e.length>=a.minUpper));a.minLower&&(e=b.match(/[a-z]/g),d.minLower=!!(e&&e.length>=a.minLower));a.minDigit&&(e=b.match(/[0-9]/g),d.minDigit=!!(e&&e.length>=a.minDigit));a.minOther&&
(e=b.match(/[\\!"#\$%&'\(\)\*\+,-\./:;<=>\?@\[\]\^_`\{\|}~]/g),d.minOther=!!(e&&e.length>=a.minOther))}else a.minLength&&(d.minLength=!1),a.minLetter&&(d.minLetter=!1),a.minUpper&&(d.minUpper=!1),a.minLower&&(d.minLower=!1),a.minDigit&&(d.minDigit=!1),a.minOther&&(d.minOther=!1);return d},userPreferences:function(a,c,d){var e=b.cookie(c||"esri_prefs");if(a)e&&(a=b.mixin(b.json.parse(e),a)),b.cookie(c||"esri_prefs",b.json.stringify(a),{path:"/",expires:1E4}),a.contentMode&&d&&this.getUser()?(e=b.create,
d=e("form",{method:"POST"},b.body()),e("input",{type:"hidden",name:"preferredView",value:a.contentMode},d),e("input",{type:"hidden",name:"clearEmptyFields",value:"false"},d),arcgisonline.sharing.geow.Community.updateProfile(d,function(d){b.publish("esri/userPreferences"+(c||"user_prefs"),[a])})):b.publish("esri/userPreferences"+(c||"user_prefs"),[a]);else return d="contentModePrefs"===c?esriGeowConfig.userInfo&&esriGeowConfig.userInfo.preferredView:null,null!=e?b.json.parse(e):d?{contentMode:d}:{}},
getToken:function(){return!1==this.isLoggedIn()?"":esriGeowConfig.userInfo.token},callPage:function(a){window.location=arcgisonline.sharing.util.replaceSSL(esriGeowConfig.baseUrl+a)},openPageAndCount:function(a,b,d){a=esriGeowConfig.restBaseUrl+"content/items/"+a+"/data";var e=arcgisonline.sharing.util.getToken(),f={f:"json"};null!=e&&""!=e&&(f.token=e);esri.request({url:a,content:f,callbackParamName:"callback"});arcgisonline.sharing.util.openPage(b,"boolean"===typeof d?d:!1)},openPage:function(a,
b){b?window.location=a:window.open(a)},fix:function(a){null!=a&&(1==a.length&&null!=a[0]&&0<a[0].length)&&(a=a[0]);return a.replace(/&lt;/g,"\x3c")},stripHTML:function(a){return!a?a:a.replace(/<(?:.|\s)*?>/g,"")},urlToObject:function(a){a=esri.urlToObject(a);a.query=a.query||{};for(key in a.query)a.query[key]=a.query[key].replace(/(&lt;|&gt;|<|>|%3C|%3E)/g,"");return a},linkifyText:function(a){a=a.split(" ");for(var b=0;b<a.length;b++)if(0==a[b].indexOf("http://")||0==a[b].indexOf("https://"))a[b]=
"\x3ca href\x3d'"+a[b]+"' target\x3d'_blank'\x3e"+a[b]+"\x3c/a\x3e";return a.join(" ")},removeHTMLTags:function(a){if(null==a)return"";a=a.replace(/&(lt|gt);/g,function(a,b){return"lt"==b?"\x3c":"\x3e"});return a.replace(/<\/?[^>]+(>|$)/g,"")},getSnippet:function(a,b){if(null==a||0==a.length)b=arcgisonline.sharing.util.removeHTMLTags(b),a=180<b.length?b.substring(0,180)+" ...":b;return a},trimTags:function(a){for(;-1<a.indexOf("  ");)a=a.replace(/  /g," ");for(;-1<a.indexOf(",,");)a=a.replace(/,,/g,
",");return a=b.trim(a.replace(/, ,/,",").replace(/^,/,"").replace(/,$/,""))},postProcessUri:function(a){a=0<=a.indexOf("?")?a+"\x26f\x3djson":a+"?f\x3djson";var b=this.getToken();null!=b&&""!=b&&(a=a+"\x26token\x3d"+b);return this.useSSL(a)},replaceSSL:function(a){return!1===esriGeowConfig.useSSL?a:a.replace("http://","https://")},useSSL:function(a){return"https:"==window.location.protocol?a.replace("http:","https:"):a},errorHandler:function(a,c,d,e){if(-1<d.indexOf(esriGeowConfig.restBaseUrl)&&
a.code&&498==a.code||403==a.code||400==a.code&&"Invalid account"==a.message)if(403==a.code&&!0==this.isLoggedIn())d&&-1<d.indexOf("/invitations/")&&e?e(a,c):0>window.location.href.indexOf(esriGeowConfig.baseUrl+"error.html")&&("Request not made over ssl"==a.message?window.location=esriGeowConfig.baseUrl+"error.html?c\x3dSSLRequired":arcgisonline.sharing.util.checkSubscriptionStatus(a)&&(window.location=esriGeowConfig.baseUrl+"error.html?c\x3dAccessDeniedResource"));else{if((403!==a.code||arcgisonline.sharing.util.checkSubscriptionStatus(a))&&
!(403===a.code&&!1===esriGeowConfig.isMultiTenant&&-1<b.indexOf(["COM_0056","COM_0057"],a.messageCode))){esriGeowConfig.userInfo=null;b.cookie("esri_auth",null,{expires:-1,path:"/",domain:document.domain});b.cookie("esri_auth",null,{expires:-1,path:"/",domain:".arcgis.com"});c="";-1==esriGeowConfig.signin.indexOf("http")&&(c=esriGeowConfig.baseUrl,!1!==esriGeowConfig.useSSL&&(c=c.replace("http:","https:")));c+=esriGeowConfig.signin;d="";e=c+("?error\x3d"+a.code);if(0>window.location.href.indexOf(e))-1<
window.location.href.indexOf(esriGeowConfig.webmapViewerPath)&&arcgisonline.map.main.map&&arcgisonline.map.main.mapInitialized?(arcgisonline.map.storage.saveMapInCookie(null,!1),d="\x26returnUrl\x3d"+encodeURIComponent(esriGeowConfig.baseUrl+esriGeowConfig.webmapViewerPath+"?useExisting\x3d1")):d="\x26returnUrl\x3d"+encodeURIComponent(window.location);else{var f=b.queryToObject(window.location.search.slice(1)).returnUrl;f&&(d="\x26returnUrl\x3d"+encodeURIComponent(f))}e+=d;0>window.location.href.indexOf(e)?
window.location=e:"User not part of this account"===a.message&&(window.location=c+"?error\x3d400"+d)}}else e?e(a,c):console.log(a.message)},checkSubscriptionStatus:function(a){return-1!==b.indexOf(["SB_0001","SB_0002","SB_0003","SB_0004"],a.messageCode)?(arcgisonline.sharing.dijit.dialog.SubscriptionStatusDlg.prototype.statics.getInstance().show(esriGeowConfig.self.subscriptionInfo),!1):-1!==b.indexOf(["SB_0005","SB_0006","SB_0007"],a.messageCode)?(arcgisonline.sharing.dijit.dialog.SubscriptionStatusDlg.prototype.statics.getInstance().showOther(a.messageCode),
!1):!0},checkError:function(a){var c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),d;return-1!==b.indexOf("COM_0044 COM_0047 CONT_0046 CONT_0047 COM_1043 COM_1044 COM_1045 COM_1046".split(" "),a.messageCode)?(a=(d=b.mixin({},b.i18n.getLocalization("arcgisonline","arcgisonline").common))&&d.errors&&d.errors[a.messageCode]?{message:d.errors[a.messageCode]}:a,a=b.mixin(b.mixin({},d.errors.genericError),a),c.show(a),!1):!0},handler:function(a,b,d,e,f){a.error&&""!=a.error?
arcgisonline.sharing.util.errorHandler(a.error,b,d,f):e&&e(a,b)},getJson:function(a,b,d){return arcgisonline.sharing.util._requestWithAppHandlers({url:a},{},b,d)},getJsonWithContent:function(a,b,d,e){return arcgisonline.sharing.util._requestWithAppHandlers({url:a,content:b},{},d,e)},postJson:function(a,b,d,e){return arcgisonline.sharing.util._requestWithAppHandlers({url:b,content:a},{usePost:!0},d,e)},postForm:function(a,b,d,e){return arcgisonline.sharing.util._requestWithAppHandlers({url:b,form:a},
{usePost:!0},d,e)},_requestWithAppHandlers:function(a,b,d,e){var f=arcgisonline.sharing.util.request(a,b);f.then(function(b,c){arcgisonline.sharing.util.handler(b||{},f.ioArgs,a.url,d,e);return b},function(b,c){arcgisonline.sharing.util.errorHandler(b||{},f.ioArgs,a.url,e);throw b;});return f},request:function(a,c){var d=a.url,e=a.content||{};c=c||{};var f=arcgisonline.sharing.util.getToken(),g,l=arcgisonline.sharing.util.urlToObject(d).query||{};!e.f&&!l.f&&(e=b.mixin(e,{f:"json"}));f&&!e.token&&
!1!==c.addToken?e.token=f:!1===c.addToken&&delete e.token;a=b.mixin({},{url:!1===c.addSSL?d:arcgisonline.sharing.util.useSSL(d),content:e,form:a.form,callbackParamName:a.form?a.callbackParamName||null:a.callbackParamName||"callback",timeout:c&&c.timeout||0});g=esri.request(a,c);g.addErrback(function(a){"IdentityManagerBase.1"===a.code&&(a.code=a.httpCode);arcgisonline.sharing.util.checkSoftwareAuthError(a,g);arcgisonline.sharing.util.checkSubscriptionStatus(a)||(g.canceled=!0);arcgisonline.sharing.util.isUnlicensed(a)&&
(g.canceled=!0,-1===window.location.href.indexOf("unlicensed.html")&&(window.location=esriGeowConfig.baseUrl+"unlicensed.html"));arcgisonline.sharing.util.isInvalidUser(a)&&(g.canceled=!0,arcgisonline.sharing.geow.Geow.signout(esriGeowConfig.baseUrl+"index.html"));arcgisonline.sharing.util.checkError(a)||(g.canceled=!0);throw a;});return g},checkSoftwareAuthError:function(a,c){var d=["COM_0056","COM_0057"];!1===esriGeowConfig.isMultiTenant&&(a.code&&403===a.code&&a.messageCode&&-1!==b.indexOf(d,a.messageCode)&&
-1===window.location.href.indexOf("error.html"))&&(c.canceled=!0,"COM_0056"===a.messageCode?window.location=esriGeowConfig.baseUrl+"error.html?c\x3dPortalCreateAccount":"COM_0057"===a.messageCode&&(window.location=esriGeowConfig.baseUrl+"error.html?c\x3dPortalSignIn"))},isUnlicensed:function(a){return!1===esriGeowConfig.isMultiTenant&&a.code&&503===a.code&&a.messageCode&&"GWM_0006"===a.messageCode},isInvalidUser:function(a){return!1===esriGeowConfig.isMultiTenant&&a.code&&404===a.code&&a.messageCode&&
"POR_205244"===a.messageCode},isNode:function(a){return"object"===typeof Node?a instanceof Node:a&&"object"===typeof a&&"number"===typeof a.nodeType&&"string"===typeof a.nodeName},isElement:function(a){return"object"===typeof HTMLElement?a instanceof HTMLElement:a&&"object"===typeof a&&1===a.nodeType&&"string"===typeof a.nodeName},isHostedService:function(a){if(!a)return!1;var c=(new b._Url(esriGeowConfig.restBaseUrl)).authority,d=!1===esriGeowConfig.isMultiTenant,e=-1!==a.indexOf(".arcgis.com/"),
f=-1!==a.indexOf("//services")||-1!==a.indexOf("//tiles")||-1!==a.indexOf("//features");a=esri.isDefined(esriGeowConfig.self)&&esriGeowConfig.self.supportsHostedServices&&-1!==a.indexOf(c)&&!d;return e&&f||!e&&a},isHostedServiceItem:function(a){return arcgisonline.sharing.util.isHostedService(a.item)||arcgisonline.sharing.util.isHostedService(a.url)},isHostedTemplateItem:function(a){a=a.split("?")[0];return(a=a.match(/http.+(arcgis.com\/apps)\/?/ig))&&a.length?!0:!1},isAgolService:function(a){return!a?
!1:-1!==a.indexOf("/services.arcgisonline.com/")||-1!==a.indexOf("/server.arcgisonline.com/")},supportsHttps:function(a){if(!a)return!1;var c=!1;b.forEach(esriGeowConfig.httpsDomains,function(b){if(-1<a.indexOf("."+b+"/")||-1<a.indexOf("/"+b+"/"))c=!0});!c&&-1<a.indexOf(esriGeowConfig.self.portalHostname)&&(c=!0);return c},isArcGISServer:function(a){var b=/http.+\/(arcgis\/rest\/services|arcgis\/services)\/?/ig,d=/(\/(MapServer|GeocodeServer|GPServer|GeometryServer|ImageServer|NAServer|FeatureServer|GeoDataServer|GlobeServer|MobileServer)).*/ig;
return(a=(a=a&&a.split("?")[0])&&a.replace(b,"").match(d))&&a.length?a[0].split("/")[1]:null},getStaticImagesUrl:function(){var a=esriGeowConfig.staticImagesUrl||esriGeowConfig.self.staticImagesUrl;return(esriGeowConfig.allSSL||"https:"===location.protocol)&&a?a.replace("http:","https:"):a},getRedSphereUrl:function(){return arcgisonline.sharing.util.getStaticImagesUrl()+"/Symbols/Basic/RedSphere.png"},doNothing:function(){},parseUrl:function(a){var b=document.createElement("a");b.href=a;for(var d=
b.protocol.replace(":",""),e=b.hostname||window.location.host,f=b.port,g=b.search,l={},m=b.search.replace(/^\?/,"").split("\x26"),h=m.length,k=0,p;k<h;k++)m[k]&&(p=m[k].split("\x3d"),l[p[0]]=p[1]);return{source:a,protocol:d,host:e,port:f,query:g,params:l,file:(b.pathname.match(/\/([^\/?#]+)$/i)||[,""])[1],hash:b.hash.replace("#",""),path:b.pathname.replace(/^([^\/])/,"/$1"),relative:(b.href.match(/tps?:\/\/[^\/]+(.+)/)||[,""])[1],segments:b.pathname.replace(/^\//,"").split("/")}},ellipse:function(a,
b){a&&(a.length>b&&0<b-4)&&(a=a.substring(0,b-4)+"...");return a},appendTags:function(a,c){var d=a.get("value");c=d?c.split(",").concat(d.split(",")):c.split(",");a.set("value",arcgisonline.sharing.util.getUniqueArray(c).join(","));b.style(a.domNode,"color","#000000")},getUniqueArray:function(a){var c={};return b.filter(a,function(a){return c[a]?!1:c[a]=!0})},relativeToExplicitUrl:function(a){esriGeowConfig.cdnServerUrl=b.baseUrl.substring(0,b.baseUrl.indexOf("/js/"));return esriGeowConfig.cdnServerUrl.lastIndexOf("/")===
esriGeowConfig.cdnServerUrl.length-1?esriGeowConfig.cdnServerUrl+a:esriGeowConfig.cdnServerUrl+"/"+a},getCookie:function(a){var c=this._cookies&&this._cookies[a]||null;if(!c){if((c=(c=b.cookie(a))?b.json.parse(c):-1)&&c.role)c.role=c.role?c.role.replace("org_","account_"):c.role;c&&(this._cookies||(this._cookies={}),this._cookies[a]=c)}return-1===c||esriGeowConfig.ignoreCookie?null:c},canSharePublic:function(){return esriGeowConfig.self&&(!0===esriGeowConfig.self.canSharePublic||!1===esriGeowConfig.self.canSharePublic)?
esriGeowConfig.self.canSharePublic:!0},getSecureUrl:function(a){a||(a=esriGeowConfig.baseUrl);if(!esriGeowConfig.self||!esriGeowConfig.self.portalMode||"singletenant"!==esriGeowConfig.self.portalMode||!esriGeowConfig.self.httpsPort)return a.replace("http:","https:");location.port?(a=a.replace(location.port,esriGeowConfig.self.httpsPort),arcgisonline.sharing.util.isPortal()&&(a=a.replace(esriGeowConfig.self.httpPort,esriGeowConfig.self.httpsPort))):a=a.replace(location.hostname,location.hostname+":"+
esriGeowConfig.self.httpsPort);a=a.replace("http:","https:");console.log("Secure URL \x3d\x3d\x3d\x3e  ",a);return arcgisonline.sharing.util.cleanPorts(a)},htmlEncode:function(a){return!a?a:a.replace(/&/g,"\x26amp;").replace(/>/g,"\x26gt;").replace(/</g,"\x26lt;").replace(/"/g,"\x26quot;")},getHttpUrl:function(a){a||(a=esriGeowConfig.baseUrl);if(!esriGeowConfig.self||!esriGeowConfig.self.portalMode||"singletenant"!==esriGeowConfig.self.portalMode||!esriGeowConfig.self.httpPort)return a.replace("https:",
"http:");location.port?(a=a.replace(location.port,esriGeowConfig.self.httpPort),arcgisonline.sharing.util.isPortal()&&(a=a.replace(esriGeowConfig.self.httpsPort,esriGeowConfig.self.httpPort))):a=a.replace(location.hostname,location.hostname+":"+esriGeowConfig.self.httpPort);a=a.replace("https:","http:");console.log("HTTP URL \x3d\x3d\x3d\x3e  ",a);return arcgisonline.sharing.util.cleanPorts(a)},cleanPorts:function(a){return a.replace(/\:80\//,"/").replace(/\:443\//,"/")},usePortalSSL:function(){return(!1===
esriGeowConfig.isMultiTenant||arcgisonline.sharing.util.isPortal())&&esriGeowConfig.self&&esriGeowConfig.self.portalHostname&&!esriGeowConfig.self.portalHostname.match(/:7080\//)&&80!==esriGeowConfig.self.httpPort&&443!==esriGeowConfig.self.httpsPort&&"https:"===location.protocol},onAGOLFederatedServer:function(a){for(var b=!1,d=0;d<esriGeowConfig.httpsDomains.length;d++)if(a&&-1<a.indexOf(esriGeowConfig.httpsDomains[d])){b=!0;break}return b},onFederatedServer:function(a){var c=!1;a&&(0<a.length&&
esriGeowConfig.federatedServers&&0<esriGeowConfig.federatedServers.length)&&(c=b.some(esriGeowConfig.federatedServers,b.hitch(this,function(b){return-1<a.indexOf(b.url)||-1<a.indexOf(b.adminUrl)})));return c},isPortal:function(){return esri.isDefined(esriGeowConfig.self)&&esriGeowConfig.self.isPortal},portalSupportsHostedServices:function(){return arcgisonline.sharing.util.isPortal()&&esriGeowConfig.self.supportsHostedServices},getHomeAppContext:function(){if(arcgisonline.sharing.util.isPortal()){var a=
window.location.pathname,b=a.indexOf("/home");if(0<b)return a.substring(0,b)}return""},normalizeOrgRole:function(a){return a?a.replace("org_","account_"):a},checkForIAA:function(){var a=new b.Deferred,c=esriGeowConfig.baseUrl.substring(0,esriGeowConfig.baseUrl.indexOf("/home"))+"/portaladmin";b.xhrGet({url:c,handleAs:"json",content:{f:"json",ts:(new Date).getTime()}}).then(b.hitch(this,function(b){var c=arcgisonline.sharing.util.getUser();b&&b.status&&"error"===b.status&&b.code&&503===b.code?a.resolve({hasIAA:!0}):
b&&(!b.error&&!c||!c&&b.error&&b.error.code&&499!==b.error.code)?-1===window.location.href.indexOf("createadmin.html")?window.location=arcgisonline.sharing.util.getSecureUrl("https://"+esriGeowConfig.self.portalHostname+"/home/createadmin.html"):a.resolve({hasIAA:!1}):a.resolve({hasIAA:!0})}),b.hitch(this,function(b){499!==b.status?-1===window.location.href.indexOf("createadmin.html")?window.location=arcgisonline.sharing.util.getSecureUrl("https://"+esriGeowConfig.self.portalHostname+"/home/createadmin.html"):
a.resolve({hasIAA:!1}):a.resolve({hasIAA:!0})}));return a},getBridgeUrl:function(a,b){var d=esriGeowConfig.bridgeUrl+"?url\x3d"+encodeURIComponent(a);return b.expires?d+"\x26exp\x3d"+Math.ceil((new Date(b.expires)-new Date)/1E3):d},getUserDisplayName:function(a){var b=a&&a.fullName||"";a=a.firstName||b;-1<b.indexOf("_")?a=b.split("_")[0]:-1<b.indexOf(",")?a=b.split(",").slice(1).join(" "):-1<b.indexOf(" ")&&(a=b.split(" ")[0]);return a.replace(/(?:(?:^|\n)\s+|\s+(?:$|\n))/g,"").replace(/\s+/g," ")},
isProApp:function(a){return a&&"ArcGIS Pro"===a.title&&"esri_apps"===a.owner&&a.tags&&-1<b.indexOf(a.tags,"pro")},findProListing:function(){var a=new b.Deferred,c=!1,d=!1,e;arcgisonline.sharing.util.request({url:esriGeowConfig.restBaseUrl+"portals/self/purchases"}).then(b.hitch(this,function(f){f.purchases?(b.forEach(f.purchases,b.hitch(this,function(a){if(!d&&(a.listing&&"ArcGIS Pro"===a.listing.title&&"esri_apps"===a.listing.owner&&"licenseByUser"===a.listing.licenseBy)&&(c=b.some(a.listing.tags,
b.hitch(this,function(a){return a&&"pro"===a.toLowerCase()}))))e=a,d=!0})),a.resolve(d?e:null)):a.resolve(null)}),b.hitch(this,function(b){a.reject(b)}));return a},isEsriWorldGeocoder:function(a){var b=arcgisonline.sharing.util.isEsriWorldGeocoderNoProxy(a);a=arcgisonline.sharing.util.isEsriWorldGeocoderThroughProxy(a);return b||a},isEsriWorldGeocoderNoProxy:function(a){return a&&!!a.match(/(arcgis.com\/arcgis\/rest\/services\/world\/geocodeserver).*/ig)},isEsriWorldGeocoderThroughProxy:function(a){return a&&
!!a.match(/(\/servers\/[\da-z\.-]+\/rest\/services\/world\/geocodeserver).*/ig)},filterBatchGeocoders:function(a){return b.filter(a,b.hitch(this,function(a){var b=arcgisonline.sharing.util.isEsriWorldGeocoderNoProxy(a.url),e=arcgisonline.sharing.util.isEsriWorldGeocoderThroughProxy(a.url);if((b||e)&&!esri.isDefined(a.name))a.name=esri.i18nBundle.common.esriWorldGeocoder;return arcgisonline.sharing.util.isPortal()&&b?!1:b||e||!!a.batch}))},loadUserTags:function(a){var c=new b.Deferred;a?arcgisonline.sharing.util.request({url:esriGeowConfig.restBaseUrl+
"community/users/"+a+"/tags",content:{ts:(new Date).getTime()}}).then(b.hitch(this,function(a){var b=[];a&&a.tags&&(b=a.tags);c.resolve(b)}),b.hitch(this,function(a){c.resolve([])})):c.resolve([]);return c}}})},"dijit/Menu":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/_base/window dojo/window ./popup ./DropDownMenu dojo/ready".split(" "),function(h,b,k,a,c,d,e,f,g,l,m,n,q,p,
s,t){m("dijit-legacy-requires")&&t(0,function(){h(["dijit/MenuItem","dijit/PopupMenuItem","dijit/CheckedMenuItem","dijit/MenuSeparator"])});return k("dijit.Menu",s,{constructor:function(){this._bindings=[]},targetNodeIds:[],selector:"",contextMenuForWindow:!1,leftClickToOpen:!1,refocus:!0,postCreate:function(){this.contextMenuForWindow?this.bindDomNode(this.ownerDocumentBody):b.forEach(this.targetNodeIds,this.bindDomNode,this);this.inherited(arguments)},_iframeContentWindow:function(a){return q.get(this._iframeContentDocument(a))||
this._iframeContentDocument(a).__parent__||a.name&&document.frames[a.name]||null},_iframeContentDocument:function(a){return a.contentDocument||a.contentWindow&&a.contentWindow.document||a.name&&document.frames[a.name]&&document.frames[a.name].document||null},bindDomNode:function(b){b=a.byId(b,this.ownerDocument);var d;if("iframe"==b.tagName.toLowerCase()){var e=b;d=this._iframeContentWindow(e);d=n.body(d.document)}else d=b==n.body(this.ownerDocument)?this.ownerDocument.documentElement:b;var m={node:b,
iframe:e};c.set(b,"_dijitMenu"+this.id,this._bindings.push(m));var h=g.hitch(this,function(a){var b=this.selector,c=b?function(a){return l.selector(b,a)}:function(a){return a},d=this;return[l(a,c(this.leftClickToOpen?"click":"contextmenu"),function(a){a.stopPropagation();a.preventDefault();(new Date).getTime()<this._lastKeyDown+500||d._scheduleOpen(this,e,{x:a.pageX,y:a.pageY},a.target)}),l(a,c("keydown"),function(a){if(93==a.keyCode||a.shiftKey&&a.keyCode==f.F10||this.leftClickToOpen&&a.keyCode==
f.SPACE)a.stopPropagation(),a.preventDefault(),d._scheduleOpen(this,e,null,a.target),this._lastKeyDown=(new Date).getTime()})]});m.connects=d?h(d):[];e&&(m.onloadHandler=g.hitch(this,function(){var a=this._iframeContentWindow(e),a=n.body(a.document);m.connects=h(a)}),e.addEventListener?e.addEventListener("load",m.onloadHandler,!1):e.attachEvent("onload",m.onloadHandler))},unBindDomNode:function(b){var d;try{d=a.byId(b,this.ownerDocument)}catch(e){return}b="_dijitMenu"+this.id;if(d&&c.has(d,b)){for(var f=
c.get(d,b)-1,g=this._bindings[f],l;l=g.connects.pop();)l.remove();(l=g.iframe)&&(l.removeEventListener?l.removeEventListener("load",g.onloadHandler,!1):l.detachEvent("onload",g.onloadHandler));c.remove(d,b);delete this._bindings[f]}},_scheduleOpen:function(a,b,c,d){this._openTimer||(this._openTimer=this.defer(function(){delete this._openTimer;this._openMyself({target:d,delegatedTarget:a,iframe:b,coords:c})},1))},_openMyself:function(b){function c(){t.refocus&&q&&q.focus();p.close(t)}var f=b.target,
g=b.iframe,l=b.coords,h=!l;this.currentTarget=b.delegatedTarget;if(l){if(g){b=d.position(g,!0);var f=this._iframeContentWindow(g),f=d.docScroll(f.document),k=e.getComputedStyle(g),n=e.toPixelValue,s=(m("ie")&&m("quirks")?0:n(g,k.paddingLeft))+(m("ie")&&m("quirks")?n(g,k.borderLeftWidth):0),g=(m("ie")&&m("quirks")?0:n(g,k.paddingTop))+(m("ie")&&m("quirks")?n(g,k.borderTopWidth):0);l.x+=b.x+s-f.x;l.y+=b.y+g-f.y}}else l=d.position(f,!0),l.x+=10,l.y+=10;var t=this,g=this._focusManager.get("prevNode");
b=this._focusManager.get("curNode");var q=!b||a.isDescendant(b,this.domNode)?g:b;p.open({popup:this,x:l.x,y:l.y,onExecute:c,onCancel:c,orient:this.isLeftToRight()?"L":"R"});this.focus();h||this.defer(function(){this._cleanUp(!0)});this._onBlur=function(){this.inherited("_onBlur",arguments);p.close(this)}},destroy:function(){b.forEach(this._bindings,function(a){a&&this.unBindDomNode(a.node)},this);this.inherited(arguments)}})})},"dijit/form/_CheckBoxMixin":function(){define(["dojo/_base/declare","dojo/dom-attr"],
function(h,b){return h("dijit.form._CheckBoxMixin",null,{type:"checkbox",value:"on",readOnly:!1,_aria_attr:"aria-checked",_setReadOnlyAttr:function(h){this._set("readOnly",h);b.set(this.focusNode,"readOnly",h)},_setLabelAttr:void 0,_getSubmitValue:function(b){return null==b||""===b?"on":b},_setValueAttr:function(h){h=this._getSubmitValue(h);this._set("value",h);b.set(this.focusNode,"value",h)},reset:function(){this.inherited(arguments);this._set("value",this._getSubmitValue(this.params.value));b.set(this.focusNode,
"value",this.value)},_onClick:function(b){return this.readOnly?(b.stopPropagation(),b.preventDefault(),!1):this.inherited(arguments)}})})},"arcgisonline/sharing/geow/Content":function(){define(["dijit","dojo","dojox","dojo/require!arcgisonline/sharing/util,esri/arcgis/Portal"],function(h,b,k){b.provide("arcgisonline.sharing.geow.Content");b.require("arcgisonline.sharing.util");b.require("esri.arcgis.Portal");arcgisonline.sharing.geow.Content={util:arcgisonline.sharing.util,i18n:function(){if(this._i18n)return this._i18n;
this._i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(this._i18n,{source:b.i18n.getLocalization("arcgisonline","arcgisonline").itemProperties.source});return this._i18n},getUserInfo:function(a,b){var d=this.util.getUser();null!=d&&this.util.getJson(esriGeowConfig.restBaseUrl+"content/users/"+d.email,a,b)},getUserItems:function(a,b,d){var e=this.util.getUser();null!=e&&(e=esriGeowConfig.restBaseUrl+"content/users/"+e.email,null!=a&&""!=a&&(e=e+"/"+a),this.util.getJson(e,b,
d))},getUserItemsByUser:function(a,b,d,e){null!=this.util.getUser()&&(a=esriGeowConfig.restBaseUrl+"content/users/"+a,null!=b&&""!=b&&(a=a+"/"+b),this.util.getJson(a,d,e))},getUserServers:function(a){void 0!==this._userServers&&a(this._userServers);this.util.getJson(esriGeowConfig.serversRestBaseUrl,function(b){a(this._userServers=b.servers)},function(b){a(null)})},addItem:function(a,c,d,e){var f=this.util.getUser();if(null!=f){f=esriGeowConfig.restBaseUrl+"content/users/"+f.email;null!=a&&(f=f+"/"+
a);f+="/addItem";a=!1;for(var g=0;g<c.childNodes.length;g++){var l=c.childNodes[g];if("async"===l.name&&"true"===l.value){a=!0;break}}a?this.util.postForm(c,f,b.hitch(arcgisonline.sharing.geow.Content,"addItemAsyncHandler",d,e),e):this.util.postForm(c,f,d,e)}},addItemByUser:function(a,c,d,e,f){if(null!=this.util.getUser()){a=esriGeowConfig.restBaseUrl+"content/users/"+a;null!=c&&(a=a+"/"+c);a+="/addItem";c=!1;for(var g=0;g<d.childNodes.length;g++){var l=d.childNodes[g];if("async"===l.name&&"true"===
l.value){c=!0;break}}c?this.util.postForm(d,a,b.hitch(arcgisonline.sharing.geow.Content,"addItemByUserAsyncHandler",e,f),f):this.util.postForm(d,a,e,f)}},addItemAsyncHandler:function(a,c,d,e){d&&d.success&&!0===d.success?arcgisonline.sharing.geow.Content.itemStatus(d,b.hitch(arcgisonline.sharing.geow.Content,"itemStatusHandler",0,d,a,c),c):c(d,e)},addItemByUserAsyncHandler:function(a,c,d,e){d&&d.success&&!0===d.success?arcgisonline.sharing.geow.Content.itemStatus(d,b.hitch(arcgisonline.sharing.geow.Content,
"itemStatusByUserHandler",0,d,a,c),c):c(d,e)},deleteService:function(a,c){this.getUserServers(b.hitch(this,function(d){if(d&&d.length&&-1<a.indexOf(esriGeowConfig.featuresRestBaseUrl+d[0].id+"/")){d=esriGeowConfig.serversRestBaseUrl+d[0].id+"/arcgis/admin/services/";d+=a.substr(a.indexOf(c)).replace("/",".")+"/delete";esri.config.defaults.io.proxyUrl=esriGeowConfig.proxyServer;var e=b.hitch(this,function(a){esri.config.defaults.io.proxyUrl=null});this.util.postJson("",d,e,e)}}))},publishService:function(a,
c,d,e){a=this.util.getUser();if(null!=a){a=esriGeowConfig.restBaseUrl+"content/users/"+a.email+"/publish";c=c.params;var f=b.hitch(this,function(a){d(a)});this.util.postJson(c,a,b.hitch(this,function(a){a=a.services[0];a.success=a.success||a.serviceurl&&0<a.serviceurl.length;a.success?(a.id=a.serviceItemId,d(a)):f(a)}),b.hitch(this,function(a){f({success:!1})}))}},itemStatus:function(a,b,d){var e=this.util.getUser();if(null!=e){var f=a.folder,e=esriGeowConfig.restBaseUrl+"content/users/"+(a.overrideUser||
e.email);f&&(0<f.length&&"/"!=f)&&(e+="/"+f);e=e+"/items/"+a.id+"/status";a.jobid&&(e+="?jobid\x3d"+a.jobid);this.util.getJson(e,b,d)}},itemStatusByUser:function(a,b,d){if(null!=this.util.getUser()){var e=a.folder,f=esriGeowConfig.restBaseUrl+"content/users/"+a.owner;e&&(0<e.length&&"/"!=e)&&(f+="/"+e);f=f+"/items/"+a.id+"/status";this.util.getJson(f,b,d)}},itemStatusHandler:function(a,c,d,e,f,g){f&&f.status&&"processing"===f.status?(a++,setTimeout(b.hitch(this,function(){arcgisonline.sharing.geow.Content.itemStatus(c,
b.hitch(arcgisonline.sharing.geow.Content,"itemStatusHandler",a,c,d,e),e)}),Math.min(1E3*Math.pow(2,a),6E4))):(b.mixin(f,c),d(f,g))},itemStatusByUserHandler:function(a,c,d,e,f,g){f&&f.status&&"processing"===f.status?(a++,setTimeout(b.hitch(this,function(){arcgisonline.sharing.geow.Content.itemStatusByUser(c,b.hitch(arcgisonline.sharing.geow.Content,"itemStatusByUserHandler",a,c,d,e),e)}),Math.min(1E3*Math.pow(2,a),6E4))):(b.mixin(f,c),d(f,g))},deleteItems:function(a,c,d){var e=this.util.getUser();
if(null!=e)if(1==a.length)a=a[0],e=esriGeowConfig.restBaseUrl+"content/users/"+e.email,null!=a.folderId&&(""!=a.folderId&&"/"!=a.folderId)&&(e+="/"+a.folderId),e=e+"/items/"+a.id+"/delete",this.util.postJson("",e,c,d);else if(1<a.length){var f="",g="";b.forEach(a,function(a){f+=g+a.id;g=","},this);a={items:f};e=esriGeowConfig.restBaseUrl+"content/users/"+e.email+"/deleteItems";this.util.postJson(a,e,c,d)}},deleteItemsByUser:function(a,c,d,e){if(null!=this.util.getUser())if(1==c.length)c=c[0],a=esriGeowConfig.restBaseUrl+
"content/users/"+a,null!=c.folderId&&(""!=c.folderId&&"/"!=c.folderId)&&(a+="/"+c.folderId),a=a+"/items/"+c.id+"/delete",this.util.postJson("",a,d,e);else if(1<c.length){var f="",g="";b.forEach(c,function(a){f+=g+a.id;g=","},this);c={items:f};a=esriGeowConfig.restBaseUrl+"content/users/"+a+"/deleteItems";this.util.postJson(c,a,d,e)}},getApplicationCode:function(a,c,d){var e=null,f="WMA2Code";b.isObject(a)?(e=a.id,"Mobile Application"===a.type&&(f="MobileApp2Code")):e=a;this.util.getJson(esriGeowConfig.restBaseUrl+
"content/items/"+e+"/relatedItems?relationshipType\x3d"+f,c,d)},addApplicationCodeRelate:function(a,c,d,e){var f=this.util.getUser();if(null==f)b.publish("globalMessage",[{message:this.i18n().mustLogIn,type:"error",duration:0}]);else{var g=null,l="WMA2Code";b.isObject(a)?(g=a.id,"Mobile Application"===a.type&&(l="MobileApp2Code")):g=a;this.util.postJson({relationshipType:l,originItemId:g,desinationItemId:c},esriGeowConfig.restBaseUrl+"content/users/"+f.email+"/addRelationship?relationshipType\x3d"+
l+"\x26originItem\x3d"+g+"\x26destinationItemId\x3d"+c,d,e)}},getComments:function(a,b,d,e){this.util.getJson(esriGeowConfig.restBaseUrl+"content/items/"+a+"/comments",d,e)},addComment:function(a,c,d,e){null==this.util.getUser()?b.publish("globalMessage",[{message:this.i18n().mustLogIn,type:"error",duration:0}]):this.util.postJson({comment:c},esriGeowConfig.restBaseUrl+"content/items/"+a+"/addComment",d,e)},deleteComment:function(a,c,d,e){null==this.util.getUser()?b.publish("globalMessage",[{message:this.i18n().mustLogIn,
type:"error",duration:0}]):this.util.postJson({},esriGeowConfig.restBaseUrl+"content/items/"+a+"/comments/"+c+"/delete",d,e)},addRating:function(a,c,d,e){null==this.util.getUser()?b.publish("globalMessage",[{message:this.i18n().mustLogIn,type:"error",duration:0}]):this.util.postJson({rating:c},esriGeowConfig.restBaseUrl+"content/items/"+a+"/addRating",d,e)},getRating:function(a,b,d){null!=this.util.getUser()&&this.util.postJson({},esriGeowConfig.restBaseUrl+"content/items/"+a+"/rating",b,d)},deleteItem:function(a,
b,d){var e=this.util.getUser();null!=e&&(e=esriGeowConfig.restBaseUrl+"content/users/"+e.email,null!=a.folderId&&(e=e+"/"+a.folderId),e=e+"/items/"+a.id+"/delete",this.util.postJson("",e,b,d))},deleteItemByUser:function(a,b,d){if(null!=this.util.getUser()){var e=esriGeowConfig.restBaseUrl+"content/users/"+a.owner;null!=a.folderId&&(e=e+"/"+a.folderId);e=e+"/items/"+a.id+"/delete";this.util.postJson("",e,b,d)}},updateItem:function(a,b,d,e){var f=this.util.getUser();null!=f&&(f=esriGeowConfig.restBaseUrl+
"content/users/"+f.email,null!=a.folderId&&(f=f+"/"+a.folderId),f=f+"/items/"+a.id+"/update",this.util.postForm(b,f,d,e))},updateItemByUser:function(a,b,d,e){if(null!=this.util.getUser()){var f=esriGeowConfig.restBaseUrl+"content/users/"+a.owner;null!=a.folderId&&(f=f+"/"+a.folderId);f=f+"/items/"+a.id+"/update";this.util.postForm(b,f,d,e)}},updateItemJson:function(a,b,d,e){var f=this.util.getUser();null!=f&&(f=esriGeowConfig.restBaseUrl+"content/users/"+(a.overrideUser||f.email),null!=a.folderId&&
(f=f+"/"+a.folderId),f=f+"/items/"+a.id+"/update",this.util.postJson(b,f,d,e))},updateItemJsonByUser:function(a,b,d,e){null!=this.util.getUser()&&(a=esriGeowConfig.restBaseUrl+"content/users/"+a,null!=b.folderId&&(a=a+"/"+b.folderId),a=a+"/items/"+b.id+"/update",this.util.postJson(d,a,e))},filterErrors:function(a){if((a=a&&a.results)&&a.length)if((a=b.filter(a,"return item.error"))&&a.length)return this.util.checkError(a[0].error),a;return!1},shareItems:function(a,c,d){var e=this.util.getUser();null!=
e&&this.util.postJson(a,esriGeowConfig.restBaseUrl+"content/users/"+e.email+"/shareItems",b.hitch(this,function(a){var b=this.filterErrors(a);b?d(b):c(a)}),d)},shareItemsByUser:function(a,b,d,e){null!=this.util.getUser()&&this.util.postJson(b,esriGeowConfig.restBaseUrl+"content/users/"+a+"/shareItems",d,e)},shareItem:function(a,b,d,e){var f=this.util.getUser();null!=f&&(f=esriGeowConfig.restBaseUrl+"content/users/"+f.email,null!=a.folderId&&(f=f+"/"+a.folderId),f=f+"/items/"+a.id+"/share",this.util.postJson(b,
f,d,e))},shareItemByID:function(a,b,d,e){null!=this.util.getUser()&&this.util.postJson(b,esriGeowConfig.restBaseUrl+"content/items/"+a.id+"/share",d,e)},unshareItems:function(a,c,d){var e=this.util.getUser();null!=e&&this.util.postJson(a,esriGeowConfig.restBaseUrl+"content/users/"+e.email+"/unshareItems",b.hitch(this,function(a){var b=this.filterErrors(a);b?d(b):c(a)}),d)},unshareItemsByUser:function(a,b,d,e){null!=this.util.getUser()&&this.util.postJson(b,esriGeowConfig.restBaseUrl+"content/users/"+
a+"/unshareItems",d,e)},unshareItem:function(a,b,d,e){var f=this.util.getUser();null!=f&&(f=esriGeowConfig.restBaseUrl+"content/users/"+f.email,null!=a.folderId&&(f=f+"/"+a.folderId),f=f+"/items/"+a.id+"/unshare",this.util.postJson(b,f,d,e))},unshareItemByID:function(a,b,d,e){null!=this.util.getUser()&&this.util.postJson(b,esriGeowConfig.restBaseUrl+"content/items/"+a.id+"/unshare",d,e)},moveItems:function(a,c,d,e){var f=this.util.getUser();if(null!=f){var g="",l="";b.forEach(a,function(a){g+=l+a.id;
l=","},this);c.items=g;this.util.postJson(c,esriGeowConfig.restBaseUrl+"content/users/"+f.email+"/moveItems",d,e)}},moveItemsByUser:function(a,c,d,e,f){if(null!=this.util.getUser()){var g="",l="";b.forEach(c,function(a){g+=l+a.id;l=","},this);d.items=g;this.util.postJson(d,esriGeowConfig.restBaseUrl+"content/users/"+a+"/moveItems",e,f)}},reassignItem:function(a,b,d,e,f){if(null!=this.util.getUser()){var g=esriGeowConfig.restBaseUrl+"content/users/"+a.owner;null!==a.folderId&&(g=g+"/"+a.folderId);
g=g+"/items/"+a.id+"/reassign";this.util.postJson({targetUsername:b,targetFolderName:d},g,e,f)}},moveItem:function(a,b,d,e){var f=this.util.getUser();null!=f&&(f=esriGeowConfig.restBaseUrl+"content/users/"+f.email,null!=a.folderId&&(f=f+"/"+a.folderId),f=f+"/items/"+a.id+"/move",this.util.postJson(b,f,d,e))},moveItemByUser:function(a,b,d,e){if(null!=this.util.getUser()){var f=esriGeowConfig.restBaseUrl+"content/users/"+a.owner;null!=a.folderId&&(f=f+"/"+a.folderId);f=f+"/items/"+a.id+"/move";this.util.postJson(b,
f,d,e)}},search:function(a,c,d,e){if(a){e="";if(0>a.indexOf("community/groups")){var f=this.util.userPreferences(null,"contentModePrefs"),g=b.queryToObject(window.location.search.slice(1));g.content&&"all"===g.content.toLowerCase()?f.contentMode="GIS":g.content&&"web"===g.content.toLowerCase()&&(f.contentMode="Web");e=f&&f.contentMode&&"GIS"===f.contentMode?esriGeowConfig.viewQueries.gis:e+esriGeowConfig.viewQueries.web;e+=esriGeowConfig.viewQueries.none}c.q+=e;this.util.getJsonWithContent(a,c,d)}},
getFeaturedItems:function(a,b,d){this.util.getJson(esriGeowConfig.restBaseUrl+"content/items/"+a+"/relatedItems?relationshipType\x3dFeaturedItems2Item\x26direction\x3dforward",b)},getUserItem:function(a,b,d){d=this.util.getUser();null!=d&&(d=esriGeowConfig.restBaseUrl+"content/users/"+d.email,null!=a.folderId&&(d=d+"/"+a.folderId),d=d+"/items/"+a.id,this.util.getJson(d,b))},getItem:function(a,b,d){this.util.getJson(esriGeowConfig.restBaseUrl+"content/items/"+a,b,d)},getItemData:function(a,b,d){this.util.getJson(esriGeowConfig.restBaseUrl+
"content/items/"+a+"/data",b,d)},getItemFolder:function(a,c){var d=this.util.getUser();null!=d&&this.util.getJson(esriGeowConfig.restBaseUrl+"content/users/"+d.email,b.hitch(this,function(e,f){for(var g=null,l=0;l<e.items.length;l++)if(e.items[l].id==a){g="";break}if(null!=g)c(g);else{var m=function(b,d){for(var e=b.currentFolder.id,f=0;f<b.items.length;f++)if(b.items[f].id==a){g=e;c(g);break}};b.forEach(e.folders,function(a,c){this.util.getJson(esriGeowConfig.restBaseUrl+"content/users/"+d.email+
"/"+a.folderName,b.hitch(this,m))},this)}}))},itemsToStore:function(a){var c=a.currentFolder?a.currentFolder.id:"",d=[];b.forEach(a.items,function(a,b){a.folderId=c;a.imageUrl=this._getItemIconUrl(a);a.selected=!1;a.item=a.name||a.url||a.title;if(a.snippet&&0<a.snippet.length&&"null"!=a.snippet)a.snippet=a.snippet;else if(a.description&&0<a.description.length&&"null"!=a.description){var g=arcgisonline.sharing.util.removeHTMLTags(a.description);a.snippet=150<g.length?g.substring(0,150)+"...":g}else a.snippet=
"";delete a.listingProperties;delete a.properties;d[b]=a},this);return new b.data.ItemFileWriteStore({data:{identifier:"id",label:"item",items:d}})},searchToStore:function(a){var c=[];b.forEach(a.items?a.items:a.results,function(a,b){var f={id:a.id,owner:a.owner,title:a.title,description:a.description,tags:a.tags?a.tags.join(","):[],imageUrl:this._getItemImageUrl(a),created:a.created,modified:a.modified};c[b]=f},this);return new b.data.ItemFileReadStore({data:{identifier:"id",label:"item",items:c}})},
_getPremiumItemNode:function(a){var c=(new esri.arcgis.PortalItem(a)).getTypeInfo();a=-1<b.indexOf(a.typeKeywords,"Requires Credits");return c.isPremiumContent?(a=b.create("div",{className:"esri-premium-content",title:a?this.i18n().premiumcontentcreditstitle:this.i18n().premiumcontenttitle,innerHTML:this.i18n().premiumcontent}),b.create("img",{className:"esri-premium-icon",src:c.premiumIconUrl},a,"first"),a):!1},_getItemIconUrl:function(a){return(new esri.arcgis.PortalItem(a)).iconUrl},_getItemImageUrl:function(a,
b){var d=a.type?a.type.toLowerCase():"";return this.util.relativeToExplicitUrl("geocoding service"==d||"network analysis service"==d||"geoprocessing service"==d||"geodata service"==d||"geometry service"==d||"workflow manager service"==d?b?"images/tool_16x16.png":"images/tool_32x32.png":"wms"==d||"kml"==d||"globe service"==d||"map service"==d||"image service"==d||"feature service"==d||"scene service"===d||"stream service"===d?b?"images/layer_16x16.png":"images/layer_32x32.png":"web mapping application"==
d||"mobile application"==d||"web map"==d?b?"images/map_16x16.png":"images/map_32x32.png":"layer"==d||"layer package"==d||"tile package"===d||"scene package"===d||"explorer layer"==d||"cad drawing"===d?b?"images/layer-download_16x16.png":"images/layer-download_32x32.png":"explorer add in"==d||"desktop add in"==d||"geoprocessing package"==d||"locator package"==d?b?"images/tool-download_16x16.png":"images/tool-download_32x32.png":b?"images/map-download_16x16.png":"images/map-download_32x32.png")},changeTypename:function(a,
c){var d=new esri.arcgis.PortalItem(a),e=d.getTypeInfo(),f=-1<b.indexOf(a.typeKeywords,"ArcGIS Server")||"Feature Collection"==a.type?this.i18n().source+" ":"";return c?"\x3cspan title\x3d'"+f+d.type+"'\x3e"+e.displayName+"\x3c/\x3e":e.displayName},getFavorites:function(){var a,c={};return this.util.request({url:esriGeowConfig.restBaseUrl+"content/groups/"+esriGeowConfig.self.user.favGroupId}).then(b.hitch(this,function(d){a=d.items||[];b.forEach(a,b.hitch(this,function(a){c[a.id]=!0}));return c}))},
addToFavorites:function(a){var b=this.util.getUser().favGroupId;return this.util.request({url:esriGeowConfig.restBaseUrl+"content/items/"+a.id+"/share",content:{f:"json",everyone:a.access&&"public"===a.access||a.sharing&&a.sharing.access&&"public"===a.sharing.access||!1,org:a.access&&"org"===a.access||a.sharing&&a.sharing.access&&"org"===a.sharing.access||!1,groups:[b],items:[a.id]}},{usePost:!0})},removeFromFavorites:function(a){var b=this.util.getUser().favGroupId;return this.util.request({url:esriGeowConfig.restBaseUrl+
"content/items/"+a.id+"/unshare",content:{f:"json",everyone:!1,org:!1,groups:[b],items:[a.id]}},{usePost:!0})}}})},"esri/Evented":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/Evented dojo/has ./kernel".split(" "),function(h,b,k,a,c,d){h=h([a],{declaredClass:"esri.Evented",registerConnectEvents:function(){var a=this.constructor,c=this.constructor._meta.parents,d=[{}],l={},m,h,k=function(a,c){b.isArray(a)||(a=[a]);for(var d=0;d<a.length;d++){var e=a[d];e._meta&&e._meta.parents&&
k(e._meta.parents,c);e.prototype._eventMap&&c.push(b.mixin({},e.prototype._eventMap))}return c};if(!a._onMap){k(c,d);d.push(this._eventMap);c=b.mixin.apply(this,d);for(m in this)/^on\w/.test(m)&&b.isFunction(this[m])&&(d=this._hyphenLower(m).toLowerCase(),c[d]||(l[d]={method:m}));for(h in c)m=this._onCamelCase(h),l[h]={method:m,argKeys:c[h]};a._onMap=l;return a._onMap}},on:function(a,c){if(-1<a.indexOf(",")){for(var d=a.split(/\s*,\s*/),l=d.length,m=[];l--;)m.push(this.on(d[l],c));m.remove=function(){for(var a=
0;a<m.length;a++)m[a].remove()};return m}var d=this.constructor._onMap||this.registerConnectEvents(),l="string"==typeof a&&a.toLowerCase(),h=this._onCamelCase(l),q=d&&d[l];return(h=q&&q.method||this[h]&&b.isFunction(this[h])&&h)?q&&b.isArray(q.argKeys)?(d=this._onArr2Obj(c,d[l].argKeys),k.after(this,h,d,!0)):k.after(this,h,function(a){a=a||{};a.target||(a.target=this);c.call(this,a)},!0):this.inherited(arguments)},emit:function(a,c){var d,l,m,h,k=a.toLowerCase();h=this._onCamelCase(a);var p=this.constructor._onMap||
this.registerConnectEvents();h=(m=p&&p[k]&&p[k].method||b.isFunction(this[h])&&h)&&this[m];m&&(p&&p[k])&&this._onObj2Arr(function(){l=Array.prototype.slice.call(arguments)},p[k].argKeys)(c);c=c||{};c.target||(c.target=this);h&&(d=l&&l.length?l:[c],d=h.apply(this,d));this.inherited(arguments,[a,c]);return d},_onObj2Arr:function(a,b){if(b){var c=this;return function(d){var m,h=[],k=b.length;for(m=0;m<k;m++)h[m]=d[b[m]];a.apply(c,h)}}return a},_onArr2Obj:function(a,b){if(b){var c=this;return function(){var d,
m={},h=arguments.length;for(d=0;d<h;d++)m[b[d]]=arguments[d];m.target||(m.target=c);a.call(c,m)}}return a},_hyphenLower:function(a){return a.replace(/^on/,"").replace(/[A-Z](?=[a-z])/g,function(a,b){return(b?"-":"")+a.toLowerCase()})},_onCamelCase:function(a){return"on"+a.substr(0,1).toUpperCase()+a.substr(1).replace(/\-([a-z])/g,function(a,b){return b.toUpperCase()})}});c("extend-esri")&&(d.Evented=h);return h})},"dijit/layout/ContentPane":function(){define("dojo/_base/kernel dojo/_base/lang ../_Widget ../_Container ./_ContentPaneResizeMixin dojo/string dojo/html dojo/i18n!../nls/loading dojo/_base/array dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-construct dojo/_base/xhr dojo/i18n dojo/when".split(" "),
function(h,b,k,a,c,d,e,f,g,l,m,n,q,p,s,t,u){return l("dijit.layout.ContentPane",[k,a,c],{href:"",content:"",extractContent:!1,parseOnLoad:!0,parserScope:h._scopeName,preventCache:!1,preload:!1,refreshOnShow:!1,loadingMessage:"\x3cspan class\x3d'dijitContentPaneLoading'\x3e\x3cspan class\x3d'dijitInline dijitIconLoading'\x3e\x3c/span\x3e${loadingState}\x3c/span\x3e",errorMessage:"\x3cspan class\x3d'dijitContentPaneError'\x3e\x3cspan class\x3d'dijitInline dijitIconError'\x3e\x3c/span\x3e${errorState}\x3c/span\x3e",
isLoaded:!1,baseClass:"dijitContentPane",ioArgs:{},onLoadDeferred:null,_setTitleAttr:null,stopParser:!0,template:!1,markupFactory:function(a,b,c){var d=new c(a,b);return!d.href&&d._contentSetter&&d._contentSetter.parseDeferred&&!d._contentSetter.parseDeferred.isFulfilled()?d._contentSetter.parseDeferred.then(function(){return d}):d},create:function(a,c){if((!a||!a.template)&&c&&!("href"in a)&&!("content"in a)){c=n.byId(c);for(var d=c.ownerDocument.createDocumentFragment();c.firstChild;)d.appendChild(c.firstChild);
a=b.delegate(a,{content:d})}this.inherited(arguments,[a,c])},postMixInProperties:function(){this.inherited(arguments);var a=t.getLocalization("dijit","loading",this.lang);this.loadingMessage=d.substitute(this.loadingMessage,a);this.errorMessage=d.substitute(this.errorMessage,a)},buildRendering:function(){this.inherited(arguments);this.containerNode||(this.containerNode=this.domNode);this.domNode.removeAttribute("title")},startup:function(){this.inherited(arguments);this._contentSetter&&g.forEach(this._contentSetter.parseResults,
function(a){!a._started&&(!a._destroyed&&b.isFunction(a.startup))&&(a.startup(),a._started=!0)},this)},_startChildren:function(){g.forEach(this.getChildren(),function(a){!a._started&&(!a._destroyed&&b.isFunction(a.startup))&&(a.startup(),a._started=!0)});this._contentSetter&&g.forEach(this._contentSetter.parseResults,function(a){!a._started&&(!a._destroyed&&b.isFunction(a.startup))&&(a.startup(),a._started=!0)},this)},setHref:function(a){h.deprecated("dijit.layout.ContentPane.setHref() is deprecated. Use set('href', ...) instead.",
"","2.0");return this.set("href",a)},_setHrefAttr:function(a){this.cancel();this.onLoadDeferred=new m(b.hitch(this,"cancel"));this.onLoadDeferred.then(b.hitch(this,"onLoad"));this._set("href",a);this.preload||this._created&&this._isShown()?this._load():this._hrefChanged=!0;return this.onLoadDeferred},setContent:function(a){h.deprecated("dijit.layout.ContentPane.setContent() is deprecated.  Use set('content', ...) instead.","","2.0");this.set("content",a)},_setContentAttr:function(a){this._set("href",
"");this.cancel();this.onLoadDeferred=new m(b.hitch(this,"cancel"));this._created&&this.onLoadDeferred.then(b.hitch(this,"onLoad"));this._setContent(a||"");this._isDownloaded=!1;return this.onLoadDeferred},_getContentAttr:function(){return this.containerNode.innerHTML},cancel:function(){this._xhrDfd&&-1==this._xhrDfd.fired&&this._xhrDfd.cancel();delete this._xhrDfd;this.onLoadDeferred=null},destroy:function(){this.cancel();this.inherited(arguments)},destroyRecursive:function(a){this._beingDestroyed||
this.inherited(arguments)},_onShow:function(){this.inherited(arguments);if(this.href&&!this._xhrDfd&&(!this.isLoaded||this._hrefChanged||this.refreshOnShow))return this.refresh()},refresh:function(){this.cancel();this.onLoadDeferred=new m(b.hitch(this,"cancel"));this.onLoadDeferred.then(b.hitch(this,"onLoad"));this._load();return this.onLoadDeferred},_load:function(){this._setContent(this.onDownloadStart(),!0);var a=this,c={preventCache:this.preventCache||this.refreshOnShow,url:this.href,handleAs:"text"};
b.isObject(this.ioArgs)&&b.mixin(c,this.ioArgs);var d=this._xhrDfd=(this.ioMethod||s.get)(c),e;d.then(function(b){e=b;try{return a._isDownloaded=!0,a._setContent(b,!1)}catch(c){a._onError("Content",c)}},function(b){d.canceled||a._onError("Download",b);delete a._xhrDfd;return b}).then(function(){a.onDownloadEnd();delete a._xhrDfd;return e});delete this._hrefChanged},_onLoadHandler:function(a){this._set("isLoaded",!0);try{this.onLoadDeferred.resolve(a)}catch(b){console.error("Error "+this.widgetId+
" running custom onLoad code: "+b.message)}},_onUnloadHandler:function(){this._set("isLoaded",!1);try{this.onUnload()}catch(a){console.error("Error "+this.widgetId+" running custom onUnload code: "+a.message)}},destroyDescendants:function(a){this.isLoaded&&this._onUnloadHandler();var b=this._contentSetter;g.forEach(this.getChildren(),function(b){b.destroyRecursive?b.destroyRecursive(a):b.destroy&&b.destroy(a);b._destroyed=!0});b&&(g.forEach(b.parseResults,function(b){b._destroyed||(b.destroyRecursive?
b.destroyRecursive(a):b.destroy&&b.destroy(a),b._destroyed=!0)}),delete b.parseResults);a||p.empty(this.containerNode);delete this._singleChild},_setContent:function(a,c){this.destroyDescendants();var d=this._contentSetter;d&&d instanceof e._ContentSetter||(d=this._contentSetter=new e._ContentSetter({node:this.containerNode,_onError:b.hitch(this,this._onError),onContentError:b.hitch(this,function(a){a=this.onContentError(a);try{this.containerNode.innerHTML=a}catch(b){console.error("Fatal "+this.id+
" could not change content due to "+b.message,b)}})}));var f=b.mixin({cleanContent:this.cleanContent,extractContent:this.extractContent,parseContent:!a.domNode&&this.parseOnLoad,parserScope:this.parserScope,startup:!1,dir:this.dir,lang:this.lang,textDir:this.textDir},this._contentSetterParams||{}),f=d.set(b.isObject(a)&&a.domNode?a.domNode:a,f),g=this;return u(f&&f.then?f:d.parseDeferred,function(){delete g._contentSetterParams;c||(g._started&&(g._startChildren(),g._scheduleLayout()),g._onLoadHandler(a))})},
_onError:function(a,b,c){this.onLoadDeferred.reject(b);a=this["on"+a+"Error"].call(this,b);c?console.error(c,b):a&&this._setContent(a,!0)},onLoad:function(){},onUnload:function(){},onDownloadStart:function(){return this.loadingMessage},onContentError:function(){},onDownloadError:function(){return this.errorMessage},onDownloadEnd:function(){}})})},"dijit/_Contained":function(){define(["dojo/_base/declare","./registry"],function(h,b){return h("dijit._Contained",null,{_getSibling:function(h){var a=this.domNode;
do a=a[h+"Sibling"];while(a&&1!=a.nodeType);return a&&b.byNode(a)},getPreviousSibling:function(){return this._getSibling("previous")},getNextSibling:function(){return this._getSibling("next")},getIndexInParent:function(){var b=this.getParent();return!b||!b.getIndexOfChild?-1:b.getIndexOfChild(this)}})})},"dijit/_KeyNavContainer":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/keys dojo/_base/lang ./registry ./_Container ./_FocusMixin ./_KeyNavMixin".split(" "),
function(h,b,k,a,c,d,e,f,g,l){return b("dijit._KeyNavContainer",[g,l,f],{connectKeyNavHandlers:function(a,b){var e=this._keyNavCodes={},f=d.hitch(this,"focusPrev"),g=d.hitch(this,"focusNext");h.forEach(a,function(a){e[a]=f});h.forEach(b,function(a){e[a]=g});e[c.HOME]=d.hitch(this,"focusFirstChild");e[c.END]=d.hitch(this,"focusLastChild")},startupKeyNavChildren:function(){a.deprecated("startupKeyNavChildren() call no longer needed","","2.0")},startup:function(){this.inherited(arguments);h.forEach(this.getChildren(),
d.hitch(this,"_startupChild"))},addChild:function(a,b){this.inherited(arguments);this._startupChild(a)},_startupChild:function(a){a.set("tabIndex","-1")},_getFirst:function(){var a=this.getChildren();return a.length?a[0]:null},_getLast:function(){var a=this.getChildren();return a.length?a[a.length-1]:null},focusNext:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,1))},focusPrev:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,-1),!0)},childSelector:function(a){return(a=
e.byNode(a))&&a.getParent()==this}})})},"dijit/layout/utils":function(){define(["dojo/_base/array","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/_base/lang"],function(h,b,k,a,c){function d(a,b){var d=a.resize?a.resize(b):k.setMarginBox(a.domNode,b);d?c.mixin(a,d):(c.mixin(a,k.getMarginBox(a.domNode)),c.mixin(a,b))}var e={marginBox2contentBox:function(b,c){var d=a.getComputedStyle(b),e=k.getMarginExtents(b,d),h=k.getPadBorderExtents(b,d);return{l:a.toPixelValue(b,d.paddingLeft),t:a.toPixelValue(b,
d.paddingTop),w:c.w-(e.w+h.w),h:c.h-(e.h+h.h)}},layoutChildren:function(a,e,l,m,k){e=c.mixin({},e);b.add(a,"dijitLayoutContainer");l=h.filter(l,function(a){return"center"!=a.region&&"client"!=a.layoutAlign}).concat(h.filter(l,function(a){return"center"==a.region||"client"==a.layoutAlign}));h.forEach(l,function(a){var c=a.domNode,f=a.region||a.layoutAlign;if(!f)throw Error("No region setting for "+a.id);var l=c.style;l.left=e.l+"px";l.top=e.t+"px";l.position="absolute";b.add(c,"dijitAlign"+(f.substring(0,
1).toUpperCase()+f.substring(1)));c={};m&&m==a.id&&(c["top"==a.region||"bottom"==a.region?"h":"w"]=k);"leading"==f&&(f=a.isLeftToRight()?"left":"right");"trailing"==f&&(f=a.isLeftToRight()?"right":"left");"top"==f||"bottom"==f?(c.w=e.w,d(a,c),e.h-=a.h,"top"==f?e.t+=a.h:l.top=e.t+e.h+"px"):"left"==f||"right"==f?(c.h=e.h,d(a,c),e.w-=a.w,"left"==f?e.l+=a.w:l.left=e.l+e.w+"px"):("client"==f||"center"==f)&&d(a,e)})}};c.setObject("dijit.layout.utils",e);return e})},"dijit/form/DataList":function(){define("dojo/_base/declare dojo/dom dojo/_base/lang dojo/query dojo/store/Memory ../registry".split(" "),
function(h,b,k,a,c,d){function e(a){return{id:a.value,value:a.value,name:k.trim(a.innerText||a.textContent||"")}}return h("dijit.form.DataList",c,{constructor:function(c,g){this.domNode=b.byId(g);k.mixin(this,c);this.id&&d.add(this);this.domNode.style.display="none";this.inherited(arguments,[{data:a("option",this.domNode).map(e)}])},destroy:function(){d.remove(this.id)},fetchSelectedItem:function(){var b=a("\x3e option[selected]",this.domNode)[0]||a("\x3e option",this.domNode)[0];return b&&e(b)}})})},
"dijit/form/CheckBox":function(){define("require dojo/_base/declare dojo/dom-attr dojo/has dojo/query dojo/ready ./ToggleButton ./_CheckBoxMixin dojo/text!./templates/CheckBox.html dojo/NodeList-dom ../a11yclick".split(" "),function(h,b,k,a,c,d,e,f,g){a("dijit-legacy-requires")&&d(0,function(){h(["dijit/form/RadioButton"])});return b("dijit.form.CheckBox",[e,f],{templateString:g,baseClass:"dijitCheckBox",_setValueAttr:function(a,b){"string"==typeof a&&(this.inherited(arguments),a=!0);this._created&&
this.set("checked",a,b)},_getValueAttr:function(){return this.checked&&this._get("value")},_setIconClassAttr:null,_setNameAttr:"focusNode",postMixInProperties:function(){this.inherited(arguments);this.checkedAttrSetting=""},_fillContent:function(){},_onFocus:function(){this.id&&c("label[for\x3d'"+this.id+"']").addClass("dijitFocusedLabel");this.inherited(arguments)},_onBlur:function(){this.id&&c("label[for\x3d'"+this.id+"']").removeClass("dijitFocusedLabel");this.inherited(arguments)}})})},"esri/graphicsUtils":function(){define(["dojo/_base/lang",
"dojo/_base/array","dojo/has","./kernel","./geometry/Extent"],function(h,b,k,a,c){var d={graphicsExtent:function(a){var b=a[0].geometry,d=b.getExtent(),l,m,h=a.length;null===d&&(d=new c(b.x,b.y,b.x,b.y,b.spatialReference));for(m=1;m<h;m++)l=(b=a[m].geometry).getExtent(),null===l&&(l=new c(b.x,b.y,b.x,b.y,b.spatialReference)),d=d.union(l);return 0>d.getWidth()&&0>d.getHeight()?null:d},getGeometries:function(a){return b.map(a,function(a){return a.geometry})},_encodeGraphics:function(a,c){var d=[],l,
m,h;b.forEach(a,function(a,b){l=a.toJson();m={};l.geometry&&(h=c&&c[b],m.geometry=h&&h.toJson()||l.geometry);l.attributes&&(m.attributes=l.attributes);d[b]=m});return d}};k("extend-esri")&&h.mixin(a,d);return d})},"esri/IdentityManager":function(){define(["./IdentityManagerDialog","./kernel","./OAuthSignInHandler","dojo/_base/declare"],function(h,b,k,a){h=new h;b.id=a.safeMixin(h,k);return b.id})},"dijit/_Container":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/dom-construct","dojo/_base/kernel"],
function(h,b,k,a){return b("dijit._Container",null,{buildRendering:function(){this.inherited(arguments);this.containerNode||(this.containerNode=this.domNode)},addChild:function(a,b){var e=this.containerNode;if(0<b){for(e=e.firstChild;0<b;)1==e.nodeType&&b--,e=e.nextSibling;e?b="before":(e=this.containerNode,b="last")}k.place(a.domNode,e,b);this._started&&!a._started&&a.startup()},removeChild:function(a){"number"==typeof a&&(a=this.getChildren()[a]);a&&(a=a.domNode)&&a.parentNode&&a.parentNode.removeChild(a)},
hasChildren:function(){return 0<this.getChildren().length},_getSiblingOfChild:function(b,d){a.deprecated(this.declaredClass+"::_getSiblingOfChild() is deprecated. Use _KeyNavMixin::_getNext() instead.","","2.0");var e=this.getChildren(),f=h.indexOf(e,b);return e[f+d]},getIndexOfChild:function(a){return h.indexOf(this.getChildren(),a)}})})},"dojo/data/ItemFileReadStore":function(){define("../_base/kernel ../_base/lang ../_base/declare ../_base/array ../_base/xhr ../Evented ./util/filter ./util/simpleFetch ../date/stamp".split(" "),
function(h,b,k,a,c,d,e,f,g){k=k("dojo.data.ItemFileReadStore",[d],{constructor:function(a){this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=!1;this.url=this._ccUrl=this._jsonFileUrl=a.url;this._jsonData=a.data;this.data=null;this._datatypeMap=a.typeMap||{};this._datatypeMap.Date||(this._datatypeMap.Date={type:Date,deserialize:function(a){return g.fromISOString(a)}});this._features={"dojo.data.api.Read":!0,"dojo.data.api.Identity":!0};this._itemsByIdentity=null;this._storeRefPropName=
"_S";this._itemNumPropName="_0";this._rootItemPropName="_RI";this._reverseRefMap="_RRM";this._loadInProgress=!1;this._queuedFetches=[];void 0!==a.urlPreventCache&&(this.urlPreventCache=a.urlPreventCache?!0:!1);void 0!==a.hierarchical&&(this.hierarchical=a.hierarchical?!0:!1);a.clearOnClose&&(this.clearOnClose=!0);"failOk"in a&&(this.failOk=a.failOk?!0:!1)},url:"",_ccUrl:"",data:null,typeMap:null,clearOnClose:!1,urlPreventCache:!1,failOk:!1,hierarchical:!0,_assertIsItem:function(a){if(!this.isItem(a))throw Error(this.declaredClass+
": Invalid item argument.");},_assertIsAttribute:function(a){if("string"!==typeof a)throw Error(this.declaredClass+": Invalid attribute argument.");},getValue:function(a,b,c){a=this.getValues(a,b);return 0<a.length?a[0]:c},getValues:function(a,b){this._assertIsItem(a);this._assertIsAttribute(b);return(a[b]||[]).slice(0)},getAttributes:function(a){this._assertIsItem(a);var b=[],c;for(c in a)c!==this._storeRefPropName&&(c!==this._itemNumPropName&&c!==this._rootItemPropName&&c!==this._reverseRefMap)&&
b.push(c);return b},hasAttribute:function(a,b){this._assertIsItem(a);this._assertIsAttribute(b);return b in a},containsValue:function(a,b,c){var d=void 0;"string"===typeof c&&(d=e.patternToRegExp(c,!1));return this._containsValue(a,b,c,d)},_containsValue:function(c,d,e,f){return a.some(this.getValues(c,d),function(a){if(null!==a&&!b.isObject(a)&&f){if(a.toString().match(f))return!0}else if(e===a)return!0})},isItem:function(a){return a&&a[this._storeRefPropName]===this&&this._arrayOfAllItems[a[this._itemNumPropName]]===
a?!0:!1},isItemLoaded:function(a){return this.isItem(a)},loadItem:function(a){this._assertIsItem(a.item)},getFeatures:function(){return this._features},getLabel:function(a){if(this._labelAttr&&this.isItem(a))return this.getValue(a,this._labelAttr)},getLabelAttributes:function(a){return this._labelAttr?[this._labelAttr]:null},filter:function(a,b,c){var d=[],f,g;if(a.query){var h;f=a.queryOptions?a.queryOptions.ignoreCase:!1;var k={};for(g in a.query)h=a.query[g],"string"===typeof h?k[g]=e.patternToRegExp(h,
f):h instanceof RegExp&&(k[g]=h);for(f=0;f<b.length;++f){var x=!0,w=b[f];if(null===w)x=!1;else for(g in a.query)h=a.query[g],this._containsValue(w,g,h,k[g])||(x=!1);x&&d.push(w)}}else for(f=0;f<b.length;++f)g=b[f],null!==g&&d.push(g);c(d,a)},_fetchItems:function(a,d,e){var f=this;if(this._loadFinished)this.filter(a,this._getItemsArray(a.queryOptions),d);else if(this._jsonFileUrl!==this._ccUrl?(h.deprecated(this.declaredClass+": ","To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"),
this.url=this._ccUrl=this._jsonFileUrl):this.url!==this._ccUrl&&(this._ccUrl=this._jsonFileUrl=this.url),null!=this.data&&(this._jsonData=this.data,this.data=null),this._jsonFileUrl)if(this._loadInProgress)this._queuedFetches.push({args:a,filter:b.hitch(f,"filter"),findCallback:b.hitch(f,d)});else{this._loadInProgress=!0;var g=c.get({url:f._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk});g.addCallback(function(b){try{f._getItemsFromLoadedData(b),
f._loadFinished=!0,f._loadInProgress=!1,f.filter(a,f._getItemsArray(a.queryOptions),d),f._handleQueuedFetches()}catch(c){f._loadFinished=!0,f._loadInProgress=!1,e(c,a)}});g.addErrback(function(b){f._loadInProgress=!1;e(b,a)});var k=null;a.abort&&(k=a.abort);a.abort=function(){g&&-1===g.fired&&g.cancel();k&&k.call(a)}}else if(this._jsonData)try{this._loadFinished=!0,this._getItemsFromLoadedData(this._jsonData),this._jsonData=null,f.filter(a,this._getItemsArray(a.queryOptions),d)}catch(t){e(t,a)}else e(Error(this.declaredClass+
": No JSON source data was provided as either URL or a nested Javascript object."),a)},_handleQueuedFetches:function(){if(0<this._queuedFetches.length){for(var a=0;a<this._queuedFetches.length;a++){var b=this._queuedFetches[a],c=b.args,d=b.filter,b=b.findCallback;d?d(c,this._getItemsArray(c.queryOptions),b):this.fetchItemByIdentity(c)}this._queuedFetches=[]}},_getItemsArray:function(a){return a&&a.deep?this._arrayOfAllItems:this._arrayOfTopLevelItems},close:function(a){this.clearOnClose&&(this._loadFinished&&
!this._loadInProgress)&&((""==this._jsonFileUrl||null==this._jsonFileUrl)&&(""==this.url||null==this.url)&&null==this.data&&console.debug(this.declaredClass+": WARNING!  Data reload  information has not been provided.  Please set 'url' or 'data' to the appropriate value before the next fetch"),this._arrayOfAllItems=[],this._arrayOfTopLevelItems=[],this._loadFinished=!1,this._itemsByIdentity=null,this._loadInProgress=!1,this._queuedFetches=[])},_getItemsFromLoadedData:function(a){function c(a){return null!==
a&&"object"===typeof a&&(!b.isArray(a)||e)&&!b.isFunction(a)&&(a.constructor==Object||b.isArray(a))&&"undefined"===typeof a._reference&&"undefined"===typeof a._type&&"undefined"===typeof a._value&&f.hierarchical}function d(a){f._arrayOfAllItems.push(a);for(var e in a){var g=a[e];if(g)if(b.isArray(g))for(var l=0;l<g.length;++l){var h=g[l];c(h)&&d(h)}else c(g)&&d(g)}}var e=!1,f=this;this._labelAttr=a.label;var g,h;this._arrayOfAllItems=[];this._arrayOfTopLevelItems=a.items;for(g=0;g<this._arrayOfTopLevelItems.length;++g)h=
this._arrayOfTopLevelItems[g],b.isArray(h)&&(e=!0),d(h),h[this._rootItemPropName]=!0;var k={},x;for(g=0;g<this._arrayOfAllItems.length;++g)for(x in h=this._arrayOfAllItems[g],h){if(x!==this._rootItemPropName){var w=h[x];null!==w?b.isArray(w)||(h[x]=[w]):h[x]=[null]}k[x]=x}for(;k[this._storeRefPropName];)this._storeRefPropName+="_";for(;k[this._itemNumPropName];)this._itemNumPropName+="_";for(;k[this._reverseRefMap];)this._reverseRefMap+="_";if(k=a.identifier){this._itemsByIdentity={};this._features["dojo.data.api.Identity"]=
k;for(g=0;g<this._arrayOfAllItems.length;++g)if(h=this._arrayOfAllItems[g],a=h[k],a=a[0],Object.hasOwnProperty.call(this._itemsByIdentity,a)){if(this._jsonFileUrl)throw Error(this.declaredClass+":  The json data as specified by: ["+this._jsonFileUrl+"] is malformed.  Items within the list have identifier: ["+k+"].  Value collided: ["+a+"]");if(this._jsonData)throw Error(this.declaredClass+":  The json data provided by the creation arguments is malformed.  Items within the list have identifier: ["+
k+"].  Value collided: ["+a+"]");}else this._itemsByIdentity[a]=h}else this._features["dojo.data.api.Identity"]=Number;for(g=0;g<this._arrayOfAllItems.length;++g)h=this._arrayOfAllItems[g],h[this._storeRefPropName]=this,h[this._itemNumPropName]=g;for(g=0;g<this._arrayOfAllItems.length;++g)for(x in h=this._arrayOfAllItems[g],h){a=h[x];for(k=0;k<a.length;++k)if(w=a[k],null!==w&&"object"==typeof w){if("_type"in w&&"_value"in w){var v=w._type,y=this._datatypeMap[v];if(y)if(b.isFunction(y))a[k]=new y(w._value);
else if(b.isFunction(y.deserialize))a[k]=y.deserialize(w._value);else throw Error("dojo.data.ItemFileReadStore: Value provided in typeMap was neither a constructor, nor a an object with a deserialize function");else throw Error("dojo.data.ItemFileReadStore: in the typeMap constructor arg, no object class was specified for the datatype '"+v+"'");}if(w._reference){w=w._reference;if(b.isObject(w))for(v=0;v<this._arrayOfAllItems.length;++v){var y=this._arrayOfAllItems[v],A=!0,z;for(z in w)y[z]!=w[z]&&
(A=!1);A&&(a[k]=y)}else a[k]=this._getItemByIdentity(w);this.referenceIntegrity&&(w=a[k],this.isItem(w)&&this._addReferenceToMap(w,h,x))}else this.isItem(w)&&this.referenceIntegrity&&this._addReferenceToMap(w,h,x)}}},_addReferenceToMap:function(a,b,c){},getIdentity:function(a){var b=this._features["dojo.data.api.Identity"];return b===Number?a[this._itemNumPropName]:(a=a[b])?a[0]:null},fetchItemByIdentity:function(a){var b,d;if(this._loadFinished)b=this._getItemByIdentity(a.identity),a.onItem&&(d=
a.scope?a.scope:h.global,a.onItem.call(d,b));else{var e=this;this._jsonFileUrl!==this._ccUrl?(h.deprecated(this.declaredClass+": ","To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"),this.url=this._ccUrl=this._jsonFileUrl):this.url!==this._ccUrl&&(this._ccUrl=this._jsonFileUrl=this.url);null!=this.data&&null==this._jsonData&&(this._jsonData=this.data,this.data=null);this._jsonFileUrl?this._loadInProgress?this._queuedFetches.push({args:a}):
(this._loadInProgress=!0,d=c.get({url:e._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk}),d.addCallback(function(c){var d=a.scope?a.scope:h.global;try{e._getItemsFromLoadedData(c),e._loadFinished=!0,e._loadInProgress=!1,b=e._getItemByIdentity(a.identity),a.onItem&&a.onItem.call(d,b),e._handleQueuedFetches()}catch(f){e._loadInProgress=!1,a.onError&&a.onError.call(d,f)}}),d.addErrback(function(b){e._loadInProgress=!1;a.onError&&a.onError.call(a.scope?
a.scope:h.global,b)})):this._jsonData&&(e._getItemsFromLoadedData(e._jsonData),e._jsonData=null,e._loadFinished=!0,b=e._getItemByIdentity(a.identity),a.onItem&&(d=a.scope?a.scope:h.global,a.onItem.call(d,b)))}},_getItemByIdentity:function(a){var b=null;this._itemsByIdentity?Object.hasOwnProperty.call(this._itemsByIdentity,a)&&(b=this._itemsByIdentity[a]):Object.hasOwnProperty.call(this._arrayOfAllItems,a)&&(b=this._arrayOfAllItems[a]);void 0===b&&(b=null);return b},getIdentityAttributes:function(a){a=
this._features["dojo.data.api.Identity"];return a===Number?null:[a]},_forceLoad:function(){var a=this;this._jsonFileUrl!==this._ccUrl?(h.deprecated(this.declaredClass+": ","To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"),this.url=this._ccUrl=this._jsonFileUrl):this.url!==this._ccUrl&&(this._ccUrl=this._jsonFileUrl=this.url);null!=this.data&&(this._jsonData=this.data,this.data=null);if(this._jsonFileUrl){var b=c.get({url:this._jsonFileUrl,
handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk,sync:!0});b.addCallback(function(b){try{if(!0!==a._loadInProgress&&!a._loadFinished)a._getItemsFromLoadedData(b),a._loadFinished=!0;else if(a._loadInProgress)throw Error(this.declaredClass+":  Unable to perform a synchronous load, an async load is in progress.");}catch(c){throw console.log(c),c;}});b.addErrback(function(a){throw a;})}else this._jsonData&&(a._getItemsFromLoadedData(a._jsonData),a._jsonData=null,a._loadFinished=
!0)}});b.extend(k,f);return k})},"dojo/dnd/Source":function(){define("../_base/array ../_base/declare ../_base/kernel ../_base/lang ../dom-class ../dom-geometry ../mouse ../ready ../topic ./common ./Selector ./Manager".split(" "),function(h,b,k,a,c,d,e,f,g,l,m,n){k.isAsync||f(0,function(){require(["dojo/dnd/AutoSource","dojo/dnd/Target"])});var q=b("dojo.dnd.Source",m,{isSource:!0,horizontal:!1,copyOnly:!1,selfCopy:!1,selfAccept:!0,skipForm:!1,withHandles:!1,autoSync:!1,delay:0,accept:["text"],generateText:!0,
constructor:function(b,d){a.mixin(this,a.mixin({},d));var e=this.accept;if(e.length){this.accept={};for(var f=0;f<e.length;++f)this.accept[e[f]]=1}this.mouseDown=this.isDragging=!1;this.targetBox=this.targetAnchor=null;this.before=!0;this._lastY=this._lastX=0;this.sourceState="";this.isSource&&c.add(this.node,"dojoDndSource");this.targetState="";this.accept&&c.add(this.node,"dojoDndTarget");this.horizontal&&c.add(this.node,"dojoDndHorizontal");this.topics=[g.subscribe("/dnd/source/over",a.hitch(this,
"onDndSourceOver")),g.subscribe("/dnd/start",a.hitch(this,"onDndStart")),g.subscribe("/dnd/drop",a.hitch(this,"onDndDrop")),g.subscribe("/dnd/cancel",a.hitch(this,"onDndCancel"))]},checkAcceptance:function(a,b){if(this==a)return!this.copyOnly||this.selfAccept;for(var c=0;c<b.length;++c){for(var d=a.getItem(b[c].id).type,e=!1,f=0;f<d.length;++f)if(d[f]in this.accept){e=!0;break}if(!e)return!1}return!0},copyState:function(a,b){if(a)return!0;2>arguments.length&&(b=this==n.manager().target);if(b){if(this.copyOnly)return this.selfCopy}else return this.copyOnly;
return!1},destroy:function(){q.superclass.destroy.call(this);h.forEach(this.topics,function(a){a.remove()});this.targetAnchor=null},onMouseMove:function(a){if(!(this.isDragging&&"Disabled"==this.targetState)){q.superclass.onMouseMove.call(this,a);var b=n.manager();if(!this.isDragging&&this.mouseDown&&this.isSource&&(Math.abs(a.pageX-this._lastX)>this.delay||Math.abs(a.pageY-this._lastY)>this.delay)){var c=this.getSelectedNodes();c.length&&b.startDrag(this,c,this.copyState(l.getCopyKeyState(a),!0))}if(this.isDragging){c=
!1;if(this.current){if(!this.targetBox||this.targetAnchor!=this.current)this.targetBox=d.position(this.current,!0);c=this.horizontal?a.pageX-this.targetBox.x<this.targetBox.w/2==d.isBodyLtr(this.current.ownerDocument):a.pageY-this.targetBox.y<this.targetBox.h/2}if(this.current!=this.targetAnchor||c!=this.before)this._markTargetAnchor(c),b.canDrop(!this.current||b.source!=this||!(this.current.id in this.selection))}}},onMouseDown:function(a){if(!this.mouseDown&&this._legalMouseDown(a)&&(!this.skipForm||
!l.isFormElement(a)))this.mouseDown=!0,this._lastX=a.pageX,this._lastY=a.pageY,q.superclass.onMouseDown.call(this,a)},onMouseUp:function(a){this.mouseDown&&(this.mouseDown=!1,q.superclass.onMouseUp.call(this,a))},onDndSourceOver:function(a){this!==a?(this.mouseDown=!1,this.targetAnchor&&this._unmarkTargetAnchor()):this.isDragging&&(a=n.manager(),a.canDrop("Disabled"!=this.targetState&&(!this.current||a.source!=this||!(this.current.id in this.selection))))},onDndStart:function(a,b,c){this.autoSync&&
this.sync();this.isSource&&this._changeState("Source",this==a?c?"Copied":"Moved":"");b=this.accept&&this.checkAcceptance(a,b);this._changeState("Target",b?"":"Disabled");this==a&&n.manager().overSource(this);this.isDragging=!0},onDndDrop:function(a,b,c,d){if(this==d)this.onDrop(a,b,c);this.onDndCancel()},onDndCancel:function(){this.targetAnchor&&(this._unmarkTargetAnchor(),this.targetAnchor=null);this.before=!0;this.mouseDown=this.isDragging=!1;this._changeState("Source","");this._changeState("Target",
"")},onDrop:function(a,b,c){if(this!=a)this.onDropExternal(a,b,c);else this.onDropInternal(b,c)},onDropExternal:function(a,b,c){var d=this._normalizedCreator;this._normalizedCreator=this.creator?function(b,c){return d.call(this,a.getItem(b.id).data,c)}:c?function(b){var c=a.getItem(b.id);b=b.cloneNode(!0);b.id=l.getUniqueId();return{node:b,data:c.data,type:c.type}}:function(b){var c=a.getItem(b.id);a.delItem(b.id);return{node:b,data:c.data,type:c.type}};this.selectNone();!c&&!this.creator&&a.selectNone();
this.insertNodes(!0,b,this.before,this.current);!c&&this.creator&&a.deleteSelectedNodes();this._normalizedCreator=d},onDropInternal:function(a,b){var c=this._normalizedCreator;if(!(this.current&&this.current.id in this.selection)){if(b)this._normalizedCreator=this.creator?function(a,b){return c.call(this,this.getItem(a.id).data,b)}:function(a){var b=this.getItem(a.id);a=a.cloneNode(!0);a.id=l.getUniqueId();return{node:a,data:b.data,type:b.type}};else{if(!this.current)return;this._normalizedCreator=
function(a){var b=this.getItem(a.id);return{node:a,data:b.data,type:b.type}}}this._removeSelection();this.insertNodes(!0,a,this.before,this.current);this._normalizedCreator=c}},onDraggingOver:function(){},onDraggingOut:function(){},onOverEvent:function(){q.superclass.onOverEvent.call(this);n.manager().overSource(this);if(this.isDragging&&"Disabled"!=this.targetState)this.onDraggingOver()},onOutEvent:function(){q.superclass.onOutEvent.call(this);n.manager().outSource(this);if(this.isDragging&&"Disabled"!=
this.targetState)this.onDraggingOut()},_markTargetAnchor:function(a){this.current==this.targetAnchor&&this.before==a||(this.targetAnchor&&this._removeItemClass(this.targetAnchor,this.before?"Before":"After"),this.targetAnchor=this.current,this.targetBox=null,this.before=a,this.targetAnchor&&this._addItemClass(this.targetAnchor,this.before?"Before":"After"))},_unmarkTargetAnchor:function(){this.targetAnchor&&(this._removeItemClass(this.targetAnchor,this.before?"Before":"After"),this.targetBox=this.targetAnchor=
null,this.before=!0)},_markDndStatus:function(a){this._changeState("Source",a?"Copied":"Moved")},_legalMouseDown:function(a){if("touchstart"!=a.type&&!e.isLeft(a))return!1;if(!this.withHandles)return!0;for(a=a.target;a&&a!==this.node;a=a.parentNode){if(c.contains(a,"dojoDndHandle"))return!0;if(c.contains(a,"dojoDndItem")||c.contains(a,"dojoDndIgnore"))break}return!1}});return q})},"dojo/html":function(){define("./_base/kernel ./_base/lang ./_base/array ./_base/declare ./dom ./dom-construct ./parser".split(" "),
function(h,b,k,a,c,d,e){var f=0,g={_secureForInnerHtml:function(a){return a.replace(/(?:\s*<!DOCTYPE\s[^>]+>|<title[^>]*>[\s\S]*?<\/title>)/ig,"")},_emptyNode:d.empty,_setNodeContent:function(a,c){d.empty(a);if(c)if("string"==typeof c&&(c=d.toDom(c,a.ownerDocument)),!c.nodeType&&b.isArrayLike(c))for(var e=c.length,f=0;f<c.length;f=e==c.length?f+1:0)d.place(c[f],a,"last");else d.place(c,a,"last");return a},_ContentSetter:a("dojo.html._ContentSetter",null,{node:"",content:"",id:"",cleanContent:!1,extractContent:!1,
parseContent:!1,parserScope:h._scopeName,startup:!0,constructor:function(a,d){b.mixin(this,a||{});d=this.node=c.byId(this.node||d);this.id||(this.id=["Setter",d?d.id||d.tagName:"",f++].join("_"))},set:function(a,b){void 0!==a&&(this.content=a);b&&this._mixin(b);this.onBegin();this.setContent();var c=this.onEnd();return c&&c.then?c:this.node},setContent:function(){var a=this.node;if(!a)throw Error(this.declaredClass+": setContent given no node");try{a=g._setNodeContent(a,this.content)}catch(b){var c=
this.onContentError(b);try{a.innerHTML=c}catch(d){console.error("Fatal "+this.declaredClass+".setContent could not change content due to "+d.message,d)}}this.node=a},empty:function(){this.parseDeferred&&(this.parseDeferred.isResolved()||this.parseDeferred.cancel(),delete this.parseDeferred);this.parseResults&&this.parseResults.length&&(k.forEach(this.parseResults,function(a){a.destroy&&a.destroy()}),delete this.parseResults);d.empty(this.node)},onBegin:function(){var a=this.content;if(b.isString(a)&&
(this.cleanContent&&(a=g._secureForInnerHtml(a)),this.extractContent)){var c=a.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);c&&(a=c[1])}this.empty();this.content=a;return this.node},onEnd:function(){this.parseContent&&this._parse();return this.node},tearDown:function(){delete this.parseResults;delete this.parseDeferred;delete this.node;delete this.content},onContentError:function(a){return"Error occurred setting content: "+a},onExecError:function(a){return"Error occurred executing scripts: "+a},
_mixin:function(a){var b={},c;for(c in a)c in b||(this[c]=a[c])},_parse:function(){var a=this.node;try{var b={};k.forEach(["dir","lang","textDir"],function(a){this[a]&&(b[a]=this[a])},this);var c=this;this.parseDeferred=e.parse({rootNode:a,noStart:!this.startup,inherited:b,scope:this.parserScope}).then(function(a){return c.parseResults=a},function(a){c._onError("Content",a,"Error parsing in _ContentSetter#"+this.id)})}catch(d){this._onError("Content",d,"Error parsing in _ContentSetter#"+this.id)}},
_onError:function(a,b,c){a=this["on"+a+"Error"].call(this,b);c?console.error(c,b):a&&g._setNodeContent(this.node,a,!0)}}),set:function(a,c,d){void 0==c&&(console.warn("dojo.html.set: no cont argument provided, using empty string"),c="");return d?(new g._ContentSetter(b.mixin(d,{content:c,node:a}))).set():g._setNodeContent(a,c,!0)}};b.setObject("dojo.html",g);return g})},"dijit/form/ValidationTextBox":function(){define("dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/i18n ./TextBox ../Tooltip dojo/text!./templates/ValidationTextBox.html dojo/i18n!./nls/validate".split(" "),
function(h,b,k,a,c,d,e){var f;return f=h("dijit.form.ValidationTextBox",c,{templateString:e,required:!1,promptMessage:"",invalidMessage:"$_unset_$",missingMessage:"$_unset_$",message:"",constraints:{},pattern:".*",regExp:"",regExpGen:function(){},state:"",tooltipPosition:[],_deprecateRegExp:function(a,c){c!=f.prototype[a]&&(b.deprecated("ValidationTextBox id\x3d"+this.id+", set('"+a+"', ...) is deprecated.  Use set('pattern', ...) instead.","","2.0"),this.set("pattern",c))},_setRegExpGenAttr:function(a){this._deprecateRegExp("regExpGen",
a);this._set("regExpGen",this._computeRegexp)},_setRegExpAttr:function(a){this._deprecateRegExp("regExp",a)},_setValueAttr:function(){this.inherited(arguments);this._refreshState()},validator:function(a,b){return RegExp("^(?:"+this._computeRegexp(b)+")"+(this.required?"":"?")+"$").test(a)&&(!this.required||!this._isEmpty(a))&&(this._isEmpty(a)||void 0!==this.parse(a,b))},_isValidSubset:function(){return 0==this.textbox.value.search(this._partialre)},isValid:function(){return this.validator(this.textbox.value,
this.get("constraints"))},_isEmpty:function(a){return(this.trim?/^\s*$/:/^$/).test(a)},getErrorMessage:function(){var a="$_unset_$"==this.invalidMessage?this.messages.invalidMessage:!this.invalidMessage?this.promptMessage:this.invalidMessage,b="$_unset_$"==this.missingMessage?this.messages.missingMessage:!this.missingMessage?a:this.missingMessage;return this.required&&this._isEmpty(this.textbox.value)?b:a},getPromptMessage:function(){return this.promptMessage},_maskValidSubsetError:!0,validate:function(a){var b=
"",c=this.disabled||this.isValid(a);c&&(this._maskValidSubsetError=!0);var d=this._isEmpty(this.textbox.value),e=!c&&a&&this._isValidSubset();this._set("state",c?"":((!this._hasBeenBlurred||a)&&d||e)&&(this._maskValidSubsetError||e&&!this._hasBeenBlurred&&a)?"Incomplete":"Error");this.focusNode.setAttribute("aria-invalid","Error"==this.state?"true":"false");"Error"==this.state?(this._maskValidSubsetError=a&&e,b=this.getErrorMessage(a)):"Incomplete"==this.state?(b=this.getPromptMessage(a),this._maskValidSubsetError=
!this._hasBeenBlurred||a):d&&(b=this.getPromptMessage(a));this.set("message",b);return c},displayMessage:function(a){a&&this.focused?d.show(a,this.domNode,this.tooltipPosition,!this.isLeftToRight()):d.hide(this.domNode)},_refreshState:function(){this._created&&this.validate(this.focused);this.inherited(arguments)},constructor:function(a){this.constraints=k.clone(this.constraints);this.baseClass+=" dijitValidationTextBox"},startup:function(){this.inherited(arguments);this._refreshState()},_setConstraintsAttr:function(a){!a.locale&&
this.lang&&(a.locale=this.lang);this._set("constraints",a);this._refreshState()},_setPatternAttr:function(a){this._set("pattern",a);this._refreshState()},_computeRegexp:function(a){var b=this.pattern;"function"==typeof b&&(b=b.call(this,a));if(b!=this._lastRegExp){var c="";this._lastRegExp=b;".*"!=b&&b.replace(/\\.|\[\]|\[.*?[^\\]{1}\]|\{.*?\}|\(\?[=:!]|./g,function(a){switch(a.charAt(0)){case "{":case "+":case "?":case "*":case "^":case "$":case "|":case "(":c+=a;break;case ")":c+="|$)";break;default:c+=
"(?:"+a+"|$)"}});try{"".search(c)}catch(d){c=this.pattern,console.warn("RegExp error in "+this.declaredClass+": "+this.pattern)}this._partialre="^(?:"+c+")$"}return b},postMixInProperties:function(){this.inherited(arguments);this.messages=a.getLocalization("dijit.form","validate",this.lang);this._setConstraintsAttr(this.constraints)},_setDisabledAttr:function(a){this.inherited(arguments);this._refreshState()},_setRequiredAttr:function(a){this._set("required",a);this.focusNode.setAttribute("aria-required",
a);this._refreshState()},_setMessageAttr:function(a){this._set("message",a);this.displayMessage(a)},reset:function(){this._maskValidSubsetError=!0;this.inherited(arguments)},_onBlur:function(){this.displayMessage("");this.inherited(arguments)},destroy:function(){d.hide(this.domNode);this.inherited(arguments)}})})},"dijit/selection":function(){define("dojo/_base/array dojo/dom dojo/_base/lang dojo/sniff dojo/_base/window dijit/focus".split(" "),function(h,b,k,a,c,d){var e=function(e){var f=e.document;
this.getType=function(){if(f.getSelection){var a="text",b;try{b=e.getSelection()}catch(c){}b&&1==b.rangeCount&&(b=b.getRangeAt(0),b.startContainer==b.endContainer&&(1==b.endOffset-b.startOffset&&3!=b.startContainer.nodeType)&&(a="control"));return a}return f.selection.type.toLowerCase()};this.getSelectedText=function(){if(f.getSelection){var a=e.getSelection();return a?a.toString():""}return"control"==this.getType()?null:f.selection.createRange().text};this.getSelectedHtml=function(){if(f.getSelection){var a=
e.getSelection();if(a&&a.rangeCount){var b,c="";for(b=0;b<a.rangeCount;b++){var d=a.getRangeAt(b).cloneContents(),h=f.createElement("div");h.appendChild(d);c+=h.innerHTML}return c}return null}return"control"==this.getType()?null:f.selection.createRange().htmlText};this.getSelectedElement=function(){if("control"==this.getType()){if(f.getSelection){var a=e.getSelection();return a.anchorNode.childNodes[a.anchorOffset]}if((a=f.selection.createRange())&&a.item)return f.selection.createRange().item(0)}return null};
this.getParentElement=function(){if("control"==this.getType()){var a=this.getSelectedElement();if(a)return a.parentNode}else if(f.getSelection){if(a=f.getSelection()){for(a=a.anchorNode;a&&1!=a.nodeType;)a=a.parentNode;return a}}else return a=f.selection.createRange(),a.collapse(!0),a.parentElement();return null};this.hasAncestorElement=function(a){return null!=this.getAncestorElement.apply(this,arguments)};this.getAncestorElement=function(a){var b=this.getSelectedElement()||this.getParentElement();
return this.getParentOfType(b,arguments)};this.isTag=function(a,b){if(a&&a.tagName)for(var c=a.tagName.toLowerCase(),d=0;d<b.length;d++){var e=String(b[d]).toLowerCase();if(c==e)return e}return""};this.getParentOfType=function(a,b){for(;a;){if(this.isTag(a,b).length)return a;a=a.parentNode}return null};this.collapse=function(a){if(f.getSelection){var b=e.getSelection();b.removeAllRanges?a?b.collapseToStart():b.collapseToEnd():b.collapse(a)}else b=f.selection.createRange(),b.collapse(a),b.select()};
this.remove=function(){var a=f.selection;f.getSelection?(a=e.getSelection(),a.deleteFromDocument()):"none"!=a.type.toLowerCase()&&a.clear();return a};this.selectElementChildren=function(c,d){var h;c=b.byId(c);if(f.getSelection){var k=e.getSelection();a("opera")?(h=k.rangeCount?k.getRangeAt(0):f.createRange(),h.setStart(c,0),h.setEnd(c,3==c.nodeType?c.length:c.childNodes.length),k.addRange(h)):k.selectAllChildren(c)}else if(h=c.ownerDocument.body.createTextRange(),h.moveToElementText(c),!d)try{h.select()}catch(s){}};
this.selectElement=function(d,e){var g;d=b.byId(d);if(f.getSelection){var h=f.getSelection();g=f.createRange();h.removeAllRanges&&(a("opera")&&h.getRangeAt(0)&&(g=h.getRangeAt(0)),g.selectNode(d),h.removeAllRanges(),h.addRange(g))}else try{h=d.tagName?d.tagName.toLowerCase():"",g="img"===h||"table"===h?c.body(f).createControlRange():c.body(f).createRange(),g.addElement(d),e||g.select()}catch(k){this.selectElementChildren(d,e)}};this.inSelection=function(a){if(a){var b,c;if(f.getSelection){var d=e.getSelection();
d&&0<d.rangeCount&&(c=d.getRangeAt(0));if(c&&c.compareBoundaryPoints&&f.createRange)try{if(b=f.createRange(),b.setStart(a,0),1===c.compareBoundaryPoints(c.START_TO_END,b))return!0}catch(h){}}else{c=f.selection.createRange();try{b=a.ownerDocument.body.createTextRange(),b.moveToElementText(a)}catch(k){}if(c&&b&&1===c.compareEndPoints("EndToStart",b))return!0}}return!1};this.getBookmark=function(){var a,b,c=f.selection,h=d.curNode;if(f.getSelection){if(c=e.getSelection())if(c.isCollapsed){if(a=h?h.tagName:
"")if(a=a.toLowerCase(),"textarea"==a||"input"==a&&(!h.type||"text"==h.type.toLowerCase()))return c={start:h.selectionStart,end:h.selectionEnd,node:h,pRange:!0},{isCollapsed:c.end<=c.start,mark:c};a={isCollapsed:!0};c.rangeCount&&(a.mark=c.getRangeAt(0).cloneRange())}else b=c.getRangeAt(0),a={isCollapsed:!1,mark:b.cloneRange()}}else if(c){a=h?h.tagName:"";a=a.toLowerCase();if(h&&a&&("button"==a||"textarea"==a||"input"==a)){if(c.type&&"none"==c.type.toLowerCase())return{isCollapsed:!0,mark:null};b=
c.createRange();return{isCollapsed:b.text&&b.text.length?!1:!0,mark:{range:b,pRange:!0}}}a={};try{b=c.createRange(),a.isCollapsed=!("Text"==c.type?b.htmlText.length:b.length)}catch(k){return a.isCollapsed=!0,a}if("CONTROL"==c.type.toUpperCase())if(b.length){a.mark=[];c=0;for(h=b.length;c<h;)a.mark.push(b.item(c++))}else a.isCollapsed=!0,a.mark=null;else a.mark=b.getBookmark()}else console.warn("No idea how to store the current selection for this browser!");return a};this.moveToBookmark=function(a){if(a=
a.mark)if(f.getSelection){var b=e.getSelection();b&&b.removeAllRanges?a.pRange?(b=a.node,b.selectionStart=a.start,b.selectionEnd=a.end):(b.removeAllRanges(),b.addRange(a)):console.warn("No idea how to restore selection for this browser!")}else if(f.selection&&a){var c;a.pRange?c=a.range:k.isArray(a)?(c=f.body.createControlRange(),h.forEach(a,function(a){c.addElement(a)})):(c=f.body.createTextRange(),c.moveToBookmark(a));c.select()}};this.isCollapsed=function(){return this.getBookmark().isCollapsed}},
f=new e(window);f.SelectionManager=e;return f})},"dijit/layout/BorderContainer":function(){define("dojo/_base/array dojo/cookie dojo/_base/declare dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/on dojo/touch ../_WidgetBase ../_Widget ../_TemplatedMixin ./LayoutContainer ./utils".split(" "),function(h,b,k,a,c,d,e,f,g,l,m,n,q,p,s,t){var u=k("dijit.layout._Splitter",[q,p],{live:!0,templateString:'\x3cdiv class\x3d"dijitSplitter" data-dojo-attach-event\x3d"onkeydown:_onKeyDown,press:_startDrag,onmouseenter:_onMouse,onmouseleave:_onMouse" tabIndex\x3d"0" role\x3d"separator"\x3e\x3cdiv class\x3d"dijitSplitterThumb"\x3e\x3c/div\x3e\x3c/div\x3e',
constructor:function(){this._handlers=[]},postMixInProperties:function(){this.inherited(arguments);this.horizontal=/top|bottom/.test(this.region);this._factor=/top|left/.test(this.region)?1:-1;this._cookieName=this.container.id+"_"+this.region},buildRendering:function(){this.inherited(arguments);a.add(this.domNode,"dijitSplitter"+(this.horizontal?"H":"V"));if(this.container.persist){var c=b(this._cookieName);c&&(this.child.domNode.style[this.horizontal?"height":"width"]=c)}},_computeMaxSize:function(){var a=
this.horizontal?"h":"w",b=d.getMarginBox(this.child.domNode)[a],c=h.filter(this.container.getChildren(),function(a){return"center"==a.region})[0],a=d.getContentBox(c.domNode)[a]-10;return Math.min(this.child.maxSize,b+a)},_startDrag:function(b){this.cover||(this.cover=c.place("\x3cdiv class\x3ddijitSplitterCover\x3e\x3c/div\x3e",this.child.domNode,"after"));a.add(this.cover,"dijitSplitterCoverActive");this.fake&&c.destroy(this.fake);if(!(this._resize=this.live))(this.fake=this.domNode.cloneNode(!0)).removeAttribute("id"),
a.add(this.domNode,"dijitSplitterShadow"),c.place(this.fake,this.domNode,"after");a.add(this.domNode,"dijitSplitterActive dijitSplitter"+(this.horizontal?"H":"V")+"Active");this.fake&&a.remove(this.fake,"dijitSplitterHover dijitSplitter"+(this.horizontal?"H":"V")+"Hover");var f=this._factor,h=this.horizontal,k=h?"pageY":"pageX",s=b[k],p=this.domNode.style,h=h?"h":"w",n=e.getComputedStyle(this.child.domNode),t=d.getMarginBox(this.child.domNode,n)[h],q=this._computeMaxSize(),u=Math.max(this.child.minSize,
d.getPadBorderExtents(this.child.domNode,n)[h]+10),h=this.region,x="top"==h||"bottom"==h?"top":"left",P=parseInt(p[x],10),Q=this._resize,S=g.hitch(this.container,"_layoutChildren",this.child.id),h=this.ownerDocument;this._handlers=this._handlers.concat([l(h,m.move,this._drag=function(a,b){var c=a[k]-s,d=f*c+t,e=Math.max(Math.min(d,q),u);(Q||b)&&S(e);p[x]=c+P+f*(e-d)+"px"}),l(h,"dragstart",function(a){a.stopPropagation();a.preventDefault()}),l(this.ownerDocumentBody,"selectstart",function(a){a.stopPropagation();
a.preventDefault()}),l(h,m.release,g.hitch(this,"_stopDrag"))]);b.stopPropagation();b.preventDefault()},_onMouse:function(b){b="mouseover"==b.type||"mouseenter"==b.type;a.toggle(this.domNode,"dijitSplitterHover",b);a.toggle(this.domNode,"dijitSplitter"+(this.horizontal?"H":"V")+"Hover",b)},_stopDrag:function(d){try{this.cover&&a.remove(this.cover,"dijitSplitterCoverActive"),this.fake&&c.destroy(this.fake),a.remove(this.domNode,"dijitSplitterActive dijitSplitter"+(this.horizontal?"H":"V")+"Active dijitSplitterShadow"),
this._drag(d),this._drag(d,!0)}finally{this._cleanupHandlers(),delete this._drag}this.container.persist&&b(this._cookieName,this.child.domNode.style[this.horizontal?"height":"width"],{expires:365})},_cleanupHandlers:function(){for(var a;a=this._handlers.pop();)a.remove()},_onKeyDown:function(a){this._resize=!0;var b=this.horizontal,c=1;switch(a.keyCode){case b?f.UP_ARROW:f.LEFT_ARROW:c*=-1;case b?f.DOWN_ARROW:f.RIGHT_ARROW:break;default:return}b=d.getMarginSize(this.child.domNode)[b?"h":"w"]+this._factor*
c;this.container._layoutChildren(this.child.id,Math.max(Math.min(b,this._computeMaxSize()),this.child.minSize));a.stopPropagation();a.preventDefault()},destroy:function(){this._cleanupHandlers();delete this.child;delete this.container;delete this.cover;delete this.fake;this.inherited(arguments)}}),x=k("dijit.layout._Gutter",[q,p],{templateString:'\x3cdiv class\x3d"dijitGutter" role\x3d"presentation"\x3e\x3c/div\x3e',postMixInProperties:function(){this.inherited(arguments);this.horizontal=/top|bottom/.test(this.region)},
buildRendering:function(){this.inherited(arguments);a.add(this.domNode,"dijitGutter"+(this.horizontal?"H":"V"))}});k=k("dijit.layout.BorderContainer",s,{gutters:!0,liveSplitters:!0,persist:!1,baseClass:"dijitBorderContainer",_splitterClass:u,postMixInProperties:function(){this.gutters||(this.baseClass+="NoGutter");this.inherited(arguments)},_setupChild:function(a){this.inherited(arguments);var b=a.region,d=a.isLeftToRight();"leading"==b&&(b=d?"left":"right");"trailing"==b&&(b=d?"right":"left");if(b&&
"center"!=b&&(a.splitter||this.gutters)&&!a._splitterWidget)d=a.splitter?this._splitterClass:x,g.isString(d)&&(d=g.getObject(d)),d=new d({id:a.id+"_splitter",container:this,child:a,region:b,live:this.liveSplitters}),d.isSplitter=!0,a._splitterWidget=d,b="bottom"==b||b==(this.isLeftToRight()?"right":"left"),c.place(d.domNode,a.domNode,b?"before":"after"),d.startup()},layout:function(){this._layoutChildren()},removeChild:function(a){var b=a._splitterWidget;b&&(b.destroy(),delete a._splitterWidget);
this.inherited(arguments)},getChildren:function(){return h.filter(this.inherited(arguments),function(a){return!a.isSplitter})},getSplitter:function(a){return h.filter(this.getChildren(),function(b){return b.region==a})[0]._splitterWidget},resize:function(a,b){if(!this.cs||!this.pe){var c=this.domNode;this.cs=e.getComputedStyle(c);this.pe=d.getPadExtents(c,this.cs);this.pe.r=e.toPixelValue(c,this.cs.paddingRight);this.pe.b=e.toPixelValue(c,this.cs.paddingBottom);e.set(c,"padding","0px")}this.inherited(arguments)},
_layoutChildren:function(a,b){if(this._borderBox&&this._borderBox.h){var c=[];h.forEach(this._getOrderedChildren(),function(a){c.push(a);a._splitterWidget&&c.push(a._splitterWidget)});t.layoutChildren(this.domNode,{l:this.pe.l,t:this.pe.t,w:this._borderBox.w-this.pe.w,h:this._borderBox.h-this.pe.h},c,a,b)}},destroyRecursive:function(){h.forEach(this.getChildren(),function(a){var b=a._splitterWidget;b&&b.destroy();delete a._splitterWidget});this.inherited(arguments)}});k.ChildWidgetProperties={splitter:!1,
minSize:0,maxSize:Infinity};g.mixin(k.ChildWidgetProperties,s.ChildWidgetProperties);g.extend(n,k.ChildWidgetProperties);k._Splitter=u;k._Gutter=x;return k})},"dijit/_base":function(){define("./main ./a11y ./WidgetSet ./_base/focus ./_base/manager ./_base/place ./_base/popup ./_base/scroll ./_base/sniff ./_base/typematic ./_base/wai ./_base/window".split(" "),function(h){return h._base})},"dijit/_base/typematic":function(){define(["../typematic"],function(){})},"dojo/window":function(){define("./_base/lang ./sniff ./_base/window ./dom ./dom-geometry ./dom-style ./dom-construct".split(" "),
function(h,b,k,a,c,d,e){b.add("rtl-adjust-position-for-verticalScrollBar",function(a,b){var d=k.body(b),f=e.create("div",{style:{overflow:"scroll",overflowX:"visible",direction:"rtl",visibility:"hidden",position:"absolute",left:"0",top:"0",width:"64px",height:"64px"}},d,"last"),h=e.create("div",{style:{overflow:"hidden",direction:"ltr"}},f,"last"),p=0!=c.position(h).x;f.removeChild(h);d.removeChild(f);return p});b.add("position-fixed-support",function(a,b){var d=k.body(b),f=e.create("span",{style:{visibility:"hidden",
position:"fixed",left:"1px",top:"1px"}},d,"last"),h=e.create("span",{style:{position:"fixed",left:"0",top:"0"}},f,"last"),p=c.position(h).x!=c.position(f).x;f.removeChild(h);d.removeChild(f);return p});var f={getBox:function(a){a=a||k.doc;var d="BackCompat"==a.compatMode?k.body(a):a.documentElement,e=c.docScroll(a);if(b("touch")){var h=f.get(a);a=h.innerWidth||d.clientWidth;d=h.innerHeight||d.clientHeight}else a=d.clientWidth,d=d.clientHeight;return{l:e.x,t:e.y,w:a,h:d}},get:function(a){if(b("ie")&&
f!==document.parentWindow){a.parentWindow.execScript("document._parentWindow \x3d window;","Javascript");var c=a._parentWindow;a._parentWindow=null;return c}return a.parentWindow||a.defaultView},scrollIntoView:function(e,f){try{e=a.byId(e);var h=e.ownerDocument||k.doc,n=k.body(h),q=h.documentElement||n.parentNode,p=b("ie"),s=b("webkit");if(!(e==n||e==q))if(!b("mozilla")&&(!p&&!s&&!b("opera")&&!b("trident"))&&"scrollIntoView"in e)e.scrollIntoView(!1);else{var t="BackCompat"==h.compatMode,u=Math.min(n.clientWidth||
q.clientWidth,q.clientWidth||n.clientWidth),x=Math.min(n.clientHeight||q.clientHeight,q.clientHeight||n.clientHeight),h=s||t?n:q,w=f||c.position(e),v=e.parentNode,s=function(a){return 6>=p||7==p&&t?!1:b("position-fixed-support")&&"fixed"==d.get(a,"position").toLowerCase()},y=this,A=function(a,b,c){"BODY"==a.tagName||"HTML"==a.tagName?y.get(a.ownerDocument).scrollBy(b,c):(b&&(a.scrollLeft+=b),c&&(a.scrollTop+=c))};if(!s(e))for(;v;){v==n&&(v=h);var z=c.position(v),G=s(v),F="rtl"==d.getComputedStyle(v).direction.toLowerCase();
if(v==h){z.w=u;z.h=x;if(h==q&&(p||b("trident"))&&F)z.x+=h.offsetWidth-z.w;if(0>z.x||!p||9<=p||b("trident"))z.x=0;if(0>z.y||!p||9<=p||b("trident"))z.y=0}else{var B=c.getPadBorderExtents(v);z.w-=B.w;z.h-=B.h;z.x+=B.l;z.y+=B.t;var E=v.clientWidth,K=z.w-E;0<E&&0<K&&(F&&b("rtl-adjust-position-for-verticalScrollBar")&&(z.x+=K),z.w=E);E=v.clientHeight;K=z.h-E;0<E&&0<K&&(z.h=E)}G&&(0>z.y&&(z.h+=z.y,z.y=0),0>z.x&&(z.w+=z.x,z.x=0),z.y+z.h>x&&(z.h=x-z.y),z.x+z.w>u&&(z.w=u-z.x));var O=w.x-z.x,P=w.y-z.y,Q=O+w.w-
z.w,S=P+w.h-z.h,H,D;if(0<Q*O&&(v.scrollLeft||v==h||v.scrollWidth>v.offsetHeight)){H=Math[0>O?"max":"min"](O,Q);if(F&&(8==p&&!t||9<=p||b("trident")))H=-H;D=v.scrollLeft;A(v,H,0);H=v.scrollLeft-D;w.x-=H}if(0<S*P&&(v.scrollTop||v==h||v.scrollHeight>v.offsetHeight))H=Math.ceil(Math[0>P?"max":"min"](P,S)),D=v.scrollTop,A(v,0,H),H=v.scrollTop-D,w.y-=H;v=v!=h&&!G&&v.parentNode}}}catch(J){console.error("scrollIntoView: "+J),e.scrollIntoView(!1)}}};h.setObject("dojo.window",f);return f})},"dojo/number":function(){define(["./_base/lang",
"./i18n","./i18n!./cldr/nls/number","./string","./regexp"],function(h,b,k,a,c){var d={};h.setObject("dojo.number",d);d.format=function(a,c){c=h.mixin({},c||{});var e=b.normalizeLocale(c.locale),e=b.getLocalization("dojo.cldr","number",e);c.customs=e;e=c.pattern||e[(c.type||"decimal")+"Format"];return isNaN(a)||Infinity==Math.abs(a)?null:d._applyPattern(a,e,c)};d._numberPatternRE=/[#0,]*[#0](?:\.0*#*)?/;d._applyPattern=function(a,b,c){c=c||{};var e=c.customs.group,h=c.customs.decimal;b=b.split(";");
var k=b[0];b=b[0>a?1:0]||"-"+k;if(-1!=b.indexOf("%"))a*=100;else if(-1!=b.indexOf("\u2030"))a*=1E3;else if(-1!=b.indexOf("\u00a4"))e=c.customs.currencyGroup||e,h=c.customs.currencyDecimal||h,b=b.replace(/\u00a4{1,3}/,function(a){return c[["symbol","currency","displayName"][a.length-1]]||c.currency||""});else if(-1!=b.indexOf("E"))throw Error("exponential notation not supported");var p=d._numberPatternRE,k=k.match(p);if(!k)throw Error("unable to find a number expression in pattern: "+b);!1===c.fractional&&
(c.places=0);return b.replace(p,d._formatAbsolute(a,k[0],{decimal:h,group:e,places:c.places,round:c.round}))};d.round=function(a,b,c){c=10/(c||10);return(c*+a).toFixed(b)/c};if(0==(0.9).toFixed()){var e=d.round;d.round=function(a,b,c){var d=Math.pow(10,-b||0),h=Math.abs(a);if(!a||h>=d)d=0;else if(h/=d,0.5>h||0.95<=h)d=0;return e(a,b,c)+(0<a?d:-d)}}d._formatAbsolute=function(b,c,e){e=e||{};!0===e.places&&(e.places=0);Infinity===e.places&&(e.places=6);c=c.split(".");var h="string"==typeof e.places&&
e.places.indexOf(","),k=e.places;h?k=e.places.substring(h+1):0<=k||(k=(c[1]||[]).length);0>e.round||(b=d.round(b,k,e.round));b=String(Math.abs(b)).split(".");var q=b[1]||"";c[1]||e.places?(h&&(e.places=e.places.substring(0,h)),h=void 0!==e.places?e.places:c[1]&&c[1].lastIndexOf("0")+1,h>q.length&&(b[1]=a.pad(q,h,"0",!0)),k<q.length&&(b[1]=q.substr(0,k))):b[1]&&b.pop();k=c[0].replace(",","");h=k.indexOf("0");-1!=h&&(h=k.length-h,h>b[0].length&&(b[0]=a.pad(b[0],h)),-1==k.indexOf("#")&&(b[0]=b[0].substr(b[0].length-
h)));var k=c[0].lastIndexOf(","),p,s;-1!=k&&(p=c[0].length-k-1,c=c[0].substr(0,k),k=c.lastIndexOf(","),-1!=k&&(s=c.length-k-1));c=[];for(k=b[0];k;)h=k.length-p,c.push(0<h?k.substr(h):k),k=0<h?k.slice(0,h):"",s&&(p=s,delete s);b[0]=c.reverse().join(e.group||",");return b.join(e.decimal||".")};d.regexp=function(a){return d._parseInfo(a).regexp};d._parseInfo=function(a){a=a||{};var e=b.normalizeLocale(a.locale),e=b.getLocalization("dojo.cldr","number",e),h=a.pattern||e[(a.type||"decimal")+"Format"],
k=e.group,n=e.decimal,q=1;if(-1!=h.indexOf("%"))q/=100;else if(-1!=h.indexOf("\u2030"))q/=1E3;else{var p=-1!=h.indexOf("\u00a4");p&&(k=e.currencyGroup||k,n=e.currencyDecimal||n)}e=h.split(";");1==e.length&&e.push("-"+e[0]);e=c.buildGroupRE(e,function(b){b="(?:"+c.escapeString(b,".")+")";return b.replace(d._numberPatternRE,function(b){var c={signed:!1,separator:a.strict?k:[k,""],fractional:a.fractional,decimal:n,exponent:!1};b=b.split(".");var e=a.places;1==b.length&&1!=q&&(b[1]="###");1==b.length||
0===e?c.fractional=!1:(void 0===e&&(e=a.pattern?b[1].lastIndexOf("0")+1:Infinity),e&&void 0==a.fractional&&(c.fractional=!0),!a.places&&e<b[1].length&&(e+=","+b[1].length),c.places=e);b=b[0].split(",");1<b.length&&(c.groupSize=b.pop().length,1<b.length&&(c.groupSize2=b.pop().length));return"("+d._realNumberRegexp(c)+")"})},!0);p&&(e=e.replace(/([\s\xa0]*)(\u00a4{1,3})([\s\xa0]*)/g,function(b,d,e,g){b=c.escapeString(a[["symbol","currency","displayName"][e.length-1]]||a.currency||"");d=d?"[\\s\\xa0]":
"";g=g?"[\\s\\xa0]":"";return!a.strict?(d&&(d+="*"),g&&(g+="*"),"(?:"+d+b+g+")?"):d+b+g}));return{regexp:e.replace(/[\xa0 ]/g,"[\\s\\xa0]"),group:k,decimal:n,factor:q}};d.parse=function(a,b){var c=d._parseInfo(b),e=RegExp("^"+c.regexp+"$").exec(a);if(!e)return NaN;var h=e[1];if(!e[1]){if(!e[2])return NaN;h=e[2];c.factor*=-1}h=h.replace(RegExp("["+c.group+"\\s\\xa0]","g"),"").replace(c.decimal,".");return h*c.factor};d._realNumberRegexp=function(a){a=a||{};"places"in a||(a.places=Infinity);"string"!=
typeof a.decimal&&(a.decimal=".");if(!("fractional"in a)||/^0/.test(a.places))a.fractional=[!0,!1];"exponent"in a||(a.exponent=[!0,!1]);"eSigned"in a||(a.eSigned=[!0,!1]);var b=d._integerRegexp(a),e=c.buildGroupRE(a.fractional,function(b){var c="";b&&0!==a.places&&(c="\\"+a.decimal,c=Infinity==a.places?"(?:"+c+"\\d+)?":c+("\\d{"+a.places+"}"));return c},!0),h=c.buildGroupRE(a.exponent,function(b){return b?"([eE]"+d._integerRegexp({signed:a.eSigned})+")":""}),b=b+e;e&&(b="(?:(?:"+b+")|(?:"+e+"))");
return b+h};d._integerRegexp=function(a){a=a||{};"signed"in a||(a.signed=[!0,!1]);"separator"in a?"groupSize"in a||(a.groupSize=3):a.separator="";var b=c.buildGroupRE(a.signed,function(a){return a?"[-+]":""},!0),d=c.buildGroupRE(a.separator,function(b){if(!b)return"(?:\\d+)";b=c.escapeString(b);" "==b?b="\\s":"\u00a0"==b&&(b="\\s\\xa0");var d=a.groupSize,e=a.groupSize2;return e?(b="(?:0|[1-9]\\d{0,"+(e-1)+"}(?:["+b+"]\\d{"+e+"})*["+b+"]\\d{"+d+"})",0<d-e?"(?:"+b+"|(?:0|[1-9]\\d{0,"+(d-1)+"}))":b):
"(?:0|[1-9]\\d{0,"+(d-1)+"}(?:["+b+"]\\d{"+d+"})*)"},!0);return b+d};return d})},"esri/geometry/Polygon":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./Extent ./mathUtils".split(" "),function(h,b,k,a,c,d,e,f,g,l,m){var n={type:"polygon",rings:null},q=h(f,{declaredClass:"esri.geometry.Polygon",constructor:function(a){k.mixin(this,n);this.rings=[];this._ring=0;a&&(k.isArray(a)?this.rings=k.isArray(a[0][0])?a:
[a]:a.rings?k.mixin(this,a):this.spatialReference=a,this.spatialReference&&(this.spatialReference=new e(this.spatialReference)));this.verifySR()},addRing:function(a){this.clearCache();this._ring=this.rings.length;this.rings[this._ring]=[];k.isArray(a[0])?b.forEach(a,this._addPointArr,this):b.forEach(a,this._addPoint,this);return this},_addPointArr:function(a){this.rings[this._ring].push(a)},_addPoint:function(a){this.rings[this._ring].push([a.x,a.y])},_insertPoints:function(a,c){this.clearCache();
this._ring=c;this.rings[this._ring]||(this.rings[this._ring]=[]);b.forEach(a,this._addPoint,this)},_validateInputs:function(a,b){return null!==a&&void 0!==a&&(0>a||a>=this.rings.length)||null!==b&&void 0!==a&&(0>b||b>=this.rings[a].length)?!1:!0},getPoint:function(a,b){if(this._validateInputs(a,b))return new g(this.rings[a][b],this.spatialReference)},setPoint:function(a,b,c){if(this._validateInputs(a,b))return this.clearCache(),this.rings[a][b]=[c.x,c.y],this},insertPoint:function(a,b,c){if(this._validateInputs(a)&&
d.isDefined(b)&&0<=b&&b<=this.rings[a].length)return this.clearCache(),this.rings[a].splice(b,0,[c.x,c.y]),this},removeRing:function(a){if(this._validateInputs(a,null)){this.clearCache();a=this.rings.splice(a,1)[0];var b,c=a.length,d=this.spatialReference;for(b=0;b<c;b++)a[b]=new g(a[b],d);return a}},removePoint:function(a,b){if(this._validateInputs(a,b))return this.clearCache(),new g(this.rings[a].splice(b,1)[0],this.spatialReference)},getExtent:function(){var a;a=this.getCacheValue("_extent");var b=
this.getCacheValue("_partwise");if(a)return a=new l(a),a._partwise=b,a;a=this.rings;var c=a.length;if(c&&a[0].length){var d,e,f,g,h,k,m,n,q=g=a[0][0][0],B=h=a[0][0][1],E=Math.min,K=Math.max,O=this.spatialReference,b=[],P,Q,S,H;for(k=0;k<c;k++){d=a[k];P=Q=d[0]&&d[0][0];S=H=d[0]&&d[0][1];n=d.length;for(m=0;m<n;m++)e=d[m],f=e[0],e=e[1],q=E(q,f),B=E(B,e),g=K(g,f),h=K(h,e),P=E(P,f),S=E(S,e),Q=K(Q,f),H=K(H,e);b.push(new l({xmin:P,ymin:S,xmax:Q,ymax:H,spatialReference:O?O.toJson():null}))}a={xmin:q,ymin:B,
xmax:g,ymax:h,spatialReference:O?O.toJson():null};b=1<b.length?b:null;this.setCacheValue("_extent",a);this.setCacheValue("_partwise",b);a=new l(a);a._partwise=b;return a}},contains:function(a){var b=this.rings,c,d=!1,e,f,h,k,l,m,n=b.length;c=this.spatialReference;e=a.spatialReference;var q=a.x;a=a.y;c&&(e&&!c.equals(e)&&c._canProject(e))&&(a=c.isWebMercator()?g.lngLatToXY(q,a):g.xyToLngLat(q,a,!0),q=a[0],a=a[1]);for(m=0;m<n;m++){c=b[m];h=c.length;for(l=k=0;l<h;l++)if(k++,k===h&&(k=0),e=c[l],f=c[k],
(e[1]<a&&f[1]>=a||f[1]<a&&e[1]>=a)&&e[0]+(a-e[1])/(f[1]-e[1])*(f[0]-e[0])<q)d=!d}return d},getCentroid:function(){var a=this.getCacheValue("_centroid");if(void 0!==a)return a;var a=this.rings,c,d,e,f=[],h,k;b.forEach(a,function(a){c=d=e=0;b.forEach(a,function(b,f){f<a.length-1&&(h=a[f+1],k=b[0]*h[1]-h[0]*b[1],c+=(b[0]+h[0])*k,d+=(b[1]+h[1])*k,e+=k)});0<e&&(e*=-1);e&&f.push([c,d,e/2])});f.sort(function(a,b){return a[2]-b[2]});c=d=void 0;if(f[0])a=6*f[0][2],c=f[0][0]/a,d=f[0][1]/a;else if(a=a[0]&&a[0].length?
this._getLineCentroid(a[0]):null)c=a.x,d=a.y;a=isNaN(c)||isNaN(d)?null:new g(c,d,this.spatialReference);this.setCacheValue("_centroid",a);return a},_getLineCentroid:function(a){var b,c=0,d=0,e=0,f,g,h={x:0,y:0},k={x:0,y:0},l,n=a.length,q;for(l=0;l<n-1;l++)f=a[l],g=a[l+1],f&&g&&(h.x=f[0],h.y=f[1],k.x=g[0],k.y=g[1],b=m.getLength(h,k),0<b&&(c+=b,f=m.getMidpoint(f,g),d+=b*f[0],e+=b*f[1]));0<c?q={x:d/c,y:e/c}:a[0]&&(q={x:a[0][0],y:a[0][1]});return q},isClockwise:function(a){var b=0,c,d=a.length,e=k.isArray(a[0])?
function(a,b){return a[0]*b[1]-b[0]*a[1]}:function(a,b){return a.x*b.y-b.x*a.y};for(c=0;c<d;c++)b+=e(a[c],a[(c+1)%d]);return 0>=b/2},isSelfIntersecting:function(a){a=a||this;var b,c,d,e,f,g,h,k=a.rings.length,l;for(d=0;d<k;d++){for(b=0;b<a.rings[d].length-1;b++){f=[[a.rings[d][b][0],a.rings[d][b][1]],[a.rings[d][b+1][0],a.rings[d][b+1][1]]];for(c=d+1;c<k;c++)for(e=0;e<a.rings[c].length-1;e++)if(g=[[a.rings[c][e][0],a.rings[c][e][1]],[a.rings[c][e+1][0],a.rings[c][e+1][1]]],(h=m._getLineIntersection2(f,
g))&&!(h[0]===f[0][0]&&h[1]===f[0][1]||h[0]===g[0][0]&&h[1]===g[0][1]||h[0]===f[1][0]&&h[1]===f[1][1]||h[0]===g[1][0]&&h[1]===g[1][1]))return!0}e=a.rings[d].length;if(!(4>=e))for(b=0;b<e-3;b++){l=e-1;0===b&&(l=e-2);f=[[a.rings[d][b][0],a.rings[d][b][1]],[a.rings[d][b+1][0],a.rings[d][b+1][1]]];for(c=b+2;c<l;c++)if(g=[[a.rings[d][c][0],a.rings[d][c][1]],[a.rings[d][c+1][0],a.rings[d][c+1][1]]],(h=m._getLineIntersection2(f,g))&&!(h[0]===f[0][0]&&h[1]===f[0][1]||h[0]===g[0][0]&&h[1]===g[0][1]||h[0]===
f[1][0]&&h[1]===f[1][1]||h[0]===g[1][0]&&h[1]===g[1][1]))return!0}}return!1},toJson:function(){var a={rings:k.clone(this.rings)},b=this.spatialReference;b&&(a.spatialReference=b.toJson());return a}});q.defaultProps=n;q.createEllipse=function(a){var b=a.center.x,c=a.center.y,d=a.longAxis,e=a.shortAxis,f=a.numberOfPoints,g=a.map,h,k,l;a=[];var m=2*Math.PI/f;for(k=0;k<f;k++)h=Math.cos(k*m),l=Math.sin(k*m),h=g.toMap({x:d*h+b,y:e*l+c}),a.push(h);a.push(a[0]);b=new q(g.spatialReference);b.addRing(a);return b};
q.createCircle=function(a){return q.createEllipse({center:a.center,longAxis:a.r,shortAxis:a.r,numberOfPoints:a.numberOfPoints,map:a.map})};q.fromExtent=function(a){var c=a.normalize();a=a.spatialReference;return new q({rings:b.map(c,function(a){return[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]}),spatialReference:a?a.toJson():null})};a("extend-esri")&&(k.setObject("geometry.Polygon",q,c),c.geometry.defaultPolygon=n,c.geometry.createEllipse=q.createEllipse,c.geometry.createCircle=
q.createCircle,c.geometry.isClockwise=q.prototype.isClockwise,c.geometry.polygonSelfIntersecting=q.prototype.isSelfIntersecting);return q})},"dojo/data/util/filter":function(){define(["../../_base/lang"],function(h){var b={};h.setObject("dojo.data.util.filter",b);b.patternToRegExp=function(b,a){for(var c="^",d=null,e=0;e<b.length;e++)switch(d=b.charAt(e),d){case "\\":c+=d;e++;c+=b.charAt(e);break;case "*":c+=".*";break;case "?":c+=".";break;case "$":case "^":case "/":case "+":case ".":case "|":case "(":case ")":case "{":case "}":case "[":case "]":c+=
"\\";default:c+=d}c+="$";return a?RegExp(c,"mi"):RegExp(c,"m")};return b})},"dijit/_WidgetsInTemplateMixin":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang","dojo/parser"],function(h,b,k,a,c){return k("dijit._WidgetsInTemplateMixin",null,{_earlyTemplatedStartup:!1,widgetsInTemplate:!0,contextRequire:null,_beforeFillContent:function(){if(this.widgetsInTemplate){var b=this.domNode;this.containerNode&&!this.searchContainerNode&&(this.containerNode.stopParser=
!0);c.parse(b,{noStart:!this._earlyTemplatedStartup,template:!0,inherited:{dir:this.dir,lang:this.lang,textDir:this.textDir},propsThis:this,contextRequire:this.contextRequire,scope:"dojo"}).then(a.hitch(this,function(a){this._startupWidgets=a;for(var b=0;b<a.length;b++)this._processTemplateNode(a[b],function(a,b){return a[b]},function(a,b,c){return b in a?a.connect(a,b,c):a.on(b,c,!0)});this.containerNode&&this.containerNode.stopParser&&delete this.containerNode.stopParser}));if(!this._startupWidgets)throw Error(this.declaredClass+
": parser returned unfilled promise (probably waiting for module auto-load), unsupported by _WidgetsInTemplateMixin.   Must pre-load all supporting widgets before instantiation.");}},_processTemplateNode:function(a,b,c){return b(a,"dojoType")||b(a,"data-dojo-type")?!0:this.inherited(arguments)},startup:function(){h.forEach(this._startupWidgets,function(a){a&&(!a._started&&a.startup)&&a.startup()});this._startupWidgets=null;this.inherited(arguments)}})})},"dijit/_FocusMixin":function(){define(["./focus",
"./_WidgetBase","dojo/_base/declare","dojo/_base/lang"],function(h,b,k,a){a.extend(b,{focused:!1,onFocus:function(){},onBlur:function(){},_onFocus:function(){this.onFocus()},_onBlur:function(){this.onBlur()}});return k("dijit._FocusMixin",null,{_focusManager:h})})},"dojo/fx/Toggler":function(){define(["../_base/lang","../_base/declare","../_base/fx","../aspect"],function(h,b,k,a){return b("dojo.fx.Toggler",null,{node:null,showFunc:k.fadeIn,hideFunc:k.fadeOut,showDuration:200,hideDuration:200,constructor:function(b){h.mixin(this,
b);this.node=b.node;this._showArgs=h.mixin({},b);this._showArgs.node=this.node;this._showArgs.duration=this.showDuration;this.showAnim=this.showFunc(this._showArgs);this._hideArgs=h.mixin({},b);this._hideArgs.node=this.node;this._hideArgs.duration=this.hideDuration;this.hideAnim=this.hideFunc(this._hideArgs);a.after(this.showAnim,"beforeBegin",h.hitch(this.hideAnim,"stop",!0),!0);a.after(this.hideAnim,"beforeBegin",h.hitch(this.showAnim,"stop",!0),!0)},show:function(a){return this.showAnim.play(a||
0)},hide:function(a){return this.hideAnim.play(a||0)}})})},"arcgisonline/sharing/dijit/dialog/SimpleDlg":function(){define(["dijit","dojo","dojox","dojo/require!dijit/Dialog,dijit/form/Button,dijit/_Widget,dijit/_Templated"],function(h,b,k){b.provide("arcgisonline.sharing.dijit.dialog.SimpleDlg");b.require("dijit.Dialog");b.require("dijit.form.Button");b.require("dijit._Widget");b.require("dijit._Templated");b.declare("arcgisonline.sharing.dijit.dialog.SimpleDlg",[h._Widget,h._Templated],{widgetsInTemplate:!0,
templateString:'\x3cdiv class\x3d"widgetContent" \x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit.Dialog" data-dojo-attach-point\x3d"dialog" title\x3d"${title}" execute\x3d""\x3e\r\n    \x3cdiv id\x3d"simple-dialog-content"\x3e${content}\x3c/div\x3e\x3cbr /\x3e\r\n    \x3cbutton data-dojo-type\x3d"dijit.form.Button" data-dojo-attach-event\x3d"onClick: hide" class\x3d"primary" type\x3d"button"\x3e${i18n.ok}\x3c/button\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',postMixInProperties:function(){this.inherited(arguments);
this.i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common},show:function(){this.dialog.show()},hide:function(){this.dialog.hide()}})})},"dojo/dnd/Target":function(){define(["../_base/declare","../dom-class","./Source"],function(h,b,k){return h("dojo.dnd.Target",k,{constructor:function(){this.isSource=!1;b.remove(this.node,"dojoDndSource")}})})},"arcgisonline/sharing/geow/Geow":function(){define(["dijit","dojo","dojox","dojo/require!arcgisonline/sharing/util"],function(h,b,k){b.provide("arcgisonline.sharing.geow.Geow");
b.require("arcgisonline.sharing.util");arcgisonline.sharing.geow.Geow={util:arcgisonline.sharing.util,generatetoken:function(a,b,d){var e=esriGeowConfig.restBaseUrl.replace("http:","https:")+"generatetoken",f=document.domain,g=f.split(".");1<g.length&&(f=g[g.length-2]+"."+g[g.length-1]);a.referer=f;this._tokenExpiration=a.expiration;this.util.postJson(a,e,b,d)},signup:function(a,b,d){var e=esriGeowConfig.restBaseUrl+"community/signup",f=document.domain,g=f.split(".");1<g.length&&(f=g[g.length-2]+
"."+g[g.length-1]);a.referer=f;this.util.postJson(a,e,b,d)},signin:function(a,c,d){this.generatetoken(a,b.hitch(arcgisonline.sharing.geow.Geow,"signInHandler",a.username,c,d),d)},setAuthCookie:function(a,c){var d=document.domain,e={path:"/"};a.persistent&&(e.expires=new Date(a.expires));a.allSSL&&(e.secure=!0);b.cookie("esri_auth",b.json.stringify(b.mixin({portalApp:!0},a)),b.mixin(e,{domain:d}));a.portalApp&&delete a.portalApp;!esriGeowConfig.isDebug&&esriGeowConfig.self&&!esriGeowConfig.self.isPortal&&
esriGeowConfig.self.urlKey?(a.urlKey=esriGeowConfig.self&&esriGeowConfig.self.urlKey,a.customBaseUrl=esriGeowConfig.self&&esriGeowConfig.self.urlKey&&esriGeowConfig.self.customBaseUrl||esriGeowConfig.self.portalHostname||window.location.hostname,b.cookie("esri_auth",b.json.stringify(a),b.mixin(e,{domain:"arcgis.com"}))):!esriGeowConfig.isDebug&&esriGeowConfig.self&&!esriGeowConfig.self.isPortal?(a.customBaseUrl=esriGeowConfig.self&&esriGeowConfig.self.portalHostname||window.location.hostname,b.cookie("esri_auth",
b.json.stringify(a),b.mixin(e,{domain:"arcgis.com"}))):c&&(esriGeowConfig.self.isPortal||b.cookie("esri_auth",b.json.stringify(a),b.mixin(e,{domain:"arcgis.com"})));if((d=arcgisonline.sharing.util._cookies)&&d.esri_auth)d.esri_auth=null,arcgisonline.sharing.util.getCookie("esri_auth")},signInHandler:function(a,c,d,e,f){var g=new Date,h=new Date(g.setMinutes(g.getMinutes()+(this._tokenExpiration||120))),g=b.hitch(this,function(a,d){a.culture&&(a.culture=a.culture.toLowerCase());var g={email:a.username,
privacy:a.privacy,token:e.token,ssl:e.ssl,culture:a.culture,region:a.region,expires:h.getTime()};a.orgId&&a.role&&(g.accountId=a.orgId,g.role=a.role);this.setAuthCookie(g);if(a.preferredView&&null!==a.preferredView)this.util.userPreferences({contentMode:a.preferredView},esriGeowConfig.contentModeCookieName);else{var k=this.util.userPreferences(null,esriGeowConfig.contentModeCookieName);if(k&&k.contentMode){var s=b.create,t=s("form",{method:"POST"},b.body());s("input",{type:"hidden",name:"preferredView",
value:k.contentMode},t);s("input",{type:"hidden",name:"clearEmptyFields",value:"false"},t);arcgisonline.sharing.geow.Community.updateProfile(t,function(a){})}}g=b.mixin(g,a);c&&c(g,f);b.publish("onSignIn",[g])});this.util.getJson(this.util.useSSL(esriGeowConfig.restBaseUrl+"community/users/"+a+"?token\x3d"+e.token),b.hitch(this,g),d)},signInHandler2:function(a){var c=esriGeowConfig.restBaseUrl+"community/users/"+a.username+"?token\x3d"+a.token,d=new Date,e=!a.persist?Math.min(7200,Number(a.expires_in)):
Number(a.expires_in),f=new Date(d.setSeconds(d.getSeconds()+Number(e))),g=a&&!!a.ssl;return this.util.getJson(this.util.useSSL(c)).then(b.hitch(this,"_hasSecurityQuestion")).then(b.hitch(this,function(c){var d={email:c.username,privacy:c.privacy,token:a.token,culture:c.culture&&c.culture.toLowerCase()||"",region:c.region,expires:f&&f.getTime()||null,persistent:a.persist?!0:void 0,allSSL:g};c.orgId&&c.role&&(d.accountId=c.orgId,d.role=c.role);c.preferredView&&this.util.userPreferences({contentMode:c.preferredView},
esriGeowConfig.contentModeCookieName);this.setAuthCookie(d);d=b.mixin(d,c);b.publish("onSignIn",[d]);return d}))},_hasSecurityQuestion:function(a){var c=new b.Deferred;a.validateUserProfile=!0;a&&!a.idpUsername&&("arcgisonly"===a.userType||"both"===a.userType)&&a.validateUserProfile?c=this.util.request({url:esriGeowConfig.restBaseUrl+"community/users/"+a.username+"/forgotPassword",content:{}},{}).then(b.hitch(this,function(b){b&&("enterprise"!==b.provider&&-1===b.securityQuestionIdx)&&(a.noSecurityQuestion=
!0);return a})):c.resolve(a);return c},signout:function(a){esriGeowConfig.userInfo=null;esriGeowConfig.userPreferences=null;b.cookie("esri_auth",null,{expires:-1,path:"/",domain:document.domain});arcgisonline.map&&arcgisonline.map.storage.deleteMapStorageNoFeedback();b.publish("onSignOut",[]);a=a||window.location.href;window.location=arcgisonline.sharing.util.getSecureUrl(esriGeowConfig.restBaseUrl+"oauth2/signout")+(a?"?client_id\x3darcgisonline\x26redirect_uri\x3d"+a:"")},checkSharedCookie:function(){var a=
this.util.getCookie("esri_auth"),c=!1;a&&(!a.urlKey&&location.hostname.match(/\.+\maps.*\..+\..+/i))&&(c=!0);!c&&(a&&a.customBaseUrl&&-1===document.domain.toLowerCase().indexOf(a.customBaseUrl.toLowerCase())&&-1===a.customBaseUrl.toLowerCase().indexOf(document.domain.toLowerCase()))&&(c=!0);!c&&(a&&a.urlKey&&-1===window.location.hostname.toLowerCase().indexOf(a.urlKey.toLowerCase()+"."))&&(c=!0);c&&(b.cookie("esri_auth",null,{expires:-1,path:"/",domain:".arcgis.com"}),arcgisonline.sharing.util&&(arcgisonline.sharing.util._cookies&&
arcgisonline.sharing.util._cookies.esri_auth)&&delete arcgisonline.sharing.util._cookies.esri_auth)},setCookies:function(a){var b=this.util.getCookie("esri_auth");!a.isPortal&&b&&(!esriGeowConfig.isDebug&&a.urlKey&&-1===window.location.hostname.toLowerCase().indexOf(a.urlKey.toLowerCase())?(a=window.location.href.replace(window.location.hostname,a.urlKey+"."+a.customBaseUrl),window.location=this.util.getBridgeUrl(a,b)):b.urlKey?(delete b.urlKey,delete b.customBaseUrl,this.setAuthCookie(b)):b.urlKey||
esriGeowConfig.isDebug||this.setAuthCookie(b))}}})},"dojo/data/util/sorter":function(){define(["../../_base/lang"],function(h){var b={};h.setObject("dojo.data.util.sorter",b);b.basicComparator=function(b,a){var c=-1;null===b&&(b=void 0);null===a&&(a=void 0);if(b==a)c=0;else if(b>a||null==b)c=1;return c};b.createSortFunction=function(h,a){function c(a,b,c,d){return function(e,f){var g=d.getValue(e,a),h=d.getValue(f,a);return b*c(g,h)}}for(var d=[],e,f=a.comparatorMap,g=b.basicComparator,l=0;l<h.length;l++){e=
h[l];var m=e.attribute;if(m){e=e.descending?-1:1;var n=g;f&&("string"!==typeof m&&"toString"in m&&(m=m.toString()),n=f[m]||g);d.push(c(m,e,n,a))}}return function(a,b){for(var c=0;c<d.length;){var e=d[c++](a,b);if(0!==e)return e}return 0}};return b})},"dijit/form/_ButtonMixin":function(){define(["dojo/_base/declare","dojo/dom","dojo/has","../registry"],function(h,b,k,a){var c=h("dijit.form._ButtonMixin"+(k("dojo-bidi")?"_NoBidi":""),null,{label:"",type:"button",__onClick:function(a){a.stopPropagation();
a.preventDefault();this.disabled||this.valueNode.click(a);return!1},_onClick:function(b){if(this.disabled)return b.stopPropagation(),b.preventDefault(),!1;!1===this.onClick(b)&&b.preventDefault();var c=b.defaultPrevented;if(!c&&"submit"==this.type&&!(this.valueNode||this.focusNode).form)for(var f=this.domNode;f.parentNode;f=f.parentNode){var g=a.byNode(f);if(g&&"function"==typeof g._onSubmit){g._onSubmit(b);b.preventDefault();c=!0;break}}return!c},postCreate:function(){this.inherited(arguments);b.setSelectable(this.focusNode,
!1)},onClick:function(){return!0},_setLabelAttr:function(a){this._set("label",a);(this.containerNode||this.focusNode).innerHTML=a}});k("dojo-bidi")&&(c=h("dijit.form._ButtonMixin",c,{_setLabelAttr:function(){this.inherited(arguments);this.applyTextDir(this.containerNode||this.focusNode)}}));return c})},"esri/domUtils":function(){define(["./kernel","dojo/_base/connect","dojo/_base/lang","dojo/dom-style","dojo/has"],function(h,b,k,a,c){var d={show:function(a){if(a=d.getNode(a))a.style.display="block"},
getNode:function(a){return a&&a.domNode||a},hide:function(a){if(a=d.getNode(a))a.style.display="none"},toggle:function(a){if(a=d.getNode(a))a.style.display="none"===a.style.display?"block":"none"},documentBox:8>=c("ie")?{w:document.documentElement.clientWidth,h:document.documentElement.clientHeight}:{w:window.innerWidth,h:window.innerHeight},setScrollable:function(c){if(c=this.getNode(c)){var d=0,g=0,h=0,k=0,n=0,q=0;return[b.connect(c,"ontouchstart",function(a){d=a.touches[0].screenX;g=a.touches[0].screenY;
h=c.scrollWidth;k=c.scrollHeight;n=c.clientWidth;q=c.clientHeight}),b.connect(c,"ontouchmove",function(b){b.preventDefault();var s=c.firstChild;s instanceof Text&&(s=c.childNodes[1]);var t=s._currentX||0,u=s._currentY||0,t=t+(b.touches[0].screenX-d);0<t?t=0:0>t&&Math.abs(t)+n>h&&(t=-1*(h-n));s._currentX=t;u+=b.touches[0].screenY-g;0<u?u=0:0>u&&Math.abs(u)+q>k&&(u=-1*(k-q));s._currentY=u;a.set(s,{"-webkit-transition-property":"-webkit-transform","-webkit-transform":"translate("+t+"px, "+u+"px)"});
d=b.touches[0].screenX;g=b.touches[0].screenY})]}}};c("extend-esri")&&k.mixin(h,d);return d})},"dijit/registry":function(){define(["dojo/_base/array","dojo/_base/window","./main"],function(h,b,k){var a={},c={},d={length:0,add:function(a){if(c[a.id])throw Error("Tried to register widget with id\x3d\x3d"+a.id+" but that id is already registered");c[a.id]=a;this.length++},remove:function(a){c[a]&&(delete c[a],this.length--)},byId:function(a){return"string"==typeof a?c[a]:a},byNode:function(a){return c[a.getAttribute("widgetId")]},
toArray:function(){var a=[],b;for(b in c)a.push(c[b]);return a},getUniqueId:function(b){var d;do d=b+"_"+(b in a?++a[b]:a[b]=0);while(c[d]);return"dijit"==k._scopeName?d:k._scopeName+"_"+d},findWidgets:function(a,b){function d(a){for(a=a.firstChild;a;a=a.nextSibling)if(1==a.nodeType){var e=a.getAttribute("widgetId");e?(e=c[e])&&h.push(e):a!==b&&d(a)}}var h=[];d(a);return h},_destroyAll:function(){k._curFocus=null;k._prevFocus=null;k._activeStack=[];h.forEach(d.findWidgets(b.body()),function(a){a._destroyed||
(a.destroyRecursive?a.destroyRecursive():a.destroy&&a.destroy())})},getEnclosingWidget:function(a){for(;a;){var b=1==a.nodeType&&a.getAttribute("widgetId");if(b)return c[b];a=a.parentNode}return null},_hash:c};return k.registry=d})},"esri/main":function(){define(["./kernel","dojo/i18n!./nls/jsapi","./config","./sniff"],function(h,b){h.bundle=b;return h})},"dojo/io/script":function(){define("../_base/connect ../_base/kernel ../_base/lang ../sniff ../_base/window ../_base/xhr ../dom ../dom-construct ../request/script ../aspect".split(" "),
function(h,b,k,a,c,d,e,f,g,l){b.deprecated("dojo/io/script","Use dojo/request/script.","2.0");var m={get:function(a){var b,c=this._makeScriptDeferred(a,function(a){b&&b.cancel()}),e=c.ioArgs;d._ioAddQueryToUrl(e);d._ioNotifyStart(c);b=g.get(e.url,{timeout:a.timeout,jsonp:e.jsonp,checkString:a.checkString,ioArgs:e,frameDoc:a.frameDoc,canAttach:function(a){e.requestId=a.id;e.scriptId=a.scriptId;e.canDelete=a.canDelete;return m._canAttach(e)}},!0);l.around(b,"isValid",function(a){return function(b){m._validCheck(c);
return a.call(this,b)}});b.then(function(){c.resolve(c)}).otherwise(function(a){c.ioArgs.error=a;c.reject(a)});return c},attach:g._attach,remove:g._remove,_makeScriptDeferred:function(a,c){var e=d._ioSetArgs(a,c||this._deferredCancel,this._deferredOk,this._deferredError),f=e.ioArgs;f.id=b._scopeName+"IoScript"+(a.callbackSuffix||this._counter++);f.canDelete=!1;f.jsonp=a.callbackParamName||a.jsonp;f.jsonp&&(f.query=f.query||"",0<f.query.length&&(f.query+="\x26"),f.query+=f.jsonp+"\x3d"+(a.frameDoc?
"parent.":"")+b._scopeName+".io.script.jsonp_"+f.id+"._jsonpCallback",f.frameDoc=a.frameDoc,f.canDelete=!0,e._jsonpCallback=this._jsonpCallback,this["jsonp_"+f.id]=e);e.addBoth(function(a){f.canDelete&&(a instanceof Error?m["jsonp_"+f.id]._jsonpCallback=function(){delete m["jsonp_"+f.id];if(f.requestId)b.global[g._callbacksProperty][f.requestId]()}:m._addDeadScript(f))});return e},_deferredCancel:function(a){a.canceled=!0},_deferredOk:function(a){a=a.ioArgs;return a.json||a.scriptLoaded||a},_deferredError:function(a,
b){console.log("dojo.io.script error",a);return a},_deadScripts:[],_counter:1,_addDeadScript:function(a){m._deadScripts.push({id:a.id,frameDoc:a.frameDoc});a.frameDoc=null},_validCheck:function(a){if((a=m._deadScripts)&&0<a.length){for(var b=0;b<a.length;b++)m.remove(a[b].id,a[b].frameDoc),delete m["jsonp_"+a[b].id],a[b].frameDoc=null;m._deadScripts=[]}return!0},_ioCheck:function(a){a=a.ioArgs;return a.json||a.scriptLoaded&&!a.args.checkString?!0:(a=a.args.checkString)&&eval("typeof("+a+") !\x3d 'undefined'")},
_resHandle:function(a){m._ioCheck(a)?a.callback(a):a.errback(Error("inconceivable dojo.io.script._resHandle error"))},_canAttach:function(){return!0},_jsonpCallback:function(a){this.ioArgs.json=a;if(this.ioArgs.requestId)b.global[g._callbacksProperty][this.ioArgs.requestId](a)}};k.setObject("dojo.io.script",m);return m})},"dojo/date/locale":function(){define("../_base/lang ../_base/array ../date ../cldr/supplemental ../i18n ../regexp ../string ../i18n!../cldr/nls/gregorian module".split(" "),function(h,
b,k,a,c,d,e,f,g){function l(b,c,d,f){return f.replace(/([a-z])\1*/ig,function(g){var h,k,l=g.charAt(0);g=g.length;var m=["abbr","wide","narrow"];switch(l){case "G":h=c[4>g?"eraAbbr":"eraNames"][0>b.getFullYear()?0:1];break;case "y":h=b.getFullYear();switch(g){case 1:break;case 2:if(!d.fullYear){h=String(h);h=h.substr(h.length-2);break}default:k=!0}break;case "Q":case "q":h=Math.ceil((b.getMonth()+1)/3);k=!0;break;case "M":case "L":h=b.getMonth();3>g?(h+=1,k=!0):(l=["months","L"==l?"standAlone":"format",
m[g-3]].join("-"),h=c[l][h]);break;case "w":h=q._getWeekOfYear(b,0);k=!0;break;case "d":h=b.getDate();k=!0;break;case "D":h=q._getDayOfYear(b);k=!0;break;case "e":case "c":if(h=b.getDay(),2>g){h=(h-a.getFirstDayOfWeek(d.locale)+8)%7;break}case "E":h=b.getDay();3>g?(h+=1,k=!0):(l=["days","c"==l?"standAlone":"format",m[g-3]].join("-"),h=c[l][h]);break;case "a":l=12>b.getHours()?"am":"pm";h=d[l]||c["dayPeriods-format-wide-"+l];break;case "h":case "H":case "K":case "k":k=b.getHours();switch(l){case "h":h=
k%12||12;break;case "H":h=k;break;case "K":h=k%12;break;case "k":h=k||24}k=!0;break;case "m":h=b.getMinutes();k=!0;break;case "s":h=b.getSeconds();k=!0;break;case "S":h=Math.round(b.getMilliseconds()*Math.pow(10,g-3));k=!0;break;case "v":case "z":if(h=q._getZone(b,!0,d))break;g=4;case "Z":l=q._getZone(b,!1,d);l=[0>=l?"+":"-",e.pad(Math.floor(Math.abs(l)/60),2),e.pad(Math.abs(l)%60,2)];4==g&&(l.splice(0,0,"GMT"),l.splice(3,0,":"));h=l.join("");break;default:throw Error("dojo.date.locale.format: invalid pattern char: "+
f);}k&&(h=e.pad(h,g));return h})}function m(a,c,d,e){var f=function(a){return a};c=c||f;d=d||f;e=e||f;var g=a.match(/(''|[^'])+/g),h="'"==a.charAt(0);b.forEach(g,function(a,b){a?(g[b]=(h?d:c)(a.replace(/''/g,"'")),h=!h):g[b]=""});return e(g.join(""))}function n(a,b,c,e){e=d.escapeString(e);c.strict||(e=e.replace(" a"," ?a"));return e.replace(/([a-z])\1*/ig,function(d){var e;e=d.charAt(0);var f=d.length,g="",h="";c.strict?(1<f&&(g="0{"+(f-1)+"}"),2<f&&(h="0{"+(f-2)+"}")):(g="0?",h="0{0,2}");switch(e){case "y":e=
"\\d{2,4}";break;case "M":case "L":e=2<f?"\\S+?":"1[0-2]|"+g+"[1-9]";break;case "D":e="[12][0-9][0-9]|3[0-5][0-9]|36[0-6]|"+g+"[1-9][0-9]|"+h+"[1-9]";break;case "d":e="3[01]|[12]\\d|"+g+"[1-9]";break;case "w":e="[1-4][0-9]|5[0-3]|"+g+"[1-9]";break;case "E":case "e":case "c":e=".+?";break;case "h":e="1[0-2]|"+g+"[1-9]";break;case "k":e="1[01]|"+g+"\\d";break;case "H":e="1\\d|2[0-3]|"+g+"\\d";break;case "K":e="1\\d|2[0-4]|"+g+"[1-9]";break;case "m":case "s":e="[0-5]\\d";break;case "S":e="\\d{"+f+"}";
break;case "a":f=c.am||b["dayPeriods-format-wide-am"];g=c.pm||b["dayPeriods-format-wide-pm"];e=f+"|"+g;c.strict||(f!=f.toLowerCase()&&(e+="|"+f.toLowerCase()),g!=g.toLowerCase()&&(e+="|"+g.toLowerCase()),-1!=e.indexOf(".")&&(e+="|"+e.replace(/\./g,"")));e=e.replace(/\./g,"\\.");break;default:e=".*"}a&&a.push(d);return"("+e+")"}).replace(/[\xa0 ]/g,"[\\s\\xa0]")}var q={};h.setObject(g.id.replace(/\//g,"."),q);q._getZone=function(a,b,c){return b?k.getTimezoneName(a):a.getTimezoneOffset()};q.format=
function(a,b){b=b||{};var d=c.normalizeLocale(b.locale),e=b.formatLength||"short",d=q._getGregorianBundle(d),f=[],g=h.hitch(this,l,a,d,b);if("year"==b.selector)return m(d["dateFormatItem-yyyy"]||"yyyy",g);var k;"date"!=b.selector&&(k=b.timePattern||d["timeFormat-"+e])&&f.push(m(k,g));"time"!=b.selector&&(k=b.datePattern||d["dateFormat-"+e])&&f.push(m(k,g));return 1==f.length?f[0]:d["dateTimeFormat-"+e].replace(/\'/g,"").replace(/\{(\d+)\}/g,function(a,b){return f[b]})};q.regexp=function(a){return q._parseInfo(a).regexp};
q._parseInfo=function(a){a=a||{};var b=c.normalizeLocale(a.locale),b=q._getGregorianBundle(b),d=a.formatLength||"short",e=a.datePattern||b["dateFormat-"+d],f=a.timePattern||b["timeFormat-"+d],d="date"==a.selector?e:"time"==a.selector?f:b["dateTimeFormat-"+d].replace(/\{(\d+)\}/g,function(a,b){return[f,e][b]}),g=[];return{regexp:m(d,h.hitch(this,n,g,b,a)),tokens:g,bundle:b}};q.parse=function(a,c){var d=/[\u200E\u200F\u202A\u202E]/g,e=q._parseInfo(c),f=e.tokens,g=e.bundle,d=RegExp("^"+e.regexp.replace(d,
"")+"$",e.strict?"":"i").exec(a&&a.replace(d,""));if(!d)return null;var h=["abbr","wide","narrow"],l=[1970,0,1,0,0,0,0],m="",d=b.every(d,function(a,d){if(!d)return!0;var e=f[d-1],k=e.length,e=e.charAt(0);switch(e){case "y":if(2!=k&&c.strict)l[0]=a;else if(100>a)a=Number(a),e=""+(new Date).getFullYear(),k=100*e.substring(0,2),e=Math.min(Number(e.substring(2,4))+20,99),l[0]=a<e?k+a:k-100+a;else{if(c.strict)return!1;l[0]=a}break;case "M":case "L":if(2<k){if(k=g["months-"+("L"==e?"standAlone":"format")+
"-"+h[k-3]].concat(),c.strict||(a=a.replace(".","").toLowerCase(),k=b.map(k,function(a){return a.replace(".","").toLowerCase()})),a=b.indexOf(k,a),-1==a)return!1}else a--;l[1]=a;break;case "E":case "e":case "c":k=g["days-"+("c"==e?"standAlone":"format")+"-"+h[k-3]].concat();c.strict||(a=a.toLowerCase(),k=b.map(k,function(a){return a.toLowerCase()}));a=b.indexOf(k,a);if(-1==a)return!1;break;case "D":l[1]=0;case "d":l[2]=a;break;case "a":k=c.am||g["dayPeriods-format-wide-am"];e=c.pm||g["dayPeriods-format-wide-pm"];
if(!c.strict){var n=/\./g;a=a.replace(n,"").toLowerCase();k=k.replace(n,"").toLowerCase();e=e.replace(n,"").toLowerCase()}if(c.strict&&a!=k&&a!=e)return!1;m=a==e?"p":a==k?"a":"";break;case "K":24==a&&(a=0);case "h":case "H":case "k":if(23<a)return!1;l[3]=a;break;case "m":l[4]=a;break;case "s":l[5]=a;break;case "S":l[6]=a}return!0}),e=+l[3];"p"===m&&12>e?l[3]=e+12:"a"===m&&12==e&&(l[3]=0);e=new Date(l[0],l[1],l[2],l[3],l[4],l[5],l[6]);c.strict&&e.setFullYear(l[0]);var n=f.join(""),p=-1!=n.indexOf("d"),
n=-1!=n.indexOf("M");if(!d||n&&e.getMonth()>l[1]||p&&e.getDate()>l[2])return null;if(n&&e.getMonth()<l[1]||p&&e.getDate()<l[2])e=k.add(e,"hour",1);return e};var p=[];q.addCustomFormats=function(a,b){p.push({pkg:a,name:b})};q._getGregorianBundle=function(a){var d={};b.forEach(p,function(b){b=c.getLocalization(b.pkg,b.name,a);d=h.mixin(d,b)},this);return d};q.addCustomFormats(g.id.replace(/\/date\/locale$/,".cldr"),"gregorian");q.getNames=function(a,b,c,d){var e;d=q._getGregorianBundle(d);a=[a,c,b];
"standAlone"==c&&(c=a.join("-"),e=d[c],1==e[0]&&(e=void 0));a[1]="format";return(e||d[a.join("-")]).concat()};q.isWeekend=function(b,c){var d=a.getWeekend(c),e=(b||new Date).getDay();d.end<d.start&&(d.end+=7,e<d.start&&(e+=7));return e>=d.start&&e<=d.end};q._getDayOfYear=function(a){return k.difference(new Date(a.getFullYear(),0,1,a.getHours()),a)+1};q._getWeekOfYear=function(a,b){1==arguments.length&&(b=0);var c=(new Date(a.getFullYear(),0,1)).getDay(),d=Math.floor((q._getDayOfYear(a)+(c-b+7)%7-
1)/7);c==b&&d++;return d};return q})},"dijit/_base/wai":function(){define(["dojo/dom-attr","dojo/_base/lang","../main","../hccss"],function(h,b,k){b.mixin(k,{hasWaiRole:function(a,b){var d=this.getWaiRole(a);return b?-1<d.indexOf(b):0<d.length},getWaiRole:function(a){return b.trim((h.get(a,"role")||"").replace("wairole:",""))},setWaiRole:function(a,b){h.set(a,"role",b)},removeWaiRole:function(a,c){var d=h.get(a,"role");d&&(c?(d=b.trim((" "+d+" ").replace(" "+c+" "," ")),h.set(a,"role",d)):a.removeAttribute("role"))},
hasWaiState:function(a,b){return a.hasAttribute?a.hasAttribute("aria-"+b):!!a.getAttribute("aria-"+b)},getWaiState:function(a,b){return a.getAttribute("aria-"+b)||""},setWaiState:function(a,b,d){a.setAttribute("aria-"+b,d)},removeWaiState:function(a,b){a.removeAttribute("aria-"+b)}});return k})},"esri/config":function(){define(["dojo/_base/config","dojo/topic","dojo/has","./kernel"],function(h,b,k,a){var c={defaults:{screenDPI:96,geometryService:null,kmlService:null,map:{width:400,height:400,layerNamePrefix:"layer",
graphicsLayerNamePrefix:"graphicsLayer",slider:{left:"30px",top:"30px",width:null,height:"200px"},sliderLabel:{tick:5,labels:null,style:"width:2em; font-family:Verdana; font-size:75%;"},sliderChangeImmediate:!0,zoomSymbol:{color:[0,0,0,64],outline:{color:[255,0,0,255],width:1.25,style:"esriSLSSolid"},style:"esriSFSSolid"},zoomDuration:500,zoomRate:25,panDuration:350,panRate:25,logoLink:"http://www.esri.com"},autoSpatialIndexing:window.Worker&&!1,io:{errorHandler:function(a,c){b.publish("esri.Error",
[a])},proxyUrl:null,alwaysUseProxy:!1,useCors:!0,corsEnabledServers:"server.arcgisonline.com services.arcgisonline.com www.arcgis.com tiles.arcgis.com tiles1.arcgis.com tiles2.arcgis.com tiles3.arcgis.com tiles4.arcgis.com elevation3d.arcgis.com services.arcgis.com services1.arcgis.com services2.arcgis.com services3.arcgis.com services4.arcgis.com services5.arcgis.com static.arcgis.com utility.arcgisonline.com geocode.arcgis.com geoenrich.arcgis.com qaext.arcgis.com tilesqa.arcgis.com servicesqa.arcgis.com servicesqa1.arcgis.com servicesqa2.arcgis.com servicesqa3.arcgis.com geocodeqa.arcgis.com geoenrichqa.arcgis.com dev.arcgis.com devext.arcgis.com staticdev.arcgis.com tilesdevext.arcgis.com elevation3ddev.arcgis.com servicesdev.arcgis.com servicesdev1.arcgis.com servicesdev2.arcgis.com servicesdev3.arcgis.com geocodedev.arcgis.com geoenrichdev.arcgis.com".split(" "),
corsDetection:window.cordova?!1:!0,corsStatus:{},webTierAuthServers:[],proxyRules:[],postLength:2E3,timeout:6E4,useWorkers:"on-request",maxRequestWorkers:5}}};k("extend-esri")&&(a.config=c);h.noGlobals||(window.esriConfig=c);return c})},"esri/utils":function(){define("./domUtils ./lang ./urlUtils ./request ./tileUtils ./graphicsUtils ./deferredUtils ./layerUtils ./geometry/normalizeUtils".split(" "),function(){return{}})},"esri/kernel":function(){define(["dojo/_base/kernel","dojo/_base/config","dojo/has"],
function(h,b,k){var a=window.location,c=a.pathname,c={version:"3.13",_appBaseUrl:a.protocol+"//"+a.host+c.substring(0,c.lastIndexOf(c.split("/")[c.split("/").length-1]))};b.noGlobals||(window.esri=c);h.isAsync||k.add("extend-esri",1);(c.dijit=c.dijit||{})._arcgisUrl=("file:"===a.protocol?"http:":a.protocol)+"//www.arcgis.com/sharing/rest";return c})},"dijit/_KeyNavMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dijit/registry dijit/_FocusMixin".split(" "),
function(h,b,k,a,c,d,e,f){return b("dijit._KeyNavMixin",f,{tabIndex:"0",childSelector:null,postCreate:function(){this.inherited(arguments);k.set(this.domNode,"tabIndex",this.tabIndex);if(!this._keyNavCodes){var b=this._keyNavCodes={};b[a.HOME]=c.hitch(this,"focusFirstChild");b[a.END]=c.hitch(this,"focusLastChild");b[this.isLeftToRight()?a.LEFT_ARROW:a.RIGHT_ARROW]=c.hitch(this,"_onLeftArrow");b[this.isLeftToRight()?a.RIGHT_ARROW:a.LEFT_ARROW]=c.hitch(this,"_onRightArrow");b[a.UP_ARROW]=c.hitch(this,
"_onUpArrow");b[a.DOWN_ARROW]=c.hitch(this,"_onDownArrow")}var f=this,b="string"==typeof this.childSelector?this.childSelector:c.hitch(this,"childSelector");this.own(d(this.domNode,"keypress",c.hitch(this,"_onContainerKeypress")),d(this.domNode,"keydown",c.hitch(this,"_onContainerKeydown")),d(this.domNode,"focus",c.hitch(this,"_onContainerFocus")),d(this.containerNode,d.selector(b,"focusin"),function(a){f._onChildFocus(e.getEnclosingWidget(this),a)}))},_onLeftArrow:function(){},_onRightArrow:function(){},
_onUpArrow:function(){},_onDownArrow:function(){},focus:function(){this.focusFirstChild()},_getFirstFocusableChild:function(){return this._getNextFocusableChild(null,1)},_getLastFocusableChild:function(){return this._getNextFocusableChild(null,-1)},focusFirstChild:function(){this.focusChild(this._getFirstFocusableChild())},focusLastChild:function(){this.focusChild(this._getLastFocusableChild())},focusChild:function(a,b){a&&(this.focusedChild&&a!==this.focusedChild&&this._onChildBlur(this.focusedChild),
a.set("tabIndex",this.tabIndex),a.focus(b?"end":"start"))},_onContainerFocus:function(a){a.target!==this.domNode||this.focusedChild||this.focus()},_onFocus:function(){k.set(this.domNode,"tabIndex","-1");this.inherited(arguments)},_onBlur:function(a){k.set(this.domNode,"tabIndex",this.tabIndex);this.focusedChild&&(this.focusedChild.set("tabIndex","-1"),this.lastFocusedChild=this.focusedChild,this._set("focusedChild",null));this.inherited(arguments)},_onChildFocus:function(a){a&&a!=this.focusedChild&&
(this.focusedChild&&!this.focusedChild._destroyed&&this.focusedChild.set("tabIndex","-1"),a.set("tabIndex",this.tabIndex),this.lastFocused=a,this._set("focusedChild",a))},_searchString:"",multiCharSearchDuration:1E3,onKeyboardSearch:function(a,b,c,d){a&&this.focusChild(a)},_keyboardSearchCompare:function(a,b){var c=a.domNode,c=(a.label||(c.focusNode?c.focusNode.label:"")||c.innerText||c.textContent||"").replace(/^\s+/,"").substr(0,b.length).toLowerCase();return b.length&&c==b?-1:0},_isFormElement:function(a){return"INPUT"===
a.tagName||"TEXTAREA"===a.tagName||"SELECT"===a.tagName||"BUTTON"===a.tagName},_onContainerKeydown:function(b){if(!this._isFormElement(document.activeElement)){var c=this._keyNavCodes[b.keyCode];c?(c(b,this.focusedChild),b.stopPropagation(),b.preventDefault(),this._searchString=""):b.keyCode==a.SPACE&&(this._searchTimer&&!b.ctrlKey&&!b.altKey&&!b.metaKey)&&(b.stopImmediatePropagation(),b.preventDefault(),this._keyboardSearch(b," "))}},_onContainerKeypress:function(b){if(!this._isFormElement(document.activeElement)&&
!(b.charCode<=a.SPACE||b.ctrlKey||b.altKey||b.metaKey))b.preventDefault(),b.stopPropagation(),this._keyboardSearch(b,String.fromCharCode(b.charCode).toLowerCase())},_keyboardSearch:function(a,b){var d=null,e,f=0;c.hitch(this,function(){this._searchTimer&&this._searchTimer.remove();this._searchString+=b;var a=/^(.)\1*$/.test(this._searchString)?1:this._searchString.length;e=this._searchString.substr(0,a);this._searchTimer=this.defer(function(){this._searchTimer=null;this._searchString=""},this.multiCharSearchDuration);
var c=this.focusedChild||null;if(1==a||!c)if(c=this._getNextFocusableChild(c,1),!c)return;a=c;do{var g=this._keyboardSearchCompare(c,e);g&&0==f++&&(d=c);if(-1==g){f=-1;break}c=this._getNextFocusableChild(c,1)}while(c!=a)})();this.onKeyboardSearch(d,a,e,f)},_onChildBlur:function(){},_getNextFocusableChild:function(a,b){var c=a;do{if(a)a=this._getNext(a,b);else if(a=this[0<b?"_getFirst":"_getLast"](),!a)break;if(null!=a&&a!=c&&a.isFocusable())return a}while(a!=c);return null},_getFirst:function(){return null},
_getLast:function(){return null},_getNext:function(a,b){if(a)for(a=a.domNode;a;)if((a=a[0>b?"previousSibling":"nextSibling"])&&"getAttribute"in a){var c=e.byNode(a);if(c)return c}return null}})})},"dojo/store/util/QueryResults":function(){define(["../../_base/array","../../_base/lang","../../when"],function(h,b,k){var a=function(c){function d(b){c[b]=function(){var d=arguments,l=k(c,function(c){Array.prototype.unshift.call(d,c);return a(h[b].apply(h,d))});if("forEach"!==b||e)return l}}if(!c)return c;
var e=!!c.then;e&&(c=b.delegate(c));d("forEach");d("filter");d("map");null==c.total&&(c.total=k(c,function(a){return a.length}));return c};b.setObject("dojo.store.util.QueryResults",a);return a})},"dijit/form/_ListBase":function(){define(["dojo/_base/declare","dojo/on","dojo/window"],function(h,b,k){return h("dijit.form._ListBase",null,{selected:null,_listConnect:function(a,c){var d=this;return d.own(b(d.containerNode,b.selector(function(a,b,c){return a.parentNode==c},a),function(a){d[c](a,this)}))},
selectFirstNode:function(){for(var a=this.containerNode.firstChild;a&&"none"==a.style.display;)a=a.nextSibling;this._setSelectedAttr(a,!0)},selectLastNode:function(){for(var a=this.containerNode.lastChild;a&&"none"==a.style.display;)a=a.previousSibling;this._setSelectedAttr(a,!0)},selectNextNode:function(){var a=this.selected;if(a){for(a=a.nextSibling;a&&"none"==a.style.display;)a=a.nextSibling;a?this._setSelectedAttr(a,!0):this.selectFirstNode()}else this.selectFirstNode()},selectPreviousNode:function(){var a=
this.selected;if(a){for(a=a.previousSibling;a&&"none"==a.style.display;)a=a.previousSibling;a?this._setSelectedAttr(a,!0):this.selectLastNode()}else this.selectLastNode()},_setSelectedAttr:function(a,b){if(this.selected!=a){var d=this.selected;if(d)this.onDeselect(d);a&&(b&&k.scrollIntoView(a),this.onSelect(a));this._set("selected",a)}else if(a)this.onSelect(a)}})})},"arcgisonline/sharing/geow/Account":function(){define(["dijit","dojo","dojox","dojo/require!dojo/DeferredList,dojo/data/ItemFileReadStore,dojo/data/ItemFileWriteStore,dojo/data/util/sorter,dojo/json,arcgisonline/sharing/dijit/Role,arcgisonline/sharing/dijit/dialog/GeneralDlg,arcgisonline/sharing/dijit/dialog/SimpleDlg,arcgisonline/sharing/util,arcgisonline/sharing/geow/Geow"],
function(h,b,k){b.provide("arcgisonline.sharing.geow.Account");b.require("dojo.DeferredList");b.require("dojo.data.ItemFileReadStore");b.require("dojo.data.ItemFileWriteStore");b.require("dojo.data.util.sorter");b.require("dojo.json");b.require("arcgisonline.sharing.dijit.Role");b.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");b.require("arcgisonline.sharing.dijit.dialog.SimpleDlg");b.require("arcgisonline.sharing.util");b.require("arcgisonline.sharing.geow.Geow");arcgisonline.sharing.geow.Account=
{util:arcgisonline.sharing.util,geow:arcgisonline.sharing.geow.Geow,displayedPortalNonSSLNotice:!1,getCurrentUserInfo:function(a,c){var d=this.util.getUser();null!==d&&this.util.getJson(esriGeowConfig.restBaseUrl+"community/users/"+d.email,b.hitch(this,a))},i18n:function(){return this._i18n?this._i18n:this._i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common},loadMapSettings:function(a){this.geow.checkSharedCookie();arcgisonline.sharing.geow.Account.getSelf(b.hitch(this,function(c,d){if(c){this.geow.setCookies(c);
c.allSSL&&(esriGeowConfig.allSSL=c.allSSL);esri.isDefined(esriGeowConfig.allSSL)&&(esriGeowConfig.allSSL&&"http:"===location.protocol)&&(window.location=arcgisonline.sharing.util.getSecureUrl(location.href));c.basemapGalleryGroupQuery&&(esriGeowConfig.basemapGalleryGroupQuery=c.basemapGalleryGroupQuery);c.templatesGroupQuery&&(esriGeowConfig.templatesGroupQuery=c.templatesGroupQuery);c.defaultBasemap&&(esriGeowConfig.defaultBasemap=c.defaultBasemap);c.defaultExtent&&(esriGeowConfig.defaultExtent=
c.defaultExtent);c.symbolSetsGroupQuery&&(esriGeowConfig.symbolSetsGroupQuery=c.symbolSetsGroupQuery);c.staticImagesUrl&&(esriGeowConfig.staticImagesUrl=c.staticImagesUrl);c.layerTemplatesGroupQuery&&(esriGeowConfig.layerTemplatesGroupQuery=c.layerTemplatesGroupQuery);c.colorSetsGroupQuery&&(esriGeowConfig.colorSetsGroupQuery=c.colorSetsGroupQuery);c.helpBase&&(esriGeowConfig.help=c.helpBase,esriGeowConfig.helpBase=c.helpBase);c.helpMap&&c.helpMap.m&&(esriGeowConfig.helpMap=c.helpMap.m);c.urlKey&&
(esriGeowConfig.urlKey=c.urlKey);c.isPortal&&(arcgisonline.sharing.util._cookies&&-1===arcgisonline.sharing.util._cookies.esri_auth)&&delete arcgisonline.sharing.util._cookies.esri_auth;var e=!1===esriGeowConfig.isMultiTenant,f=arcgisonline.sharing.util.getUser(),g=f?!0:!1,h=window.location.pathname.toLowerCase(),k=-1!=h.indexOf(esriGeowConfig.signin),n=-1!=h.indexOf("troubleshoot.html"),h=-1!=h.indexOf("setup.html");if(!e&&f&&("account_admin"===f.role||"org_admin"===f.role)&&c.id&&!c.urlKey&&!h)window.location=
esriGeowConfig.baseUrl+"setup.html";if(e){c.access&&("private"===c.access&&!g)&&(!this.isSignInPage&&!this.isTroubleshootPage)&&(window.location=arcgisonline.sharing.util.getSecureUrl()+esriGeowConfig.signin+"?returnUrl\x3d"+encodeURIComponent(window.location));e=b.query(".esriLogoIcon");for(f=0;f<e.length;f++)b.replaceClass(e[f],"esriLogoIcon esriOrgIcon");c.isPortal&&"singletenant"===c.portalMode&&("7080"===location.port||"7443"===location.port)&&arcgisonline.sharing.util.checkForIAA().then(b.hitch(this,
function(a){if(a&&a.hasIAA&&(c.portalHostname.match(/:7080\//)&&("http:"===location.protocol&&-1===location.href.indexOf("error.html"))&&(window.location=arcgisonline.sharing.util.getHttpUrl(esriGeowConfig.baseUrl)+"error.html?c\x3dWebAdaptorRequired"),!c.portalHostname.match(/:7080\//)&&80!==esriGeowConfig.self.httpPort&&443!==esriGeowConfig.self.httpsPort&&"http:"===location.protocol&&-1===location.href.indexOf("error.html"))){a=new b._Url(location.href);var d=a.path.indexOf("/home/"),d=a.path.substring(d+
6);a=esri.isDefined(a.query)?"?"+a.query:"";window.location=arcgisonline.sharing.util.getHttpUrl("http://"+c.portalHostname)+"/home/"+d+a}}))}else if(!c.id&&c.urlKey&&!g)!k&&!n&&(window.location=esriGeowConfig.baseUrl.replace("http:","https:")+esriGeowConfig.signin+"?returnUrl\x3d"+encodeURIComponent(window.location));else if(c.id&&c.urlKey&&!g){e=b.query(".esriLogoIcon");for(f=0;f<e.length;f++)b.replaceClass(e[f],"esriLogoIcon esriOrgIcon")}}a&&a(c)}))},getAccountResource:function(a,c,d,e){this.util.getJson(esriGeowConfig.restBaseUrl+
"portals/self/resources/"+c,b.hitch(this,d),b.hitch(this,e))},uploadAccountResource:function(a,c,d,e){this.util.postJson(c,esriGeowConfig.restBaseUrl+"portals/self/addResource",b.hitch(this,d),b.hitch(this,e))},deleteAccountResource:function(a,c,d,e){this.util.postJson({key:c},esriGeowConfig.restBaseUrl+"portals/self/removeResource",b.hitch(this,d),b.hitch(this,e))},getAccountSettings:function(a,c){this.util.getJson(esriGeowConfig.restBaseUrl+"portals/self/resources/accountSettings",b.hitch(this,
function(a){c&&c(a)}),b.hitch(this,function(a){c&&c({})}))},getSelf:function(a,c){if(this._isRequestingSelf)setTimeout(b.hitch(this,"getSelf",a,c),75);else{var d=esriGeowConfig.restBaseUrl+"portals/self?culture\x3d"+b.locale,d=esriGeowConfig&&esriGeowConfig.self||this.util._requestWithAppHandlers({url:d}).then(b.hitch(this,function(a){esriGeowConfig.self=a;esriGeowConfig.userInfo=a.user&&b.mixin(esriGeowConfig.userInfo||{},a.user);a.user&&a.user.username&&(esriGeowConfig.userInfo.email=a.user&&a.user.username);
a.user&&a.user.role&&(esriGeowConfig.userRole=new arcgisonline.sharing.dijit.Role({id:a.user.roleId?a.user.roleId:a.user.role,role:a.user.role}),a.user.privileges&&esriGeowConfig.userRole.setPrivileges(a.user.privileges));this.normalizeOrgIdAndRole();this._isRequestingSelf=!1;10>=b.isIE&&this.throwawayIEPostFix();return a}),b.hitch(this,function(a){throw a;}));this._isRequestingSelf=!esriGeowConfig.self;return b.when(d,a,c)}},normalizeOrgIdAndRole:function(){esri.isDefined(esriGeowConfig.self.user)&&
(esri.isDefined(esriGeowConfig.self.user.orgId)&&(esriGeowConfig.self.user.accountId=esriGeowConfig.self.user.orgId),esri.isDefined(esriGeowConfig.self.user.role)&&(esriGeowConfig.self.user.role=this.util.normalizeOrgRole(esriGeowConfig.self.user.role)));esri.isDefined(esriGeowConfig.userInfo)&&(esri.isDefined(esriGeowConfig.userInfo.orgId)&&(esriGeowConfig.userInfo.accountId=esriGeowConfig.userInfo.orgId),esri.isDefined(esriGeowConfig.userInfo.role)&&(esriGeowConfig.userInfo.role=this.util.normalizeOrgRole(esriGeowConfig.userInfo.role)))},
throwawayIEPostFix:function(){var a=b.create("form",{encoding:"multipart/form-data",method:"POST"});b.create("input",{type:"hidden",name:"f",value:"json"},a);b.create("input",{type:"hidden",name:"q",value:"*"},a);b.create("input",{type:"hidden",name:"callback.html",value:"textarea"},a);b.io.iframe.send({url:esriGeowConfig.restBaseUrl+"community/users",form:a,handleAs:"json"}).then(function(a){}).otherwise(function(a){})},activateAccount:function(a,b,d){null!==this.util.getUser()&&this.util.postJson({code:a},
esriGeowConfig.restBaseUrl+"portals/activate",b,d)},getAccount:function(a,c,d){null!==this.util.getUser()&&this.util.getJson(esriGeowConfig.restBaseUrl+"portals/self",b.hitch(this,c))},updateAccount:function(a,c,d){if(null!==this.util.getUser()){var e="";a.defaultBasemap&&(e=b.json.stringify(a.defaultBasemap),e=e.replace(/(<|>)/g,function(a,b){return"\x3c"==b?"\x26lt;":"\x26gt;"}));a={id:a.id,name:a.name,description:a.description,access:a.access,allSSL:a.allSSL,culture:a.culture,region:a.region,featuredItemsGroupQuery:a.featuredItemsGroupQuery,
canSharePublic:a.canSharePublic,canSearchPublic:a.canSearchPublic,thumbnail:a.thumbnail,basemapGalleryGroupQuery:a.basemapGalleryGroupQuery,defaultBasemap:e,defaultExtent:a.defaultExtent?b.json.stringify(a.defaultExtent):"",featuredGroups:b.json.stringify(a.featuredGroups),homePageFeaturedContent:a.homePageFeaturedContent,homePageFeaturedContentCount:a.homePageFeaturedContentCount,rotatorPanels:b.json.stringify(a.rotatorPanels),showHomePageDescription:a.showHomePageDescription,templatesGroupQuery:a.templatesGroupQuery,
galleryTemplatesGroupQuery:a.galleryTemplatesGroupQuery,urlKey:a.urlKey,commentsEnabled:a.commentsEnabled,geocodeService:b.json.stringify(a.helperServices.geocode),printServiceTask:b.json.stringify(a.helperServices.printTask),geometryService:b.json.stringify(a.helperServices.geometry),routeServiceLayer:b.json.stringify(a.helperServices.route),bingKey:a.bingKey,canShareBingPublic:a.canShareBingPublic,backgroundImage:a.backgroundImage,canSignInIDP:a.canSignInIDP,canSignInArcGIS:a.canSignInArcGIS,useStandardizedQuery:a.useStandardizedQuery,
portalProperties:b.json.stringify(a.portalProperties),units:a.units,mfaEnabled:a.mfaEnabled,mfaAdmins:b.json.stringify(a.mfaAdmins),clearEmptyFields:!0};e=this.util.getSecureUrl(esriGeowConfig.restBaseUrl)+"portals/self/update";this.util.postJson(a,e,b.hitch(this,c),b.hitch(this,d))}},getAccountGroups:function(a,c,d,e){if(null!==this.util.getUser()){e=1;var f=10;null!==c.start&&(e=c.start);null!==c.num&&(f=c.num);this.util.getJson(esriGeowConfig.restBaseUrl+"community/groups?q\x3d"+("(orgid:"+a+" AND (access:org || access:public))")+
"\x26sortField\x3dtitle\x26sortOrder\x3dasc\x26start\x3d"+e+"\x26num\x3d"+f,b.hitch(this,d))}},checkUsernames:function(a,b,d){a=a&&0<a.length?a.join(","):"";this.util.postJson({usernames:a},esriGeowConfig.restBaseUrl+"community/checkUsernames",b,d)},inviteUsers:function(a,b,d){null!==this.util.getUser()&&this.util.postJson(a,esriGeowConfig.restBaseUrl+"portals/self/invite",b,d)},inviteAccountUsersByEmail:function(a,c,d,e){null!==this.util.getUser()&&this.util.postJson(c,esriGeowConfig.restBaseUrl+
"portals/self/inviteByEmail",b.hitch(this,d),b.hitch(this,e))},getPendingAccountUsers:function(a,c,d,e){if(null!==this.util.getUser()){a=1;e=10;var f,g;c.start&&(a=c.start);c.num&&(e=c.num);c.sortField&&(f=c.sortField);c.sortOrder&&(g=c.sortOrder);c=esriGeowConfig.restBaseUrl+"portals/self/invitations?start\x3d"+a+"\x26num\x3d"+e;f&&(c+="\x26sortField\x3d"+f);g&&(c+="\x26sortOrder\x3d"+g);this.util.getJson(c,b.hitch(this,d))}},retrieveInvitations:function(a,b){return this.util.request({url:esriGeowConfig.restBaseUrl+
"portals/self/invitations?start\x3d"+a+"\x26num\x3d"+b})},getInvitation:function(a,c,d){null!==this.util.getUser()&&this.util.getJson(esriGeowConfig.restBaseUrl+"community/invitations/"+a,b.hitch(this,c),d)},acceptInvitation:function(a,c,d){null!==this.util.getUser()&&this.util.postJson({invitationId:a},esriGeowConfig.restBaseUrl+"community/invitations/"+a+"/accept",b.hitch(this,c),b.hitch(this,d))},declineInvitation:function(a,c,d){null!==this.util.getUser()&&this.util.postJson({},esriGeowConfig.restBaseUrl+
"community/invitations/"+a+"/decline",b.hitch(this,c))},approvePendingInvitation:function(a,c,d,e){null!==this.util.getUser()&&this.util.postJson({},esriGeowConfig.restBaseUrl+"portals/self/invitations/"+c+"/approve",b.hitch(this,d))},removePendingInvitation:function(a,c,d,e){null!==this.util.getUser()&&this.util.postJson({},esriGeowConfig.restBaseUrl+"portals/self/invitations/"+c+"/delete",b.hitch(this,d))},getAccountUsers:function(a,c,d,e){if(null!==this.util.getUser()){a=1;e=10;var f,g;c.start&&
(a=c.start);c.num&&(e=c.num);c.sortField&&(f=c.sortField);c.sortOrder&&(g=c.sortOrder);c=esriGeowConfig.restBaseUrl+"portals/self/users?start\x3d"+a+"\x26num\x3d"+e;f&&(c+="\x26sortField\x3d"+f);g&&(c+="\x26sortOrder\x3d"+g);this.util.getJson(c,b.hitch(this,d))}},searchAccountUsers:function(a,c,d,e){null!==this.util.getUser()&&(a=1,e=10,esri.isDefined(c.start)&&(a=c.start),esri.isDefined(c.num)&&(e=c.num),a=esriGeowConfig.restBaseUrl+"portals/self/users?start\x3d"+a+"\x26num\x3d"+e,esri.isDefined(c.sortField)&&
(a+="\x26sortField\x3d"+c.sortField),esri.isDefined(c.sortOrder)&&(a+="\x26sortOrder\x3d"+c.sortOrder),esri.isDefined(c.role)&&(a+="\x26role\x3d"+c.role),esri.isDefined(c.username)&&(a+="\x26username\x3d"+c.username),esri.isDefined(c.fullname)&&(a+="\x26fullname\x3d"+c.fullname),esri.isDefined(c.lastname)&&(a+="\x26lastname\x3d"+c.lastname),esri.isDefined(c.firstname)&&(a+="\x26firstname\x3d"+c.firstname),this.util.getJson(a,b.hitch(this,d)))},searchAccountGroups:function(a,c,d,e,f){if(null!==this.util.getUser()){var g=
1,h=10;null!==d.start&&(g=d.start);null!=d.num&&(h=d.num);this.util.getJson(esriGeowConfig.restBaseUrl+"community/groups?q\x3d"+("("+c+" orgid:"+a+")")+"\x26start\x3d"+g+"\x26num\x3d"+h+"\x26sortField\x3dtitle\x26sortOrder\x3dasc",b.hitch(this,e),b.hitch(this,f))}},updateUserRole:function(a,c,d,e){var f=null,g=this.util.getUser();null!==g&&(f=g.accountId,null!==f&&(g.email===a&&"account_admin"===g.role&&"account_admin"!==c?(a=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),
a.onOkClick=function(){h.byId("general-dialog").hide();d(null)},a.show({title:"Account Administrator",message:"You are an account administrator and cannot remove yourself from the administrator role. Another account administrator must change your role."})):this.util.postJson({user:a,role:c},esriGeowConfig.restBaseUrl+"portals/self/updateUserRole",b.hitch(this,d),b.hitch(this,e))))},deleteUser:function(a,c,d){null!==this.util.getUser()&&this.util.postJson({},esriGeowConfig.restBaseUrl+"community/users/"+
a+"/delete",b.hitch(this,c),b.hitch(this,d))},blankUserStore:function(){return new b.data.ItemFileReadStore({data:{identifier:"username",label:"fullName",items:[]}})},caseInsensitiveComparator:function(a,c){a&&(a=a.toLowerCase());c&&(c=c.toLowerCase());return b.data.util.sorter.basicComparator(a,c)},pendingUsersToStore:function(a,c){var d=[];b.forEach(a,function(a,b){d[b]={id:a.id,fromUsername:a.fromUsername,email:a.email,username:a.username,role:this.util.normalizeOrgRole(a.role),targetId:a.targetId,
type:a.type,targetType:a.targetType,mustApprove:a.mustApprove,accepted:a.accepted,dateAccepted:a.dateAccepted,expiration:a.expiration,created:a.created,culture:c}},this);var e=new b.data.ItemFileReadStore({data:{identifier:"id",label:"fullName",items:d}});e.comparatorMap={email:arcgisonline.sharing.geow.Account.caseInsensitiveComparator,username:arcgisonline.sharing.geow.Account.caseInsensitiveComparator};return e},usersToStore:function(a,c){var d=[];b.forEach(a,function(a,b){d[b]={email:a.email,
fullName:a.fullName,username:a.username,created:a.created,storageUsage:a.storageUsage,role:this.util.normalizeOrgRole(a.role),lastLogin:a.lastLogin,culture:c,disabled:a.disabled,idpUsername:a.idpUsername,userType:a.userType,mfaEnabled:a.mfaEnabled}},this);var e=new b.data.ItemFileReadStore({data:{identifier:"username",label:"fullName",items:d}});e.comparatorMap={fullName:arcgisonline.sharing.geow.Account.caseInsensitiveComparator,username:arcgisonline.sharing.geow.Account.caseInsensitiveComparator};
return e},groupsToStore:function(a){var c=[];b.forEach(a,function(a,b){c[b]={id:a.id,title:a.title}},this);return new b.data.ItemFileWriteStore({data:{identifier:"id",label:"group",items:c}})},getSupportedLanguages:function(a,b){return esri.request({url:esriGeowConfig.restBaseUrl+"portals/languages",content:{f:"json"},load:a,callbackParamName:"callback",error:b})},getSupportedRegions:function(a,c){return esri.request({url:esriGeowConfig.restBaseUrl+"portals/regions",content:{f:"json",culture:b.locale},
load:a,callbackParamName:"callback",error:c})},getSupportedLanguagesAndRegions:function(a,c){var d=new b.Deferred;(void 0!==a&&null!==a||void 0!==c&&null!==c)&&d.addBoth(a,c);var e=[];e.push(arcgisonline.sharing.geow.Account.getSupportedLanguages(null,null));e.push(arcgisonline.sharing.geow.Account.getSupportedRegions(null,null));e=new b.DeferredList(e);e.addCallback(function(a){var b={};b.languages=a[0][1];b.regions=a[1][1];d.callback(b)});e.addErrback(function(a){d.callback(a)});return d}}})},"dijit/form/_FormWidget":function(){define("dojo/_base/declare dojo/sniff dojo/_base/kernel dojo/ready ../_Widget ../_CssStateMixin ../_TemplatedMixin ./_FormWidgetMixin".split(" "),
function(h,b,k,a,c,d,e,f){b("dijit-legacy-requires")&&a(0,function(){require(["dijit/form/_FormValueWidget"])});return h("dijit.form._FormWidget",[c,e,d,f],{setDisabled:function(a){k.deprecated("setDisabled("+a+") is deprecated. Use set('disabled',"+a+") instead.","","2.0");this.set("disabled",a)},setValue:function(a){k.deprecated("dijit.form._FormWidget:setValue("+a+") is deprecated.  Use set('value',"+a+") instead.","","2.0");this.set("value",a)},getValue:function(){k.deprecated(this.declaredClass+
"::getValue() is deprecated. Use get('value') instead.","","2.0");return this.get("value")},postMixInProperties:function(){this.nameAttrSetting=this.name&&!b("msapp")?'name\x3d"'+this.name.replace(/"/g,"\x26quot;")+'"':"";this.inherited(arguments)}})})},"dojo/DeferredList":function(){define(["./_base/kernel","./_base/Deferred","./_base/array"],function(h,b,k){h.DeferredList=function(a,c,d,e,f){var g=[];b.call(this);var h=this;0===a.length&&!c&&this.resolve([0,[]]);var m=0;k.forEach(a,function(b,f){function k(b,
c){g[f]=[b,c];m++;m===a.length&&h.resolve(g)}b.then(function(a){c?h.resolve([f,a]):k(!0,a)},function(a){d?h.reject(a):k(!1,a);if(e)return null;throw a;})})};h.DeferredList.prototype=new b;h.DeferredList.prototype.gatherResults=function(a){a=new h.DeferredList(a,!1,!0,!1);a.addCallback(function(a){var b=[];k.forEach(a,function(a){b.push(a[1])});return b});return a};return h.DeferredList})},"arcgisonline/sharing/dijit/SiteFooter":function(){define(["dijit","dojo","dojox","dojo/require!dijit/_Widget,dijit/_Templated,arcgisonline/sharing/util,arcgisonline/sharing/geow/Account,arcgisonline/sharing/geow/Geow"],
function(h,b,k){b.provide("arcgisonline.sharing.dijit.SiteFooter");b.require("dijit._Widget");b.require("dijit._Templated");b.require("arcgisonline.sharing.util");b.require("arcgisonline.sharing.geow.Account");b.require("arcgisonline.sharing.geow.Geow");b.declare("arcgisonline.sharing.dijit.SiteFooter",[h._Widget,h._Templated],{widgetsInTemplate:!0,templateString:'\x3cdiv dojoAttachPoint\x3d"containerNode" class\x3d"footer"\x3e\r\n\x3c!-- style\x3d"padding-top: 0.5em; margin-bottom: 1em; white-space: nowrap; text-align: center;"\x3e--\x3e\r\n  \x3cspan id\x3d"${id}_links" class\x3d"esriItemLinks"\x3e\x3c/span\x3e  \r\n\x3c/div\x3e',
id:"",geow:arcgisonline.sharing.geow.Geow,isSignInPage:!1,isTroubleshootPage:!1,postMixInProperties:function(){this.inherited(arguments);this.i18n=b.mixin({},b.i18n.getLocalization("arcgisonline","arcgisonline").common);b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").siteFooter);b.mixin(this.i18n,{help:b.i18n.getLocalization("arcgisonline","arcgisonline").supportPage.helpLabel})},postCreate:function(){var a=window.location.pathname.toLowerCase();this.isSignInPage=-1!==a.indexOf(esriGeowConfig.signin);
this.isTroubleshootPage=-1!==a.indexOf("troubleshoot.html")},startup:function(){this._loadLinks()},refresh:function(){b.destroy(this.id+"_links");b.create("span",{id:this.id+"_links",className:"esriItemLinks"},this.domNode);this._loadLinks()},_loadLinks:function(){arcgisonline.sharing.geow.Account.getSelf(b.hitch(this,function(a){var c=arcgisonline.sharing.util.getUser(),d=document.location.href;-1<d.indexOf("?useExisting\x3d1")&&(d=d.substring(0,d.length-14));var e=!1;-1<d.indexOf("viewer.html")&&
-1===d.indexOf("returnUrl")&&(e=!0);var f=b.byId(this.id+"_links"),g=null;b.forEach(esriGeowConfig.footerLinks,function(h){var k=h&&"ArcGIS Marketplace"===h.title&&!c;g&&!k&&b.place(g,f,"last");var l=this._getTitle(h.title);h.url?(-1===h.url.indexOf("http")&&e&&(h.url="support.html"===h.url?a.helpBase||esriGeowConfig.baseUrl+h.url:esriGeowConfig.baseUrl+h.url),("${i18n.help}"===h.title||"support.html"===h.url)&&(this.isSignInPage||this.isTroubleshootPage)&&!c&&!a.id&&a.urlKey&&a.access&&"private"===
a.access&&!a.isPortal?h.url=a.helpBase:"support.html"===h.url&&!a.isPortal&&(h.url=a.helpBase),"ArcGIS Marketplace"===h.title&&(h.url=esriGeowConfig.marketplaceUrl),l=b.create("a",{href:h.url,target:"_blank",innerHTML:l}),k||b.place(l,f,"last")):"contactUs"===h.type?(k="mailto:"+h.email,k+="?subject\x3d"+esri.substitute({appTitle:esriGeowConfig.portalName||"ArcGIS.com"},"A comment about ${appTitle}"),k+="\x26body\x3d"+esri.substitute({appTitle:esriGeowConfig.portalName||"ArcGIS.com",referringPage:escape(d)},
"I have the following comment about the ${appTitle} Web site. %0AReferring page: ${referringPage} %0A %0A(Please provide as much detail as possible. Note: Contact Us is not meant for obtaining technical support or general product information.)"),l=b.create("a",{id:"contactEsri",href:k,innerHTML:l}),b.place(l,f,"last")):"reportAbuse"===h.type&&(k="mailto:"+h.email+"?subject\x3dConcerns about an item",k+="\x26body\x3d"+esri.substitute({referringPage:escape(d)},"I have concerns about the following. %0AReferring page: ${referringPage} %0A %0A(Please describe your concerns. If you have concerns about a particular item, it's best to click the 'Report Abuse' link while viewing the item description. Doing so will include the URL to the specific item in this e-mail.)"),
l=b.create("a",{href:k,innerHTML:l}),b.place(l,f,"last"));g=e?b.create("span",{innerHTML:"\x26nbsp;. "}):b.create("span",{innerHTML:"\x26nbsp;\x26nbsp;|\x26nbsp;\x26nbsp;"})},this);if(esri.isDefined(a.portalProperties)&&esri.isDefined(a.portalProperties.links)&&esri.isDefined(a.portalProperties.links.contactUs)&&a.portalProperties.links.contactUs.visible&&!b.byId("customContactUs")){var h=b.create("a",{href:a.portalProperties.links.contactUs.url,innerHTML:this.i18n.customContactUs,id:"customContactUs"}),
k=b.byId("contactEsri");esri.isDefined(k)?(b.place(h,k,"after"),b.place(g,k,"after")):(0<esriGeowConfig.footerLinks.length&&b.place(g,f,"last"),b.place(h,f,"last"))}}))},_getTitle:function(a){for(var b=a.indexOf("${");-1<b;){var d=a.indexOf("}",b),e=a.substring(b+2,d);a=a.substring(0,b)+eval("this."+e)+a.substring(d+1,a.length);b=a.indexOf("${")}return a}})})},"dojo/dnd/common":function(){define(["../sniff","../_base/kernel","../_base/lang","../dom"],function(h,b,k,a){var c=k.getObject("dojo.dnd",
!0);c.getCopyKeyState=function(a){return a[h("mac")?"metaKey":"ctrlKey"]};c._uniqueId=0;c.getUniqueId=function(){var d;do d=b._scopeName+"Unique"+ ++c._uniqueId;while(a.byId(d));return d};c._empty={};c.isFormElement=function(a){a=a.target;3==a.nodeType&&(a=a.parentNode);return 0<=" a button textarea input select option ".indexOf(" "+a.tagName.toLowerCase()+" ")};return c})},"dijit/Viewport":function(){define(["dojo/Evented","dojo/on","dojo/domReady","dojo/sniff","dojo/window"],function(h,b,k,a,c){var d=
new h,e;k(function(){var f=c.getBox();d._rlh=b(window,"resize",function(){var a=c.getBox();f.h==a.h&&f.w==a.w||(f=a,d.emit("resize"))});if(8==a("ie")){var g=screen.deviceXDPI;setInterval(function(){screen.deviceXDPI!=g&&(g=screen.deviceXDPI,d.emit("resize"))},500)}a("ios")&&(b(document,"focusin",function(a){e=a.target}),b(document,"focusout",function(a){e=null}))});d.getEffectiveBox=function(b){b=c.getBox(b);var d=e&&e.tagName&&e.tagName.toLowerCase();if(a("ios")&&e&&!e.readOnly&&("textarea"==d||
"input"==d&&/^(color|email|number|password|search|tel|text|url)$/.test(e.type)))b.h*=0==orientation||180==orientation?0.66:0.4,d=e.getBoundingClientRect(),b.h=Math.max(b.h,d.top+d.height);return b};return d})},"dojo/io/iframe":function(){define("../_base/config ../_base/json ../_base/kernel ../_base/lang ../_base/xhr ../sniff ../_base/window ../dom ../dom-construct ../query require ../aspect ../request/iframe".split(" "),function(h,b,k,a,c,d,e,f,g,l,m,n,q){k.deprecated("dojo/io/iframe","Use dojo/request/iframe.",
"2.0");d=q._iframeName;d=d.substring(0,d.lastIndexOf("_"));var p=a.delegate(q,{create:function(){return p._frame=q.create.apply(q,arguments)},get:null,post:null,send:function(a){var d,e=c._ioSetArgs(a,function(a){d&&d.cancel()},function(a){var c=null;a=a.ioArgs;try{var e=a.handleAs;"xml"===e||"html"===e?c=d.response.data:(c=d.response.text,"json"===e?c=b.fromJson(c):"javascript"===e&&(c=k.eval(c)))}catch(f){c=f}return c},function(a,b){b.ioArgs._hasError=!0;return a}),g=e.ioArgs,l="GET",m=f.byId(a.form);
a.method&&("POST"===a.method.toUpperCase()&&m)&&(l="POST");a={method:l,handleAs:"json"===a.handleAs||"javascript"===a.handleAs?"text":a.handleAs,form:a.form,query:m?null:a.content,data:m?a.content:null,timeout:a.timeout,ioArgs:g};a.method&&(a.method=a.method.toUpperCase());if(h.ioPublish&&k.publish&&!1!==g.args.ioPublish)var p=n.after(q,"_notifyStart",function(a){a.options.ioArgs===g&&(p.remove(),c._ioNotifyStart(e))},!0);d=q(g.url,a,!0);g._callNext=d._callNext;d.then(function(){e.resolve(e)}).otherwise(function(a){e.ioArgs.error=
a;e.reject(a)});return e},_iframeOnload:e.global[d+"_onload"]});a.setObject("dojo.io.iframe",p);return p})},"arcgisonline/sharing/dijit/views":function(){define(["dijit","dojo","dojox","dojo/require!arcgisonline/sharing/dijit/TextMenu,arcgisonline/sharing/util,arcgisonline/sharing/dijit/ProfilePopup"],function(h,b,k){b.provide("arcgisonline.sharing.dijit.views");b.require("arcgisonline.sharing.dijit.TextMenu");b.require("arcgisonline.sharing.util");b.require("arcgisonline.sharing.dijit.ProfilePopup");
arcgisonline.sharing.dijit.views.item={detailClass:"itemDetail",thumbClass:"itemThumbnail",thumbContainerClass:"itemThumbnailContainer",titleClass:"esriItemTitle",snippetClass:"esriItemSnippet",i18n:function(){if(this._i18n)return this._i18n;this._i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(this._i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").viewsWidget);b.mixin(this._i18n,{source:b.i18n.getLocalization("arcgisonline","arcgisonline").itemProperties.source});
return this._i18n},_util:arcgisonline.sharing.util,small:function(a,c,d){var e=b.create,f=e("div",{"class":this.detailClass+" small"}),g=this._util.getGalleryMainLinkInfo(a);c&&(c=e("div",{"class":this.thumbContainerClass},f),b.addClass(f,d),e("img",{src:this._getThumbnailUrl(a),"class":this.thumbClass},e("a",{href:g.href||"#",target:g.target,alt:g.tip,title:g.tip},c)));e("a",{href:"#",innerHTML:a.title},e("span",{"class":this.titleClass},f));d=this._util.getSnippet(a.snippet,a.description);e("span",
{"class":this.snippetClass,innerHTML:d},f);a=arcgisonline.sharing.geow.Content.changeTypename(a)+arcgisonline.sharing.dijit.views.item.i18n().spaceBy+"\x3cspan class\x3d'esriItemOwner'\x3e"+a.owner+"\x3c/span\x3e ("+this._util.toFullDateString(a.modified)+")";e("span",{innerHTML:a},f);return f},mediumFormat:function(a,b){return this.medium(b,!0,"left")},itemLinkInfo:function(a){var b=this._util.getGalleryMainLinkInfo(a);a=this._util.getItemDetailsLinkInfo(a);return{openLink:b,detailLink:a}},medium:function(a,
c){var d=b.create,e=d("div",{"class":this.detailClass+" medium"});if(c.unshareHandler){var f=d("a",{href:"#",className:"unshare esriFloatTrailing",style:{display:"none"}},e);d("img",{src:arcgisonline.sharing.util.relativeToExplicitUrl("images/delete_20x20.png"),alt:arcgisonline.sharing.dijit.views.item.i18n().removeItemFromGroup,title:arcgisonline.sharing.dijit.views.item.i18n().removeItemFromGroup},f);b.connect(f,"onclick",b.partial(c.unshareHandler,a.id,e))}var g=this.itemLinkInfo(a),f=g.openLink,
g=g.detailLink;if(c.showThumb){var h=d("div",{"class":this.thumbContainerClass},e);b.addClass(e,c.align||"left");if(a.thumbnail&&0<a.thumbnail.length)var k=d("img",{src:this._getThumbnailUrl(a),"class":this.thumbClass},d("a",{href:f.href||"#",target:f.target,alt:f.tip,title:f.tip},h));else k=this._util.relativeToExplicitUrl("images/web-thumbnail-error.png"),k="Web Mapping Application"==a.type?arcgisonline.sharing.util.getStaticImagesUrl()+"/webapp.png":"Mobile Application"==a.type?arcgisonline.sharing.util.getStaticImagesUrl()+
"/mobileapp.png":"Image"===a.type?arcgisonline.sharing.util.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/css/images/image-thumb.png"):"Web Scene"===a.type||"Scene Service"===a.type?arcgisonline.sharing.util.getStaticImagesUrl()+"/scene.png":arcgisonline.sharing.util.getStaticImagesUrl()+"/desktopapp.png",k=d("img",{src:k,"class":this.thumbClass},d("a",{href:f.href||"#",target:f.target,alt:f.tip,title:f.tip},h));f.onclick&&b.connect(k,"onclick",f.onclick);d("br",null,h);h=d("span",{"class":"esriItemLinks"},
h);k=this._util.getItemOpenLinkObjects(a);if(0<k.length){var n=d("span",{innerHTML:f.label},d("a",{href:f.href||"#",target:f.target,alt:f.tip,title:f.tip,style:{marginRight:0}},h));f.onclick&&b.connect(n,"onclick",f.onclick);c.hideOpenMenu||(d("span",{innerHTML:"\x26nbsp;"},h),f=d("div",{innerHTML:"","class":"dijitReset dijitInline esriArrows",title:arcgisonline.sharing.dijit.views.item.i18n().moreOptions,alt:arcgisonline.sharing.dijit.views.item.i18n().moreOptions,style:{height:"11px",cursor:"pointer"}},
h),new arcgisonline.sharing.dijit.TextMenu({triggerNode:f,labelNode:n,textMenuItems:k}));d("span",{innerHTML:"\x26nbsp;\x26nbsp\x26nbsp;"},h)}null!==g&&d("span",{innerHTML:g.label},d("a",{href:g.link||"#",alt:g.tip,title:g.tip,target:g.target?g.target:""},h))}f=d("div",{"class":"itemTextContainer"},e);d("a",{href:g.link,innerHTML:a.title,alt:g.tip,title:g.tip},d("span",{"class":this.titleClass},f));g=this._util.getSnippet(a.snippet,a.description);d("span",{"class":this.snippetClass,innerHTML:g||""},
f);g=d("div",null,f);(h=this._getTypeIcon(a))&&d("span",{innerHTML:h},g);h="";h=arcgisonline.sharing.geow.Content.changeTypename(a)+arcgisonline.sharing.dijit.views.item.i18n().spaceBy;k=-1<b.indexOf(a.typeKeywords,"ArcGIS Server")||"Feature Collection"==a.type?arcgisonline.sharing.dijit.views.item.i18n().source+" ":"";d("span",{title:k+("GeoJson"===a.type?"GeoJSON":a.type),innerHTML:h,"class":"dim"},g);h=d("span",{"class":"esriItemAuthor"},g);h=d("a",{innerHTML:a.owner,"class":"linkNoHref",owner:a.owner,
alt:arcgisonline.sharing.dijit.views.item.i18n().viewUserprofile,title:arcgisonline.sharing.dijit.views.item.i18n().viewUserprofile},h);c.showProfilePopup?(b.connect(h,"onclick",this,function(a){var c=b.attr(a.currentTarget,"owner"),d=arcgisonline.sharing.dijit.ProfilePopup.prototype.statics.getInstance();null!==d&&b.hitch(d,d.showProfile,c,a.currentTarget).call()}),b.attr(h,{"class":"linkNoHref",owner:a.owner})):b.attr(h,"href",esriGeowConfig.baseUrl+"user.html?user\x3d"+a.owner);d("div",{innerHTML:"\x3cspan\x3e"+
arcgisonline.sharing.dijit.views.item.i18n().lastModifiedTitle+"\x3c/span\x3e\x3cspan\x3e"+this._util.toFullDateString(a.modified)+"\x3c/span\x3e","class":"dim esriLastModified"},g);(h=arcgisonline.sharing.geow.Content._getPremiumItemNode(a))&&b.place(h,b.create("div",{className:"dim esriPremiumContent"},g,"last"));g=b.create("span",{"class":"dojoxRating dijitInline"});9>b.isIE&&b.style(g,"zoom",0);h=b.create("ul",null,g);k=Math.round(a.avgRating);for(n=1;n<=k;n++)b.create("li",{"class":"dojoxRatingStar dijitInline dojoxRatingStarChecked"},
h);for(;5>k;k++)b.create("li",{"class":"dojoxRatingStar dijitInline Hover"},h);h=this._getMsgRatings(a);d=d("span",{innerHTML:h,"class":"dim"},f);b.place(g,d,"first");return e},map:function(a){var c=b.create,d=c("div",{"class":this.detailClass+" medium"}),e=c("div",{"class":"itemTextContainer"},d),f=this._util.getSnippet(a.snippet,a.description);c("span",{"class":this.snippetClass,innerHTML:f?this._util.htmlEncode(f):""},e);var f=c("span",null,e),g=this._getTypeIcon(a,!0);g&&c("span",{innerHTML:g},
f);var g="",g=a.url&&-1<b.indexOf(a.typeKeywords,"Hosted Service")&&(arcgisonline.sharing.util.isHostedServiceItem(a)||arcgisonline.sharing.util.portalSupportsHostedServices())?arcgisonline.sharing.geow.Content.changeTypename(a,!0)+arcgisonline.sharing.dijit.views.item.i18n().startBracket+arcgisonline.sharing.dijit.views.item.i18n().hostedService+arcgisonline.sharing.dijit.views.item.i18n().endBracket+arcgisonline.sharing.dijit.views.item.i18n().spaceBy:arcgisonline.sharing.geow.Content.changeTypename(a,
!1)+arcgisonline.sharing.dijit.views.item.i18n().spaceBy,h=-1<b.indexOf(a.typeKeywords,"ArcGIS Server")||"Feature Collection"==a.type?arcgisonline.sharing.dijit.views.item.i18n().source+" ":"";c("span",{title:h+("GeoJson"===a.type?"GeoJSON":a.type),innerHTML:g,"class":"dim"},f);g=c("span",{"class":"esriItemAuthor"},f);g=c("a",{innerHTML:a.owner,"class":"linkNoHref",owner:a.owner,alt:arcgisonline.sharing.dijit.views.item.i18n().viewUserprofile,title:arcgisonline.sharing.dijit.views.item.i18n().viewUserprofile},
g);b.connect(g,"onclick",this,function(a){var c=b.attr(a.currentTarget,"owner"),d=arcgisonline.sharing.dijit.ProfilePopup.prototype.statics.getInstance();null!==d&&(b.hitch(d,d.showProfile,c,a.currentTarget).call(),b.style(d.domNode,"zIndex","10"))});b.attr(g,{"class":"linkNoHref",owner:a.owner});c("div",{innerHTML:"\x3cbr/\x3e\x3cspan\x3e"+arcgisonline.sharing.dijit.views.item.i18n().lastModifiedTitle+"\x3c/span\x3e\x3cspan\x3e"+this._util.toFullDateString(a.modified)+"\x3c/span\x3e","class":"dim esriLastModified"},
f);(g=arcgisonline.sharing.geow.Content._getPremiumItemNode(a))&&b.place(g,b.create("div",{className:"dim esriPremiumContent"},f,"last"));f=b.create("span",{"class":"dojoxRating dijitInline"});9>b.isIE&&b.style(f,"zoom",0);for(var g=b.create("ul",null,f),h=Math.round(a.avgRating),k=1;k<=h;k++)b.create("li",{"class":"dojoxRatingStar dijitInline dojoxRatingStarChecked"},g);for(;5>h;h++)b.create("li",{"class":"dojoxRatingStar dijitInline Hover"},g);a=this._getMsgRatings(a);c=c("span",{innerHTML:a,"class":"dim"},
e);b.place(f,c,"first");return d},_getMsgRatings:function(a){var c="",c=1===a.numRatings?c+b.string.substitute(arcgisonline.sharing.dijit.views.item.i18n().ratingMsg,{ratingcount:b.number.format(a.numRatings,{pattern:"#,###,###,##0"})}):c+b.string.substitute(arcgisonline.sharing.dijit.views.item.i18n().ratingsMsg,{ratingcount:b.number.format(a.numRatings,{pattern:"#,###,###,##0"})}),c=1===a.numComments?c+b.string.substitute(arcgisonline.sharing.dijit.views.item.i18n().commentMsg,{commentcount:b.number.format(a.numComments,
{pattern:"#,###,###,##0"})}):c+b.string.substitute(arcgisonline.sharing.dijit.views.item.i18n().commentsMsg,{commentcount:b.number.format(a.numComments,{pattern:"#,###,###,##0"})}),d=a.type,c="Explorer Map"===d||"Map Document"===d||"Globe Document"===d||"Scene Document"===d||"Layer Package"===d||"Map Package"===d||"Desktop Add In"===d||"Windows Mobile Package"===d||"Layer"===d||"Explorer Layer"===d||"Explorer Add In"===d||"Published Map"===d||"Desktop Application Template"===d||"Map Template"===d||
"Geoprocessing Sample"===d||"Code Sample"===d?1===a.numViews?c+b.string.substitute(arcgisonline.sharing.dijit.views.item.i18n().downloadMsg,{downloadcount:b.number.format(a.numViews,{pattern:"#,###,###,##0"})}):c+b.string.substitute(arcgisonline.sharing.dijit.views.item.i18n().downloadsMsg,{downloadcount:b.number.format(a.numViews,{pattern:"#,###,###,##0"})}):1===a.numViews?c+b.string.substitute(arcgisonline.sharing.dijit.views.item.i18n().viewMsg,{viewcount:b.number.format(a.numViews,{pattern:"#,###,###,##0"})}):
c+b.string.substitute(arcgisonline.sharing.dijit.views.item.i18n().viewsMsg,{viewcount:b.number.format(a.numViews,{pattern:"#,###,###,##0"})});return c=arcgisonline.sharing.dijit.views.item.i18n().startBracket+c+arcgisonline.sharing.dijit.views.item.i18n().endBracket},_getThumbnailUrl:function(a){var b=this._util.getToken(),b=b?"?token\x3d"+b:"";if(a.thumbnail)return esriGeowConfig.restBaseUrl+"content/items/"+a.id+"/info/"+a.thumbnail+b;b=this._util.relativeToExplicitUrl("images/web-thumbnail-error.png");
return b="Web Mapping Application"==a.type?arcgisonline.sharing.util.getStaticImagesUrl()+"/webapp.png":"Mobile Application"==a.type?arcgisonline.sharing.util.getStaticImagesUrl()+"/mobileapp.png":"Web Scene"==a.type||"Scene Service"===a.type?arcgisonline.sharing.util.getStaticImagesUrl()+"/scene.png":arcgisonline.sharing.util.getStaticImagesUrl()+"/desktopapp.png"},_getTypeIcon:function(a,c){var d=arcgisonline.sharing.geow.Content._getItemIconUrl(a,!0),e=(-1<b.indexOf(a.typeKeywords,"ArcGIS Server")||
"Feature Collection"==a.type?this.i18n().source+" ":"")+("GeoJson"===a.type?"GeoJSON":a.type),f="";d&&(f='\x3cimg src\x3d"'+d+'" alt\x3d"'+e+'" title\x3d"'+e+'" style\x3d"vertical-align:middle;"/\x3e\x26nbsp;');return f}};arcgisonline.sharing.dijit.views.group={_util:arcgisonline.sharing.util,detailClass:"itemDetail group",thumbClass:"groupThumbnail",thumbContainerClass:"itemThumbnailContainer",titleClass:"esriItemTitle",snippetClass:"esriItemSnippet",i18n:function(){if(this._i18n)return this._i18n;
this._i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(this._i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").viewsWidget);return this._i18n},_getThumbnailUrl:function(a){var b=this._util.getToken();return esriGeowConfig.restBaseUrl+"community/groups/"+a.id+"/info/"+a.thumbnail+(b?"?token\x3d"+b:"")},small:function(a,c,d){var e=b.create,f=e("div",{"class":this.detailClass});b.addClass(f,"small");var g={target:"",href:"#"};c&&(c=e("div",{"class":this.thumbContainerClass},
f),b.addClass(f,d||"left"),a.thumbnail&&0<a.thumbnail.length?e("img",{src:this._getThumbnailUrl(a),"class":this.thumbClass},c):e("img",{src:this._util.relativeToExplicitUrl("images/group-no-image.png"),"class":this.thumbClass},c));e("a",{href:g.href,target:g.target,innerHTML:a.title,alt:g.tip,title:g.tip},e("span",{"class":this.titleClass},f));d=this._util.getSnippet(a.snippet,a.description);e("span",{"class":this.snippetClass,innerHTML:d},f);d=e("span",null,null);e("span",{innerHTML:"owned by ",
"class":"dim"},d);d=e("span",{"class":"esriItemAuthor"},d);e("a",{innerHTML:a.owner,href:""},d);return f},medium:function(a,c){var d=b.create,e=d("div",{"class":this.detailClass+" medium"}),f=esriGeowConfig.baseUrl+"group.html?owner\x3d"+a.owner+"\x26title\x3d"+encodeURIComponent(a.title);arcgisonline.sharing.dijit.views.group.i18n();arcgisonline.sharing.dijit.views.group.i18n();if(c.showThumb){var g=d("div",{"class":this.thumbContainerClass},e);b.addClass(e,c.align||"left");if(c.groupsUser){var h=
this._util.getUser();arcgisonline.sharing.geow.Community.getProfile(a.owner,b.hitch(this,function(b,c,e){!c.code&&!c.message?"public"!==b.access&&(!c.orgId||c.orgId!==h.accountId)?d("img",{src:this._util.relativeToExplicitUrl("images/group-no-image.png"),"class":this.thumbClass},d("a",{href:f||"#",alt:arcgisonline.sharing.dijit.views.group.i18n().viewGroupDetails,title:arcgisonline.sharing.dijit.views.group.i18n().viewGroupDetails},g)):a.thumbnail&&0<a.thumbnail.length?d("img",{src:this._getThumbnailUrl(a),
"class":this.thumbClass},d("a",{href:f||"#",alt:arcgisonline.sharing.dijit.views.group.i18n().viewGroupDetails,title:arcgisonline.sharing.dijit.views.group.i18n().viewGroupDetails},g)):d("img",{src:this._util.relativeToExplicitUrl("images/group-no-image.png"),"class":this.thumbClass},d("a",{href:f||"#",alt:arcgisonline.sharing.dijit.views.group.i18n().viewGroupDetails,title:arcgisonline.sharing.dijit.views.group.i18n().viewGroupDetails},g)):d("img",{src:this._util.relativeToExplicitUrl("images/group-no-image.png"),
"class":this.thumbClass},d("a",{href:f||"#",alt:arcgisonline.sharing.dijit.views.group.i18n().viewGroupDetails,title:arcgisonline.sharing.dijit.views.group.i18n().viewGroupDetails},g))},a))}else a.thumbnail&&0<a.thumbnail.length?d("img",{src:this._getThumbnailUrl(a),"class":this.thumbClass},d("a",{href:f||"#",alt:arcgisonline.sharing.dijit.views.group.i18n().viewGroupDetails,title:arcgisonline.sharing.dijit.views.group.i18n().viewGroupDetails},g)):d("img",{src:this._util.relativeToExplicitUrl("images/group-no-image.png"),
"class":this.thumbClass},d("a",{href:f||"#",alt:arcgisonline.sharing.dijit.views.group.i18n().viewGroupDetails,title:arcgisonline.sharing.dijit.views.group.i18n().viewGroupDetails},g)),d("br",null,g),b.place(this._util.getGroupLinks(a),g)}var k=d("div",{"class":"itemTextContainer"},e);d("a",{href:f,innerHTML:a.title,alt:arcgisonline.sharing.dijit.views.group.i18n().viewGroupDetails,title:arcgisonline.sharing.dijit.views.group.i18n().viewGroupDetails},d("span",{"class":this.titleClass},k));var n=this._util.getSnippet(a.snippet,
a.description);d("span",{"class":this.snippetClass,innerHTML:n||""},k);k=d("span",null,k);d("span",{innerHTML:arcgisonline.sharing.dijit.views.group.i18n().createdBy,"class":"dim"},k);n=d("span",{"class":"esriItemAuthor"},k);n=d("a",{innerHTML:a.owner,alt:arcgisonline.sharing.dijit.views.group.i18n().viewUserprofile,title:arcgisonline.sharing.dijit.views.group.i18n().viewUserprofile},n);c.showProfilePopup?(b.connect(n,"onclick",this,function(a){var c=b.attr(a.currentTarget,"owner"),d=arcgisonline.sharing.dijit.ProfilePopup.prototype.statics.getInstance();
null!==d&&b.hitch(d,d.showProfile,c,a.currentTarget).call()}),b.attr(n,{"class":"linkNoHref",owner:a.owner})):b.attr(n,"href",esriGeowConfig.baseUrl+"user.html?user\x3d"+a.owner);n=a.created;d("span",{innerHTML:"\x26nbsp;"+arcgisonline.sharing.dijit.views.group.i18n().createdOn+"\x26nbsp;"+this._util.toFullDateString(n),"class":"dim"},k);return e}};arcgisonline.sharing.dijit.views.profile={_util:arcgisonline.sharing.util,detailClass:"itemDetail",thumbClass:"profileThumbnail",thumbContainerClass:"itemThumbnailContainer",
titleClass:"esriItemTitle",snippetClass:"esriItemSnippet",noDescriptionText:"",i18n:function(){if(this._i18n)return this._i18n;this._i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(this._i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").viewsWidget);return this._i18n},_getThumbnailUrl:function(a){var b=this._util.getToken();return esriGeowConfig.restBaseUrl+"community/users/"+a.username+"/info/"+a.thumbnail+(b?"?token\x3d"+b:"")},medium:function(a,c){arcgisonline.sharing.dijit.views.profile.noDescriptionText=
arcgisonline.sharing.dijit.views.profile.i18n().userPersonalInfoMsg;arcgisonline.sharing.dijit.views.profile.memberNoDescriptionText=arcgisonline.sharing.dijit.views.profile.i18n().memberPersonalInfoMsg;var d=arcgisonline.sharing.util.getUser(),e=b.create,f=e("div",{"class":this.detailClass});b.addClass(f,"medium");e("span",{"class":this.titleClass,innerHTML:a.fullName||a.username},f);if(d&&d.accountId&&a.accountId&&a.role&&d.accountId==a.accountId){var g="\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;";
"account_publisher"===a.role?g+=arcgisonline.sharing.dijit.views.profile.i18n().publisher:"account_admin"===a.role?g+=arcgisonline.sharing.dijit.views.profile.i18n().administrator:"account_user"===a.role&&(g+=arcgisonline.sharing.dijit.views.profile.i18n().user);e("span",{innerHTML:g},e("strong",{},f))}c.showThumb&&(g=e("div",{"class":this.thumbContainerClass},f),b.addClass(f,c.align||"left"),a.thumbnail&&0<a.thumbnail.length?e("img",{src:this._getThumbnailUrl(a),"class":this.thumbClass},g):e("img",
{src:this._util.relativeToExplicitUrl("js/arcgisonline/css/images/no-user-thumb.jpg"),"class":this.thumbClass,style:"width:150px; height:150px;"},g));var g=e("div",{"class":this.snippetClass},e("span",{"class":"esriItemLinks"},f)),h=this._util.removeHTMLTags(a.description),k=d&&d.accountId&&a.orgId&&d.accountId===a.orgId?arcgisonline.sharing.dijit.views.profile.memberNoDescriptionText:arcgisonline.sharing.dijit.views.profile.noDescriptionText,h=0<h.length?a.description:k,h=this._util.linkifyText(h);
8>b.isIE&&(h="\x3cpre class\x3d'esriProfileDesc'\x3e"+h+"\x3c/pre\x3e");e("span",{innerHTML:h,style:"white-space:pre-wrap;"},g,"only");g=e("div",{style:{clear:"both"},"class":"profileLinks esriItemLinks esriFloatTrailing"},f);h=e("a",{href:"JavaScript:void(0);",innerHTML:arcgisonline.sharing.dijit.views.profile.i18n().profile},g);b.connect(h,"onclick",function(){-1<window.location.href.indexOf(esriGeowConfig.webmapViewerPath)&&arcgisonline.map.main.map&&arcgisonline.map.main.mapInitialized?arcgisonline.map.storage.saveMapInCookie(null,
!0,null,null,b.hitch(this,function(){window.location=esriGeowConfig.baseUrl+"user.html?user\x3d"+a.username})):window.location=esriGeowConfig.baseUrl+"user.html?user\x3d"+a.username});this._util.relativeToExplicitUrl("js/arcgisonline/css/images/transparent.gif");-1<window.location.href.indexOf(esriGeowConfig.webmapViewerPath)&&this._util.relativeToExplicitUrl("images/transparent.gif");var h=esriGeowConfig.userRole&&esriGeowConfig.userRole.isAdmin(),n=(k=esriGeowConfig.userRole&&esriGeowConfig.userRole.isCustom())&&
esriGeowConfig.userRole.canViewUsers()&&esriGeowConfig.userRole.canViewOrgItems();d&&(d.username===a.username?e("a",{href:esriGeowConfig.baseUrl+"content.html",innerHTML:arcgisonline.sharing.dijit.views.profile.i18n().manageItems},g):d.accountId&&d.role&&(a.orgId&&a.role&&(h||k&&n)&&d.accountId===a.orgId)&&e("a",{href:esriGeowConfig.baseUrl+"content.html?user\x3d"+a.username,innerHTML:arcgisonline.sharing.dijit.views.profile.i18n().manageItems},g));e("a",{href:esriGeowConfig.baseUrl+"search.html?q\x3downer:"+
a.username,innerHTML:arcgisonline.sharing.dijit.views.profile.i18n().items},g);e("a",{href:esriGeowConfig.baseUrl+"search.html?t\x3dgroups\x26q\x3downer:"+a.username,innerHTML:arcgisonline.sharing.dijit.views.profile.i18n().groups},g);e("div",{style:{clear:"both",width:"100%"}},f);return f}}})},"esri/tileUtils":function(){define(["dojo/_base/array","dojo/has","./kernel","./geometry/Point","./geometry/Extent"],function(h,b,k,a,c){var d={_addFrameInfo:function(a,b){var c,d,k=2*b.origin[1],n=b.origin[0],
q=a.origin.x,p=a.width,s;h.forEach(a.lods,function(a){c=Math.round(k/a.resolution);d=Math.ceil(c/p);s=Math.floor((n-q)/(p*a.resolution));a._frameInfo||(a._frameInfo=[d,s,s+d-1,c])})},getContainingTileCoords:function(a,b,c){var d=a.origin;c=c.resolution;return{row:Math.floor((d.y-b.y)/(a.height*c)),col:Math.floor((b.x-d.x)/(a.width*c))}},getCandidateTileInfo:function(b,d,g){var h;h=b.width;for(var k=b.height,n=g.xmax-g.xmin,q=g.ymax-g.ymin,p=b.__tileInfo===d,s=p?b.getMinZoom():-1,p=p?b.getMaxZoom():
-1,t=-1,u=d.lods,x=Math.abs,w,v,y,p=-1<p?p:u.length-1,s=-1<s?s:0;s<=p;s++)if(v=u[s])if(y=n>q?x(q-k*v.resolution):x(n-h*v.resolution),0>t||y<=t)w=v,t=y;else break;h=w;w=h.resolution;k=(g.xmin+g.xmax)/2;n=(g.ymin+g.ymax)/2;q=b.width/2*w;w*=b.height/2;k=new c(k-q,n-w,k+q,n+w,g.spatialReference);g=new a(k.xmin,k.ymax,g.spatialReference);p=h.resolution;q=d.width;n=d.height;d=d.origin;b=b.__visibleDelta;w=Math.floor;u=q*p;x=n*p;p=w((d.y-g.y)/x);t=w((g.x-d.x)/u);s=d.y-p*x;d=w(Math.abs((g.x-(d.x+t*u))*q/
u))+b.x;b=w(Math.abs((g.y-s)*n/x))+b.y;return{tile:{point:g,coords:{row:p,col:t},offsets:{x:d,y:b}},lod:h,extent:k}},getTileExtent:function(a,b,d,h){var k=a.origin;b=a.lods[b].resolution;var n=a.width,q=a.height;return new c(h*b*n+k.x,k.y-(d+1)*b*q,(h+1)*b*n+k.x,k.y-d*b*q,a.spatialReference)}};b("extend-esri")&&(k.TileUtils=d);return d})},"arcgisonline/sharing/dijit/Search":function(){define(["dijit","dojo","dojox","dojo/require!arcgisonline/sharing/util,dijit/_Widget,dijit/_Templated,arcgisonline/sharing/_Search,dijit/form/Button,dijit/form/TextBox,dijit/Menu,arcgisonline/sharing/dijit/dialog/GeneralDlg"],
function(h,b,k){b.provide("arcgisonline.sharing.dijit.Search");b.require("arcgisonline.sharing.util");b.require("dijit._Widget");b.require("dijit._Templated");b.require("arcgisonline.sharing._Search");b.require("dijit.form.Button");b.require("dijit.form.TextBox");b.require("dijit.Menu");b.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");b.declare("arcgisonline.sharing.dijit.Search",[h._Widget,h._Templated,arcgisonline.sharing._Search],{util:arcgisonline.sharing.util,widgetsInTemplate:!0,templateString:'\x3cdiv dojoAttachPoint\x3d"containerNode" class\x3d"search" id\x3d"search-form-box" style\x3d"position: relative;"\x3e\r\n  \x3cform id\x3d"search-form" autocomplete\x3d"off"\x3e\r\n    \r\n    \x3cinput class\x3d"esriSearchBox" name\x3d"q" type\x3d"text" dojoType\x3d"dijit.form.TextBox" trim\x3d"true" id\x3d"search-box" dojoAttachPoint\x3d"searchText" dojoAttachEvent\x3d"onKeyPress:_onSearchKeyPress,onFocus:_onSearchTextFocus,onBlur:_onSearchBoxBlur" alt\x3d"${i18n.searchFor}" title\x3d"${i18n.searchFor}" /\x3e\r\n    \x3c!--\x3cinput type\x3d"search" placeholder\x3d"Search"id\x3d"search-box" dojoAttachPoint\x3d"searchText" dojoAttachEvent\x3d"onKeyPress:_onSearchKeyPress,onFocus:_onSearchBoxFocus,onBlur:_onSearchBoxBlur" alt\x3d"${i18n.searchFor}" title\x3d"${i18n.searchFor} /\x3e--\x3e\r\n    \x3c!--\x3cbutton class\x3d"esriLeadingMargin13 esriSearchButton" id\x3d"search-box_submit" alt\x3d"${i18n.searchTitle}" title\x3d"${i18n.searchTitle}" dojoAttachPoint\x3d"searchButton" dojoAttachEvent\x3d"onclick:_onSearchClick" \x3e\x26nbsp;\x26nbsp;\x3c/button\x3e--\x3e\r\n    \r\n    \x3cdiv dojoAttachPoint\x3d"_domainsContainer" class\x3d"domains" style\x3d"display: none; position: absolute; z-index:5;"\x3e\r\n      \x3ca dojoAttachEvent\x3d"onclick:_onFilterClick" class\x3d"selected" filter\x3d""\x3e${i18n.searchAllContent}\x3c/a\x3e\r\n      \x3ca dojoAttachEvent\x3d"onclick:_onFilterClick" filter\x3d"maps"\x3e${i18n.searchForMaps}\x3c/a\x3e\r\n      \x3ca dojoAttachEvent\x3d"onclick:_onFilterClick" filter\x3d"layers"\x3e${i18n.searchForLayers}\x3c/a\x3e\r\n      \x3ca dojoAttachEvent\x3d"onclick:_onFilterClick" filter\x3d"applications"\x3e${i18n.searchForApps}\x3c/a\x3e\r\n      \x3ca dojoAttachEvent\x3d"onclick:_onFilterClick" filter\x3d"tools"\x3e${i18n.searchForTools}\x3c/a\x3e\r\n      \x3ca dojoAttachEvent\x3d"onclick:_onFilterClick" filter\x3d"files"\x3e${i18n.searchForFiles}\x3c/a\x3e\r\n      \x3chr/\x3e\r\n      \x3ca dojoAttachPoint\x3d"_groupSearchAnchor" dojoAttachEvent\x3d"onclick:_onFilterClick" filter\x3d"group" style\x3d"display:none;"\x3e${i18n.searchForThisGroup}\x3c/a\x3e\r\n      \x3ca dojoAttachEvent\x3d"onclick:_onFilterClick" filter\x3d"groups"\x3e${i18n.searchForGroups}\x3c/a\x3e\r\n    \x3c/div\x3e\r\n    \r\n  \x3c/form\x3e      \r\n\x3c/div\x3e',
query:"",domain:null,focus:null,owner:"",group:"",searchButton:null,searchText:null,_domainsContainer:null,_groupSeachAnchor:null,showDomainsAnim:null,hidedomainsAnim:null,_currentSearchBoxTip:null,searchBoxTip:null,searchBoxTipGroup:null,searchBoxTipGroups:null,_firstLinkPos:0,i18n:null,postMixInProperties:function(){this.inherited(arguments);this.i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").search);this.searchBoxTip=
this.i18n.searchBoxTip;this.searchBoxTipGroup=this.i18n.searchBoxTipGroup;this.searchBoxTipGroups=this.i18n.searchBoxTipGroups},postCreate:function(){this.restrict=(this._queryStringParams=b.queryToObject(window.location.search.slice(1)))&&this._queryStringParams.restrict;-1!==window.location.pathname.toLowerCase().indexOf("group.html")&&(this.owner=this._queryStringParams.owner,this.title=this._queryStringParams.title,b.style(this._groupSearchAnchor,"display",""));var a=b.query(".domains a",this.domNode);
a.removeClass("selected");this._queryStringParams.t&&"content"!==this._queryStringParams.t?b.query(".domains a[filter\x3d"+this._queryStringParams.t+"]",this.domNode).addClass("selected"):this._queryStringParams.focus?(this.focus="all"===this._queryStringParams.focus?null:this._queryStringParams.focus,b.query(".domains a[filter\x3d"+(this.focus?this.focus.split("-")[0]:"")+"]",this.domNode).addClass("selected")):-1!==window.location.pathname.toLowerCase().indexOf("group.html")?b.query(".domains a[filter\x3d'group']",
this.domNode).addClass("selected"):-1!==window.location.pathname.toLowerCase().indexOf("groups.html")?b.query(".domains a[filter\x3d'groups']",this.domNode).addClass("selected"):b.query(".domains a[filter\x3d'']",this.domNode).addClass("selected");b.forEach(a,function(a,d){b.hasClass(a,"selected")&&(this._firstLinkPos=d)},this);this._loadSearchBoxTip();b.connect(this.searchText,"onFocus",this,this._onSearchTextFocus);b.subscribe("onRestrictSearchChange",b.hitch(this,function(a){this.restrict=a.restrictSearch}));
this.showDomainsAnim=b.anim(this._domainsContainer,{opacity:1,beforeBegin:function(a){b.style(a,"display","")}},300);this.hidedomainsAnim=b.anim(this._domainsContainer,{opacity:0,onEnd:function(a){b.style(a,"display","none")}},300);this.hidedomainsAnim.play();b.query(".searchNode").removeClass("openSearch")},_loadSearchBoxTip:function(a){this.searchText.set("value",this._queryStringParams.q||"")},doSearch:function(a){if(-1<a.indexOf("*"))arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorLabel,
message:this.i18n.error.wildCardSearchError}),this.searchText.focus();else if(a===this._currentSearchBoxTip||""===a)this.searchText.focus();else{this.hidedomainsAnim.play();b.query(".searchNode").removeClass("openSearch");var c={};c.q=a;c.t="content";this.focus&&(c.focus=this.focus);esri.isDefined(this.restrict)&&(c.restrict=this.restrict);a=b.query(".domains a.selected")[0];void 0!=a&&b.hasAttr(a,"filter")&&(a=b.trim(b.attr(a,"filter")),"groups"==a?c.t="groups":"group"==a&&(c.t="group"));a=b.queryToObject(window.location.search.slice(1));
c.sortField=a.sortField||null;c.sortOrder=a.sortOrder||null;this.goToSearch(c,{useCurrentPageLocation:"group"===c.t,clearParams:"group"!==c.t})}},_onFilterClick:function(a){this.focus=b.attr(a.currentTarget,"filter");null!=this.focus&&(b.query(".domains a",this.domNode).removeClass("selected"),b.addClass(a.currentTarget,"selected"),this._onSearchClick(a))},_onSearchTextFocus:function(a){var c=b.connect(this.showDomainsAnim,"onEnd",b.hitch(this,function(){b.disconnect(c);this.searchText.focus()}));
b.query(".searchNode").addClass("openSearch");this.showDomainsAnim.play()},_onBlur:function(a){this.hidedomainsAnim.play();b.query(".searchNode").removeClass("openSearch")},_onSearchBoxFocus:function(a){},_onSearchBoxBlur:function(a){""==this.searchText.getValue()&&(this._queryStringParams.q=null,this._loadSearchBoxTip())},_onSearchClick:function(a){b.stopEvent(a);var c=this.searchText.getValue();null!=a&&a.prefentDefault&&a.preventDefault();0==b.trim(c).length?this.searchText.focus():this.doSearch(c)},
_onSearchKeyPress:function(a){if(a.keyCode==b.keys.ENTER)b.stopEvent(a),this._onSearchClick(a);else if(a.keyCode===b.keys.DOWN_ARROW){this._firstLinkPos++;var c=b.query(".domains a",this.domNode);b.forEach(c,function(a){b.removeClass(a,"selected")});0<c.length&&(this._firstLinkPos%=c.length,"none"===b.style(c[this._firstLinkPos],"display")&&(this._firstLinkPos++,this._firstLinkPos%=c.length),c[this._firstLinkPos].focus(),b.addClass(c[this._firstLinkPos],"selected"))}else a.keyCode===b.keys.UP_ARROW&&
(this._firstLinkPos--,c=b.query(".domains a",this.domNode),b.forEach(c,function(a){b.removeClass(a,"selected")}),0<c.length&&(this._firstLinkPos=(this._firstLinkPos+c.length)%c.length,"none"===b.style(c[this._firstLinkPos],"display")&&(this._firstLinkPos--,this._firstLinkPos=(this._firstLinkPos+c.length)%c.length),c[this._firstLinkPos].focus(),b.addClass(c[this._firstLinkPos],"selected")));this.onSearchFieldKeyPress(a)},onSearchFieldKeyPress:function(a){}})})},"dojo/rpc/RpcService":function(){define("../_base/array ../_base/declare ../_base/Deferred ../_base/kernel ../_base/lang ../_base/url ../_base/xhr".split(" "),
function(h,b,k,a,c,d,e){return b("dojo.rpc.RpcService",null,{constructor:function(b){if(b)if(c.isString(b)||b instanceof d){var g=e.get({url:b instanceof d?b+"":b,handleAs:"json-comment-optional",sync:!0});g.addCallback(this,"processSmd");g.addErrback(function(){throw Error("Unable to load SMD from "+b);})}else b.smdStr?this.processSmd(a.eval("("+b.smdStr+")")):(b.serviceUrl&&(this.serviceUrl=b.serviceUrl),this.timeout=b.timeout||0,"strictArgChecks"in b&&(this.strictArgChecks=b.strictArgChecks),this.processSmd(b))},
strictArgChecks:!0,serviceUrl:"",parseResults:function(a){return a},errorCallback:function(a){return function(b){a.errback(b.message)}},resultCallback:function(a){return c.hitch(this,function(b){if(null!=b.error){var c;"object"==typeof b.error?(c=Error(b.error.message),c.code=b.error.code,c.error=b.error.error):c=Error(b.error);c.id=b.id;c.errorObject=b;a.errback(c)}else a.callback(this.parseResults(b))})},generateMethod:function(a,b,d){return c.hitch(this,function(){var e=new k;if(this.strictArgChecks&&
null!=b&&arguments.length!=b.length)throw Error("Invalid number of parameters for remote method.");this.bind(a,c._toArray(arguments),e,d);return e})},processSmd:function(a){a.methods&&h.forEach(a.methods,function(a){if(a&&a.name&&(this[a.name]=this.generateMethod(a.name,a.parameters,a.url||a.serviceUrl||a.serviceURL),!c.isFunction(this[a.name])))throw Error("RpcService: Failed to create"+a.name+"()");},this);this.serviceUrl=a.serviceUrl||a.serviceURL;this.required=a.required;this.smd=a}})})},"dijit/_base/place":function(){define(["dojo/_base/array",
"dojo/_base/lang","dojo/window","../place","../main"],function(h,b,k,a,c){var d={getViewport:function(){return k.getBox()}};d.placeOnScreen=a.at;d.placeOnScreenAroundElement=function(c,d,g,h){var k;if(b.isArray(g))k=g;else{k=[];for(var n in g)k.push({aroundCorner:n,corner:g[n]})}return a.around(c,d,k,!0,h)};d.placeOnScreenAroundNode=d.placeOnScreenAroundElement;d.placeOnScreenAroundRectangle=d.placeOnScreenAroundElement;d.getPopupAroundAlignment=function(a,b){var c={};h.forEach(a,function(a){var d=
b;switch(a){case "after":c[b?"BR":"BL"]=b?"BL":"BR";break;case "before":c[b?"BL":"BR"]=b?"BR":"BL";break;case "below-alt":d=!d;case "below":c[d?"BL":"BR"]=d?"TL":"TR";c[d?"BR":"BL"]=d?"TR":"TL";break;case "above-alt":d=!d;default:c[d?"TL":"TR"]=d?"BL":"BR",c[d?"TR":"TL"]=d?"BR":"BL"}});return c};b.mixin(c,d);return c})},"dijit/MenuSeparator":function(){define("dojo/_base/declare dojo/dom ./_WidgetBase ./_TemplatedMixin ./_Contained dojo/text!./templates/MenuSeparator.html".split(" "),function(h,b,
k,a,c,d){return h("dijit.MenuSeparator",[k,a,c],{templateString:d,buildRendering:function(){this.inherited(arguments);b.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}})})},"dijit/form/_ComboBoxMenu":function(){define("dojo/_base/declare dojo/dom-class dojo/dom-style dojo/keys ../_WidgetBase ../_TemplatedMixin ./_ComboBoxMenuMixin ./_ListMouseMixin".split(" "),function(h,b,k,a,c,d,e,f){return h("dijit.form._ComboBoxMenu",[c,d,f,e],{templateString:"\x3cdiv class\x3d'dijitReset dijitMenu' data-dojo-attach-point\x3d'containerNode' style\x3d'overflow: auto; overflow-x: hidden;' role\x3d'listbox'\x3e\x3cdiv class\x3d'dijitMenuItem dijitMenuPreviousButton' data-dojo-attach-point\x3d'previousButton' role\x3d'option'\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitMenuItem dijitMenuNextButton' data-dojo-attach-point\x3d'nextButton' role\x3d'option'\x3e\x3c/div\x3e\x3c/div\x3e",
baseClass:"dijitComboBoxMenu",postCreate:function(){this.inherited(arguments);this.isLeftToRight()||(b.add(this.previousButton,"dijitMenuItemRtl"),b.add(this.nextButton,"dijitMenuItemRtl"));this.containerNode.setAttribute("role","listbox")},_createMenuItem:function(){var a=this.ownerDocument.createElement("div");a.className="dijitReset dijitMenuItem"+(this.isLeftToRight()?"":" dijitMenuItemRtl");a.setAttribute("role","option");return a},onHover:function(a){b.add(a,"dijitMenuItemHover")},onUnhover:function(a){b.remove(a,
"dijitMenuItemHover")},onSelect:function(a){b.add(a,"dijitMenuItemSelected")},onDeselect:function(a){b.remove(a,"dijitMenuItemSelected")},_page:function(a){var b=0,c=this.domNode.scrollTop,d=k.get(this.domNode,"height");for(this.getHighlightedOption()||this.selectNextNode();b<d;){var e=this.getHighlightedOption();if(a){if(!e.previousSibling||"none"==e.previousSibling.style.display)break;this.selectPreviousNode()}else{if(!e.nextSibling||"none"==e.nextSibling.style.display)break;this.selectNextNode()}e=
this.domNode.scrollTop;b+=(e-c)*(a?-1:1);c=e}},handleKey:function(b){switch(b.keyCode){case a.DOWN_ARROW:return this.selectNextNode(),!1;case a.PAGE_DOWN:return this._page(!1),!1;case a.UP_ARROW:return this.selectPreviousNode(),!1;case a.PAGE_UP:return this._page(!0),!1;default:return!0}}})})},"arcgisonline/sharing/dijit/ClassificationBanner":function(){define(["dijit","dojo","dojox","dojo/require!dijit/_Widget,dijit/_Templated"],function(h,b,k){b.provide("arcgisonline.sharing.dijit.ClassificationBanner");
b.require("dijit._Widget");b.require("dijit._Templated");b.declare("arcgisonline.sharing.dijit.ClassificationBanner",[h._Widget],{widgetsInTemplate:!1,postCreate:function(){if(esriGeowConfig.classificationBanner){var a=b.create("div",{id:this.id+"_0",style:"width:100%"});esriGeowConfig.classificationBanner.color&&b.style(a,"color",b.colorFromArray(esriGeowConfig.classificationBanner.color).toHex());esriGeowConfig.classificationBanner.font&&(esriGeowConfig.classificationBanner.font.decoration&&b.style(a,
"textDecoration",esriGeowConfig.classificationBanner.font.decoration),esriGeowConfig.classificationBanner.font.family&&b.style(a,"fontFamily",esriGeowConfig.classificationBanner.font.family),esriGeowConfig.classificationBanner.font.size&&b.style(a,"size",esriGeowConfig.classificationBanner.font.size+"px"),esriGeowConfig.classificationBanner.font.style&&b.style(a,"fontStyle",esriGeowConfig.classificationBanner.font.style),esriGeowConfig.classificationBanner.font.weight&&b.style(a,"fontWeight",esriGeowConfig.classificationBanner.font.weight));
if(esriGeowConfig.classificationBanner.height){var c=esriGeowConfig.classificationBanner.height;esriGeowConfig.classificationBanner.font.size&&(c=Math.max(esriGeowConfig.classificationBanner.height,esriGeowConfig.classificationBanner.font.size+2));b.style(a,"height",c+"px")}esriGeowConfig.classificationBanner.backgroundColor&&b.style(a,"background",b.colorFromArray(esriGeowConfig.classificationBanner.backgroundColor).toHex());b.create("span",{innerHTML:esriGeowConfig.classificationBanner.text},b.create("center",
{},a));b.place(a,this.domNode,"only")}else b.style(this.domNode,"height","0")}})})},"esri/OAuthCredential":function(){define(["./kernel","dojo/_base/declare","dojo/has","dojo/json"],function(h,b,k,a){b=b(null,{declaredClass:"esri.OAuthCredential",oAuthInfo:null,storage:null,expires:null,ssl:null,token:null,userId:null,constructor:function(a,b){this.oAuthInfo=a;this.storage=b;this._init()},isValid:function(){var a=!1;if(this.oAuthInfo&&this.token&&this.userId){var b=(new Date).getTime();this.expires>
b&&(this.expires-b)/1E3>60*this.oAuthInfo.minTimeUntilExpiration&&(a=!0)}return a},save:function(){if(this.storage){var b=this._load(),d=this.oAuthInfo;if(d&&d.authNamespace&&d.portalUrl){var e=b[d.authNamespace];e||(e=b[d.authNamespace]={});e[d.portalUrl]={expires:this.expires,ssl:this.ssl,token:this.token,userId:this.userId};try{this.storage.setItem("esriJSAPIOAuth",a.stringify(b))}catch(f){console.log(f)}}}},destroy:function(){var b=this._load(),d=this.oAuthInfo;if(d&&d.authNamespace&&d.portalUrl&&
this.storage){var e=b[d.authNamespace];if(e){delete e[d.portalUrl];try{this.storage.setItem("esriJSAPIOAuth",a.stringify(b))}catch(f){console.log(f)}}}d&&(this.oAuthInfo=d._oAuthCred=null)},_init:function(){var a=this._load(),b=this.oAuthInfo;if(b&&(b.authNamespace&&b.portalUrl)&&(a=a[b.authNamespace]))if(a=a[b.portalUrl])this.expires=a.expires,this.ssl=a.ssl,this.token=a.token,this.userId=a.userId},_load:function(){var b={};if(this.storage){var d=this.storage.getItem("esriJSAPIOAuth");if(d)try{b=
a.parse(d)}catch(e){console.log(e)}}return b}});k("extend-esri")&&(h.OAuthCredential=b);return b})},"esri/geometry/Point":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry".split(" "),function(h,b,k,a,c,d,e){function f(a,b){89.99999<b?b=89.99999:-89.99999>b&&(b=-89.99999);var c=b*q;return[a*q*l,l/2*Math.log((1+Math.sin(c))/(1-Math.sin(c)))]}function g(a,b,c){a=a/l*n;if(c)return b=m/2-2*Math.atan(Math.exp(-1*b/l)),[a,b*n];c=a-360*Math.floor((a+
180)/360);b=m/2-2*Math.atan(Math.exp(-1*b/l));return[c,b*n]}var l=6378137,m=3.141592653589793,n=57.29577951308232,q=0.017453292519943,p={type:"point",x:0,y:0};h=h(e,{declaredClass:"esri.geometry.Point",constructor:function(a,e,f){b.mixin(this,p);b.isArray(a)?(this.x=a[0],this.y=a[1],this.spatialReference=e):b.isObject(a)?(b.mixin(this,a),c.isDefined(this.latitude)&&(this.y=this.latitude),c.isDefined(this.longitude)&&(this.x=this.longitude),this.spatialReference&&(this.spatialReference=new d(this.spatialReference))):
(this.x=a,this.y=e,this.spatialReference=f);this.verifySR()},offset:function(a,b){return new this.constructor(this.x+a,this.y+b,this.spatialReference)},setX:function(a){this.x=a;this.clearCache();return this},setY:function(a){this.y=a;this.clearCache();return this},setLongitude:function(a){var b=this.spatialReference;b&&(b._isWebMercator()?this.setX(f(a,this.y)[0]):4326===b.wkid&&this.setX(a));return this},setLatitude:function(a){var b=this.spatialReference;b&&(b._isWebMercator()?this.setY(f(this.x,
a)[1]):4326===b.wkid&&this.setY(a));return this},getLongitude:function(){var a=this.spatialReference,b;a&&(a._isWebMercator()?b=g(this.x,this.y)[0]:4326===a.wkid&&(b=this.x));return b},getLatitude:function(){var a=this.spatialReference,b;a&&(a._isWebMercator()?b=g(this.x,this.y)[1]:4326===a.wkid&&(b=this.y));return b},update:function(a,b){this.x=a;this.y=b;this.clearCache();return this},normalize:function(){var a=this.x,b=this.spatialReference;if(b){var c=b._getInfo();if(c){var d=c.valid[0],e=c.valid[1],
c=2*e;a>e?(d=Math.ceil(Math.abs(a-e)/c),a-=d*c):a<d&&(d=Math.ceil(Math.abs(a-d)/c),a+=d*c)}}return new this.constructor(a,this.y,b)},toJson:function(){var a={x:this.x,y:this.y},b=this.spatialReference;b&&(a.spatialReference=b.toJson());return a}});h.lngLatToXY=f;h.xyToLngLat=g;h.defaultProps=p;k("extend-esri")&&(b.setObject("geometry.Point",h,a),a.geometry.defaultPoint=p);return h})},"dijit/Dialog":function(){define("require dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/fx dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/ready dojo/sniff dojo/window dojo/dnd/Moveable dojo/dnd/TimedMoveable ./focus ./_base/manager ./_Widget ./_TemplatedMixin ./_CssStateMixin ./form/_FormMixin ./_DialogMixin ./DialogUnderlay ./layout/ContentPane ./layout/utils dojo/text!./templates/Dialog.html ./a11yclick dojo/i18n!./nls/common".split(" "),
function(h,b,k,a,c,d,e,f,g,l,m,n,q,p,s,t,u,x,w,v,y,A,z,G,F,B,E,K,O,P){var Q=new c;Q.resolve(!0);y=a("dijit._DialogBase"+(t("dojo-bidi")?"_NoBidi":""),[z,F,B,G],{templateString:P,baseClass:"dijitDialog",cssStateNodes:{closeButtonNode:"dijitDialogCloseIcon"},_setTitleAttr:{node:"titleNode",type:"innerHTML"},open:!1,duration:y.defaultDuration,refocus:!0,autofocus:!0,_firstFocusItem:null,_lastFocusItem:null,draggable:!0,_setDraggableAttr:function(a){this._set("draggable",a)},maxRatio:0.9,closable:!0,
_setClosableAttr:function(a){this.closeButtonNode.style.display=a?"":"none";this._set("closable",a)},postMixInProperties:function(){var a=m.getLocalization("dijit","common");q.mixin(this,a);this.inherited(arguments)},postCreate:function(){g.set(this.domNode,{display:"none",position:"absolute"});this.ownerDocumentBody.appendChild(this.domNode);this.inherited(arguments);k.after(this,"onExecute",q.hitch(this,"hide"),!0);k.after(this,"onCancel",q.hitch(this,"hide"),!0);this._modalconnects=[]},onLoad:function(){this.resize();
this._position();this.autofocus&&H.isTop(this)&&(this._getFocusItems(),v.focus(this._firstFocusItem));this.inherited(arguments)},focus:function(){this._getFocusItems();v.focus(this._firstFocusItem)},_endDrag:function(){var a=f.position(this.domNode),b=u.getBox(this.ownerDocument);a.y=Math.min(Math.max(a.y,0),b.h-a.h);a.x=Math.min(Math.max(a.x,0),b.w-a.w);this._relativePosition=a;this._position()},_setup:function(){var a=this.domNode;this.titleBar&&this.draggable?(this._moveable=new (6==t("ie")?w:
x)(a,{handle:this.titleBar}),k.after(this._moveable,"onMoveStop",q.hitch(this,"_endDrag"),!0)):e.add(a,"dijitDialogFixed");this.underlayAttrs={dialogId:this.id,"class":b.map(this["class"].split(/\s/),function(a){return a+"_underlay"}).join(" "),_onKeyDown:q.hitch(this,"_onKey"),ownerDocument:this.ownerDocument}},_size:function(){this.resize()},_position:function(){if(!e.contains(this.ownerDocumentBody,"dojoMove")){var a=this.domNode,b=u.getBox(this.ownerDocument),c=this._relativePosition,d=c?null:
f.position(a);g.set(a,{left:Math.floor(b.l+(c?c.x:(b.w-d.w)/2))+"px",top:Math.floor(b.t+(c?c.y:(b.h-d.h)/2))+"px"})}},_onKey:function(a){if(a.keyCode==n.TAB){this._getFocusItems();var b=a.target;this._firstFocusItem==this._lastFocusItem?(a.stopPropagation(),a.preventDefault()):b==this._firstFocusItem&&a.shiftKey?(v.focus(this._lastFocusItem),a.stopPropagation(),a.preventDefault()):b==this._lastFocusItem&&!a.shiftKey&&(v.focus(this._firstFocusItem),a.stopPropagation(),a.preventDefault())}else this.closable&&
a.keyCode==n.ESCAPE&&(this.onCancel(),a.stopPropagation(),a.preventDefault())},show:function(){if(this.open)return Q.promise;this._started||this.startup();this._alreadyInitialized||(this._setup(),this._alreadyInitialized=!0);this._fadeOutDeferred&&(this._fadeOutDeferred.cancel(),H.hide(this));var a=u.get(this.ownerDocument);this._modalconnects.push(p(a,"scroll",q.hitch(this,"resize",null)));this._modalconnects.push(p(this.domNode,"keydown",q.hitch(this,"_onKey")));g.set(this.domNode,{opacity:0,display:""});
this._set("open",!0);this._onShow();this.resize();this._position();var b;this._fadeInDeferred=new c(q.hitch(this,function(){b.stop();delete this._fadeInDeferred}));a=this._fadeInDeferred.promise;b=l.fadeIn({node:this.domNode,duration:this.duration,beforeBegin:q.hitch(this,function(){H.show(this,this.underlayAttrs)}),onEnd:q.hitch(this,function(){this.autofocus&&H.isTop(this)&&(this._getFocusItems(),v.focus(this._firstFocusItem));this._fadeInDeferred.resolve(!0);delete this._fadeInDeferred})}).play();
return a},hide:function(){if(!this._alreadyInitialized||!this.open)return Q.promise;this._fadeInDeferred&&this._fadeInDeferred.cancel();var a;this._fadeOutDeferred=new c(q.hitch(this,function(){a.stop();delete this._fadeOutDeferred}));this._fadeOutDeferred.then(q.hitch(this,"onHide"));var b=this._fadeOutDeferred.promise;a=l.fadeOut({node:this.domNode,duration:this.duration,onEnd:q.hitch(this,function(){this.domNode.style.display="none";H.hide(this);this._fadeOutDeferred.resolve(!0);delete this._fadeOutDeferred})}).play();
this._scrollConnected&&(this._scrollConnected=!1);for(var d;d=this._modalconnects.pop();)d.remove();this._relativePosition&&delete this._relativePosition;this._set("open",!1);return b},resize:function(a){if("none"!=this.domNode.style.display){this._checkIfSingleChild();if(!a){this._shrunk&&(this._singleChild&&"undefined"!=typeof this._singleChildOriginalStyle&&(this._singleChild.domNode.style.cssText=this._singleChildOriginalStyle,delete this._singleChildOriginalStyle),b.forEach([this.domNode,this.containerNode,
this.titleBar,this.actionBarNode],function(a){a&&g.set(a,{position:"static",width:"auto",height:"auto"})}),this.domNode.style.position="absolute");var c=u.getBox(this.ownerDocument);c.w*=this.maxRatio;c.h*=this.maxRatio;var d=f.position(this.domNode);d.w>=c.w||d.h>=c.h?(a={w:Math.min(d.w,c.w),h:Math.min(d.h,c.h)},this._shrunk=!0):this._shrunk=!1}if(a){f.setMarginBox(this.domNode,a);c=[];this.titleBar&&c.push({domNode:this.titleBar,region:"top"});this.actionBarNode&&c.push({domNode:this.actionBarNode,
region:"bottom"});d={domNode:this.containerNode,region:"center"};c.push(d);var e=O.marginBox2contentBox(this.domNode,a);O.layoutChildren(this.domNode,e,c);this._singleChild?(c=O.marginBox2contentBox(this.containerNode,d),this._singleChild.resize({w:c.w,h:c.h})):(this.containerNode.style.overflow="auto",this._layoutChildren())}else this._layoutChildren();!t("touch")&&!a&&this._position()}},_layoutChildren:function(){b.forEach(this.getChildren(),function(a){a.resize&&a.resize()})},destroy:function(){this._fadeInDeferred&&
this._fadeInDeferred.cancel();this._fadeOutDeferred&&this._fadeOutDeferred.cancel();this._moveable&&this._moveable.destroy();for(var a;a=this._modalconnects.pop();)a.remove();H.hide(this);this.inherited(arguments)}});t("dojo-bidi")&&(y=a("dijit._DialogBase",y,{_setTitleAttr:function(a){this._set("title",a);this.titleNode.innerHTML=a;this.applyTextDir(this.titleNode)},_setTextDirAttr:function(a){this._created&&this.textDir!=a&&(this._set("textDir",a),this.set("title",this.title))}}));var S=a("dijit.Dialog",
[K,y],{});S._DialogBase=y;var H=S._DialogLevelManager={_beginZIndex:950,show:function(a,b){D[D.length-1].focus=v.curNode;var c=D[D.length-1].dialog?D[D.length-1].zIndex+2:S._DialogLevelManager._beginZIndex;g.set(a.domNode,"zIndex",c);E.show(b,c-1);D.push({dialog:a,underlayAttrs:b,zIndex:c})},hide:function(a){if(D[D.length-1].dialog==a){D.pop();var c=D[D.length-1];1==D.length?E.hide():E.show(c.underlayAttrs,c.zIndex-1);if(a.refocus){a=c.focus;if(c.dialog&&(!a||!d.isDescendant(a,c.dialog.domNode)))c.dialog._getFocusItems(),
a=c.dialog._firstFocusItem;if(a)try{a.focus()}catch(e){}}}else c=b.indexOf(b.map(D,function(a){return a.dialog}),a),-1!=c&&D.splice(c,1)},isTop:function(a){return D[D.length-1].dialog==a}},D=S._dialogStack=[{dialog:null,focus:null,underlayAttrs:null}];v.watch("curNode",function(a,b,c){a=D[D.length-1].dialog;if(c&&a&&!a._fadeOutDeferred&&c.ownerDocument==a.ownerDocument){do if(c==a.domNode||e.contains(c,"dijitPopup"))return;while(c=c.parentNode);a.focus()}});t("dijit-legacy-requires")&&s(0,function(){h(["dijit/TooltipDialog"])});
return S})},"dijit/_base/focus":function(){define("dojo/_base/array dojo/dom dojo/_base/lang dojo/topic dojo/_base/window ../focus ../selection ../main".split(" "),function(h,b,k,a,c,d,e,f){d.focus=function(a){if(a){var b="node"in a?a.node:a,e=a.bookmark;a=a.openedForWindow;var h=e?e.isCollapsed:!1;if(b){var k="iframe"==b.tagName.toLowerCase()?b.contentWindow:b;if(k&&k.focus)try{k.focus()}catch(p){}d._onFocusNode(b)}if(e&&c.withGlobal(a||c.global,f.isCollapsed)&&!h){a&&a.focus();try{c.withGlobal(a||
c.global,f.moveToBookmark,null,[e])}catch(s){}}}};d.watch("curNode",function(b,c,d){f._curFocus=d;f._prevFocus=c;d&&a.publish("focusNode",d)});d.watch("activeStack",function(a,b,c){f._activeStack=c});d.on("widget-blur",function(b,c){a.publish("widgetBlur",b,c)});d.on("widget-focus",function(b,c){a.publish("widgetFocus",b,c)});k.mixin(f,{_curFocus:null,_prevFocus:null,isCollapsed:function(){return f.getBookmark().isCollapsed},getBookmark:function(){return(c.global==window?e:new e.SelectionManager(c.global)).getBookmark()},
moveToBookmark:function(a){return(c.global==window?e:new e.SelectionManager(c.global)).moveToBookmark(a)},getFocus:function(a,e){var h=!d.curNode||a&&b.isDescendant(d.curNode,a.domNode)?f._prevFocus:d.curNode;return{node:h,bookmark:h&&h==d.curNode&&c.withGlobal(e||c.global,f.getBookmark),openedForWindow:e}},_activeStack:[],registerIframe:function(a){return d.registerIframe(a)},unregisterIframe:function(a){a&&a.remove()},registerWin:function(a,b){return d.registerWin(a,b)},unregisterWin:function(a){a&&
a.remove()}});return f})},"dijit/a11y":function(){define("dojo/_base/array dojo/dom dojo/dom-attr dojo/dom-style dojo/_base/lang dojo/sniff ./main".split(" "),function(h,b,k,a,c,d,e){var f={_isElementShown:function(b){var c=a.get(b);return"hidden"!=c.visibility&&"collapsed"!=c.visibility&&"none"!=c.display&&"hidden"!=k.get(b,"type")},hasDefaultTabStop:function(a){switch(a.nodeName.toLowerCase()){case "a":return k.has(a,"href");case "area":case "button":case "input":case "object":case "select":case "textarea":return!0;
case "iframe":var b;try{var c=a.contentDocument;if("designMode"in c&&"on"==c.designMode)return!0;b=c.body}catch(d){try{b=a.contentWindow.document.body}catch(e){return!1}}return b&&("true"==b.contentEditable||b.firstChild&&"true"==b.firstChild.contentEditable);default:return"true"==a.contentEditable}},effectiveTabIndex:function(a){return k.get(a,"disabled")?void 0:k.has(a,"tabIndex")?+k.get(a,"tabIndex"):f.hasDefaultTabStop(a)?0:void 0},isTabNavigable:function(a){return 0<=f.effectiveTabIndex(a)},
isFocusable:function(a){return-1<=f.effectiveTabIndex(a)},_getTabNavigable:function(a){function b(a){return a&&"input"==a.tagName.toLowerCase()&&a.type&&"radio"==a.type.toLowerCase()&&a.name&&a.name.toLowerCase()}var c,e,h,p,s,t,u={},x=f._isElementShown,w=f.effectiveTabIndex,v=function(a){for(a=a.firstChild;a;a=a.nextSibling)if(!(1!=a.nodeType||9>=d("ie")&&"HTML"!==a.scopeName||!x(a))){var f=w(a);if(0<=f){if(0==f)c||(c=a),e=a;else if(0<f){if(!h||f<p)p=f,h=a;if(!s||f>=t)t=f,s=a}f=b(a);k.get(a,"checked")&&
f&&(u[f]=a)}"SELECT"!=a.nodeName.toUpperCase()&&v(a)}};x(a)&&v(a);return{first:u[b(c)]||c,last:u[b(e)]||e,lowest:u[b(h)]||h,highest:u[b(s)]||s}},getFirstInTabbingOrder:function(a,c){var d=f._getTabNavigable(b.byId(a,c));return d.lowest?d.lowest:d.first},getLastInTabbingOrder:function(a,c){var d=f._getTabNavigable(b.byId(a,c));return d.last?d.last:d.highest}};c.mixin(e,f);return f})},"dijit/form/_ToggleButtonMixin":function(){define(["dojo/_base/declare","dojo/dom-attr"],function(h,b){return h("dijit.form._ToggleButtonMixin",
null,{checked:!1,_aria_attr:"aria-pressed",_onClick:function(b){var a=this.checked;this._set("checked",!a);var c=this.inherited(arguments);this.set("checked",c?this.checked:a);return c},_setCheckedAttr:function(h,a){this._set("checked",h);var c=this.focusNode||this.domNode;this._created&&b.get(c,"checked")!=!!h&&b.set(c,"checked",!!h);c.setAttribute(this._aria_attr,String(h));this._handleOnChange(h,a)},postCreate:function(){this.inherited(arguments);var b=this.focusNode||this.domNode;this.checked&&
b.setAttribute("checked","checked");void 0===this._resetValue&&(this._lastValueReported=this._resetValue=this.checked)},reset:function(){this._hasBeenBlurred=!1;this.set("checked",this.params.checked||!1)}})})},"dojo/dnd/Container":function(){define("../_base/array ../_base/declare ../_base/kernel ../_base/lang ../_base/window ../dom ../dom-class ../dom-construct ../Evented ../has ../on ../query ../touch ./common".split(" "),function(h,b,k,a,c,d,e,f,g,l,m,n,q,p){b=b("dojo.dnd.Container",g,{skipForm:!1,
allowNested:!1,constructor:function(b,c){this.node=d.byId(b);c||(c={});this.creator=c.creator||null;this.skipForm=c.skipForm;this.parent=c.dropParent&&d.byId(c.dropParent);this.map={};this.current=null;this.containerState="";e.add(this.node,"dojoDndContainer");(!c||!c._skipStartup)&&this.startup();this.events=[m(this.node,q.over,a.hitch(this,"onMouseOver")),m(this.node,q.out,a.hitch(this,"onMouseOut")),m(this.node,"dragstart",a.hitch(this,"onSelectStart")),m(this.node,"selectstart",a.hitch(this,"onSelectStart"))]},
creator:function(){},getItem:function(a){return this.map[a]},setItem:function(a,b){this.map[a]=b},delItem:function(a){delete this.map[a]},forInItems:function(a,b){b=b||k.global;var c=this.map,d=p._empty,e;for(e in c)e in d||a.call(b,c[e],e,this);return b},clearItems:function(){this.map={}},getAllNodes:function(){return n((this.allowNested?"":"\x3e ")+".dojoDndItem",this.parent)},sync:function(){var a={};this.getAllNodes().forEach(function(b){if(b.id){var c=this.getItem(b.id);if(c){a[b.id]=c;return}}else b.id=
p.getUniqueId();var c=b.getAttribute("dndType"),d=b.getAttribute("dndData");a[b.id]={data:d||b.innerHTML,type:c?c.split(/\s*,\s*/):["text"]}},this);this.map=a;return this},insertNodes:function(a,b,c){this.parent.firstChild?b?c||(c=this.parent.firstChild):c&&(c=c.nextSibling):c=null;var d;if(c)for(b=0;b<a.length;++b)d=this._normalizedCreator(a[b]),this.setItem(d.node.id,{data:d.data,type:d.type}),c.parentNode.insertBefore(d.node,c);else for(b=0;b<a.length;++b)d=this._normalizedCreator(a[b]),this.setItem(d.node.id,
{data:d.data,type:d.type}),this.parent.appendChild(d.node);return this},destroy:function(){h.forEach(this.events,function(a){a.remove()});this.clearItems();this.node=this.parent=this.current=null},markupFactory:function(a,b,c){a._skipStartup=!0;return new c(b,a)},startup:function(){if(!this.parent&&(this.parent=this.node,"table"==this.parent.tagName.toLowerCase())){var a=this.parent.getElementsByTagName("tbody");a&&a.length&&(this.parent=a[0])}this.defaultCreator=p._defaultCreator(this.parent);this.sync()},
onMouseOver:function(a){for(var b=a.relatedTarget;b&&b!=this.node;)try{b=b.parentNode}catch(c){b=null}b||(this._changeState("Container","Over"),this.onOverEvent());b=this._getChildByEvent(a);this.current!=b&&(this.current&&this._removeItemClass(this.current,"Over"),b&&this._addItemClass(b,"Over"),this.current=b)},onMouseOut:function(a){for(a=a.relatedTarget;a;){if(a==this.node)return;try{a=a.parentNode}catch(b){a=null}}this.current&&(this._removeItemClass(this.current,"Over"),this.current=null);this._changeState("Container",
"");this.onOutEvent()},onSelectStart:function(a){if(!this.skipForm||!p.isFormElement(a))a.stopPropagation(),a.preventDefault()},onOverEvent:function(){},onOutEvent:function(){},_changeState:function(a,b){var c="dojoDnd"+a,d=a.toLowerCase()+"State";e.replace(this.node,c+b,c+this[d]);this[d]=b},_addItemClass:function(a,b){e.add(a,"dojoDndItem"+b)},_removeItemClass:function(a,b){e.remove(a,"dojoDndItem"+b)},_getChildByEvent:function(a){if(a=a.target)for(var b=a.parentNode;b;a=b,b=a.parentNode)if((b==
this.parent||this.allowNested)&&e.contains(a,"dojoDndItem"))return a;return null},_normalizedCreator:function(b,c){var d=(this.creator||this.defaultCreator).call(this,b,c);a.isArray(d.type)||(d.type=["text"]);d.node.id||(d.node.id=p.getUniqueId());e.add(d.node,"dojoDndItem");return d}});p._createNode=function(a){return!a?p._createSpan:function(b){return f.create(a,{innerHTML:b})}};p._createTrTd=function(a){var b=f.create("tr");f.create("td",{innerHTML:a},b);return b};p._createSpan=function(a){return f.create("span",
{innerHTML:a})};p._defaultCreatorNodes={ul:"li",ol:"li",div:"div",p:"div"};p._defaultCreator=function(b){b=b.tagName.toLowerCase();var c="tbody"==b||"thead"==b?p._createTrTd:p._createNode(p._defaultCreatorNodes[b]);return function(b,d){var e=b&&a.isObject(b),f,g;e&&b.tagName&&b.nodeType&&b.getAttribute?(f=b.getAttribute("dndData")||b.innerHTML,e=(e=b.getAttribute("dndType"))?e.split(/\s*,\s*/):["text"],g=b):(f=e&&b.data?b.data:b,e=e&&b.type?b.type:["text"],g=("avatar"==d?p._createSpan:c)(String(f)));
g.id||(g.id=p.getUniqueId());return{node:g,data:f,type:e}}};return b})},"dijit/_Widget":function(){define("dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/has dojo/_base/kernel dojo/_base/lang dojo/query dojo/ready ./registry ./_WidgetBase ./_OnDijitClickMixin ./_FocusMixin dojo/uacss ./hccss".split(" "),function(h,b,k,a,c,d,e,f,g,l,m,n,q){function p(){}function s(a){return function(b,c,d,f){return b&&"string"==typeof c&&b[c]==p?b.on(c.substring(2).toLowerCase(),e.hitch(d,
f)):a.apply(k,arguments)}}h.around(k,"connect",s);d.connect&&h.around(d,"connect",s);h=a("dijit._Widget",[m,n,q],{onClick:p,onDblClick:p,onKeyDown:p,onKeyPress:p,onKeyUp:p,onMouseDown:p,onMouseMove:p,onMouseOut:p,onMouseOver:p,onMouseLeave:p,onMouseEnter:p,onMouseUp:p,constructor:function(a){this._toConnect={};for(var b in a)this[b]===p&&(this._toConnect[b.replace(/^on/,"").toLowerCase()]=a[b],delete a[b])},postCreate:function(){this.inherited(arguments);for(var a in this._toConnect)this.on(a,this._toConnect[a]);
delete this._toConnect},on:function(a,b){return this[this._onMap(a)]===p?k.connect(this.domNode,a.toLowerCase(),this,b):this.inherited(arguments)},_setFocusedAttr:function(a){this._focused=a;this._set("focused",a)},setAttribute:function(a,b){d.deprecated(this.declaredClass+"::setAttribute(attr, value) is deprecated. Use set() instead.","","2.0");this.set(a,b)},attr:function(a,b){return 2<=arguments.length||"object"===typeof a?this.set.apply(this,arguments):this.get(a)},getDescendants:function(){d.deprecated(this.declaredClass+
"::getDescendants() is deprecated. Use getChildren() instead.","","2.0");return this.containerNode?f("[widgetId]",this.containerNode).map(l.byNode):[]},_onShow:function(){this.onShow()},onShow:function(){},onHide:function(){},onClose:function(){return!0}});c("dijit-legacy-requires")&&g(0,function(){require(["dijit/_base"])});return h})},"dojo/touch":function(){define("./_base/kernel ./aspect ./dom ./dom-class ./_base/lang ./on ./has ./mouse ./domReady ./_base/window".split(" "),function(h,b,k,a,c,
d,e,f,g,l){function m(a,b,c){return s&&c?function(a,b){return d(a,c,b)}:u?function(c,e){var f=d(c,b,function(a){e.call(this,a);E=(new Date).getTime()}),g=d(c,a,function(a){(!E||(new Date).getTime()>E+1E3)&&e.call(this,a)});return{remove:function(){f.remove();g.remove()}}}:function(b,c){return d(b,a,c)}}function n(a){do if(void 0!==a.dojoClick)return a;while(a=a.parentNode)}function q(b,c,e){var f=n(b.target);if(w=!b.target.disabled&&f&&f.dojoClick)if(y=(v="useTarget"==w)?f:b.target,v&&b.preventDefault(),
A=b.changedTouches?b.changedTouches[0].pageX-l.global.pageXOffset:b.clientX,z=b.changedTouches?b.changedTouches[0].pageY-l.global.pageYOffset:b.clientY,G=("object"==typeof w?w.x:"number"==typeof w?w:0)||4,F=("object"==typeof w?w.y:"number"==typeof w?w:0)||4,!x){x=!0;var g=function(a){w=v?k.isDescendant(l.doc.elementFromPoint(a.changedTouches?a.changedTouches[0].pageX-l.global.pageXOffset:a.clientX,a.changedTouches?a.changedTouches[0].pageY-l.global.pageYOffset:a.clientY),y):w&&(a.changedTouches?a.changedTouches[0].target:
a.target)==y&&Math.abs((a.changedTouches?a.changedTouches[0].pageX-l.global.pageXOffset:a.clientX)-A)<=G&&Math.abs((a.changedTouches?a.changedTouches[0].pageY-l.global.pageYOffset:a.clientY)-z)<=F};l.doc.addEventListener(c,function(a){g(a);v&&a.preventDefault()},!0);l.doc.addEventListener(e,function(a){g(a);if(w){B=(new Date).getTime();var b=v?y:a.target;"LABEL"===b.tagName&&(b=k.byId(b.getAttribute("for"))||b);var c=a.changedTouches?a.changedTouches[0]:a,e=document.createEvent("MouseEvents");e._dojo_click=
!0;e.initMouseEvent("click",!0,!0,a.view,a.detail,c.screenX,c.screenY,c.clientX,c.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,0,null);setTimeout(function(){d.emit(b,"click",e);B=(new Date).getTime()},0)}},!0);b=function(b){l.doc.addEventListener(b,function(c){!c._dojo_click&&((new Date).getTime()<=B+1E3&&!("INPUT"==c.target.tagName&&a.contains(c.target,"dijitOffScreen")))&&(c.stopPropagation(),c.stopImmediatePropagation&&c.stopImmediatePropagation(),"click"==b&&(("INPUT"!=c.target.tagName||"radio"==
c.target.type||"checkbox"==c.target.type)&&"TEXTAREA"!=c.target.tagName&&"AUDIO"!=c.target.tagName&&"VIDEO"!=c.target.tagName)&&c.preventDefault())},!0)};b("click");b("mousedown");b("mouseup")}}var p=5>e("ios"),s=e("pointer-events")||e("MSPointer"),t=function(){var a={},b;for(b in{down:1,move:1,up:1,cancel:1,over:1,out:1})a[b]=e("MSPointer")?"MSPointer"+b.charAt(0).toUpperCase()+b.slice(1):"pointer"+b;return a}(),u=e("touch-events"),x,w,v=!1,y,A,z,G,F,B,E,K;s?g(function(){l.doc.addEventListener(t.down,
function(a){q(a,t.move,t.up)},!0)}):u&&g(function(){function a(b){var d=c.delegate(b,{bubbles:!0});6<=e("ios")&&(d.touches=b.touches,d.altKey=b.altKey,d.changedTouches=b.changedTouches,d.ctrlKey=b.ctrlKey,d.metaKey=b.metaKey,d.shiftKey=b.shiftKey,d.targetTouches=b.targetTouches);return d}K=l.body();l.doc.addEventListener("touchstart",function(a){E=(new Date).getTime();var b=K;K=a.target;d.emit(b,"dojotouchout",{relatedTarget:K,bubbles:!0});d.emit(K,"dojotouchover",{relatedTarget:b,bubbles:!0});q(a,
"touchmove","touchend")},!0);d(l.doc,"touchmove",function(b){E=(new Date).getTime();var c=l.doc.elementFromPoint(b.pageX-(p?0:l.global.pageXOffset),b.pageY-(p?0:l.global.pageYOffset));c&&(K!==c&&(d.emit(K,"dojotouchout",{relatedTarget:c,bubbles:!0}),d.emit(c,"dojotouchover",{relatedTarget:K,bubbles:!0}),K=c),d.emit(c,"dojotouchmove",a(b))||b.preventDefault())});d(l.doc,"touchend",function(b){E=(new Date).getTime();var c=l.doc.elementFromPoint(b.pageX-(p?0:l.global.pageXOffset),b.pageY-(p?0:l.global.pageYOffset))||
l.body();d.emit(c,"dojotouchend",a(b))})});b={press:m("mousedown","touchstart",t.down),move:m("mousemove","dojotouchmove",t.move),release:m("mouseup","dojotouchend",t.up),cancel:m(f.leave,"touchcancel",s?t.cancel:null),over:m("mouseover","dojotouchover",t.over),out:m("mouseout","dojotouchout",t.out),enter:f._eventHandler(m("mouseover","dojotouchover",t.over)),leave:f._eventHandler(m("mouseout","dojotouchout",t.out))};return h.touch=b})},"dojo/fx":function(){define("./_base/lang ./Evented ./_base/kernel ./_base/array ./aspect ./_base/fx ./dom ./dom-style ./dom-geometry ./ready require".split(" "),
function(h,b,k,a,c,d,e,f,g,l,m){k.isAsync||l(0,function(){m(["./fx/Toggler"])});k=k.fx={};l={_fire:function(a,b){this[a]&&this[a].apply(this,b||[]);return this}};var n=function(b){this._index=-1;this._animations=b||[];this._current=this._onAnimateCtx=this._onEndCtx=null;this.duration=0;a.forEach(this._animations,function(a){this.duration+=a.duration;a.delay&&(this.duration+=a.delay)},this)};n.prototype=new b;h.extend(n,{_onAnimate:function(){this._fire("onAnimate",arguments)},_onEnd:function(){this._onAnimateCtx.remove();
this._onEndCtx.remove();this._onAnimateCtx=this._onEndCtx=null;this._index+1==this._animations.length?this._fire("onEnd"):(this._current=this._animations[++this._index],this._onAnimateCtx=c.after(this._current,"onAnimate",h.hitch(this,"_onAnimate"),!0),this._onEndCtx=c.after(this._current,"onEnd",h.hitch(this,"_onEnd"),!0),this._current.play(0,!0))},play:function(a,b){this._current||(this._current=this._animations[this._index=0]);if(!b&&"playing"==this._current.status())return this;var d=c.after(this._current,
"beforeBegin",h.hitch(this,function(){this._fire("beforeBegin")}),!0),e=c.after(this._current,"onBegin",h.hitch(this,function(a){this._fire("onBegin",arguments)}),!0),f=c.after(this._current,"onPlay",h.hitch(this,function(a){this._fire("onPlay",arguments);d.remove();e.remove();f.remove()}));this._onAnimateCtx&&this._onAnimateCtx.remove();this._onAnimateCtx=c.after(this._current,"onAnimate",h.hitch(this,"_onAnimate"),!0);this._onEndCtx&&this._onEndCtx.remove();this._onEndCtx=c.after(this._current,
"onEnd",h.hitch(this,"_onEnd"),!0);this._current.play.apply(this._current,arguments);return this},pause:function(){if(this._current){var a=c.after(this._current,"onPause",h.hitch(this,function(b){this._fire("onPause",arguments);a.remove()}),!0);this._current.pause()}return this},gotoPercent:function(b,c){this.pause();var d=this.duration*b;this._current=null;a.some(this._animations,function(a,b){if(d<=a.duration)return this._current=a,this._index=b,!0;d-=a.duration;return!1},this);this._current&&this._current.gotoPercent(d/
this._current.duration);c&&this.play();return this},stop:function(a){if(this._current){if(a){for(;this._index+1<this._animations.length;++this._index)this._animations[this._index].stop(!0);this._current=this._animations[this._index]}var b=c.after(this._current,"onStop",h.hitch(this,function(a){this._fire("onStop",arguments);b.remove()}),!0);this._current.stop()}return this},status:function(){return this._current?this._current.status():"stopped"},destroy:function(){this.stop();this._onAnimateCtx&&
this._onAnimateCtx.remove();this._onEndCtx&&this._onEndCtx.remove()}});h.extend(n,l);k.chain=function(a){return new n(a)};var q=function(b){this._animations=b||[];this._connects=[];this.duration=this._finished=0;a.forEach(b,function(a){var b=a.duration;a.delay&&(b+=a.delay);this.duration<b&&(this.duration=b);this._connects.push(c.after(a,"onEnd",h.hitch(this,"_onEnd"),!0))},this);this._pseudoAnimation=new d.Animation({curve:[0,1],duration:this.duration});var e=this;a.forEach("beforeBegin onBegin onPlay onAnimate onPause onStop onEnd".split(" "),
function(a){e._connects.push(c.after(e._pseudoAnimation,a,function(){e._fire(a,arguments)},!0))})};h.extend(q,{_doAction:function(b,c){a.forEach(this._animations,function(a){a[b].apply(a,c)});return this},_onEnd:function(){++this._finished>this._animations.length&&this._fire("onEnd")},_call:function(a,b){var c=this._pseudoAnimation;c[a].apply(c,b)},play:function(a,b){this._finished=0;this._doAction("play",arguments);this._call("play",arguments);return this},pause:function(){this._doAction("pause",
arguments);this._call("pause",arguments);return this},gotoPercent:function(b,c){var d=this.duration*b;a.forEach(this._animations,function(a){a.gotoPercent(a.duration<d?1:d/a.duration,c)});this._call("gotoPercent",arguments);return this},stop:function(a){this._doAction("stop",arguments);this._call("stop",arguments);return this},status:function(){return this._pseudoAnimation.status()},destroy:function(){this.stop();a.forEach(this._connects,function(a){a.remove()})}});h.extend(q,l);k.combine=function(a){return new q(a)};
k.wipeIn=function(a){var b=a.node=e.byId(a.node),g=b.style,k;a=d.animateProperty(h.mixin({properties:{height:{start:function(){k=g.overflow;g.overflow="hidden";if("hidden"==g.visibility||"none"==g.display)return g.height="1px",g.display="",g.visibility="",1;var a=f.get(b,"height");return Math.max(a,1)},end:function(){return b.scrollHeight}}}},a));var l=function(){g.height="auto";g.overflow=k};c.after(a,"onStop",l,!0);c.after(a,"onEnd",l,!0);return a};k.wipeOut=function(a){var b=(a.node=e.byId(a.node)).style,
f;a=d.animateProperty(h.mixin({properties:{height:{end:1}}},a));c.after(a,"beforeBegin",function(){f=b.overflow;b.overflow="hidden";b.display=""},!0);var g=function(){b.overflow=f;b.height="auto";b.display="none"};c.after(a,"onStop",g,!0);c.after(a,"onEnd",g,!0);return a};k.slideTo=function(a){var b=null,k=null,l=function(a){return function(){var c=f.getComputedStyle(a),d=c.position;b="absolute"==d?a.offsetTop:parseInt(c.top)||0;k="absolute"==d?a.offsetLeft:parseInt(c.left)||0;"absolute"!=d&&"relative"!=
d&&(c=g.position(a,!0),b=c.y,k=c.x,a.style.position="absolute",a.style.top=b+"px",a.style.left=k+"px")}}(a.node=e.byId(a.node));l();a=d.animateProperty(h.mixin({properties:{top:a.top||0,left:a.left||0}},a));c.after(a,"beforeBegin",l,!0);return a};return k})},"arcgisonline/sharing/dijit/CreateAccount":function(){define(["dijit","dojo","dojox","dojo/i18n!arcgisonline/nls/arcgisonline","dojo/require!dijit/_Widget,dijit/_Templated,dijit/form/Button,dijit/form/Form,dijit/form/TextBox,dojo/io/iframe,dojo/store/Memory,arcgisonline/sharing/util,arcgisonline/sharing/geow/Account,arcgisonline/sharing/geow/Geow,arcgisonline/sharing/dijit/ComboBox,arcgisonline/sharing/dijit/dialog/ChoiceDlg,arcgisonline/sharing/dijit/dialog/GeneralDlg,arcgisonline/sharing/dijit/dialog/TermsOfUseDlg"],
function(h,b,k){b.provide("arcgisonline.sharing.dijit.CreateAccount");b.require("dijit._Widget");b.require("dijit._Templated");b.require("dijit.form.Button");b.require("dijit.form.Form");b.require("dijit.form.TextBox");b.require("dojo.io.iframe");b.require("dojo.store.Memory");b.require("arcgisonline.sharing.util");b.require("arcgisonline.sharing.geow.Account");b.require("arcgisonline.sharing.geow.Geow");b.require("arcgisonline.sharing.dijit.ComboBox");b.require("arcgisonline.sharing.dijit.dialog.ChoiceDlg");
b.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");b.require("arcgisonline.sharing.dijit.dialog.TermsOfUseDlg");b.requireLocalization("arcgisonline","arcgisonline");b.declare("arcgisonline.sharing.dijit.CreateAccount",[h._Widget,h._Templated],{widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"${baseClass}" dojoType\x3d"dijit.layout.ContentPane" dojoAttachPoint\x3d"containerNode"\x3e\r\n  \x3cdiv dojoType\x3d"dijit.form.Form" class\x3d"esriFloatLeading newStyles grid-50" style\x3d"margin-top:20px;"\x3e\r\n    \x3cp id\x3d"formTitle" dojoAttachPoint\x3d"_formTitle"\x3e${i18n.formTitle}\x3c/p\x3e\r\n\r\n    \x3cdiv class\x3d"formBlock" data-dojo-attach-point\x3d"_messageRow"\x3e\r\n      \x3clabel for\x3d"messageRow" id\x3d"messageRowLabel"\x3e\x26nbsp;\x3c/label\x3e\r\n      \x3cdiv id\x3d"messageRow" dojoAttachPoint\x3d"_message" style\x3d"color:red;"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel for\x3d"username" class\x3d"requiredLabel" id\x3d"usernameLabel"\x3e${i18n.usernameLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"username" dojoAttachPoint\x3d"_username" dojoType\x3d"dijit.form.TextBox" trim\x3d"true"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel for\x3d"password" class\x3d"requiredLabel" id\x3d"passwordLabel"\x3e${i18n.passwordLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"password" dojoAttachPoint\x3d"_password" dojoType\x3d"dijit.form.TextBox" type\x3d"password" trim\x3d"true"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel for\x3d"confirm_password" class\x3d"requiredLabel" id\x3d"confirmPasswordLabel"\x3e${i18n.confirmPasswordLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"confirm_password" dojoAttachPoint\x3d"_confirmPassword" dojoType\x3d"dijit.form.TextBox" type\x3d"password" trim\x3d"true"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel for\x3d"first_name" class\x3d"requiredLabel" id\x3d"firstNameLabel"\x3e${i18n.firstNameLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"first_name" dojoAttachPoint\x3d"_firstName" dojoType\x3d"dijit.form.TextBox" trim\x3d"true"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel for\x3d"last_name" class\x3d"requiredLabel" id\x3d"lastNameLabel"\x3e${i18n.lastNameLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"last_name" dojoAttachPoint\x3d"_lastName" dojoType\x3d"dijit.form.TextBox" trim\x3d"true"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv dojoAttachPoint\x3d"_organizationRow" class\x3d"formBlock"\x3e\r\n        \x3clabel for\x3d"organization" class\x3d"requiredLabel" id\x3d"organizationLabel"\x3e${i18n.organizationLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"organization" dojoAttachPoint\x3d"_organizationName" dojoType\x3d"dijit.form.TextBox" trim\x3d"true"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel for\x3d"email" class\x3d"requiredLabel" id\x3d"emailLabel"\x3e${i18n.emailLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"email" dojoAttachPoint\x3d"_email" dojoType\x3d"dijit.form.TextBox" trim\x3d"true"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel for\x3d"confirm_email" class\x3d"requiredLabel" id\x3d"confirmEmailLabel"\x3e${i18n.confirmEmailLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"confirm_email" dojoAttachPoint\x3d"_confirmEmail" dojoType\x3d"dijit.form.TextBox" trim\x3d"true"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv dojoAttachPoint\x3d"_phoneNumberRow" class\x3d"formBlock"\x3e\r\n        \x3clabel for\x3d"phoneNumber" class\x3d"requiredLabel" id\x3d"phoneNumberLabel"\x3e${i18n.phoneNumberLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"phoneNumber" dojoAttachPoint\x3d"_phoneNumber" dojoType\x3d"dijit.form.TextBox" trim\x3d"true"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"hintBox esriAlignLeading" id\x3d"identityQuestionMessage" dojoAttachPoint\x3d"_identityQuestionMessage"\x3e${i18n.identityQuestionMsg}\x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel for\x3d"identity_question" class\x3d"requiredLabel" id\x3d"identityQuestionLabel"\x3e${i18n.identityQuestionLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"identity_question" dojoAttachPoint\x3d"_identityQuestion" dojoType\x3d"arcgisonline.sharing.dijit.ComboBox" dojoAttachEvent\x3d"onChange:onIdentityQuestionChange" style\x3d"width:350px;" trim\x3d"true"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel for\x3d"identity_answer" class\x3d"requiredLabel" id\x3d"identityAnswerLabel"\x3e${i18n.answerLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"identity_answer" dojoAttachPoint\x3d"_identityAnswer" dojoType\x3d"dijit.form.TextBox" trim\x3d"true"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"formBlock" id\x3d"terms_of_use_container"\x3e\r\n        \x3clabel for\x3d"terms_of_use" class\x3d"requiredLabel" id\x3d"termsOfUseLabel"\x3e${i18n.termsOfUseLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"terms_of_use" dojoAttachPoint\x3d"_terms" class\x3d"calcite light" dojoType\x3d"dijit.form.Button" dojoAttachEvent\x3d"onClick:onTermsClick" type\x3d"button"\x3e${i18n.reviewTermsOfUseLabel}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"bottom-buttons"\x3e\r\n        \x3cdiv dojoAttachPoint\x3d"_createAccount" class\x3d"calcite blue" dojoType\x3d"dijit.form.Button" dojoAttachEvent\x3d"onClick:onCreateAccountClick" type\x3d"button"\x3e${i18n.createAccountLabel}\x3c/div\x3e\r\n        \x3cdiv dojoAttachPoint\x3d"_cancel" class\x3d"calcite transparent" dojoType\x3d"dijit.form.Button" dojoAttachEvent\x3d"onClick:onCancelClick" type\x3d"button"\x3e${i18n.cancel}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"esriFloatLeading newStyles" dojoAttachPoint\x3d"_columnThree"\x3e\r\n    \x3cdiv class\x3d"hintBox esriAlignLeading esriLeadingMargin3 grid-30" id\x3d"accountMessage" dojoAttachPoint\x3d"_accountMessage"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cform id\x3d"form_new_account" dojoAttachPoint\x3d"_form_new_account" method\x3d"post"\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_username" dojoAttachPoint\x3d"_form_username" name\x3d"username"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_password" dojoAttachPoint\x3d"_form_password" name\x3d"password"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_confirmationPassword" dojoAttachPoint\x3d"_form_confirmationPassword" name\x3d"confirmationPassword"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_firstName" dojoAttachPoint\x3d"_form_firstName" name\x3d"firstName"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_lastName" dojoAttachPoint\x3d"_form_lastName" name\x3d"lastName"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_organization" dojoAttachPoint\x3d"_form_organization" name\x3d"organization"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_email" dojoAttachPoint\x3d"_form_email" name\x3d"email"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_phoneNumber" dojoAttachPoint\x3d"_form_phoneNumber" name\x3d"phoneNumber"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_identifyQuestion" dojoAttachPoint\x3d"_form_identifyQuestion" name\x3d"identifyQuestion"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_identifyQuestionID" dojoAttachPoint\x3d"_form_identifyQuestionID" name\x3d"identifyQuestionID"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_identifyAnswer" dojoAttachPoint\x3d"_form_identifyAnswer" name\x3d"identifyAnswer"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_ipAddress" dojoAttachPoint\x3d"_form_ipAddress" name\x3d"ipAddress"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_apiKey" dojoAttachPoint\x3d"_form_apiKey" name\x3d"apiKey"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_appID" dojoAttachPoint\x3d"_form_appID" name\x3d"appID"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_languageCode" dojoAttachPoint\x3d"_form_languageCode" name\x3d"languageCode"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_format" dojoAttachPoint\x3d"_form_format" name\x3d"format"/\x3e\r\n  \x3c/form\x3e\r\n\x3c/div\x3e',
baseClass:"esriAGOCreateAccount",geow:arcgisonline.sharing.geow.Geow,util:arcgisonline.sharing.util,ipLookupUrl:"serverapi.arcgisonline.com/veadaptor/production/services/identity/clientIp",newUserUrl:esriGeowConfig.baseUrl.replace("https:","http:")+"user.html?newUser\x3dtrue",redirectUrl:esriGeowConfig.baseUrl.replace("https:","http:")+"content.html",accountMode:null,activationId:null,invitationId:null,orgName:null,termsAccepted:!1,newAccount:null,identityQuestions:null,_accountMessage:null,_pageTitle:null,
_formTitle:null,_columnThree:null,_identityQuestionMessage:null,_messageRow:null,_phoneNumberRow:null,_organizationRow:null,_usernameLabel:null,_passwordLabel:null,_confirmPasswordLabel:null,_firstNameLabel:null,_lastNameLabel:null,_organizationLabel:null,_emailLabel:null,_confirmEmailLabel:null,_phoneNumberLabel:null,_identityQuestionLabel:null,_identityAnswerLabel:null,_termsOfUseLabel:null,_message:null,_username:null,_password:null,_confirmPassword:null,_firstName:null,_lastName:null,_organizationName:null,
_email:null,_confirmEmail:null,_phoneNumber:null,_identityQuestionID:-1,_identityQuestion:null,_identityAnswer:null,_ipAddress:null,_terms:null,_createAccount:null,_cancel:null,_settingUsername:!1,_form_new_account:null,_form_username:null,_form_password:null,_form_confirmationPassword:null,_form_firstName:null,_form_lastName:null,_form_organization:null,_form_email:null,_form_phoneNumber:null,_form_identifyQuestion:null,_form_identifyQuestionID:null,_form_identifyAnswer:null,_form_ipAddress:null,
_form_apiKey:null,_form_appID:null,_form_languageCode:null,_form_format:null,i18n:null,ecasAccountMode:"ecas",arcgisAccountMode:"arcgis",bothUserType:"both",arcgisUserType:"arcgisonly",postMixInProperties:function(){this.inherited(arguments);this.i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").createAccount);this.i18n.signUpWidget=b.i18n.getLocalization("arcgisonline","arcgisonline").signUpWidget;this.i18n.securityQuestions=
b.i18n.getLocalization("arcgisonline","arcgisonline").securityQuestions},startup:function(){this.inherited(arguments);b.style(this._messageRow,"display","none");this._createAccount.set("disabled",!0);this.setupQuestions();this.accountMode=this.arcgisAccountMode;this.userType=this.bothUserType;var a=b.queryToObject(window.location.search.slice(1)).activationcode,c=b.queryToObject(window.location.search.slice(1)).invitation;a?(this.activationId=a,this.accountMode=this.arcgisAccountMode,this.userType=
this.arcgisUserType):c&&(this.accountMode=this.arcgisAccountMode,this.invitationId=c,this.util.getJson(esriGeowConfig.restBaseUrl+"community/invitations/"+this.invitationId,b.hitch(this,function(a){a.account&&a.account.name&&(this.orgName=a.account.name)})),b.style(b.byId("terms_of_use_container"),"display","none"),this.termsAccepted=!0,this._createAccount.set("disabled",!1),this.userType=this.arcgisUserType);this.showArcGISAccountUI();this.accountMode===this.ecasAccountMode&&this.lookupIPAddress();
a=this.i18n.createAccountTitle;!this.activationId&&!this.invitationId&&(a=this.i18n.createPublicAccountTitle);b.attr(b.byId("pageTitle"),"innerHTML",a);a="";!this.activationId&&!this.invitationId&&(a+=this.i18n.publicAccountMsg+"\x3cbr/\x3e\x3cbr/\x3e");a+=(this.accountMode===this.arcgisAccountMode?this.i18n.arcgisAccountMsg:this.i18n.accountMsg)+" "+this.i18n.passwordHintText;b.attr(this._accountMessage,"innerHTML",a);b.subscribe("registerUser",this,this.onTermsAccepted);b.subscribe("declineTermsOfUse",
this,this.onTermsDeclined);this.adjustNameRows()},adjustNameRows:function(){"ja"===b.locale&&b.place(b.byId("firstNameRow"),b.byId("lastNameRow"),"after")},showArcGISAccountUI:function(){b.style(this._formTitle,"display","none");b.style(this._identityQuestionMessage,"display","none");b.style(this._organizationRow,"display","none");b.style(this._phoneNumberRow,"display","none");b.removeClass(this._accountMessage,"hintBox");b.connect(this._username,"onChange",b.hitch(this,this.onUsernameChanged))},
lookupIPAddress:function(){esri.request({url:esriGeowConfig.geoIPService}).then(b.hitch(this,function(a){a&&a.clientip&&(this._ipAddress=a.clientip)}),b.hitch(this,function(a,b){console.log("Unable to lookup IP address")}))},setupQuestions:function(){this.identityQuestions=[{id:1,name:this.i18n.securityQuestions[1]},{id:2,name:this.i18n.securityQuestions[2]},{id:3,name:this.i18n.securityQuestions[3]},{id:4,name:this.i18n.securityQuestions[4]},{id:5,name:this.i18n.securityQuestions[5]},{id:6,name:this.i18n.securityQuestions[6]},
{id:7,name:this.i18n.securityQuestions[7]},{id:8,name:this.i18n.securityQuestions[8]},{id:9,name:this.i18n.securityQuestions[9]},{id:10,name:this.i18n.securityQuestions[10]},{id:11,name:this.i18n.securityQuestions[11]},{id:12,name:this.i18n.securityQuestions[12]},{id:13,name:this.i18n.securityQuestions[13]},{id:14,name:this.i18n.securityQuestions[14]}];var a=new b.store.Memory({idProperty:"name",data:this.identityQuestions});this._identityQuestion.set("store",a);this.accountMode===this.ecasAccountMode?
this._identityQuestion.set("value",this.i18n.chooseQuestionLabel):this._identityQuestion.set("value",this.i18n.securityQuestionLabel)},compileAccountInfo:function(){var a=b.locale?b.locale:"en",a=-1<a.indexOf("-")?a.substring(0,a.indexOf("-")):a;this.newAccount={};this.newAccount.username=this._username.get("value");this.newAccount.password=this._password.get("value");this.newAccount.confirmPassword=this._confirmPassword.get("value");this.newAccount.firstName=this._firstName.get("value");this.newAccount.lastName=
this._lastName.get("value");this.newAccount.organization=this._organizationName.get("value");this.newAccount.email=this._email.get("value");this.newAccount.confirmEmail=this._confirmEmail.get("value");this.newAccount.phoneNumber=this._phoneNumber.get("value");this.newAccount.identifyQuestion=this._identityQuestion.get("value");this.newAccount.identifyQuestionID=this._identityQuestionID;this.newAccount.identifyAnswer=this._identityAnswer.get("value");this.newAccount.ipAddress=this._ipAddress;this.newAccount.apiKey=
esriGeowConfig.accountApiKey;this.newAccount.appID=esriGeowConfig.accountAppKey;this.newAccount.languageCode=a},validates:function(){this.compileAccountInfo();var a=null,b="\x3cp\x3e"+this.i18n.validationErrorHeader+"\x3c/p\x3e\x3cp\x3e",d=!1;if(this.notSet(this.newAccount.username))d=!0,b+=this.i18n.invalid.usernameIsBlank+"\x3cbr/\x3e",a||(a=this._username);else{6>this.newAccount.username.length&&(d=!0,b+=this.i18n.invalid.usernameTooShort+"\x3cbr/\x3e",a||(a=this._username));24<this.newAccount.username.length&&
(d=!0,b+=this.i18n.invalid.usernameTooLong+"\x3cbr/\x3e",a||(a=this._username));var e=this.findRestrictedChars(this.newAccount.username,arcgisonline.sharing.dijit.CreateAccount.validation.restrictedCharlist+" ");e&&0<e.length&&(d=!0,b+=esri.substitute({characters:e},this.i18n.invalid.usernameBadChars)+"\x3cbr/\x3e",a||(a=this._username));this.usernameContainsAlphaNumeric(this.newAccount.username)||(d=!0,b+=this.i18n.invalid.usernameInvalidChars+"\x3cbr/\x3e",a||(a=this._username))}if(this.notSet(this.newAccount.password)||
!this.util.meetsPasswordStrength(this.newAccount.password))d=!0,b+=this.i18n.passwordHintText+"\x3cbr/\x3e",a||(a=this._password);this.notSet(this.newAccount.confirmPassword)&&(d=!0,b+=this.i18n.invalid.passwordConfirmIsBlank+"\x3cbr/\x3e",a||(a=this._confirmPassword));this.isSet(this.newAccount.password)&&(this.isSet(this.newAccount.confirmPassword)&&this.newAccount.password!==this.newAccount.confirmPassword)&&(d=!0,b+=this.i18n.invalid.passwordConfirmNoMatch+"\x3cbr/\x3e",a||(a=this._password));
this.notSet(this.newAccount.firstName)?(d=!0,b+=this.i18n.invalid.firstNameIsBlank+"\x3cbr/\x3e",a||(a=this._firstName)):40<this.newAccount.firstName.length?(d=!0,b+=this.i18n.invalid.firstNameTooLong+"\x3cbr/\x3e",a||(a=this._firstName)):this.accountMode===this.ecasAccountMode&&!this.containsAlphaNumericWithSpaces(this.newAccount.firstName)&&(d=!0,b+=this.i18n.invalid.firstNameInvalidChars+"\x3cbr/\x3e",a||(a=this._firstName));this.notSet(this.newAccount.lastName)?(d=!0,b+=this.i18n.invalid.lastNameIsBlank+
"\x3cbr/\x3e",a||(a=this._lastName)):40<this.newAccount.lastName.length?(d=!0,b+=this.i18n.invalid.lastNameTooLong+"\x3cbr/\x3e",a||(a=this._lastName)):this.accountMode===this.ecasAccountMode&&!this.containsAlphaNumericWithSpaces(this.newAccount.lastName)&&(d=!0,b+=this.i18n.invalid.lastNameInvalidChars+"\x3cbr/\x3e",a||(a=this._lastName));this.accountMode===this.ecasAccountMode&&(this.notSet(this.newAccount.organization)?(d=!0,b+=this.i18n.invalid.organizationIsBlank+"\x3cbr/\x3e",a||(a=this._organizationName)):
255<this.newAccount.organization.length?(d=!0,b+=this.i18n.invalid.organizationTooLong+"\x3cbr/\x3e",a||(a=this._organizationName)):this.containsAlphaNumericWithSpaces(this.newAccount.organization)||(d=!0,b+=this.i18n.invalid.organizationInvalidChars+"\x3cbr/\x3e",a||(a=this._organizationName)));this.notSet(this.newAccount.email)?(d=!0,b+=this.i18n.invalid.emailIsBlank+"\x3cbr/\x3e",a||(a=this._email)):this.containsRequiredEmailChars(this.newAccount.email)||(d=!0,b+=esri.substitute({email:this.newAccount.email},
this.i18n.invalid.emailAddress+"\x3cbr/\x3e"),a||(a=this._email));this.notSet(this.newAccount.confirmEmail)?(d=!0,b+=this.i18n.invalid.emailConfirmIsBlank+"\x3cbr/\x3e",a||(a=this._confirmEmail)):this.containsRequiredEmailChars(this.newAccount.confirmEmail)||(d=!0,b+=esri.substitute({email:this.newAccount.confirmEmail},this.i18n.invalid.emailConfirmAddress)+"\x3cbr/\x3e",a||(a=this._confirmEmail));this.isSet(this.newAccount.email)&&(this.isSet(this.newAccount.confirmEmail)&&this.newAccount.email!==
this.newAccount.confirmEmail)&&(d=!0,b+=this.i18n.invalid.emailConfirmNoMatch+"\x3cbr/\x3e",a||(a=this._email));this.accountMode===this.ecasAccountMode&&(this.notSet(this.newAccount.phoneNumber)?(d=!0,b+=this.i18n.invalid.phoneIsBlank+"\x3cbr/\x3e",a||(a=this._phoneNumber)):(e=this.findRestrictedPhoneChars(this.newAccount.phoneNumber,arcgisonline.sharing.dijit.CreateAccount.validation.phoneValidChars),0!==e.length&&(d=!0,b+=esri.substitute({characters:e},this.i18n.invalid.phoneBadChars)+"\x3cbr/\x3e",
a||(a=this._phoneNumber))));1>this.newAccount.identifyQuestionID&&(d=!0,b+=this.i18n.invalid.questionSelection+"\x3cbr/\x3e",a||(a=this._identityQuestion));this.notSet(this.newAccount.identifyQuestion)&&(d=!0,b+=this.i18n.invalid.questionIsBlank+"\x3cbr/\x3e",a||(a=this._identityQuestion));this.notSet(this.newAccount.identifyAnswer)?(d=!0,b+=this.i18n.invalid.answerIsBlank+"\x3cbr/\x3e",a||(a=this._identityAnswer)):60<this.newAccount.identifyAnswer.length&&(d=!0,b+=this.i18n.invalid.answerTooLong+
"\x3cbr/\x3e",a||(a=this._identityAnswer));b+="\x3c/p\x3e";d&&(a&&a.focus(),arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.noticeLabel,message:b}));return!d},onTermsAccepted:function(){this.termsAccepted=!0;this._createAccount.set("disabled",!1)},onTermsDeclined:function(){this.invitationId||(this.termsAccepted=!1,this._createAccount.set("disabled",!0))},onTermsClick:function(){arcgisonline.sharing.dijit.dialog.TermsOfUseDlg.prototype.statics.getInstance().show()},
onUsernameChanged:function(){b.style(this._messageRow,"display","none");b.attr(this._message,"innerHTML","");if(this._settingUsername)this._settingUsername=!1;else{var a=this._username.get("value");if(a&&0<a.length)arcgisonline.sharing.geow.Account.checkUsernames([a],b.hitch(this,this.handleCheckUsername),b.hitch(this,this.handleCheckUsername));else this.onTermsDeclined()}},handleCheckUsername:function(a){if(a&&!a.code&&!a.message){if(a.usernames&&0<a.usernames.length&&this._username.get("value")!==
a.usernames[0].suggested){var c=esriGeowConfig.baseUrl.replace("http:","https:");a=esri.substitute({username:a.usernames[0].requested,linkStart:"\x3cspan class\x3d'esriItemLinks'\x3e\x3ca href\x3d'"+c+esriGeowConfig.signin+window.location.search+"'\x3e",linkEnd:"\x3c/a\x3e\x3c/span\x3e"},this.i18n.invalid.usernameIsTaken);b.style(this._messageRow,"display","table-row");b.attr(this._message,"innerHTML",a);this.onTermsDeclined()}}else a.messageCode&&"DB_0006"===a.messageCode?(b.style(this._messageRow,
"display","table-row"),b.attr(this._message,"innerHTML",this.i18n.errors.restrictedCharacters)):(b.style(this._messageRow,"display","table-row"),b.attr(this._message,"innerHTML",this.i18n.errors.checkingUsername)),this.onTermsDeclined()},onIdentityQuestionChange:function(a){this._identityQuestion.get("store").query({name:a}).forEach(b.hitch(this,function(a){this._identityQuestionID=a.id}))},onCreateAccountClick:function(){this.termsAccepted?this.validates()&&this.createAccount(this.newAccount,esriGeowConfig.accountApi):
arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.noticeLabel,message:this.i18n.termsOfUseReminder})},onCancelClick:function(){var a=esriGeowConfig.baseUrl.replace("http://","https://")+esriGeowConfig.signin;this.activationId?a+="?activationcode\x3d"+this.activationId:this.invitationId&&(a+="?invitation\x3d"+this.invitationId);window.location=a},handleArcGISAccount:function(a,c){if(a&&a.success&&!0===a.success)this.onSignUp(a,c);else{var d=this.i18n.errors.creatingAccount,
e=this.i18n.errorLabel,f=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();a.code&&400===a.code&&a.message&&"Unable to signup user."===a.message&&a.details&&a.details[0]&&"Invitation email does not match."===a.details[0]?(e=this.i18n.noticeLabel,d="\x3cp\x3e"+this.i18n.invite.emailInvitation+"\x3c/p\x3e\x3cp\x3e"+this.i18n.invite.correctEmail+"\x3c/p\x3e",f.onOkClick=b.hitch(this,function(a,b){a.hide();this._email.set("value","");this._confirmEmail.set("value","");this._email.focus();
this._createAccount.set("disabled",!1);this._createAccount.set("label",this.i18n.createAccountLabel)},f),f.show({title:e,message:d})):a.code&&500===a.code&&a.message&&-1<a.message.indexOf("Username")&&-1<a.message.indexOf("not available.")?(e=this.i18n.noticeLabel,d=this.i18n.errors.restrictedCharacters,f.onOkClick=b.hitch(this,function(a,b){a.hide();this._username.focus();this._createAccount.set("disabled",!1);this._createAccount.set("label",this.i18n.createAccountLabel)})):(f.show({title:e,message:d}),
this._createAccount.set("disabled",!1),this._createAccount.set("label",this.i18n.createAccountLabel))}},handleCreateAccount:function(a){if(a&&a.status)if("success"===a.status)this.register();else{if("error"===a.status){console.log(a);var b="";(a=a.errorcode)?"Missing_FirstName"===a?(b=this.i18n.invalid.ecasFirstNameIsMissing,this._firstName.focus()):"Missing_LastName"===a?(b=this.i18n.invalid.ecasLastNameIsMissing,this._lastName.focus()):"Missing_Organization"===a?(b=this.i18n.invalid.ecasOrganizationIsMissing,
this._organizationName.focus()):"Missing_Email"===a||"Email_Bad_Format"===a?("Missing_Email"===a?b=this.i18n.invalid.ecasEmailIsMissing:"Email_Bad_Format"===a&&(b=this.i18n.invalid.ecasEmailBadFormat),this._email.focus()):"Missing_PhoneNumber"===a||"PhoneNumber_Bad_Format"===a?(""===a?b=this.i18n.invalid.ecasPhoneIsMissing:""===a&&(b=this.i18n.invalid.ecasPhoneBadFormat),this._phoneNumber.focus()):"Missing_Password"===a||"Password_Length"===a||"Password_Missmatch"===a?("Missing_Password"===a?b=this.i18n.invalid.ecasPasswordIsMissing:
"Password_Length"===a?b=this.i18n.invalid.ecasPasswordLength:"Password_Missmatch"===a&&(b=this.i18n.invalid.ecasPasswordMissmatch),this._password.focus()):"Missing_PasswordConfirmation"===a?(b=this.i18n.invalid.ecasPasswordConfirmIsMissing,this._confirmPassword.focus()):"Missing_IdentifyQuestion"===a?(b=this.i18n.invalid.ecasQuestionIsMissing,this._identityQuestion.focus()):"Missing_Answer"===a?(b=this.i18n.invalid.ecasAnswerIsMissing,this._identityAnswer.focus()):"Missing_Username"===a||"Username_Taken"===
a||"Username_Length"===a?("Username_Taken"===a?b=esri.substitute({username:this.newAccount.username},this.i18n.invalid.ecasUsernameIsTaken):"Missing_Username"===a?b=this.i18n.invalid.ecasUsernameIsMissing:"Username_Length"===a&&(b=this.i18n.invalid.ecasUsernameLength),this._username.focus()):"Delayed_Creation"===a?b=esri.substitute({p:"\x3cp\x3e",pEnd:"\x3c/p\x3e"},this.i18n.errors.delayedCreation):"Restricted_Characters"===a?this.usernameContainsAlphaNumeric(this.newAccount.username)?this.containsLatinCharset(this.newAccount.password)?
this.containsAlphaNumeric(this.newAccount.firstName)?this.containsAlphaNumeric(this.newAccount.lastName)?this.containsAlphaNumericWithSpaces(this.newAccount.organization)?(b=this.i18n.errors.restrictedIdentifyAnswerCharacters,this._identityAnswer.focus()):b=this.i18n.errors.restrictedOrganizationCharacters:b=this.i18n.errors.restrictedLastNameCharacters:b=this.i18n.errors.restrictedFirstNameCharacters:(b=this.i18n.invalid.ecasPasswordRestrictedCharacters,this._password.focus()):(b=this.i18n.errors.restrictedCharacters,
this._username.focus()):b=this.i18n.errors.creatingAccount:b=this.i18n.errors.creatingAccount;a=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();a.show({title:this.i18n.errorLabel,message:b});this._createAccount.set("disabled",!1);this._createAccount.set("label",this.i18n.createAccountLabel)}}else console.log(a),a=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),a.show({title:this.i18n.errorLabel,message:this.i18n.errors.creatingAccount}),this._createAccount.set("disabled",
!1),this._createAccount.set("label",this.i18n.createAccountLabel)},register:function(){var a={username:this.newAccount.username,password:this.newAccount.password};this.signout();this.geow.signup(a,b.hitch(this,this.onSignUp),b.hitch(this,this.signUpError))},signUpError:function(a,c){var d=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();d.onOkClick=b.hitch(this,function(a,b){a.hide();var c=esriGeowConfig.baseUrl+esriGeowConfig.signin;this.invitationId?c+="?invitation\x3d"+
this.invitationId+"\x26org\x3d"+this.orgName:this.activationId&&(c+="?activationcode\x3d"+this.activationId);window.location=c},d);d.show({title:this.i18n.noticeLabel,message:this.i18n.errors.loggingIn});this._createAccount.set("disabled",!1);this._createAccount.set("label",this.i18n.createAccountLabel)},onSignUp:function(a,c){null!=a.error&&""!=a.error?this.errorHandler(a,c):arcgisonline.sharing.geow.Geow.signInHandler(this.newAccount.username,b.hitch(this,this.signIn),b.hitch(this,this.signInError),
a,c)},signIn:function(a,c){this.invitationId?arcgisonline.sharing.geow.Account.getInvitation(this.invitationId,b.hitch(this,this.onInvitationInfo),b.hitch(this,this.onInvitationInfo)):this.activationId?arcgisonline.sharing.geow.Account.activateAccount(this.activationId,b.hitch(this,this.onActivation),b.hitch(this,this.onActivation)):this.routeUser()},signInError:function(a){console.log(a);a=this.i18n.errors.registering+"\x3cbr/\x3e"+this.i18n.errors.caseSensitive;arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.noticeLabel,
message:a});this._createAccount.set("disabled",!1);this._createAccount.set("label",this.i18n.createAccountLabel)},onActivation:function(a){a&&!a.code&&!a.message?this.geow.signin({username:this.newAccount.username,password:this.newAccount.password,expiration:esriGeowConfig.tokenExpiration},b.hitch(this,this.routeUser),b.hitch(this,this.signInError)):(console.log(a),this.routeUser())},onInvitationInfo:function(a,c){var d;if(a&&a.code&&a.message&&403===a.code){var e="\x3cp\x3e"+this.i18n.invite.cantJoin+
"\x3c/p\x3e",e=e+("\x3cp\x3e"+esri.substitute({a:"\x3ca href\x3d'"+esriGeowConfig.account_edit+"' target\x3d'_blank' style\x3d'text-decoration:underline;'\x3e",aEnd:"\x3c/a\x3e"},this.i18n.invite.editEmail)+"\x3c/p\x3e"),e=e+("\x3cp\x3e"+this.i18n.invite.signInNoJoin+"\x3c/p\x3e");d=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();d.onOkClick=b.hitch(this,function(a,b){a.hide();this.routeUser()},d);d.show({title:this.i18n.noticeLabel,message:e})}else if(a&&a.code&&a.message&&
400===a.code)e="\x3cp\x3e"+this.i18n.invite.alreadyAccepted+"\x3c/p\x3e\x3cp\x3e"+this.i18n.invite.signInNoJoin+"\x3c/p\x3e",d=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),d.onOkClick=b.hitch(this,function(a,b){a.hide();this.routeUser()},d),d.show({title:this.i18n.noticeLabel,message:e});else if(a&&a.id&&a.id===this.invitationId){var f="\x3cp\x3e"+esri.substitute({organization:"\x3cstrong\x3e"+a.account.name+"\x3c/strong\x3e"},this.i18n.invite.pendingApproval)+"\x3c/p\x3e",
e="\x3cp\x3e\x3cstrong\x3e"+esri.substitute({organization:a.account.name},this.i18n.invite.joiningOrg)+"\x3c/strong\x3e\x3c/p\x3e\x3cp\x3e\x3cul\x3e",e=e+("\x3cli\x3e"+this.i18n.invite.createdContent+" \x3cstrong\x3e"+this.i18n.invite.adminRights+"\x3c/strong\x3e\x3c/li\x3e"),e=e+("\x3cli\x3e"+this.i18n.signUpWidget.accountManagedMsg+"\x3c/li\x3e"),e=e+("\x3cli\x3e"+this.i18n.signUpWidget.leaveOrganization+"\x3c/li\x3e\x3c/ul\x3e\x3c/p\x3e");d=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();
d.onOkClick=b.hitch(this,function(c){c.hide();a.mustApprove&&!0===a.mustApprove?(c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),c.onOkClick=b.hitch(this,function(a){a.hide();arcgisonline.sharing.geow.Account.acceptInvitation(this.invitationId,b.hitch(this,this.onInvitationAccepted),b.hitch(this,this.onInvitationAccepted))},c),c.show({title:this.i18n.noticeLabel,message:f})):arcgisonline.sharing.geow.Account.acceptInvitation(this.invitationId,b.hitch(this,this.onInvitationAccepted),
b.hitch(this,this.onInvitationAccepted))},d);d.show({title:this.i18n.noticeLabel,message:e})}else this.routeUser()},onInvitationAccepted:function(a,c){var d;if(a&&a.success&&!0===a.success)this.geow.signin({username:this.newAccount.username,password:this.newAccount.password,expiration:esriGeowConfig.tokenExpiration},b.hitch(this,this.routeUser),b.hitch(this,this.signInError));else if(a&&a.code&&a.message&&500===a.code&&"Invitation has already been accepted."===b.trim(a.message)){var e="\x3cp\x3e"+
this.i18n.invite.awaitingApproval+"\x3c/p\x3e\x3cp\x3e"+this.i18n.invite.clickToSignIn+"\x3c/p\x3e";d=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();d.onOkClick=b.hitch(this,function(a,b){a.hide();this.routeUser()},d);d.show({title:this.i18n.noticeLabel,message:e})}else console.log(a),d=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),d.onOkClick=b.hitch(this,function(a,b){a.hide();window.location=esriGeowConfig.baseUrl.replace("http:","https:")+
esriGeowConfig.signin},d),a.code&&a.message?d.show({title:this.i18n.unableToJoinLabel,message:a.message}):d.show({title:this.i18n.unableToJoinLabel,message:this.i18n.errors.joiningOrg})},routeUser:function(){var a=this.util.getUser(),c=b.queryToObject(window.location.search.slice(1)).returnUrl;!esriGeowConfig.isDebug&&a&&a.accountId?(esriGeowConfig.self=null,arcgisonline.sharing.geow.Account.getSelf(b.hitch(this,this.routeOrg))):window.location=null!=c?c:this.newUserUrl},routeOrg:function(a,c){var d=
this.util.getUser(),e=b.queryToObject(window.location.search.slice(1)).returnUrl;if(a&&!a.code&&!a.message){var f=a.allSSL;if(e){if(a.urlKey&&a.customBaseUrl){var g=this.util.parseUrl(e).host;-1===g.indexOf(a.urlKey+"."+a.customBaseUrl)&&(d=this.util.getCookie("esri_auth"),e=e.replace(g,a.urlKey+"."+a.customBaseUrl),e=this.util.getBridgeUrl(e,d))}window.location=f?e.replace("http:","https:"):e}else a.urlKey&&a.customBaseUrl?(d=null,-1===window.location.host.indexOf(a.urlKey+"."+a.customBaseUrl)&&
(d=this.util.getCookie("esri_auth")),e=(f?"https:":"http:")+"//"+a.urlKey+"."+a.customBaseUrl,g=esriGeowConfig.baseUrl.indexOf(location.host),e=-1<g?e+(esriGeowConfig.baseUrl.substring(g+location.host.length)+"content.html"):f?this.redirectUrl.replace("http:","https:"):this.redirectUrl.replace("https:","http:"),d&&(e=esriGeowConfig.bridgeUrl+"?url\x3d"+e+"\x26exp\x3d"+Math.ceil((new Date(d.expires)-new Date)/1E3)),window.location=e):window.location="account_admin"===d.role&&!a.urlKey?(f?esriGeowConfig.baseUrl.replace("http:",
"https:"):esriGeowConfig.baseUrl.replace("https:","http:"))+"setup.html":f?this.redirectUrl.replace("http:","https:"):this.redirectUrl}else window.location=e?e:this.newUserUrl},isSet:function(a){return a&&null!==a&&0<a.length},notSet:function(a){return!a||null===a||""===a},findRestrictedChars:function(a,b){var d="",e;if(a&&b)for(e=0;e<b.length;e++){var f=b.charAt(e);-1!==a.indexOf(f)&&(" "==f&&(f="spaces"),d=0==d.length?f:d+(" "+f))}return d},findRestrictedPhoneChars:function(a,b){var d="",e;if(a&&
b)for(e=0;e<a.length;e++){var f=a.charAt(e);-1===b.indexOf(f)&&(d+=f+" ")}return d},containsRequiredEmailChars:function(a){if(window.RegExp){var b=/^.+\@(\[?)[a-zA-Z0-9\-\.]+\.([a-zA-Z]{2,20}|[0-9]{1,3})(\]?)$/;return!/(@.*@)|(\.\.)|(@\.)|(\.@)|(^\.)/.test(a)&&b.test(a)?!0:!1}return-1===a.indexOf("@")||-1===a.indexOf(".")?!1:!0},containsLatinCharset:function(a){return/^[\u0000-\u00FF]+$/g.test(a)},usernameContainsAlphaNumeric:function(a){var b=/^[a-zA-Z0-9@_\.]+$/g;return a&&!!b.test(a)},containsAlphaNumeric:function(a){var b=
/^[a-zA-Z0-9@_\.\-]+$/g;return a&&!!b.test(a)},containsAlphaNumericWithSpaces:function(a){var b=/^[a-zA-Z0-9@_\.\-\s]+$/g;return a&&!!b.test(a)},createAccount:function(a,c){this._createAccount.set("disabled",!0);this._createAccount.set("label",this.i18n.creatingAccountLabel);if(this.accountMode===this.ecasAccountMode){if(esriGeowConfig.proxyServer){var d=esriGeowConfig.proxyServer;-1!==location.protocol.indexOf("https")&&(d=d.replace("http:","https:"));c=d+"?"+c}b.attr(this._form_new_account,"action",
c);b.attr(this._form_username,"value",a.username);b.attr(this._form_password,"value",a.password);b.attr(this._form_confirmationPassword,"value",a.confirmPassword);b.attr(this._form_firstName,"value",a.firstName);b.attr(this._form_lastName,"value",a.lastName);b.attr(this._form_organization,"value",a.organization);b.attr(this._form_email,"value",a.email);b.attr(this._form_phoneNumber,"value",a.phoneNumber);b.attr(this._form_identifyQuestion,"value",a.identifyQuestion);b.attr(this._form_identifyQuestionID,
"value",a.identifyQuestionID);b.attr(this._form_identifyAnswer,"value",a.identifyAnswer);b.attr(this._form_ipAddress,"value",this._ipAddress);b.attr(this._form_apiKey,"value",a.apiKey);b.attr(this._form_appID,"value",a.appID);b.attr(this._form_languageCode,"value",a.languageCode);b.attr(this._form_format,"value","json");b.xhrPost({url:c,form:this._form_new_account,handleAs:"json",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},load:b.hitch(this,this.handleCreateAccount),
error:b.hitch(this,this.handleCreateAccount)})}else if(this.accountMode===this.arcgisAccountMode){var d="ja"===b.locale?a.lastName+" "+a.firstName:a.firstName+" "+a.lastName,e={username:a.username,password:a.password,email:a.email,firstName:a.firstName,lastName:a.lastName,securityQuestionIdx:a.identifyQuestionID,securityAnswer:a.identifyAnswer,provider:this.arcgisAccountMode,usertype:this.userType};"ja"===b.locale&&(e.fullName=d);this.invitationId&&(e.invitationId=this.invitationId);this.activationId&&
(e.activationCode=this.activationId);this.signout();this.geow.signup(e,b.hitch(this,this.onSignUp),b.hitch(this,this.handleArcGISAccount))}},signout:function(){esriGeowConfig.userInfo=null;esriGeowConfig.userPreferences=null;b.cookie("esri_auth",null,{expires:-1,path:"/",domain:document.domain});b.cookie("ESRI_Webmap",null,{expires:-1,path:"/",domain:document.domain});b.publish("onSignOut",[])}});arcgisonline.sharing.dijit.CreateAccount.validation={restrictedCharlist:"'\"\x3c\x3e{}[]#$%^\x26;:/\\",
phoneValidChars:"0123456789().-+ "}})},"dijit/_DialogMixin":function(){define(["dojo/_base/declare","./a11y"],function(h,b){return h("dijit._DialogMixin",null,{actionBarTemplate:"",execute:function(){},onCancel:function(){},onExecute:function(){},_onSubmit:function(){this.onExecute();this.execute(this.get("value"))},_getFocusItems:function(){var h=b._getTabNavigable(this.domNode);this._firstFocusItem=h.lowest||h.first||this.closeButtonNode||this.domNode;this._lastFocusItem=h.last||h.highest||this._firstFocusItem}})})},
"dijit/form/_FormValueWidget":function(){define(["dojo/_base/declare","dojo/sniff","./_FormWidget","./_FormValueMixin"],function(h,b,k,a){return h("dijit.form._FormValueWidget",[k,a],{_layoutHackIE7:function(){if(7==b("ie"))for(var a=this.domNode,d=a.parentNode,e=a.firstChild||a,f=e.style.filter,g=this;d&&0==d.clientHeight;)(function(){var a=g.connect(d,"onscroll",function(){g.disconnect(a);e.style.filter=(new Date).getMilliseconds();g.defer(function(){e.style.filter=f})})})(),d=d.parentNode}})})},
"esri/urlUtils":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/url dojo/io-query ./kernel ./config ./sniff dojo/i18n!./nls/jsapi".split(" "),function(h,b,k,a,c,d,e,f){var g={},l=d.defaults.io,m=window.location.protocol;"file:"===m&&(m="http:");g.urlToObject=function(b){var c={},d=new k(b),e=b.indexOf("?");null===d.query?c={path:b,query:null}:(c.path=b.substring(0,e),c.query=a.queryToObject(d.query));d.fragment&&(c.hash=d.fragment,null===d.query&&(c.path=c.path.substring(0,c.path.length-
(d.fragment.length+1))));return c};g.getProxyUrl=function(a,b){var c=h.isString(a)?0===h.trim(a).toLowerCase().indexOf("https:"):a,d=l.proxyUrl,e,k,m=f.io.proxyNotSet;if(h.isString(a)&&(k=g.getProxyRule(a)))d=k.proxyUrl;if(!d)throw console.log(m),Error(m);c&&(!1!==b&&0!==window.location.href.toLowerCase().indexOf("https:"))&&(c=d,0!==c.toLowerCase().indexOf("http")&&(c=g.getAbsoluteUrl(c)),c=c.replace(/^http:/i,"https:"),g.canUseXhr(c)&&(d=c,e=1));d=g.urlToObject(d);d._xo=e;return d};g.addProxy=function(b){var c=
g.getProxyRule(b),d;c?d=g.urlToObject(c.proxyUrl):l.alwaysUseProxy&&(d=g.getProxyUrl());d&&(c=g.urlToObject(b),b=d.path+"?"+c.path,(d=a.objectToQuery(h.mixin(d.query||{},c.query)))&&(b+="?"+d));return b};g.addProxyRule=function(a){var b=a.urlPrefix=g.urlToObject(a.urlPrefix).path.replace(/([^\/])$/,"$1/").replace(/^https?:\/\//ig,"").toLowerCase(),c=l.proxyRules,d,e=c.length,f,h=e;for(d=0;d<e;d++)if(f=c[d].urlPrefix,0===b.indexOf(f)){if(b.length===f)return-1;h=d;break}else 0===f.indexOf(b)&&(h=d+
1);c.splice(h,0,a);return h};g.getProxyRule=function(a){var b=l.proxyRules,c=b.length,d=g.urlToObject(a).path.replace(/([^\/])$/,"$1/").replace(/^https?:\/\//ig,"").toLowerCase(),e;for(a=0;a<c;a++)if(0===d.indexOf(b[a].urlPrefix)){e=b[a];break}return e};g.hasSameOrigin=function(a,b,c){a=a.toLowerCase();b=b.toLowerCase();var d=window.location.href.toLowerCase();a=0===a.indexOf("http")?new k(a):d=new k(d);b=0===b.indexOf("http")?new k(b):h.isString(d)?new k(d):d;return(c||a.scheme===b.scheme)&&a.host===
b.host&&a.port===b.port};g.canUseXhr=function(a,c){var d=e("esri-phonegap")?!0:!1,f=g.hasSameOrigin,k=l.corsEnabledServers,m,x=-1;!d&&(e("esri-cors")&&k&&k.length)&&(d=b.some(k,function(b,c){m=0!==h.trim(b).toLowerCase().indexOf("http");return f(a,m?"http://"+b:b)||m&&f(a,"https://"+b)?(x=c,!0):!1}));return c?x:d};g.getAbsoluteUrl=function(a){return h.isString(a)&&!/^https?:\/\//i.test(a)?0===a.indexOf("//")?m+a:0===a.indexOf("/")?m+"//"+window.location.host+a:c._appBaseUrl+a:a};g.fixUrl=function(a){/^\/\//i.test(a)&&
(a=m+a);return a=a.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")};e("extend-esri")&&(h.mixin(c,g),c._getProxyUrl=g.getProxyUrl,c._getProxiedUrl=g.addProxy,c._hasSameOrigin=g.hasSameOrigin,c._canDoXOXHR=g.canUseXhr,c._getAbsoluteUrl=g.getAbsoluteUrl,c.fixUrl=g.fixUrl);return g})},"arcgisonline/sharing/dijit/NotificationsList":function(){define(["dijit","dojo","dojox","dojo/require!dijit/_Widget,dijit/_Templated,dojox/rpc/Service,dojo/rpc/JsonService,dijit/Toolbar,arcgisonline/sharing/util"],function(h,
b,k){b.provide("arcgisonline.sharing.dijit.NotificationsList");b.require("dijit._Widget");b.require("dijit._Templated");b.require("dojox.rpc.Service");b.require("dojo.rpc.JsonService");b.require("dijit.Toolbar");b.require("arcgisonline.sharing.util");b.declare("arcgisonline.sharing.dijit.NotificationsList",[h._Widget],{i18n:null,postMixInProperties:function(){this.inherited(arguments);this.i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline",
"arcgisonline").notificationsList)},loadList:function(){var a=function(a,c){b.publish("onNotificationCount",[a.notifications.length]);var f=this.notificationsToTable(a.notifications);b.byId("notificationsList").innerHTML=f},c=arcgisonline.sharing.util.getUser();null!=c&&arcgisonline.sharing.util.getJson(esriGeowConfig.restBaseUrl+"community/users/"+c.email+"/notifications",b.hitch(this,a))},updateList:function(){this.loadList()},notificationsToTable:function(a){var c='\x3ctable cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0" width\x3d"100%" class\x3d"notifications-table"\x3e';
b.forEach(a,function(a,e){var f=a.type,g=b.date.locale.format(new Date(a.received),{selector:"date",format:"short"}),h=a.data.groupTitle,k="";switch(f){case "group_join":k=b.string.substitute(this.i18n.joinGroupByDate,{groupTitle:h,dateStr:g});break;case "group_application_accepted":k=b.string.substitute(this.i18n.joinGroupAccepted,{groupTitle:h,dateStr:g});break;case "group_application_declined":k=b.string.substitute(this.i18n.declineGroupRequest,{groupTitle:h,dateStr:g});break;case "user_invite":k=
b.string.substitute(this.i18n.inviteGroupRequest,{groupTitle:h,dateStr:g})+"\x3cBR/\x3e"+this.i18n.viewInvitation;break;case "user_invitation_accepted":k=b.string.substitute(this.i18n.acceptedInvite,{groupTitle:h,dateStr:g});break;case "user_invitation_declined":k=b.string.substitute(this.i18n.declinedInvite,{groupTitle:h,dateStr:g});break;default:k=b.string.substitute(this.i18n.defaultMsg,{type:f,groupTitle:h,dateStr:g})}c+='\x3ctr\x3e\x3ctd width\x3d"90%"\x3e'+k+"\x3c/td\x3e";c+='\x3ctd width\x3d"10%"\x3e';
c+="\x3cA href\x3d\"JavaScript:arcgisonline.sharing.geow.Community.deleteNotifictation('"+a.id+'\')" alt\x3d"'+this.i18n.deleteLabel+'" title\x3d"'+this.i18n.deleteLabel+'"\x3e\x3cdiv class\x3d"deleteNotificationIcon"\x3e\x3c/div\x3e\x3c/A\x3e';c+="\x3c/td\x3e\x3c/tr\x3e"},this);0==a.length&&(c+='\x3ctr\x3e\x3ctd align\x3d"center" style\x3d"border:none;"\x3e'+this.i18n.noNotificationsMsg+"\x3c/td\x3e\x3c/tr\x3e");return c+="\x3c/table\x3e"}})})},"url:dijit/form/templates/Button.html":'\x3cspan class\x3d"dijit dijitReset dijitInline" role\x3d"presentation"\r\n\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonNode"\r\n\t\tdata-dojo-attach-event\x3d"ondijitclick:__onClick" role\x3d"presentation"\r\n\t\t\x3e\x3cspan class\x3d"dijitReset dijitStretch dijitButtonContents"\r\n\t\t\tdata-dojo-attach-point\x3d"titleNode,focusNode"\r\n\t\t\trole\x3d"button" aria-labelledby\x3d"${id}_label"\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitToggleButtonIconChar"\x3e\x26#x25CF;\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonText"\r\n\t\t\t\tid\x3d"${id}_label"\r\n\t\t\t\tdata-dojo-attach-point\x3d"containerNode"\r\n\t\t\t\x3e\x3c/span\r\n\t\t\x3e\x3c/span\r\n\t\x3e\x3c/span\r\n\t\x3e\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" class\x3d"dijitOffScreen"\r\n\t\tdata-dojo-attach-event\x3d"onclick:_onClick"\r\n\t\ttabIndex\x3d"-1" role\x3d"presentation" aria-hidden\x3d"true" data-dojo-attach-point\x3d"valueNode"\r\n/\x3e\x3c/span\x3e\r\n',
"url:dijit/templates/TooltipDialog.html":'\x3cdiv role\x3d"alertdialog" tabIndex\x3d"-1"\x3e\r\n\t\x3cdiv class\x3d"dijitTooltipContainer" role\x3d"presentation"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"contentsNode" class\x3d"dijitTooltipContents dijitTooltipFocusNode"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n\t\t\t${!actionBarTemplate}\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTooltipConnector" role\x3d"presentation" data-dojo-attach-point\x3d"connectorNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/MenuItem.html":'\x3ctr class\x3d"dijitReset" data-dojo-attach-point\x3d"focusNode" role\x3d"menuitem" tabIndex\x3d"-1"\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemIconCell" role\x3d"presentation"\x3e\r\n\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitMenuItemIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemLabel" colspan\x3d"2" data-dojo-attach-point\x3d"containerNode,textDirNode"\r\n\t\trole\x3d"presentation"\x3e\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemAccelKey" style\x3d"display: none" data-dojo-attach-point\x3d"accelKeyNode"\x3e\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuArrowCell" role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"arrowWrapper" style\x3d"visibility: hidden"\x3e\r\n\t\t\t\x3cspan class\x3d"dijitInline dijitIcon dijitMenuExpand"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"dijitMenuExpandA11y"\x3e+\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/td\x3e\r\n\x3c/tr\x3e\r\n',
"url:dijit/form/templates/TextBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft" id\x3d"widget_${id}" role\x3d"presentation"\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputInner" data-dojo-attach-point\x3d\'textbox,focusNode\' autocomplete\x3d"off"\r\n\t\t\t${!nameAttrSetting} type\x3d\'${type}\'\r\n\t/\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',"url:dijit/form/templates/CheckBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline" role\x3d"presentation"\r\n\t\x3e\x3cinput\r\n\t \t${!nameAttrSetting} type\x3d"${type}" role\x3d"${type}" aria-checked\x3d"false" ${checkedAttrSetting}\r\n\t\tclass\x3d"dijitReset dijitCheckBoxInput"\r\n\t\tdata-dojo-attach-point\x3d"focusNode"\r\n\t \tdata-dojo-attach-event\x3d"ondijitclick:_onClick"\r\n/\x3e\x3c/div\x3e\r\n',
"url:dijit/form/templates/ValidationTextBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tid\x3d"widget_${id}" role\x3d"presentation"\r\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t/\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputInner" data-dojo-attach-point\x3d\'textbox,focusNode\' autocomplete\x3d"off"\r\n\t\t\t${!nameAttrSetting} type\x3d\'${type}\'\r\n\t/\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',
"url:dijit/form/templates/DropDownBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tid\x3d"widget_${id}"\r\n\trole\x3d"combobox"\r\n\taria-haspopup\x3d"true"\r\n\tdata-dojo-attach-point\x3d"_popupStateNode"\r\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer\'\r\n\t\tdata-dojo-attach-point\x3d"_buttonNode" role\x3d"presentation"\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitArrowButtonInner" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"button presentation" aria-hidden\x3d"true"\r\n\t\t\t${_buttonInputDisabled}\r\n\t/\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t/\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\r\n\t\t\x3e\x3cinput class\x3d\'dijitReset dijitInputInner\' ${!nameAttrSetting} type\x3d"text" autocomplete\x3d"off"\r\n\t\t\tdata-dojo-attach-point\x3d"textbox,focusNode" role\x3d"textbox"\r\n\t/\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',
"url:dijit/templates/Menu.html":'\x3ctable class\x3d"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable" role\x3d"menu" tabIndex\x3d"${tabIndex}"\r\n\t   cellspacing\x3d"0"\x3e\r\n\t\x3ctbody class\x3d"dijitReset" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/tbody\x3e\r\n\x3c/table\x3e\r\n',"url:dijit/form/templates/DropDownButton.html":'\x3cspan class\x3d"dijit dijitReset dijitInline"\r\n\t\x3e\x3cspan class\x3d\'dijitReset dijitInline dijitButtonNode\'\r\n\t\tdata-dojo-attach-event\x3d"ondijitclick:__onClick" data-dojo-attach-point\x3d"_buttonNode"\r\n\t\t\x3e\x3cspan class\x3d"dijitReset dijitStretch dijitButtonContents"\r\n\t\t\tdata-dojo-attach-point\x3d"focusNode,titleNode,_arrowWrapperNode,_popupStateNode"\r\n\t\t\trole\x3d"button" aria-haspopup\x3d"true" aria-labelledby\x3d"${id}_label"\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitIcon"\r\n\t\t\t\tdata-dojo-attach-point\x3d"iconNode"\r\n\t\t\t\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonText"\r\n\t\t\t\tdata-dojo-attach-point\x3d"containerNode"\r\n\t\t\t\tid\x3d"${id}_label"\r\n\t\t\t\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitArrowButtonInner"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitArrowButtonChar"\x3e\x26#9660;\x3c/span\r\n\t\t\x3e\x3c/span\r\n\t\x3e\x3c/span\r\n\t\x3e\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" class\x3d"dijitOffScreen" tabIndex\x3d"-1"\r\n\t\tdata-dojo-attach-event\x3d"onclick:_onClick"\r\n\t\tdata-dojo-attach-point\x3d"valueNode" role\x3d"presentation" aria-hidden\x3d"true"\r\n/\x3e\x3c/span\x3e\r\n',
"url:dijit/templates/Tooltip.html":'\x3cdiv class\x3d"dijitTooltip dijitTooltipLeft" id\x3d"dojoTooltip" data-dojo-attach-event\x3d"mouseenter:onMouseEnter,mouseleave:onMouseLeave"\r\n\t\x3e\x3cdiv class\x3d"dijitTooltipConnector" data-dojo-attach-point\x3d"connectorNode"\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d"dijitTooltipContainer dijitTooltipContents" data-dojo-attach-point\x3d"containerNode" role\x3d\'alert\'\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',"url:dijit/form/templates/ComboButton.html":'\x3ctable class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tcellspacing\x3d\'0\' cellpadding\x3d\'0\' role\x3d"presentation"\r\n\t\x3e\x3ctbody role\x3d"presentation"\x3e\x3ctr role\x3d"presentation"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitStretch dijitButtonNode" data-dojo-attach-point\x3d"buttonNode" data-dojo-attach-event\x3d"ondijitclick:__onClick,onkeydown:_onButtonKeyDown"\r\n\t\t\x3e\x3cdiv id\x3d"${id}_button" class\x3d"dijitReset dijitButtonContents"\r\n\t\t\tdata-dojo-attach-point\x3d"titleNode"\r\n\t\t\trole\x3d"button" aria-labelledby\x3d"${id}_label"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitInline dijitIcon" data-dojo-attach-point\x3d"iconNode" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitInline dijitButtonText" id\x3d"${id}_label" data-dojo-attach-point\x3d"containerNode" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd id\x3d"${id}_arrow" class\x3d\'dijitReset dijitRight dijitButtonNode dijitArrowButton\'\r\n\t\t\tdata-dojo-attach-point\x3d"_popupStateNode,focusNode,_buttonNode"\r\n\t\t\tdata-dojo-attach-event\x3d"onkeydown:_onArrowKeyDown"\r\n\t\t\ttitle\x3d"${optionsTitle}"\r\n\t\t\trole\x3d"button" aria-haspopup\x3d"true"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitArrowButtonInner" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitArrowButtonChar" role\x3d"presentation"\x3e\x26#9660;\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd style\x3d"display:none !important;"\r\n\t\t\t\x3e\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" data-dojo-attach-point\x3d"valueNode"\r\n\t\t\t\tclass\x3d"dijitOffScreen"\r\n\t\t\t\trole\x3d"presentation" aria-hidden\x3d"true"\r\n\t\t\t\tdata-dojo-attach-event\x3d"onclick:_onClick"\r\n\t\t/\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\r\n\x3e\x3c/table\x3e\r\n',
"url:dijit/templates/Dialog.html":'\x3cdiv class\x3d"dijitDialog" role\x3d"dialog" aria-labelledby\x3d"${id}_title"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"titleBar" class\x3d"dijitDialogTitleBar"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"titleNode" class\x3d"dijitDialogTitle" id\x3d"${id}_title"\r\n\t\t\t\trole\x3d"heading" level\x3d"1"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"closeButtonNode" class\x3d"dijitDialogCloseIcon" data-dojo-attach-event\x3d"ondijitclick: onCancel" title\x3d"${buttonCancel}" role\x3d"button" tabindex\x3d"-1"\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"closeText" class\x3d"closeText" title\x3d"${buttonCancel}"\x3ex\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitDialogPaneContent"\x3e\x3c/div\x3e\r\n\t${!actionBarTemplate}\r\n\x3c/div\x3e\r\n\r\n',
"url:dijit/templates/MenuSeparator.html":'\x3ctr class\x3d"dijitMenuSeparator" role\x3d"separator"\x3e\r\n\t\x3ctd class\x3d"dijitMenuSeparatorIconCell"\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorTop"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorBottom"\x3e\x3c/div\x3e\r\n\t\x3c/td\x3e\r\n\t\x3ctd colspan\x3d"3" class\x3d"dijitMenuSeparatorLabelCell"\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorTop dijitMenuSeparatorLabel"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorBottom"\x3e\x3c/div\x3e\r\n\t\x3c/td\x3e\r\n\x3c/tr\x3e\r\n',
"*now":function(h){h(['dojo/i18n!*preload*arcgisonline/nls/base*["ar","ca","cs","da","de-de","el","en-gb","en-us","es-es","fi-fi","fr-fr","he-il","hu","it-it","ja-jp","ko-kr","nl-nl","nb","pl","pt-br","pt-pt","ro","ru","sk","sl","sv","th","tr","zh-tw","zh-cn","ROOT"]'])},"*noref":1}});
define("arcgisonline/base",["dijit","dojo","dojox","dojo/i18n!arcgisonline/nls/arcgisonline","dojo/require!esri/main,esri/utils,arcgisonline/init,arcgisonline/persist,arcgisonline/sharing/dijit/ClassificationBanner,arcgisonline/sharing/dijit/SiteHeader,arcgisonline/sharing/dijit/SiteFooter,arcgisonline/sharing/dijit/SiteFooterMap,arcgisonline/sharing/dijit/SignIn,arcgisonline/sharing/dijit/SignInInternal,arcgisonline/sharing/dijit/SignUp,arcgisonline/sharing/dijit/SignUpInternal,arcgisonline/sharing/dijit/ChangePassword,dijit/form/Form,arcgisonline/sharing/dijit/CreateAccount,arcgisonline/sharing/geow/Account,arcgisonline/sharing/dijit/HelpManager,dojo/date/locale,dojox/widget/Rotator,dojox/widget/AutoRotator,dojox/widget/rotator/Controller,dojox/widget/rotator/Fade,dijit/layout/StackController,dojo/cookie,dojo/json,arcgisonline/sharing/dijit/TextMenu,arcgisonline/sharing/util,dojo/topic,dijit/_base,dijit/form/DropDownButton,dijit/form/ComboButton,dijit/form/ToggleButton,dijit/form/RadioButton,dijit/PopupMenuItem,dijit/_Contained,dijit/_Container,dijit/_WidgetBase,dijit/main,dojo/Stateful,dojo/date/locale,esri/utils,arcgisonline/sharing/dijit/Gallery,arcgisonline/sharing/util,arcgisonline/sharing/dijit/views,dojo/parser,dijit/_base,dojo/dnd/AutoSource,dojo/dnd/Target,dojo/fx/Toggler,dijit/TooltipDialog,dijit/MenuSeparator"],function(h,
b,k){b.provide("arcgisonline.base");b.require("esri.main");b.require("esri.utils");b.require("arcgisonline.init");b.require("arcgisonline.persist");b.require("arcgisonline.sharing.dijit.ClassificationBanner");b.require("arcgisonline.sharing.dijit.SiteHeader");b.require("arcgisonline.sharing.dijit.SiteFooter");b.require("arcgisonline.sharing.dijit.SiteFooterMap");b.require("arcgisonline.sharing.dijit.SignIn");b.require("arcgisonline.sharing.dijit.SignInInternal");b.require("arcgisonline.sharing.dijit.SignUp");
b.require("arcgisonline.sharing.dijit.SignUpInternal");b.require("arcgisonline.sharing.dijit.ChangePassword");b.require("dijit.form.Form");b.require("arcgisonline.sharing.dijit.CreateAccount");b.require("arcgisonline.sharing.geow.Account");b.require("arcgisonline.sharing.dijit.HelpManager");b.require("dojo.date.locale");b.require("dojox.widget.Rotator");b.require("dojox.widget.AutoRotator");b.require("dojox.widget.rotator.Controller");b.require("dojox.widget.rotator.Fade");b.require("dijit.layout.StackController");
b.require("dojo.cookie");b.require("dojo.json");b.require("arcgisonline.sharing.dijit.TextMenu");b.require("arcgisonline.sharing.util");b.require("dojo.topic");b.require("dijit._base");b.require("dijit.form.DropDownButton");b.require("dijit.form.ComboButton");b.require("dijit.form.ToggleButton");b.require("dijit.form.RadioButton");b.require("dijit.PopupMenuItem");b.require("dijit._Contained");b.require("dijit._Container");b.require("dijit._WidgetBase");b.require("dijit.main");b.require("dojo.Stateful");
b.require("dojo.date.locale");b.require("esri.utils");b.require("arcgisonline.sharing.dijit.Gallery");b.require("arcgisonline.sharing.util");b.require("arcgisonline.sharing.dijit.views");b.require("dojo.parser");b.require("dijit._base");b.require("dojo.dnd.AutoSource");b.require("dojo.dnd.Target");b.require("dojo.fx.Toggler");b.require("dijit.TooltipDialog");b.require("dijit.MenuSeparator");b.requireLocalization("arcgisonline","arcgisonline")});